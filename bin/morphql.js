#!/usr/bin/env node
import{createRequire as e}from"module";var t={54:(e,t,n)=>{e=n.nmd(e);function get_beautify(e,t,n){var beautify=function(t,n){return e.js_beautify(t,n)};beautify.js=e.js_beautify;beautify.css=t.css_beautify;beautify.html=n.html_beautify;beautify.js_beautify=e.js_beautify;beautify.css_beautify=t.css_beautify;beautify.html_beautify=n.html_beautify;return beautify}if(typeof define==="function"&&define.amd){define(["./lib/beautify","./lib/beautify-css","./lib/beautify-html"],(function(e,t,n){return get_beautify(e,t,n)}))}else{(function(e){var t=n(975);t.js_beautify=t.js;t.css_beautify=t.css;t.html_beautify=t.html;e.exports=get_beautify(t,t,t)})(e)}},657:e=>{function Directives(e,t){e=typeof e==="string"?e:e.source;t=typeof t==="string"?t:t.source;this.__directives_block_pattern=new RegExp(e+/ beautify( \w+[:]\w+)+ /.source+t,"g");this.__directive_pattern=/ (\w+)[:](\w+)/g;this.__directives_end_ignore_pattern=new RegExp(e+/\sbeautify\signore:end\s/.source+t,"g")}Directives.prototype.get_directives=function(e){if(!e.match(this.__directives_block_pattern)){return null}var t={};this.__directive_pattern.lastIndex=0;var n=this.__directive_pattern.exec(e);while(n){t[n[1]]=n[2];n=this.__directive_pattern.exec(e)}return t};Directives.prototype.readIgnored=function(e){return e.readUntilAfter(this.__directives_end_ignore_pattern)};e.exports.D=Directives},713:e=>{var t=RegExp.prototype.hasOwnProperty("sticky");function InputScanner(e){this.__input=e||"";this.__input_length=this.__input.length;this.__position=0}InputScanner.prototype.restart=function(){this.__position=0};InputScanner.prototype.back=function(){if(this.__position>0){this.__position-=1}};InputScanner.prototype.hasNext=function(){return this.__position<this.__input_length};InputScanner.prototype.next=function(){var e=null;if(this.hasNext()){e=this.__input.charAt(this.__position);this.__position+=1}return e};InputScanner.prototype.peek=function(e){var t=null;e=e||0;e+=this.__position;if(e>=0&&e<this.__input_length){t=this.__input.charAt(e)}return t};InputScanner.prototype.__match=function(e,n){e.lastIndex=n;var r=e.exec(this.__input);if(r&&!(t&&e.sticky)){if(r.index!==n){r=null}}return r};InputScanner.prototype.test=function(e,t){t=t||0;t+=this.__position;if(t>=0&&t<this.__input_length){return!!this.__match(e,t)}else{return false}};InputScanner.prototype.testChar=function(e,t){var n=this.peek(t);e.lastIndex=0;return n!==null&&e.test(n)};InputScanner.prototype.match=function(e){var t=this.__match(e,this.__position);if(t){this.__position+=t[0].length}else{t=null}return t};InputScanner.prototype.read=function(e,t,n){var r="";var o;if(e){o=this.match(e);if(o){r+=o[0]}}if(t&&(o||!e)){r+=this.readUntil(t,n)}return r};InputScanner.prototype.readUntil=function(e,t){var n="";var r=this.__position;e.lastIndex=this.__position;var o=e.exec(this.__input);if(o){r=o.index;if(t){r+=o[0].length}}else{r=this.__input_length}n=this.__input.substring(this.__position,r);this.__position=r;return n};InputScanner.prototype.readUntilAfter=function(e){return this.readUntil(e,true)};InputScanner.prototype.get_regexp=function(e,n){var r=null;var o="g";if(n&&t){o="y"}if(typeof e==="string"&&e!==""){r=new RegExp(e,o)}else if(e){r=new RegExp(e.source,o)}return r};InputScanner.prototype.get_literal_regexp=function(e){return RegExp(e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"))};InputScanner.prototype.peekUntilAfter=function(e){var t=this.__position;var n=this.readUntilAfter(e);this.__position=t;return n};InputScanner.prototype.lookBack=function(e){var t=this.__position-1;return t>=e.length&&this.__input.substring(t-e.length,t).toLowerCase()===e};e.exports.z=InputScanner},301:e=>{var t;function Options(e,t){this.raw_options=_mergeOpts(e,t);this.disabled=this._get_boolean("disabled");this.eol=this._get_characters("eol","auto");this.end_with_newline=this._get_boolean("end_with_newline");this.indent_size=this._get_number("indent_size",4);this.indent_char=this._get_characters("indent_char"," ");this.indent_level=this._get_number("indent_level");this.preserve_newlines=this._get_boolean("preserve_newlines",true);this.max_preserve_newlines=this._get_number("max_preserve_newlines",32786);if(!this.preserve_newlines){this.max_preserve_newlines=0}this.indent_with_tabs=this._get_boolean("indent_with_tabs",this.indent_char==="\t");if(this.indent_with_tabs){this.indent_char="\t";if(this.indent_size===1){this.indent_size=4}}this.wrap_line_length=this._get_number("wrap_line_length",this._get_number("max_char"));this.indent_empty_lines=this._get_boolean("indent_empty_lines");this.templating=this._get_selection_list("templating",["auto","none","angular","django","erb","handlebars","php","smarty"],["auto"])}Options.prototype._get_array=function(e,t){var n=this.raw_options[e];var r=t||[];if(typeof n==="object"){if(n!==null&&typeof n.concat==="function"){r=n.concat()}}else if(typeof n==="string"){r=n.split(/[^a-zA-Z0-9_\/\-]+/)}return r};Options.prototype._get_boolean=function(e,t){var n=this.raw_options[e];var r=n===undefined?!!t:!!n;return r};Options.prototype._get_characters=function(e,t){var n=this.raw_options[e];var r=t||"";if(typeof n==="string"){r=n.replace(/\\r/,"\r").replace(/\\n/,"\n").replace(/\\t/,"\t")}return r};Options.prototype._get_number=function(e,t){var n=this.raw_options[e];t=parseInt(t,10);if(isNaN(t)){t=0}var r=parseInt(n,10);if(isNaN(r)){r=t}return r};Options.prototype._get_selection=function(e,t,n){var r=this._get_selection_list(e,t,n);if(r.length!==1){throw new Error("Invalid Option Value: The option '"+e+"' can only be one of the following values:\n"+t+"\nYou passed in: '"+this.raw_options[e]+"'")}return r[0]};Options.prototype._get_selection_list=function(e,t,n){if(!t||t.length===0){throw new Error("Selection list cannot be empty.")}n=n||[t[0]];if(!this._is_valid_selection(n,t)){throw new Error("Invalid Default Value!")}var r=this._get_array(e,n);if(!this._is_valid_selection(r,t)){throw new Error("Invalid Option Value: The option '"+e+"' can contain only the following values:\n"+t+"\nYou passed in: '"+this.raw_options[e]+"'")}return r};Options.prototype._is_valid_selection=function(e,t){return e.length&&t.length&&!e.some((function(e){return t.indexOf(e)===-1}))};function _mergeOpts(e,t){var n={};e=_normalizeOpts(e);var r;for(r in e){if(r!==t){n[r]=e[r]}}if(t&&e[t]){for(r in e[t]){n[r]=e[t][r]}}return n}function _normalizeOpts(e){var t={};var n;for(n in e){var r=n.replace(/-/g,"_");t[r]=e[n]}return t}e.exports.JY=Options;t=_normalizeOpts;t=_mergeOpts},498:e=>{function OutputLine(e){this.__parent=e;this.__character_count=0;this.__indent_count=-1;this.__alignment_count=0;this.__wrap_point_index=0;this.__wrap_point_character_count=0;this.__wrap_point_indent_count=-1;this.__wrap_point_alignment_count=0;this.__items=[]}OutputLine.prototype.clone_empty=function(){var e=new OutputLine(this.__parent);e.set_indent(this.__indent_count,this.__alignment_count);return e};OutputLine.prototype.item=function(e){if(e<0){return this.__items[this.__items.length+e]}else{return this.__items[e]}};OutputLine.prototype.has_match=function(e){for(var t=this.__items.length-1;t>=0;t--){if(this.__items[t].match(e)){return true}}return false};OutputLine.prototype.set_indent=function(e,t){if(this.is_empty()){this.__indent_count=e||0;this.__alignment_count=t||0;this.__character_count=this.__parent.get_indent_size(this.__indent_count,this.__alignment_count)}};OutputLine.prototype._set_wrap_point=function(){if(this.__parent.wrap_line_length){this.__wrap_point_index=this.__items.length;this.__wrap_point_character_count=this.__character_count;this.__wrap_point_indent_count=this.__parent.next_line.__indent_count;this.__wrap_point_alignment_count=this.__parent.next_line.__alignment_count}};OutputLine.prototype._should_wrap=function(){return this.__wrap_point_index&&this.__character_count>this.__parent.wrap_line_length&&this.__wrap_point_character_count>this.__parent.next_line.__character_count};OutputLine.prototype._allow_wrap=function(){if(this._should_wrap()){this.__parent.add_new_line();var e=this.__parent.current_line;e.set_indent(this.__wrap_point_indent_count,this.__wrap_point_alignment_count);e.__items=this.__items.slice(this.__wrap_point_index);this.__items=this.__items.slice(0,this.__wrap_point_index);e.__character_count+=this.__character_count-this.__wrap_point_character_count;this.__character_count=this.__wrap_point_character_count;if(e.__items[0]===" "){e.__items.splice(0,1);e.__character_count-=1}return true}return false};OutputLine.prototype.is_empty=function(){return this.__items.length===0};OutputLine.prototype.last=function(){if(!this.is_empty()){return this.__items[this.__items.length-1]}else{return null}};OutputLine.prototype.push=function(e){this.__items.push(e);var t=e.lastIndexOf("\n");if(t!==-1){this.__character_count=e.length-t}else{this.__character_count+=e.length}};OutputLine.prototype.pop=function(){var e=null;if(!this.is_empty()){e=this.__items.pop();this.__character_count-=e.length}return e};OutputLine.prototype._remove_indent=function(){if(this.__indent_count>0){this.__indent_count-=1;this.__character_count-=this.__parent.indent_size}};OutputLine.prototype._remove_wrap_indent=function(){if(this.__wrap_point_indent_count>0){this.__wrap_point_indent_count-=1}};OutputLine.prototype.trim=function(){while(this.last()===" "){this.__items.pop();this.__character_count-=1}};OutputLine.prototype.toString=function(){var e="";if(this.is_empty()){if(this.__parent.indent_empty_lines){e=this.__parent.get_indent_string(this.__indent_count)}}else{e=this.__parent.get_indent_string(this.__indent_count,this.__alignment_count);e+=this.__items.join("")}return e};function IndentStringCache(e,t){this.__cache=[""];this.__indent_size=e.indent_size;this.__indent_string=e.indent_char;if(!e.indent_with_tabs){this.__indent_string=new Array(e.indent_size+1).join(e.indent_char)}t=t||"";if(e.indent_level>0){t=new Array(e.indent_level+1).join(this.__indent_string)}this.__base_string=t;this.__base_string_length=t.length}IndentStringCache.prototype.get_indent_size=function(e,t){var n=this.__base_string_length;t=t||0;if(e<0){n=0}n+=e*this.__indent_size;n+=t;return n};IndentStringCache.prototype.get_indent_string=function(e,t){var n=this.__base_string;t=t||0;if(e<0){e=0;n=""}t+=e*this.__indent_size;this.__ensure_cache(t);n+=this.__cache[t];return n};IndentStringCache.prototype.__ensure_cache=function(e){while(e>=this.__cache.length){this.__add_column()}};IndentStringCache.prototype.__add_column=function(){var e=this.__cache.length;var t=0;var n="";if(this.__indent_size&&e>=this.__indent_size){t=Math.floor(e/this.__indent_size);e-=t*this.__indent_size;n=new Array(t+1).join(this.__indent_string)}if(e){n+=new Array(e+1).join(" ")}this.__cache.push(n)};function Output(e,t){this.__indent_cache=new IndentStringCache(e,t);this.raw=false;this._end_with_newline=e.end_with_newline;this.indent_size=e.indent_size;this.wrap_line_length=e.wrap_line_length;this.indent_empty_lines=e.indent_empty_lines;this.__lines=[];this.previous_line=null;this.current_line=null;this.next_line=new OutputLine(this);this.space_before_token=false;this.non_breaking_space=false;this.previous_token_wrapped=false;this.__add_outputline()}Output.prototype.__add_outputline=function(){this.previous_line=this.current_line;this.current_line=this.next_line.clone_empty();this.__lines.push(this.current_line)};Output.prototype.get_line_number=function(){return this.__lines.length};Output.prototype.get_indent_string=function(e,t){return this.__indent_cache.get_indent_string(e,t)};Output.prototype.get_indent_size=function(e,t){return this.__indent_cache.get_indent_size(e,t)};Output.prototype.is_empty=function(){return!this.previous_line&&this.current_line.is_empty()};Output.prototype.add_new_line=function(e){if(this.is_empty()||!e&&this.just_added_newline()){return false}if(!this.raw){this.__add_outputline()}return true};Output.prototype.get_code=function(e){this.trim(true);var t=this.current_line.pop();if(t){if(t[t.length-1]==="\n"){t=t.replace(/\n+$/g,"")}this.current_line.push(t)}if(this._end_with_newline){this.__add_outputline()}var n=this.__lines.join("\n");if(e!=="\n"){n=n.replace(/[\n]/g,e)}return n};Output.prototype.set_wrap_point=function(){this.current_line._set_wrap_point()};Output.prototype.set_indent=function(e,t){e=e||0;t=t||0;this.next_line.set_indent(e,t);if(this.__lines.length>1){this.current_line.set_indent(e,t);return true}this.current_line.set_indent();return false};Output.prototype.add_raw_token=function(e){for(var t=0;t<e.newlines;t++){this.__add_outputline()}this.current_line.set_indent(-1);this.current_line.push(e.whitespace_before);this.current_line.push(e.text);this.space_before_token=false;this.non_breaking_space=false;this.previous_token_wrapped=false};Output.prototype.add_token=function(e){this.__add_space_before_token();this.current_line.push(e);this.space_before_token=false;this.non_breaking_space=false;this.previous_token_wrapped=this.current_line._allow_wrap()};Output.prototype.__add_space_before_token=function(){if(this.space_before_token&&!this.just_added_newline()){if(!this.non_breaking_space){this.set_wrap_point()}this.current_line.push(" ")}};Output.prototype.remove_indent=function(e){var t=this.__lines.length;while(e<t){this.__lines[e]._remove_indent();e++}this.current_line._remove_wrap_indent()};Output.prototype.trim=function(e){e=e===undefined?false:e;this.current_line.trim();while(e&&this.__lines.length>1&&this.current_line.is_empty()){this.__lines.pop();this.current_line=this.__lines[this.__lines.length-1];this.current_line.trim()}this.previous_line=this.__lines.length>1?this.__lines[this.__lines.length-2]:null};Output.prototype.just_added_newline=function(){return this.current_line.is_empty()};Output.prototype.just_added_blankline=function(){return this.is_empty()||this.current_line.is_empty()&&this.previous_line.is_empty()};Output.prototype.ensure_empty_line_above=function(e,t){var n=this.__lines.length-2;while(n>=0){var r=this.__lines[n];if(r.is_empty()){break}else if(r.item(0).indexOf(e)!==0&&r.item(-1)!==t){this.__lines.splice(n+1,0,new OutputLine(this));this.previous_line=this.__lines[this.__lines.length-2];break}n--}};e.exports.k=Output},569:e=>{function Pattern(e,t){this._input=e;this._starting_pattern=null;this._match_pattern=null;this._until_pattern=null;this._until_after=false;if(t){this._starting_pattern=this._input.get_regexp(t._starting_pattern,true);this._match_pattern=this._input.get_regexp(t._match_pattern,true);this._until_pattern=this._input.get_regexp(t._until_pattern);this._until_after=t._until_after}}Pattern.prototype.read=function(){var e=this._input.read(this._starting_pattern);if(!this._starting_pattern||e){e+=this._input.read(this._match_pattern,this._until_pattern,this._until_after)}return e};Pattern.prototype.read_match=function(){return this._input.match(this._match_pattern)};Pattern.prototype.until_after=function(e){var t=this._create();t._until_after=true;t._until_pattern=this._input.get_regexp(e);t._update();return t};Pattern.prototype.until=function(e){var t=this._create();t._until_after=false;t._until_pattern=this._input.get_regexp(e);t._update();return t};Pattern.prototype.starting_with=function(e){var t=this._create();t._starting_pattern=this._input.get_regexp(e,true);t._update();return t};Pattern.prototype.matching=function(e){var t=this._create();t._match_pattern=this._input.get_regexp(e,true);t._update();return t};Pattern.prototype._create=function(){return new Pattern(this._input,this)};Pattern.prototype._update=function(){};e.exports.z=Pattern},392:(e,t,n)=>{var r=n(569).z;var o={django:false,erb:false,handlebars:false,php:false,smarty:false,angular:false};function TemplatablePattern(e,t){r.call(this,e,t);this.__template_pattern=null;this._disabled=Object.assign({},o);this._excluded=Object.assign({},o);if(t){this.__template_pattern=this._input.get_regexp(t.__template_pattern);this._excluded=Object.assign(this._excluded,t._excluded);this._disabled=Object.assign(this._disabled,t._disabled)}var n=new r(e);this.__patterns={handlebars_comment:n.starting_with(/{{!--/).until_after(/--}}/),handlebars_unescaped:n.starting_with(/{{{/).until_after(/}}}/),handlebars:n.starting_with(/{{/).until_after(/}}/),php:n.starting_with(/<\?(?:[= ]|php)/).until_after(/\?>/),erb:n.starting_with(/<%[^%]/).until_after(/[^%]%>/),django:n.starting_with(/{%/).until_after(/%}/),django_value:n.starting_with(/{{/).until_after(/}}/),django_comment:n.starting_with(/{#/).until_after(/#}/),smarty:n.starting_with(/{(?=[^}{\s\n])/).until_after(/[^\s\n]}/),smarty_comment:n.starting_with(/{\*/).until_after(/\*}/),smarty_literal:n.starting_with(/{literal}/).until_after(/{\/literal}/)}}TemplatablePattern.prototype=new r;TemplatablePattern.prototype._create=function(){return new TemplatablePattern(this._input,this)};TemplatablePattern.prototype._update=function(){this.__set_templated_pattern()};TemplatablePattern.prototype.disable=function(e){var t=this._create();t._disabled[e]=true;t._update();return t};TemplatablePattern.prototype.read_options=function(e){var t=this._create();for(var n in o){t._disabled[n]=e.templating.indexOf(n)===-1}t._update();return t};TemplatablePattern.prototype.exclude=function(e){var t=this._create();t._excluded[e]=true;t._update();return t};TemplatablePattern.prototype.read=function(){var e="";if(this._match_pattern){e=this._input.read(this._starting_pattern)}else{e=this._input.read(this._starting_pattern,this.__template_pattern)}var t=this._read_template();while(t){if(this._match_pattern){t+=this._input.read(this._match_pattern)}else{t+=this._input.readUntil(this.__template_pattern)}e+=t;t=this._read_template()}if(this._until_after){e+=this._input.readUntilAfter(this._until_pattern)}return e};TemplatablePattern.prototype.__set_templated_pattern=function(){var e=[];if(!this._disabled.php){e.push(this.__patterns.php._starting_pattern.source)}if(!this._disabled.handlebars){e.push(this.__patterns.handlebars._starting_pattern.source)}if(!this._disabled.angular){e.push(this.__patterns.handlebars._starting_pattern.source)}if(!this._disabled.erb){e.push(this.__patterns.erb._starting_pattern.source)}if(!this._disabled.django){e.push(this.__patterns.django._starting_pattern.source);e.push(this.__patterns.django_value._starting_pattern.source);e.push(this.__patterns.django_comment._starting_pattern.source)}if(!this._disabled.smarty){e.push(this.__patterns.smarty._starting_pattern.source)}if(this._until_pattern){e.push(this._until_pattern.source)}this.__template_pattern=this._input.get_regexp("(?:"+e.join("|")+")")};TemplatablePattern.prototype._read_template=function(){var e="";var t=this._input.peek();if(t==="<"){var n=this._input.peek(1);if(!this._disabled.php&&!this._excluded.php&&n==="?"){e=e||this.__patterns.php.read()}if(!this._disabled.erb&&!this._excluded.erb&&n==="%"){e=e||this.__patterns.erb.read()}}else if(t==="{"){if(!this._disabled.handlebars&&!this._excluded.handlebars){e=e||this.__patterns.handlebars_comment.read();e=e||this.__patterns.handlebars_unescaped.read();e=e||this.__patterns.handlebars.read()}if(!this._disabled.django){if(!this._excluded.django&&!this._excluded.handlebars){e=e||this.__patterns.django_value.read()}if(!this._excluded.django){e=e||this.__patterns.django_comment.read();e=e||this.__patterns.django.read()}}if(!this._disabled.smarty){if(this._disabled.django&&this._disabled.handlebars){e=e||this.__patterns.smarty_comment.read();e=e||this.__patterns.smarty_literal.read();e=e||this.__patterns.smarty.read()}}}return e};e.exports.i=TemplatablePattern},658:e=>{function Token(e,t,n,r){this.type=e;this.text=t;this.comments_before=null;this.newlines=n||0;this.whitespace_before=r||"";this.parent=null;this.next=null;this.previous=null;this.opened=null;this.closed=null;this.directives=null}e.exports.o=Token},170:(e,t,n)=>{var r=n(713).z;var o=n(658).o;var l=n(914).e;var h=n(974).g;var f={START:"TK_START",RAW:"TK_RAW",EOF:"TK_EOF"};var Tokenizer=function(e,t){this._input=new r(e);this._options=t||{};this.__tokens=null;this._patterns={};this._patterns.whitespace=new h(this._input)};Tokenizer.prototype.tokenize=function(){this._input.restart();this.__tokens=new l;this._reset();var e;var t=new o(f.START,"");var n=null;var r=[];var h=new l;while(t.type!==f.EOF){e=this._get_next_token(t,n);while(this._is_comment(e)){h.add(e);e=this._get_next_token(t,n)}if(!h.isEmpty()){e.comments_before=h;h=new l}e.parent=n;if(this._is_opening(e)){r.push(n);n=e}else if(n&&this._is_closing(e,n)){e.opened=n;n.closed=e;n=r.pop();e.parent=n}e.previous=t;t.next=e;this.__tokens.add(e);t=e}return this.__tokens};Tokenizer.prototype._is_first_token=function(){return this.__tokens.isEmpty()};Tokenizer.prototype._reset=function(){};Tokenizer.prototype._get_next_token=function(e,t){this._readWhitespace();var n=this._input.read(/.+/g);if(n){return this._create_token(f.RAW,n)}else{return this._create_token(f.EOF,"")}};Tokenizer.prototype._is_comment=function(e){return false};Tokenizer.prototype._is_opening=function(e){return false};Tokenizer.prototype._is_closing=function(e,t){return false};Tokenizer.prototype._create_token=function(e,t){var n=new o(e,t,this._patterns.whitespace.newline_count,this._patterns.whitespace.whitespace_before_token);return n};Tokenizer.prototype._readWhitespace=function(){return this._patterns.whitespace.read()};e.exports._=Tokenizer;e.exports.C=f},914:e=>{function TokenStream(e){this.__tokens=[];this.__tokens_length=this.__tokens.length;this.__position=0;this.__parent_token=e}TokenStream.prototype.restart=function(){this.__position=0};TokenStream.prototype.isEmpty=function(){return this.__tokens_length===0};TokenStream.prototype.hasNext=function(){return this.__position<this.__tokens_length};TokenStream.prototype.next=function(){var e=null;if(this.hasNext()){e=this.__tokens[this.__position];this.__position+=1}return e};TokenStream.prototype.peek=function(e){var t=null;e=e||0;e+=this.__position;if(e>=0&&e<this.__tokens_length){t=this.__tokens[e]}return t};TokenStream.prototype.add=function(e){if(this.__parent_token){e.parent=this.__parent_token}this.__tokens.push(e);this.__tokens_length+=1};e.exports.e=TokenStream},974:(e,t,n)=>{var r=n(569).z;function WhitespacePattern(e,t){r.call(this,e,t);if(t){this._line_regexp=this._input.get_regexp(t._line_regexp)}else{this.__set_whitespace_patterns("","")}this.newline_count=0;this.whitespace_before_token=""}WhitespacePattern.prototype=new r;WhitespacePattern.prototype.__set_whitespace_patterns=function(e,t){e+="\\t ";t+="\\n\\r";this._match_pattern=this._input.get_regexp("["+e+t+"]+",true);this._newline_regexp=this._input.get_regexp("\\r\\n|["+t+"]")};WhitespacePattern.prototype.read=function(){this.newline_count=0;this.whitespace_before_token="";var e=this._input.read(this._match_pattern);if(e===" "){this.whitespace_before_token=" "}else if(e){var t=this.__split(this._newline_regexp,e);this.newline_count=t.length-1;this.whitespace_before_token=t[this.newline_count]}return e};WhitespacePattern.prototype.matching=function(e,t){var n=this._create();n.__set_whitespace_patterns(e,t);n._update();return n};WhitespacePattern.prototype._create=function(){return new WhitespacePattern(this._input,this)};WhitespacePattern.prototype.__split=function(e,t){e.lastIndex=0;var n=0;var r=[];var o=e.exec(t);while(o){r.push(t.substring(n,o.index));n=o.index+o[0].length;o=e.exec(t)}if(n<t.length){r.push(t.substring(n,t.length))}else{r.push("")}return r};e.exports.g=WhitespacePattern},481:(e,t,n)=>{var r=n(221).J;var o=n(498).k;var l=n(713).z;var h=n(657).D;var f=new h(/\/\*/,/\*\//);var p=/\r\n|[\r\n]/;var d=/\r\n|[\r\n]/g;var _=/\s/;var m=/(?:\s|\n)+/g;var g=/\/\*(?:[\s\S]*?)((?:\*\/)|$)/g;var y=/\/\/(?:[^\n\r\u2028\u2029]*)/g;function Beautifier(e,t){this._source_text=e||"";this._options=new r(t);this._ch=null;this._input=null;this.NESTED_AT_RULE={page:true,"font-face":true,keyframes:true,media:true,supports:true,document:true};this.CONDITIONAL_GROUP_RULE={media:true,supports:true,document:true};this.NON_SEMICOLON_NEWLINE_PROPERTY=["grid-template-areas","grid-template"]}Beautifier.prototype.eatString=function(e){var t="";this._ch=this._input.next();while(this._ch){t+=this._ch;if(this._ch==="\\"){t+=this._input.next()}else if(e.indexOf(this._ch)!==-1||this._ch==="\n"){break}this._ch=this._input.next()}return t};Beautifier.prototype.eatWhitespace=function(e){var t=_.test(this._input.peek());var n=0;while(_.test(this._input.peek())){this._ch=this._input.next();if(e&&this._ch==="\n"){if(n===0||n<this._options.max_preserve_newlines){n++;this._output.add_new_line(true)}}}return t};Beautifier.prototype.foundNestedPseudoClass=function(){var e=0;var t=1;var n=this._input.peek(t);while(n){if(n==="{"){return true}else if(n==="("){e+=1}else if(n===")"){if(e===0){return false}e-=1}else if(n===";"||n==="}"){return false}t++;n=this._input.peek(t)}return false};Beautifier.prototype.print_string=function(e){this._output.set_indent(this._indentLevel);this._output.non_breaking_space=true;this._output.add_token(e)};Beautifier.prototype.preserveSingleSpace=function(e){if(e){this._output.space_before_token=true}};Beautifier.prototype.indent=function(){this._indentLevel++};Beautifier.prototype.outdent=function(){if(this._indentLevel>0){this._indentLevel--}};Beautifier.prototype.beautify=function(){if(this._options.disabled){return this._source_text}var e=this._source_text;var t=this._options.eol;if(t==="auto"){t="\n";if(e&&p.test(e||"")){t=e.match(p)[0]}}e=e.replace(d,"\n");var n=e.match(/^[\t ]*/)[0];this._output=new o(this._options,n);this._input=new l(e);this._indentLevel=0;this._nestedLevel=0;this._ch=null;var r=0;var h=false;var b=false;var v=false;var E=false;var k=false;var O=this._ch;var x=false;var A;var w;var S;while(true){A=this._input.read(m);w=A!=="";S=O;this._ch=this._input.next();if(this._ch==="\\"&&this._input.hasNext()){this._ch+=this._input.next()}O=this._ch;if(!this._ch){break}else if(this._ch==="/"&&this._input.peek()==="*"){this._output.add_new_line();this._input.back();var R=this._input.read(g);var N=f.get_directives(R);if(N&&N.ignore==="start"){R+=f.readIgnored(this._input)}this.print_string(R);this.eatWhitespace(true);this._output.add_new_line()}else if(this._ch==="/"&&this._input.peek()==="/"){this._output.space_before_token=true;this._input.back();this.print_string(this._input.read(y));this.eatWhitespace(true)}else if(this._ch==="$"){this.preserveSingleSpace(w);this.print_string(this._ch);var C=this._input.peekUntilAfter(/[: ,;{}()[\]\/='"]/g);if(C.match(/[ :]$/)){C=this.eatString(": ").replace(/\s+$/,"");this.print_string(C);this._output.space_before_token=true}if(r===0&&C.indexOf(":")!==-1){b=true;this.indent()}}else if(this._ch==="@"){this.preserveSingleSpace(w);if(this._input.peek()==="{"){this.print_string(this._ch+this.eatString("}"))}else{this.print_string(this._ch);var I=this._input.peekUntilAfter(/[: ,;{}()[\]\/='"]/g);if(I.match(/[ :]$/)){I=this.eatString(": ").replace(/\s+$/,"");this.print_string(I);this._output.space_before_token=true}if(r===0&&I.indexOf(":")!==-1){b=true;this.indent()}else if(I in this.NESTED_AT_RULE){this._nestedLevel+=1;if(I in this.CONDITIONAL_GROUP_RULE){v=true}}else if(r===0&&!b){E=true}}}else if(this._ch==="#"&&this._input.peek()==="{"){this.preserveSingleSpace(w);this.print_string(this._ch+this.eatString("}"))}else if(this._ch==="{"){if(b){b=false;this.outdent()}E=false;if(v){v=false;h=this._indentLevel>=this._nestedLevel}else{h=this._indentLevel>=this._nestedLevel-1}if(this._options.newline_between_rules&&h){if(this._output.previous_line&&this._output.previous_line.item(-1)!=="{"){this._output.ensure_empty_line_above("/",",")}}this._output.space_before_token=true;if(this._options.brace_style==="expand"){this._output.add_new_line();this.print_string(this._ch);this.indent();this._output.set_indent(this._indentLevel)}else{if(S==="("){this._output.space_before_token=false}else if(S!==","){this.indent()}this.print_string(this._ch)}this.eatWhitespace(true);this._output.add_new_line()}else if(this._ch==="}"){this.outdent();this._output.add_new_line();if(S==="{"){this._output.trim(true)}if(b){this.outdent();b=false}this.print_string(this._ch);h=false;if(this._nestedLevel){this._nestedLevel--}this.eatWhitespace(true);this._output.add_new_line();if(this._options.newline_between_rules&&!this._output.just_added_blankline()){if(this._input.peek()!=="}"){this._output.add_new_line(true)}}if(this._input.peek()===")"){this._output.trim(true);if(this._options.brace_style==="expand"){this._output.add_new_line(true)}}}else if(this._ch===":"){for(var L=0;L<this.NON_SEMICOLON_NEWLINE_PROPERTY.length;L++){if(this._input.lookBack(this.NON_SEMICOLON_NEWLINE_PROPERTY[L])){x=true;break}}if((h||v)&&!(this._input.lookBack("&")||this.foundNestedPseudoClass())&&!this._input.lookBack("(")&&!E&&r===0){this.print_string(":");if(!b){b=true;this._output.space_before_token=true;this.eatWhitespace(true);this.indent()}}else{if(this._input.lookBack(" ")){this._output.space_before_token=true}if(this._input.peek()===":"){this._ch=this._input.next();this.print_string("::")}else{this.print_string(":")}}}else if(this._ch==='"'||this._ch==="'"){var P=S==='"'||S==="'";this.preserveSingleSpace(P||w);this.print_string(this._ch+this.eatString(this._ch));this.eatWhitespace(true)}else if(this._ch===";"){x=false;if(r===0){if(b){this.outdent();b=false}E=false;this.print_string(this._ch);this.eatWhitespace(true);if(this._input.peek()!=="/"){this._output.add_new_line()}}else{this.print_string(this._ch);this.eatWhitespace(true);this._output.space_before_token=true}}else if(this._ch==="("){if(this._input.lookBack("url")){this.print_string(this._ch);this.eatWhitespace();r++;this.indent();this._ch=this._input.next();if(this._ch===")"||this._ch==='"'||this._ch==="'"){this._input.back()}else if(this._ch){this.print_string(this._ch+this.eatString(")"));if(r){r--;this.outdent()}}}else{var M=false;if(this._input.lookBack("with")){M=true}this.preserveSingleSpace(w||M);this.print_string(this._ch);if(b&&S==="$"&&this._options.selector_separator_newline){this._output.add_new_line();k=true}else{this.eatWhitespace();r++;this.indent()}}}else if(this._ch===")"){if(r){r--;this.outdent()}if(k&&this._input.peek()===";"&&this._options.selector_separator_newline){k=false;this.outdent();this._output.add_new_line()}this.print_string(this._ch)}else if(this._ch===","){this.print_string(this._ch);this.eatWhitespace(true);if(this._options.selector_separator_newline&&(!b||k)&&r===0&&!E){this._output.add_new_line()}else{this._output.space_before_token=true}}else if((this._ch===">"||this._ch==="+"||this._ch==="~")&&!b&&r===0){if(this._options.space_around_combinator){this._output.space_before_token=true;this.print_string(this._ch);this._output.space_before_token=true}else{this.print_string(this._ch);this.eatWhitespace();if(this._ch&&_.test(this._ch)){this._ch=""}}}else if(this._ch==="]"){this.print_string(this._ch)}else if(this._ch==="["){this.preserveSingleSpace(w);this.print_string(this._ch)}else if(this._ch==="="){this.eatWhitespace();this.print_string("=");if(_.test(this._ch)){this._ch=""}}else if(this._ch==="!"&&!this._input.lookBack("\\")){this._output.space_before_token=true;this.print_string(this._ch)}else{var F=S==='"'||S==="'";this.preserveSingleSpace(F||w);this.print_string(this._ch);if(!this._output.just_added_newline()&&this._input.peek()==="\n"&&x){this._output.add_new_line()}}}var D=this._output.get_code(t);return D};e.exports.P=Beautifier},295:(e,t,n)=>{var r=n(481).P,o=n(221).J;function css_beautify(e,t){var n=new r(e,t);return n.beautify()}e.exports=css_beautify;e.exports.defaultOptions=function(){return new o}},221:(e,t,n)=>{var r=n(301).JY;function Options(e){r.call(this,e,"css");this.selector_separator_newline=this._get_boolean("selector_separator_newline",true);this.newline_between_rules=this._get_boolean("newline_between_rules",true);var t=this._get_boolean("space_around_selector_separator");this.space_around_combinator=this._get_boolean("space_around_combinator")||t;var n=this._get_selection_list("brace_style",["collapse","expand","end-expand","none","preserve-inline"]);this.brace_style="collapse";for(var o=0;o<n.length;o++){if(n[o]!=="expand"){this.brace_style="collapse"}else{this.brace_style=n[o]}}}Options.prototype=new r;e.exports.J=Options},327:(e,t,n)=>{var r=n(83).J;var o=n(498).k;var l=n(772)._;var h=n(772).C;var f=/\r\n|[\r\n]/;var p=/\r\n|[\r\n]/g;var Printer=function(e,t){this.indent_level=0;this.alignment_size=0;this.max_preserve_newlines=e.max_preserve_newlines;this.preserve_newlines=e.preserve_newlines;this._output=new o(e,t)};Printer.prototype.current_line_has_match=function(e){return this._output.current_line.has_match(e)};Printer.prototype.set_space_before_token=function(e,t){this._output.space_before_token=e;this._output.non_breaking_space=t};Printer.prototype.set_wrap_point=function(){this._output.set_indent(this.indent_level,this.alignment_size);this._output.set_wrap_point()};Printer.prototype.add_raw_token=function(e){this._output.add_raw_token(e)};Printer.prototype.print_preserved_newlines=function(e){var t=0;if(e.type!==h.TEXT&&e.previous.type!==h.TEXT){t=e.newlines?1:0}if(this.preserve_newlines){t=e.newlines<this.max_preserve_newlines+1?e.newlines:this.max_preserve_newlines+1}for(var n=0;n<t;n++){this.print_newline(n>0)}return t!==0};Printer.prototype.traverse_whitespace=function(e){if(e.whitespace_before||e.newlines){if(!this.print_preserved_newlines(e)){this._output.space_before_token=true}return true}return false};Printer.prototype.previous_token_wrapped=function(){return this._output.previous_token_wrapped};Printer.prototype.print_newline=function(e){this._output.add_new_line(e)};Printer.prototype.print_token=function(e){if(e.text){this._output.set_indent(this.indent_level,this.alignment_size);this._output.add_token(e.text)}};Printer.prototype.indent=function(){this.indent_level++};Printer.prototype.deindent=function(){if(this.indent_level>0){this.indent_level--;this._output.set_indent(this.indent_level,this.alignment_size)}};Printer.prototype.get_full_indent=function(e){e=this.indent_level+(e||0);if(e<1){return""}return this._output.get_indent_string(e)};var get_type_attribute=function(e){var t=null;var n=e.next;while(n.type!==h.EOF&&e.closed!==n){if(n.type===h.ATTRIBUTE&&n.text==="type"){if(n.next&&n.next.type===h.EQUALS&&n.next.next&&n.next.next.type===h.VALUE){t=n.next.next.text}break}n=n.next}return t};var get_custom_beautifier_name=function(e,t){var n=null;var r=null;if(!t.closed){return null}if(e==="script"){n="text/javascript"}else if(e==="style"){n="text/css"}n=get_type_attribute(t)||n;if(n.search("text/css")>-1){r="css"}else if(n.search(/module|((text|application|dojo)\/(x-)?(javascript|ecmascript|jscript|livescript|(ld\+)?json|method|aspect))/)>-1){r="javascript"}else if(n.search(/(text|application|dojo)\/(x-)?(html)/)>-1){r="html"}else if(n.search(/test\/null/)>-1){r="null"}return r};function in_array(e,t){return t.indexOf(e)!==-1}function TagFrame(e,t,n){this.parent=e||null;this.tag=t?t.tag_name:"";this.indent_level=n||0;this.parser_token=t||null}function TagStack(e){this._printer=e;this._current_frame=null}TagStack.prototype.get_parser_token=function(){return this._current_frame?this._current_frame.parser_token:null};TagStack.prototype.record_tag=function(e){var t=new TagFrame(this._current_frame,e,this._printer.indent_level);this._current_frame=t};TagStack.prototype._try_pop_frame=function(e){var t=null;if(e){t=e.parser_token;this._printer.indent_level=e.indent_level;this._current_frame=e.parent}return t};TagStack.prototype._get_frame=function(e,t){var n=this._current_frame;while(n){if(e.indexOf(n.tag)!==-1){break}else if(t&&t.indexOf(n.tag)!==-1){n=null;break}n=n.parent}return n};TagStack.prototype.try_pop=function(e,t){var n=this._get_frame([e],t);return this._try_pop_frame(n)};TagStack.prototype.indent_to_tag=function(e){var t=this._get_frame(e);if(t){this._printer.indent_level=t.indent_level}};function Beautifier(e,t,n,o){this._source_text=e||"";t=t||{};this._js_beautify=n;this._css_beautify=o;this._tag_stack=null;var l=new r(t,"html");this._options=l;this._is_wrap_attributes_force=this._options.wrap_attributes.substr(0,"force".length)==="force";this._is_wrap_attributes_force_expand_multiline=this._options.wrap_attributes==="force-expand-multiline";this._is_wrap_attributes_force_aligned=this._options.wrap_attributes==="force-aligned";this._is_wrap_attributes_aligned_multiple=this._options.wrap_attributes==="aligned-multiple";this._is_wrap_attributes_preserve=this._options.wrap_attributes.substr(0,"preserve".length)==="preserve";this._is_wrap_attributes_preserve_aligned=this._options.wrap_attributes==="preserve-aligned"}Beautifier.prototype.beautify=function(){if(this._options.disabled){return this._source_text}var e=this._source_text;var t=this._options.eol;if(this._options.eol==="auto"){t="\n";if(e&&f.test(e)){t=e.match(f)[0]}}e=e.replace(p,"\n");var n=e.match(/^[\t ]*/)[0];var r={text:"",type:""};var o=new TagOpenParserToken(this._options);var d=new Printer(this._options,n);var _=new l(e,this._options).tokenize();this._tag_stack=new TagStack(d);var m=null;var g=_.next();while(g.type!==h.EOF){if(g.type===h.TAG_OPEN||g.type===h.COMMENT){m=this._handle_tag_open(d,g,o,r,_);o=m}else if(g.type===h.ATTRIBUTE||g.type===h.EQUALS||g.type===h.VALUE||g.type===h.TEXT&&!o.tag_complete){m=this._handle_inside_tag(d,g,o,r)}else if(g.type===h.TAG_CLOSE){m=this._handle_tag_close(d,g,o)}else if(g.type===h.TEXT){m=this._handle_text(d,g,o)}else if(g.type===h.CONTROL_FLOW_OPEN){m=this._handle_control_flow_open(d,g)}else if(g.type===h.CONTROL_FLOW_CLOSE){m=this._handle_control_flow_close(d,g)}else{d.add_raw_token(g)}r=m;g=_.next()}var y=d._output.get_code(t);return y};Beautifier.prototype._handle_control_flow_open=function(e,t){var n={text:t.text,type:t.type};e.set_space_before_token(t.newlines||t.whitespace_before!=="",true);if(t.newlines){e.print_preserved_newlines(t)}else{e.set_space_before_token(t.newlines||t.whitespace_before!=="",true)}e.print_token(t);e.indent();return n};Beautifier.prototype._handle_control_flow_close=function(e,t){var n={text:t.text,type:t.type};e.deindent();if(t.newlines){e.print_preserved_newlines(t)}else{e.set_space_before_token(t.newlines||t.whitespace_before!=="",true)}e.print_token(t);return n};Beautifier.prototype._handle_tag_close=function(e,t,n){var r={text:t.text,type:t.type};e.alignment_size=0;n.tag_complete=true;e.set_space_before_token(t.newlines||t.whitespace_before!=="",true);if(n.is_unformatted){e.add_raw_token(t)}else{if(n.tag_start_char==="<"){e.set_space_before_token(t.text[0]==="/",true);if(this._is_wrap_attributes_force_expand_multiline&&n.has_wrapped_attrs){e.print_newline(false)}}e.print_token(t)}if(n.indent_content&&!(n.is_unformatted||n.is_content_unformatted)){e.indent();n.indent_content=false}if(!n.is_inline_element&&!(n.is_unformatted||n.is_content_unformatted)){e.set_wrap_point()}return r};Beautifier.prototype._handle_inside_tag=function(e,t,n,r){var o=n.has_wrapped_attrs;var l={text:t.text,type:t.type};e.set_space_before_token(t.newlines||t.whitespace_before!=="",true);if(n.is_unformatted){e.add_raw_token(t)}else if(n.tag_start_char==="{"&&t.type===h.TEXT){if(e.print_preserved_newlines(t)){t.newlines=0;e.add_raw_token(t)}else{e.print_token(t)}}else{if(t.type===h.ATTRIBUTE){e.set_space_before_token(true)}else if(t.type===h.EQUALS){e.set_space_before_token(false)}else if(t.type===h.VALUE&&t.previous.type===h.EQUALS){e.set_space_before_token(false)}if(t.type===h.ATTRIBUTE&&n.tag_start_char==="<"){if(this._is_wrap_attributes_preserve||this._is_wrap_attributes_preserve_aligned){e.traverse_whitespace(t);o=o||t.newlines!==0}if(this._is_wrap_attributes_force&&n.attr_count>=this._options.wrap_attributes_min_attrs&&(r.type!==h.TAG_OPEN||this._is_wrap_attributes_force_expand_multiline)){e.print_newline(false);o=true}}e.print_token(t);o=o||e.previous_token_wrapped();n.has_wrapped_attrs=o}return l};Beautifier.prototype._handle_text=function(e,t,n){var r={text:t.text,type:"TK_CONTENT"};if(n.custom_beautifier_name){this._print_custom_beatifier_text(e,t,n)}else if(n.is_unformatted||n.is_content_unformatted){e.add_raw_token(t)}else{e.traverse_whitespace(t);e.print_token(t)}return r};Beautifier.prototype._print_custom_beatifier_text=function(e,t,n){var r=this;if(t.text!==""){var o=t.text,l,h=1,f="",p="";if(n.custom_beautifier_name==="javascript"&&typeof this._js_beautify==="function"){l=this._js_beautify}else if(n.custom_beautifier_name==="css"&&typeof this._css_beautify==="function"){l=this._css_beautify}else if(n.custom_beautifier_name==="html"){l=function(e,t){var n=new Beautifier(e,t,r._js_beautify,r._css_beautify);return n.beautify()}}if(this._options.indent_scripts==="keep"){h=0}else if(this._options.indent_scripts==="separate"){h=-e.indent_level}var d=e.get_full_indent(h);o=o.replace(/\n[ \t]*$/,"");if(n.custom_beautifier_name!=="html"&&o[0]==="<"&&o.match(/^(<!--|<!\[CDATA\[)/)){var _=/^(<!--[^\n]*|<!\[CDATA\[)(\n?)([ \t\n]*)([\s\S]*)(-->|]]>)$/.exec(o);if(!_){e.add_raw_token(t);return}f=d+_[1]+"\n";o=_[4];if(_[5]){p=d+_[5]}o=o.replace(/\n[ \t]*$/,"");if(_[2]||_[3].indexOf("\n")!==-1){_=_[3].match(/[ \t]+$/);if(_){t.whitespace_before=_[0]}}}if(o){if(l){var Child_options=function(){this.eol="\n"};Child_options.prototype=this._options.raw_options;var m=new Child_options;o=l(d+o,m)}else{var g=t.whitespace_before;if(g){o=o.replace(new RegExp("\n("+g+")?","g"),"\n")}o=d+o.replace(/\n/g,"\n"+d)}}if(f){if(!o){o=f+p}else{o=f+o+"\n"+p}}e.print_newline(false);if(o){t.text=o;t.whitespace_before="";t.newlines=0;e.add_raw_token(t);e.print_newline(true)}}};Beautifier.prototype._handle_tag_open=function(e,t,n,r,o){var l=this._get_tag_open_token(t);if((n.is_unformatted||n.is_content_unformatted)&&!n.is_empty_element&&t.type===h.TAG_OPEN&&!l.is_start_tag){e.add_raw_token(t);l.start_tag_token=this._tag_stack.try_pop(l.tag_name)}else{e.traverse_whitespace(t);this._set_tag_position(e,t,l,n,r);if(!l.is_inline_element){e.set_wrap_point()}e.print_token(t)}if(l.is_start_tag&&this._is_wrap_attributes_force){var f=0;var p;do{p=o.peek(f);if(p.type===h.ATTRIBUTE){l.attr_count+=1}f+=1}while(p.type!==h.EOF&&p.type!==h.TAG_CLOSE)}if(this._is_wrap_attributes_force_aligned||this._is_wrap_attributes_aligned_multiple||this._is_wrap_attributes_preserve_aligned){l.alignment_size=t.text.length+1}if(!l.tag_complete&&!l.is_unformatted){e.alignment_size=l.alignment_size}return l};var TagOpenParserToken=function(e,t,n){this.parent=t||null;this.text="";this.type="TK_TAG_OPEN";this.tag_name="";this.is_inline_element=false;this.is_unformatted=false;this.is_content_unformatted=false;this.is_empty_element=false;this.is_start_tag=false;this.is_end_tag=false;this.indent_content=false;this.multiline_content=false;this.custom_beautifier_name=null;this.start_tag_token=null;this.attr_count=0;this.has_wrapped_attrs=false;this.alignment_size=0;this.tag_complete=false;this.tag_start_char="";this.tag_check="";if(!n){this.tag_complete=true}else{var r;this.tag_start_char=n.text[0];this.text=n.text;if(this.tag_start_char==="<"){r=n.text.match(/^<([^\s>]*)/);this.tag_check=r?r[1]:""}else{r=n.text.match(/^{{~?(?:[\^]|#\*?)?([^\s}]+)/);this.tag_check=r?r[1]:"";if((n.text.startsWith("{{#>")||n.text.startsWith("{{~#>"))&&this.tag_check[0]===">"){if(this.tag_check===">"&&n.next!==null){this.tag_check=n.next.text.split(" ")[0]}else{this.tag_check=n.text.split(">")[1]}}}this.tag_check=this.tag_check.toLowerCase();if(n.type===h.COMMENT){this.tag_complete=true}this.is_start_tag=this.tag_check.charAt(0)!=="/";this.tag_name=!this.is_start_tag?this.tag_check.substr(1):this.tag_check;this.is_end_tag=!this.is_start_tag||n.closed&&n.closed.text==="/>";var o=2;if(this.tag_start_char==="{"&&this.text.length>=3){if(this.text.charAt(2)==="~"){o=3}}this.is_end_tag=this.is_end_tag||this.tag_start_char==="{"&&(!e.indent_handlebars||this.text.length<3||/[^#\^]/.test(this.text.charAt(o)))}};Beautifier.prototype._get_tag_open_token=function(e){var t=new TagOpenParserToken(this._options,this._tag_stack.get_parser_token(),e);t.alignment_size=this._options.wrap_attributes_indent_size;t.is_end_tag=t.is_end_tag||in_array(t.tag_check,this._options.void_elements);t.is_empty_element=t.tag_complete||t.is_start_tag&&t.is_end_tag;t.is_unformatted=!t.tag_complete&&in_array(t.tag_check,this._options.unformatted);t.is_content_unformatted=!t.is_empty_element&&in_array(t.tag_check,this._options.content_unformatted);t.is_inline_element=in_array(t.tag_name,this._options.inline)||this._options.inline_custom_elements&&t.tag_name.includes("-")||t.tag_start_char==="{";return t};Beautifier.prototype._set_tag_position=function(e,t,n,r,o){if(!n.is_empty_element){if(n.is_end_tag){n.start_tag_token=this._tag_stack.try_pop(n.tag_name)}else{if(this._do_optional_end_element(n)){if(!n.is_inline_element){e.print_newline(false)}}this._tag_stack.record_tag(n);if((n.tag_name==="script"||n.tag_name==="style")&&!(n.is_unformatted||n.is_content_unformatted)){n.custom_beautifier_name=get_custom_beautifier_name(n.tag_check,t)}}}if(in_array(n.tag_check,this._options.extra_liners)){e.print_newline(false);if(!e._output.just_added_blankline()){e.print_newline(true)}}if(n.is_empty_element){if(n.tag_start_char==="{"&&n.tag_check==="else"){this._tag_stack.indent_to_tag(["if","unless","each"]);n.indent_content=true;var l=e.current_line_has_match(/{{#if/);if(!l){e.print_newline(false)}}if(n.tag_name==="!--"&&o.type===h.TAG_CLOSE&&r.is_end_tag&&n.text.indexOf("\n")===-1){}else{if(!(n.is_inline_element||n.is_unformatted)){e.print_newline(false)}this._calcluate_parent_multiline(e,n)}}else if(n.is_end_tag){var f=false;f=n.start_tag_token&&n.start_tag_token.multiline_content;f=f||!n.is_inline_element&&!(r.is_inline_element||r.is_unformatted)&&!(o.type===h.TAG_CLOSE&&n.start_tag_token===r)&&o.type!=="TK_CONTENT";if(n.is_content_unformatted||n.is_unformatted){f=false}if(f){e.print_newline(false)}}else{n.indent_content=!n.custom_beautifier_name;if(n.tag_start_char==="<"){if(n.tag_name==="html"){n.indent_content=this._options.indent_inner_html}else if(n.tag_name==="head"){n.indent_content=this._options.indent_head_inner_html}else if(n.tag_name==="body"){n.indent_content=this._options.indent_body_inner_html}}if(!(n.is_inline_element||n.is_unformatted)&&(o.type!=="TK_CONTENT"||n.is_content_unformatted)){e.print_newline(false)}this._calcluate_parent_multiline(e,n)}};Beautifier.prototype._calcluate_parent_multiline=function(e,t){if(t.parent&&e._output.just_added_newline()&&!((t.is_inline_element||t.is_unformatted)&&t.parent.is_inline_element)){t.parent.multiline_content=true}};var d=["address","article","aside","blockquote","details","div","dl","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hr","main","menu","nav","ol","p","pre","section","table","ul"];var _=["a","audio","del","ins","map","noscript","video"];Beautifier.prototype._do_optional_end_element=function(e){var t=null;if(e.is_empty_element||!e.is_start_tag||!e.parent){return}if(e.tag_name==="body"){t=t||this._tag_stack.try_pop("head")}else if(e.tag_name==="li"){t=t||this._tag_stack.try_pop("li",["ol","ul","menu"])}else if(e.tag_name==="dd"||e.tag_name==="dt"){t=t||this._tag_stack.try_pop("dt",["dl"]);t=t||this._tag_stack.try_pop("dd",["dl"])}else if(e.parent.tag_name==="p"&&d.indexOf(e.tag_name)!==-1){var n=e.parent.parent;if(!n||_.indexOf(n.tag_name)===-1){t=t||this._tag_stack.try_pop("p")}}else if(e.tag_name==="rp"||e.tag_name==="rt"){t=t||this._tag_stack.try_pop("rt",["ruby","rtc"]);t=t||this._tag_stack.try_pop("rp",["ruby","rtc"])}else if(e.tag_name==="optgroup"){t=t||this._tag_stack.try_pop("optgroup",["select"])}else if(e.tag_name==="option"){t=t||this._tag_stack.try_pop("option",["select","datalist","optgroup"])}else if(e.tag_name==="colgroup"){t=t||this._tag_stack.try_pop("caption",["table"])}else if(e.tag_name==="thead"){t=t||this._tag_stack.try_pop("caption",["table"]);t=t||this._tag_stack.try_pop("colgroup",["table"])}else if(e.tag_name==="tbody"||e.tag_name==="tfoot"){t=t||this._tag_stack.try_pop("caption",["table"]);t=t||this._tag_stack.try_pop("colgroup",["table"]);t=t||this._tag_stack.try_pop("thead",["table"]);t=t||this._tag_stack.try_pop("tbody",["table"])}else if(e.tag_name==="tr"){t=t||this._tag_stack.try_pop("caption",["table"]);t=t||this._tag_stack.try_pop("colgroup",["table"]);t=t||this._tag_stack.try_pop("tr",["table","thead","tbody","tfoot"])}else if(e.tag_name==="th"||e.tag_name==="td"){t=t||this._tag_stack.try_pop("td",["table","thead","tbody","tfoot","tr"]);t=t||this._tag_stack.try_pop("th",["table","thead","tbody","tfoot","tr"])}e.parent=this._tag_stack.get_parser_token();return t};e.exports.P=Beautifier},905:(e,t,n)=>{var r=n(327).P,o=n(83).J;function style_html(e,t,n,o){var l=new r(e,t,n,o);return l.beautify()}e.exports=style_html;e.exports.defaultOptions=function(){return new o}},83:(e,t,n)=>{var r=n(301).JY;function Options(e){r.call(this,e,"html");if(this.templating.length===1&&this.templating[0]==="auto"){this.templating=["django","erb","handlebars","php"]}this.indent_inner_html=this._get_boolean("indent_inner_html");this.indent_body_inner_html=this._get_boolean("indent_body_inner_html",true);this.indent_head_inner_html=this._get_boolean("indent_head_inner_html",true);this.indent_handlebars=this._get_boolean("indent_handlebars",true);this.wrap_attributes=this._get_selection("wrap_attributes",["auto","force","force-aligned","force-expand-multiline","aligned-multiple","preserve","preserve-aligned"]);this.wrap_attributes_min_attrs=this._get_number("wrap_attributes_min_attrs",2);this.wrap_attributes_indent_size=this._get_number("wrap_attributes_indent_size",this.indent_size);this.extra_liners=this._get_array("extra_liners",["head","body","/html"]);this.inline=this._get_array("inline",["a","abbr","area","audio","b","bdi","bdo","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","i","iframe","img","input","ins","kbd","keygen","label","map","mark","math","meter","noscript","object","output","progress","q","ruby","s","samp","select","small","span","strong","sub","sup","svg","template","textarea","time","u","var","video","wbr","text","acronym","big","strike","tt"]);this.inline_custom_elements=this._get_boolean("inline_custom_elements",true);this.void_elements=this._get_array("void_elements",["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr","!doctype","?xml","basefont","isindex"]);this.unformatted=this._get_array("unformatted",[]);this.content_unformatted=this._get_array("content_unformatted",["pre","textarea"]);this.unformatted_content_delimiter=this._get_characters("unformatted_content_delimiter");this.indent_scripts=this._get_selection("indent_scripts",["normal","keep","separate"])}Options.prototype=new r;e.exports.J=Options},772:(e,t,n)=>{var r=n(170)._;var o=n(170).C;var l=n(657).D;var h=n(392).i;var f=n(569).z;var p={TAG_OPEN:"TK_TAG_OPEN",TAG_CLOSE:"TK_TAG_CLOSE",CONTROL_FLOW_OPEN:"TK_CONTROL_FLOW_OPEN",CONTROL_FLOW_CLOSE:"TK_CONTROL_FLOW_CLOSE",ATTRIBUTE:"TK_ATTRIBUTE",EQUALS:"TK_EQUALS",VALUE:"TK_VALUE",COMMENT:"TK_COMMENT",TEXT:"TK_TEXT",UNKNOWN:"TK_UNKNOWN",START:o.START,RAW:o.RAW,EOF:o.EOF};var d=new l(/<\!--/,/-->/);var Tokenizer=function(e,t){r.call(this,e,t);this._current_tag_name="";var n=new h(this._input).read_options(this._options);var o=new f(this._input);this.__patterns={word:n.until(/[\n\r\t <]/),word_control_flow_close_excluded:n.until(/[\n\r\t <}]/),single_quote:n.until_after(/'/),double_quote:n.until_after(/"/),attribute:n.until(/[\n\r\t =>]|\/>/),element_name:n.until(/[\n\r\t >\/]/),angular_control_flow_start:o.matching(/\@[a-zA-Z]+[^({]*[({]/),handlebars_comment:o.starting_with(/{{!--/).until_after(/--}}/),handlebars:o.starting_with(/{{/).until_after(/}}/),handlebars_open:o.until(/[\n\r\t }]/),handlebars_raw_close:o.until(/}}/),comment:o.starting_with(/<!--/).until_after(/-->/),cdata:o.starting_with(/<!\[CDATA\[/).until_after(/]]>/),conditional_comment:o.starting_with(/<!\[/).until_after(/]>/),processing:o.starting_with(/<\?/).until_after(/\?>/)};if(this._options.indent_handlebars){this.__patterns.word=this.__patterns.word.exclude("handlebars");this.__patterns.word_control_flow_close_excluded=this.__patterns.word_control_flow_close_excluded.exclude("handlebars")}this._unformatted_content_delimiter=null;if(this._options.unformatted_content_delimiter){var l=this._input.get_literal_regexp(this._options.unformatted_content_delimiter);this.__patterns.unformatted_content_delimiter=o.matching(l).until_after(l)}};Tokenizer.prototype=new r;Tokenizer.prototype._is_comment=function(e){return false};Tokenizer.prototype._is_opening=function(e){return e.type===p.TAG_OPEN||e.type===p.CONTROL_FLOW_OPEN};Tokenizer.prototype._is_closing=function(e,t){return e.type===p.TAG_CLOSE&&(t&&((e.text===">"||e.text==="/>")&&t.text[0]==="<"||e.text==="}}"&&t.text[0]==="{"&&t.text[1]==="{"))||e.type===p.CONTROL_FLOW_CLOSE&&(e.text==="}"&&t.text.endsWith("{"))};Tokenizer.prototype._reset=function(){this._current_tag_name=""};Tokenizer.prototype._get_next_token=function(e,t){var n=null;this._readWhitespace();var r=this._input.peek();if(r===null){return this._create_token(p.EOF,"")}n=n||this._read_open_handlebars(r,t);n=n||this._read_attribute(r,e,t);n=n||this._read_close(r,t);n=n||this._read_script_and_style(r,e);n=n||this._read_control_flows(r,t);n=n||this._read_raw_content(r,e,t);n=n||this._read_content_word(r,t);n=n||this._read_comment_or_cdata(r);n=n||this._read_processing(r);n=n||this._read_open(r,t);n=n||this._create_token(p.UNKNOWN,this._input.next());return n};Tokenizer.prototype._read_comment_or_cdata=function(e){var t=null;var n=null;var r=null;if(e==="<"){var o=this._input.peek(1);if(o==="!"){n=this.__patterns.comment.read();if(n){r=d.get_directives(n);if(r&&r.ignore==="start"){n+=d.readIgnored(this._input)}}else{n=this.__patterns.cdata.read()}}if(n){t=this._create_token(p.COMMENT,n);t.directives=r}}return t};Tokenizer.prototype._read_processing=function(e){var t=null;var n=null;var r=null;if(e==="<"){var o=this._input.peek(1);if(o==="!"||o==="?"){n=this.__patterns.conditional_comment.read();n=n||this.__patterns.processing.read()}if(n){t=this._create_token(p.COMMENT,n);t.directives=r}}return t};Tokenizer.prototype._read_open=function(e,t){var n=null;var r=null;if(!t||t.type===p.CONTROL_FLOW_OPEN){if(e==="<"){n=this._input.next();if(this._input.peek()==="/"){n+=this._input.next()}n+=this.__patterns.element_name.read();r=this._create_token(p.TAG_OPEN,n)}}return r};Tokenizer.prototype._read_open_handlebars=function(e,t){var n=null;var r=null;if(!t||t.type===p.CONTROL_FLOW_OPEN){if((this._options.templating.includes("angular")||this._options.indent_handlebars)&&e==="{"&&this._input.peek(1)==="{"){if(this._options.indent_handlebars&&this._input.peek(2)==="!"){n=this.__patterns.handlebars_comment.read();n=n||this.__patterns.handlebars.read();r=this._create_token(p.COMMENT,n)}else{n=this.__patterns.handlebars_open.read();r=this._create_token(p.TAG_OPEN,n)}}}return r};Tokenizer.prototype._read_control_flows=function(e,t){var n="";var r=null;if(!this._options.templating.includes("angular")){return r}if(e==="@"){n=this.__patterns.angular_control_flow_start.read();if(n===""){return r}var o=n.endsWith("(")?1:0;var l=0;while(!(n.endsWith("{")&&o===l)){var h=this._input.next();if(h===null){break}else if(h==="("){o++}else if(h===")"){l++}n+=h}r=this._create_token(p.CONTROL_FLOW_OPEN,n)}else if(e==="}"&&t&&t.type===p.CONTROL_FLOW_OPEN){n=this._input.next();r=this._create_token(p.CONTROL_FLOW_CLOSE,n)}return r};Tokenizer.prototype._read_close=function(e,t){var n=null;var r=null;if(t&&t.type===p.TAG_OPEN){if(t.text[0]==="<"&&(e===">"||e==="/"&&this._input.peek(1)===">")){n=this._input.next();if(e==="/"){n+=this._input.next()}r=this._create_token(p.TAG_CLOSE,n)}else if(t.text[0]==="{"&&e==="}"&&this._input.peek(1)==="}"){this._input.next();this._input.next();r=this._create_token(p.TAG_CLOSE,"}}")}}return r};Tokenizer.prototype._read_attribute=function(e,t,n){var r=null;var o="";if(n&&n.text[0]==="<"){if(e==="="){r=this._create_token(p.EQUALS,this._input.next())}else if(e==='"'||e==="'"){var l=this._input.next();if(e==='"'){l+=this.__patterns.double_quote.read()}else{l+=this.__patterns.single_quote.read()}r=this._create_token(p.VALUE,l)}else{o=this.__patterns.attribute.read();if(o){if(t.type===p.EQUALS){r=this._create_token(p.VALUE,o)}else{r=this._create_token(p.ATTRIBUTE,o)}}}}return r};Tokenizer.prototype._is_content_unformatted=function(e){return this._options.void_elements.indexOf(e)===-1&&(this._options.content_unformatted.indexOf(e)!==-1||this._options.unformatted.indexOf(e)!==-1)};Tokenizer.prototype._read_raw_content=function(e,t,n){var r="";if(n&&n.text[0]==="{"){r=this.__patterns.handlebars_raw_close.read()}else if(t.type===p.TAG_CLOSE&&t.opened.text[0]==="<"&&t.text[0]!=="/"){var o=t.opened.text.substr(1).toLowerCase();if(this._is_content_unformatted(o)){r=this._input.readUntil(new RegExp("</"+o+"[\\n\\r\\t ]*?>","ig"))}}if(r){return this._create_token(p.TEXT,r)}return null};Tokenizer.prototype._read_script_and_style=function(e,t){if(t.type===p.TAG_CLOSE&&t.opened.text[0]==="<"&&t.text[0]!=="/"){var n=t.opened.text.substr(1).toLowerCase();if(n==="script"||n==="style"){var r=this._read_comment_or_cdata(e);if(r){r.type=p.TEXT;return r}var o=this._input.readUntil(new RegExp("</"+n+"[\\n\\r\\t ]*?>","ig"));if(o){return this._create_token(p.TEXT,o)}}}return null};Tokenizer.prototype._read_content_word=function(e,t){var n="";if(this._options.unformatted_content_delimiter){if(e===this._options.unformatted_content_delimiter[0]){n=this.__patterns.unformatted_content_delimiter.read()}}if(!n){n=t&&t.type===p.CONTROL_FLOW_OPEN?this.__patterns.word_control_flow_close_excluded.read():this.__patterns.word.read()}if(n){return this._create_token(p.TEXT,n)}return null};e.exports._=Tokenizer;e.exports.C=p},975:(e,t,n)=>{var r=n(611);var o=n(295);var l=n(905);function style_html(e,t,n,h){n=n||r;h=h||o;return l(e,t,n,h)}style_html.defaultOptions=l.defaultOptions;e.exports.js=r;e.exports.css=o;e.exports.html=style_html},434:(e,t)=>{var n="\\x23\\x24\\x40\\x41-\\x5a\\x5f\\x61-\\x7a";var r="\\x24\\x30-\\x39\\x41-\\x5a\\x5f\\x61-\\x7a";var o="\\xaa\\xb5\\xba\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\u02c1\\u02c6-\\u02d1\\u02e0-\\u02e4\\u02ec\\u02ee\\u0370-\\u0374\\u0376\\u0377\\u037a-\\u037d\\u0386\\u0388-\\u038a\\u038c\\u038e-\\u03a1\\u03a3-\\u03f5\\u03f7-\\u0481\\u048a-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05d0-\\u05ea\\u05f0-\\u05f2\\u0620-\\u064a\\u066e\\u066f\\u0671-\\u06d3\\u06d5\\u06e5\\u06e6\\u06ee\\u06ef\\u06fa-\\u06fc\\u06ff\\u0710\\u0712-\\u072f\\u074d-\\u07a5\\u07b1\\u07ca-\\u07ea\\u07f4\\u07f5\\u07fa\\u0800-\\u0815\\u081a\\u0824\\u0828\\u0840-\\u0858\\u08a0\\u08a2-\\u08ac\\u0904-\\u0939\\u093d\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097f\\u0985-\\u098c\\u098f\\u0990\\u0993-\\u09a8\\u09aa-\\u09b0\\u09b2\\u09b6-\\u09b9\\u09bd\\u09ce\\u09dc\\u09dd\\u09df-\\u09e1\\u09f0\\u09f1\\u0a05-\\u0a0a\\u0a0f\\u0a10\\u0a13-\\u0a28\\u0a2a-\\u0a30\\u0a32\\u0a33\\u0a35\\u0a36\\u0a38\\u0a39\\u0a59-\\u0a5c\\u0a5e\\u0a72-\\u0a74\\u0a85-\\u0a8d\\u0a8f-\\u0a91\\u0a93-\\u0aa8\\u0aaa-\\u0ab0\\u0ab2\\u0ab3\\u0ab5-\\u0ab9\\u0abd\\u0ad0\\u0ae0\\u0ae1\\u0b05-\\u0b0c\\u0b0f\\u0b10\\u0b13-\\u0b28\\u0b2a-\\u0b30\\u0b32\\u0b33\\u0b35-\\u0b39\\u0b3d\\u0b5c\\u0b5d\\u0b5f-\\u0b61\\u0b71\\u0b83\\u0b85-\\u0b8a\\u0b8e-\\u0b90\\u0b92-\\u0b95\\u0b99\\u0b9a\\u0b9c\\u0b9e\\u0b9f\\u0ba3\\u0ba4\\u0ba8-\\u0baa\\u0bae-\\u0bb9\\u0bd0\\u0c05-\\u0c0c\\u0c0e-\\u0c10\\u0c12-\\u0c28\\u0c2a-\\u0c33\\u0c35-\\u0c39\\u0c3d\\u0c58\\u0c59\\u0c60\\u0c61\\u0c85-\\u0c8c\\u0c8e-\\u0c90\\u0c92-\\u0ca8\\u0caa-\\u0cb3\\u0cb5-\\u0cb9\\u0cbd\\u0cde\\u0ce0\\u0ce1\\u0cf1\\u0cf2\\u0d05-\\u0d0c\\u0d0e-\\u0d10\\u0d12-\\u0d3a\\u0d3d\\u0d4e\\u0d60\\u0d61\\u0d7a-\\u0d7f\\u0d85-\\u0d96\\u0d9a-\\u0db1\\u0db3-\\u0dbb\\u0dbd\\u0dc0-\\u0dc6\\u0e01-\\u0e30\\u0e32\\u0e33\\u0e40-\\u0e46\\u0e81\\u0e82\\u0e84\\u0e87\\u0e88\\u0e8a\\u0e8d\\u0e94-\\u0e97\\u0e99-\\u0e9f\\u0ea1-\\u0ea3\\u0ea5\\u0ea7\\u0eaa\\u0eab\\u0ead-\\u0eb0\\u0eb2\\u0eb3\\u0ebd\\u0ec0-\\u0ec4\\u0ec6\\u0edc-\\u0edf\\u0f00\\u0f40-\\u0f47\\u0f49-\\u0f6c\\u0f88-\\u0f8c\\u1000-\\u102a\\u103f\\u1050-\\u1055\\u105a-\\u105d\\u1061\\u1065\\u1066\\u106e-\\u1070\\u1075-\\u1081\\u108e\\u10a0-\\u10c5\\u10c7\\u10cd\\u10d0-\\u10fa\\u10fc-\\u1248\\u124a-\\u124d\\u1250-\\u1256\\u1258\\u125a-\\u125d\\u1260-\\u1288\\u128a-\\u128d\\u1290-\\u12b0\\u12b2-\\u12b5\\u12b8-\\u12be\\u12c0\\u12c2-\\u12c5\\u12c8-\\u12d6\\u12d8-\\u1310\\u1312-\\u1315\\u1318-\\u135a\\u1380-\\u138f\\u13a0-\\u13f4\\u1401-\\u166c\\u166f-\\u167f\\u1681-\\u169a\\u16a0-\\u16ea\\u16ee-\\u16f0\\u1700-\\u170c\\u170e-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176c\\u176e-\\u1770\\u1780-\\u17b3\\u17d7\\u17dc\\u1820-\\u1877\\u1880-\\u18a8\\u18aa\\u18b0-\\u18f5\\u1900-\\u191c\\u1950-\\u196d\\u1970-\\u1974\\u1980-\\u19ab\\u19c1-\\u19c7\\u1a00-\\u1a16\\u1a20-\\u1a54\\u1aa7\\u1b05-\\u1b33\\u1b45-\\u1b4b\\u1b83-\\u1ba0\\u1bae\\u1baf\\u1bba-\\u1be5\\u1c00-\\u1c23\\u1c4d-\\u1c4f\\u1c5a-\\u1c7d\\u1ce9-\\u1cec\\u1cee-\\u1cf1\\u1cf5\\u1cf6\\u1d00-\\u1dbf\\u1e00-\\u1f15\\u1f18-\\u1f1d\\u1f20-\\u1f45\\u1f48-\\u1f4d\\u1f50-\\u1f57\\u1f59\\u1f5b\\u1f5d\\u1f5f-\\u1f7d\\u1f80-\\u1fb4\\u1fb6-\\u1fbc\\u1fbe\\u1fc2-\\u1fc4\\u1fc6-\\u1fcc\\u1fd0-\\u1fd3\\u1fd6-\\u1fdb\\u1fe0-\\u1fec\\u1ff2-\\u1ff4\\u1ff6-\\u1ffc\\u2071\\u207f\\u2090-\\u209c\\u2102\\u2107\\u210a-\\u2113\\u2115\\u2119-\\u211d\\u2124\\u2126\\u2128\\u212a-\\u212d\\u212f-\\u2139\\u213c-\\u213f\\u2145-\\u2149\\u214e\\u2160-\\u2188\\u2c00-\\u2c2e\\u2c30-\\u2c5e\\u2c60-\\u2ce4\\u2ceb-\\u2cee\\u2cf2\\u2cf3\\u2d00-\\u2d25\\u2d27\\u2d2d\\u2d30-\\u2d67\\u2d6f\\u2d80-\\u2d96\\u2da0-\\u2da6\\u2da8-\\u2dae\\u2db0-\\u2db6\\u2db8-\\u2dbe\\u2dc0-\\u2dc6\\u2dc8-\\u2dce\\u2dd0-\\u2dd6\\u2dd8-\\u2dde\\u2e2f\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303c\\u3041-\\u3096\\u309d-\\u309f\\u30a1-\\u30fa\\u30fc-\\u30ff\\u3105-\\u312d\\u3131-\\u318e\\u31a0-\\u31ba\\u31f0-\\u31ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\ua000-\\ua48c\\ua4d0-\\ua4fd\\ua500-\\ua60c\\ua610-\\ua61f\\ua62a\\ua62b\\ua640-\\ua66e\\ua67f-\\ua697\\ua6a0-\\ua6ef\\ua717-\\ua71f\\ua722-\\ua788\\ua78b-\\ua78e\\ua790-\\ua793\\ua7a0-\\ua7aa\\ua7f8-\\ua801\\ua803-\\ua805\\ua807-\\ua80a\\ua80c-\\ua822\\ua840-\\ua873\\ua882-\\ua8b3\\ua8f2-\\ua8f7\\ua8fb\\ua90a-\\ua925\\ua930-\\ua946\\ua960-\\ua97c\\ua984-\\ua9b2\\ua9cf\\uaa00-\\uaa28\\uaa40-\\uaa42\\uaa44-\\uaa4b\\uaa60-\\uaa76\\uaa7a\\uaa80-\\uaaaf\\uaab1\\uaab5\\uaab6\\uaab9-\\uaabd\\uaac0\\uaac2\\uaadb-\\uaadd\\uaae0-\\uaaea\\uaaf2-\\uaaf4\\uab01-\\uab06\\uab09-\\uab0e\\uab11-\\uab16\\uab20-\\uab26\\uab28-\\uab2e\\uabc0-\\uabe2\\uac00-\\ud7a3\\ud7b0-\\ud7c6\\ud7cb-\\ud7fb\\uf900-\\ufa6d\\ufa70-\\ufad9\\ufb00-\\ufb06\\ufb13-\\ufb17\\ufb1d\\ufb1f-\\ufb28\\ufb2a-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40\\ufb41\\ufb43\\ufb44\\ufb46-\\ufbb1\\ufbd3-\\ufd3d\\ufd50-\\ufd8f\\ufd92-\\ufdc7\\ufdf0-\\ufdfb\\ufe70-\\ufe74\\ufe76-\\ufefc\\uff21-\\uff3a\\uff41-\\uff5a\\uff66-\\uffbe\\uffc2-\\uffc7\\uffca-\\uffcf\\uffd2-\\uffd7\\uffda-\\uffdc";var l="\\u0300-\\u036f\\u0483-\\u0487\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u0620-\\u0649\\u0672-\\u06d3\\u06e7-\\u06e8\\u06fb-\\u06fc\\u0730-\\u074a\\u0800-\\u0814\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0840-\\u0857\\u08e4-\\u08fe\\u0900-\\u0903\\u093a-\\u093c\\u093e-\\u094f\\u0951-\\u0957\\u0962-\\u0963\\u0966-\\u096f\\u0981-\\u0983\\u09bc\\u09be-\\u09c4\\u09c7\\u09c8\\u09d7\\u09df-\\u09e0\\u0a01-\\u0a03\\u0a3c\\u0a3e-\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a66-\\u0a71\\u0a75\\u0a81-\\u0a83\\u0abc\\u0abe-\\u0ac5\\u0ac7-\\u0ac9\\u0acb-\\u0acd\\u0ae2-\\u0ae3\\u0ae6-\\u0aef\\u0b01-\\u0b03\\u0b3c\\u0b3e-\\u0b44\\u0b47\\u0b48\\u0b4b-\\u0b4d\\u0b56\\u0b57\\u0b5f-\\u0b60\\u0b66-\\u0b6f\\u0b82\\u0bbe-\\u0bc2\\u0bc6-\\u0bc8\\u0bca-\\u0bcd\\u0bd7\\u0be6-\\u0bef\\u0c01-\\u0c03\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62-\\u0c63\\u0c66-\\u0c6f\\u0c82\\u0c83\\u0cbc\\u0cbe-\\u0cc4\\u0cc6-\\u0cc8\\u0cca-\\u0ccd\\u0cd5\\u0cd6\\u0ce2-\\u0ce3\\u0ce6-\\u0cef\\u0d02\\u0d03\\u0d46-\\u0d48\\u0d57\\u0d62-\\u0d63\\u0d66-\\u0d6f\\u0d82\\u0d83\\u0dca\\u0dcf-\\u0dd4\\u0dd6\\u0dd8-\\u0ddf\\u0df2\\u0df3\\u0e34-\\u0e3a\\u0e40-\\u0e45\\u0e50-\\u0e59\\u0eb4-\\u0eb9\\u0ec8-\\u0ecd\\u0ed0-\\u0ed9\\u0f18\\u0f19\\u0f20-\\u0f29\\u0f35\\u0f37\\u0f39\\u0f41-\\u0f47\\u0f71-\\u0f84\\u0f86-\\u0f87\\u0f8d-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u1000-\\u1029\\u1040-\\u1049\\u1067-\\u106d\\u1071-\\u1074\\u1082-\\u108d\\u108f-\\u109d\\u135d-\\u135f\\u170e-\\u1710\\u1720-\\u1730\\u1740-\\u1750\\u1772\\u1773\\u1780-\\u17b2\\u17dd\\u17e0-\\u17e9\\u180b-\\u180d\\u1810-\\u1819\\u1920-\\u192b\\u1930-\\u193b\\u1951-\\u196d\\u19b0-\\u19c0\\u19c8-\\u19c9\\u19d0-\\u19d9\\u1a00-\\u1a15\\u1a20-\\u1a53\\u1a60-\\u1a7c\\u1a7f-\\u1a89\\u1a90-\\u1a99\\u1b46-\\u1b4b\\u1b50-\\u1b59\\u1b6b-\\u1b73\\u1bb0-\\u1bb9\\u1be6-\\u1bf3\\u1c00-\\u1c22\\u1c40-\\u1c49\\u1c5b-\\u1c7d\\u1cd0-\\u1cd2\\u1d00-\\u1dbe\\u1e01-\\u1f15\\u200c\\u200d\\u203f\\u2040\\u2054\\u20d0-\\u20dc\\u20e1\\u20e5-\\u20f0\\u2d81-\\u2d96\\u2de0-\\u2dff\\u3021-\\u3028\\u3099\\u309a\\ua640-\\ua66d\\ua674-\\ua67d\\ua69f\\ua6f0-\\ua6f1\\ua7f8-\\ua800\\ua806\\ua80b\\ua823-\\ua827\\ua880-\\ua881\\ua8b4-\\ua8c4\\ua8d0-\\ua8d9\\ua8f3-\\ua8f7\\ua900-\\ua909\\ua926-\\ua92d\\ua930-\\ua945\\ua980-\\ua983\\ua9b3-\\ua9c0\\uaa00-\\uaa27\\uaa40-\\uaa41\\uaa4c-\\uaa4d\\uaa50-\\uaa59\\uaa7b\\uaae0-\\uaae9\\uaaf2-\\uaaf3\\uabc0-\\uabe1\\uabec\\uabed\\uabf0-\\uabf9\\ufb20-\\ufb28\\ufe00-\\ufe0f\\ufe20-\\ufe26\\ufe33\\ufe34\\ufe4d-\\ufe4f\\uff10-\\uff19\\uff3f";var h="\\\\u[0-9a-fA-F]{4}|\\\\u\\{[0-9a-fA-F]+\\}";var f="(?:"+h+"|["+n+o+"])";var p="(?:"+h+"|["+r+o+l+"])*";t.identifier=new RegExp(f+p,"g");t.identifierStart=new RegExp(f);t.identifierMatch=new RegExp("(?:"+h+"|["+r+o+l+"])+");var d=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/;t.newline=/[\n\r\u2028\u2029]/;t.lineBreak=new RegExp("\r\n|"+t.newline.source);t.allLineBreaks=new RegExp(t.lineBreak.source,"g")},877:(e,t,n)=>{var r=n(498).k;var o=n(658).o;var l=n(434);var h=n(833).J;var f=n(982)._F;var p=n(982).O0;var d=n(982).OK;var _=n(982).CV;function in_array(e,t){return t.indexOf(e)!==-1}function ltrim(e){return e.replace(/^\s+/g,"")}function generateMapFromStrings(e){var t={};for(var n=0;n<e.length;n++){t[e[n].replace(/-/g,"_")]=e[n]}return t}function reserved_word(e,t){return e&&e.type===_.RESERVED&&e.text===t}function reserved_array(e,t){return e&&e.type===_.RESERVED&&in_array(e.text,t)}var m=["case","return","do","if","throw","else","await","break","continue","async"];var g=["before-newline","after-newline","preserve-newline"];var y=generateMapFromStrings(g);var b=[y.before_newline,y.preserve_newline];var v={BlockStatement:"BlockStatement",Statement:"Statement",ObjectLiteral:"ObjectLiteral",ArrayLiteral:"ArrayLiteral",ForInitializer:"ForInitializer",Conditional:"Conditional",Expression:"Expression"};function remove_redundant_indentation(e,t){if(t.multiline_frame||t.mode===v.ForInitializer||t.mode===v.Conditional){return}e.remove_indent(t.start_line_index)}function split_linebreaks(e){e=e.replace(l.allLineBreaks,"\n");var t=[],n=e.indexOf("\n");while(n!==-1){t.push(e.substring(0,n));e=e.substring(n+1);n=e.indexOf("\n")}if(e.length){t.push(e)}return t}function is_array(e){return e===v.ArrayLiteral}function is_expression(e){return in_array(e,[v.Expression,v.ForInitializer,v.Conditional])}function all_lines_start_with(e,t){for(var n=0;n<e.length;n++){var r=e[n].trim();if(r.charAt(0)!==t){return false}}return true}function each_line_matches_indent(e,t){var n=0,r=e.length,o;for(;n<r;n++){o=e[n];if(o&&o.indexOf(t)!==0){return false}}return true}function Beautifier(e,t){t=t||{};this._source_text=e||"";this._output=null;this._tokens=null;this._last_last_text=null;this._flags=null;this._previous_flags=null;this._flag_store=null;this._options=new h(t)}Beautifier.prototype.create_flags=function(e,t){var n=0;if(e){n=e.indentation_level;if(!this._output.just_added_newline()&&e.line_indent_level>n){n=e.line_indent_level}}var r={mode:t,parent:e,last_token:e?e.last_token:new o(_.START_BLOCK,""),last_word:e?e.last_word:"",declaration_statement:false,declaration_assignment:false,multiline_frame:false,inline_frame:false,if_block:false,else_block:false,class_start_block:false,do_block:false,do_while:false,import_block:false,in_case_statement:false,in_case:false,case_body:false,case_block:false,indentation_level:n,alignment:0,line_indent_level:e?e.line_indent_level:n,start_line_index:this._output.get_line_number(),ternary_depth:0};return r};Beautifier.prototype._reset=function(e){var t=e.match(/^[\t ]*/)[0];this._last_last_text="";this._output=new r(this._options,t);this._output.raw=this._options.test_output_raw;this._flag_store=[];this.set_mode(v.BlockStatement);var n=new f(e,this._options);this._tokens=n.tokenize();return e};Beautifier.prototype.beautify=function(){if(this._options.disabled){return this._source_text}var e;var t=this._reset(this._source_text);var n=this._options.eol;if(this._options.eol==="auto"){n="\n";if(t&&l.lineBreak.test(t||"")){n=t.match(l.lineBreak)[0]}}var r=this._tokens.next();while(r){this.handle_token(r);this._last_last_text=this._flags.last_token.text;this._flags.last_token=r;r=this._tokens.next()}e=this._output.get_code(n);return e};Beautifier.prototype.handle_token=function(e,t){if(e.type===_.START_EXPR){this.handle_start_expr(e)}else if(e.type===_.END_EXPR){this.handle_end_expr(e)}else if(e.type===_.START_BLOCK){this.handle_start_block(e)}else if(e.type===_.END_BLOCK){this.handle_end_block(e)}else if(e.type===_.WORD){this.handle_word(e)}else if(e.type===_.RESERVED){this.handle_word(e)}else if(e.type===_.SEMICOLON){this.handle_semicolon(e)}else if(e.type===_.STRING){this.handle_string(e)}else if(e.type===_.EQUALS){this.handle_equals(e)}else if(e.type===_.OPERATOR){this.handle_operator(e)}else if(e.type===_.COMMA){this.handle_comma(e)}else if(e.type===_.BLOCK_COMMENT){this.handle_block_comment(e,t)}else if(e.type===_.COMMENT){this.handle_comment(e,t)}else if(e.type===_.DOT){this.handle_dot(e)}else if(e.type===_.EOF){this.handle_eof(e)}else if(e.type===_.UNKNOWN){this.handle_unknown(e,t)}else{this.handle_unknown(e,t)}};Beautifier.prototype.handle_whitespace_and_comments=function(e,t){var n=e.newlines;var r=this._options.keep_array_indentation&&is_array(this._flags.mode);if(e.comments_before){var o=e.comments_before.next();while(o){this.handle_whitespace_and_comments(o,t);this.handle_token(o,t);o=e.comments_before.next()}}if(r){for(var l=0;l<n;l+=1){this.print_newline(l>0,t)}}else{if(this._options.max_preserve_newlines&&n>this._options.max_preserve_newlines){n=this._options.max_preserve_newlines}if(this._options.preserve_newlines){if(n>1){this.print_newline(false,t);for(var h=1;h<n;h+=1){this.print_newline(true,t)}}}}};var E=["async","break","continue","return","throw","yield"];Beautifier.prototype.allow_wrap_or_preserved_newline=function(e,t){t=t===undefined?false:t;if(this._output.just_added_newline()){return}var n=this._options.preserve_newlines&&e.newlines||t;var r=in_array(this._flags.last_token.text,d)||in_array(e.text,d);if(r){var o=in_array(this._flags.last_token.text,d)&&in_array(this._options.operator_position,b)||in_array(e.text,d);n=n&&o}if(n){this.print_newline(false,true)}else if(this._options.wrap_line_length){if(reserved_array(this._flags.last_token,E)){return}this._output.set_wrap_point()}};Beautifier.prototype.print_newline=function(e,t){if(!t){if(this._flags.last_token.text!==";"&&this._flags.last_token.text!==","&&this._flags.last_token.text!=="="&&(this._flags.last_token.type!==_.OPERATOR||this._flags.last_token.text==="--"||this._flags.last_token.text==="++")){var n=this._tokens.peek();while(this._flags.mode===v.Statement&&!(this._flags.if_block&&reserved_word(n,"else"))&&!this._flags.do_block){this.restore_mode()}}}if(this._output.add_new_line(e)){this._flags.multiline_frame=true}};Beautifier.prototype.print_token_line_indentation=function(e){if(this._output.just_added_newline()){if(this._options.keep_array_indentation&&e.newlines&&(e.text==="["||is_array(this._flags.mode))){this._output.current_line.set_indent(-1);this._output.current_line.push(e.whitespace_before);this._output.space_before_token=false}else if(this._output.set_indent(this._flags.indentation_level,this._flags.alignment)){this._flags.line_indent_level=this._flags.indentation_level}}};Beautifier.prototype.print_token=function(e){if(this._output.raw){this._output.add_raw_token(e);return}if(this._options.comma_first&&e.previous&&e.previous.type===_.COMMA&&this._output.just_added_newline()){if(this._output.previous_line.last()===","){var t=this._output.previous_line.pop();if(this._output.previous_line.is_empty()){this._output.previous_line.push(t);this._output.trim(true);this._output.current_line.pop();this._output.trim()}this.print_token_line_indentation(e);this._output.add_token(",");this._output.space_before_token=true}}this.print_token_line_indentation(e);this._output.non_breaking_space=true;this._output.add_token(e.text);if(this._output.previous_token_wrapped){this._flags.multiline_frame=true}};Beautifier.prototype.indent=function(){this._flags.indentation_level+=1;this._output.set_indent(this._flags.indentation_level,this._flags.alignment)};Beautifier.prototype.deindent=function(){if(this._flags.indentation_level>0&&(!this._flags.parent||this._flags.indentation_level>this._flags.parent.indentation_level)){this._flags.indentation_level-=1;this._output.set_indent(this._flags.indentation_level,this._flags.alignment)}};Beautifier.prototype.set_mode=function(e){if(this._flags){this._flag_store.push(this._flags);this._previous_flags=this._flags}else{this._previous_flags=this.create_flags(null,e)}this._flags=this.create_flags(this._previous_flags,e);this._output.set_indent(this._flags.indentation_level,this._flags.alignment)};Beautifier.prototype.restore_mode=function(){if(this._flag_store.length>0){this._previous_flags=this._flags;this._flags=this._flag_store.pop();if(this._previous_flags.mode===v.Statement){remove_redundant_indentation(this._output,this._previous_flags)}this._output.set_indent(this._flags.indentation_level,this._flags.alignment)}};Beautifier.prototype.start_of_object_property=function(){return this._flags.parent.mode===v.ObjectLiteral&&this._flags.mode===v.Statement&&(this._flags.last_token.text===":"&&this._flags.ternary_depth===0||reserved_array(this._flags.last_token,["get","set"]))};Beautifier.prototype.start_of_statement=function(e){var t=false;t=t||reserved_array(this._flags.last_token,["var","let","const"])&&e.type===_.WORD;t=t||reserved_word(this._flags.last_token,"do");t=t||!(this._flags.parent.mode===v.ObjectLiteral&&this._flags.mode===v.Statement)&&reserved_array(this._flags.last_token,E)&&!e.newlines;t=t||reserved_word(this._flags.last_token,"else")&&!(reserved_word(e,"if")&&!e.comments_before);t=t||this._flags.last_token.type===_.END_EXPR&&(this._previous_flags.mode===v.ForInitializer||this._previous_flags.mode===v.Conditional);t=t||this._flags.last_token.type===_.WORD&&this._flags.mode===v.BlockStatement&&!this._flags.in_case&&!(e.text==="--"||e.text==="++")&&this._last_last_text!=="function"&&e.type!==_.WORD&&e.type!==_.RESERVED;t=t||this._flags.mode===v.ObjectLiteral&&(this._flags.last_token.text===":"&&this._flags.ternary_depth===0||reserved_array(this._flags.last_token,["get","set"]));if(t){this.set_mode(v.Statement);this.indent();this.handle_whitespace_and_comments(e,true);if(!this.start_of_object_property()){this.allow_wrap_or_preserved_newline(e,reserved_array(e,["do","for","if","while"]))}return true}return false};Beautifier.prototype.handle_start_expr=function(e){if(!this.start_of_statement(e)){this.handle_whitespace_and_comments(e)}var t=v.Expression;if(e.text==="["){if(this._flags.last_token.type===_.WORD||this._flags.last_token.text===")"){if(reserved_array(this._flags.last_token,p)){this._output.space_before_token=true}this.print_token(e);this.set_mode(t);this.indent();if(this._options.space_in_paren){this._output.space_before_token=true}return}t=v.ArrayLiteral;if(is_array(this._flags.mode)){if(this._flags.last_token.text==="["||this._flags.last_token.text===","&&(this._last_last_text==="]"||this._last_last_text==="}")){if(!this._options.keep_array_indentation){this.print_newline()}}}if(!in_array(this._flags.last_token.type,[_.START_EXPR,_.END_EXPR,_.WORD,_.OPERATOR,_.DOT])){this._output.space_before_token=true}}else{if(this._flags.last_token.type===_.RESERVED){if(this._flags.last_token.text==="for"){this._output.space_before_token=this._options.space_before_conditional;t=v.ForInitializer}else if(in_array(this._flags.last_token.text,["if","while","switch"])){this._output.space_before_token=this._options.space_before_conditional;t=v.Conditional}else if(in_array(this._flags.last_word,["await","async"])){this._output.space_before_token=true}else if(this._flags.last_token.text==="import"&&e.whitespace_before===""){this._output.space_before_token=false}else if(in_array(this._flags.last_token.text,p)||this._flags.last_token.text==="catch"){this._output.space_before_token=true}}else if(this._flags.last_token.type===_.EQUALS||this._flags.last_token.type===_.OPERATOR){if(!this.start_of_object_property()){this.allow_wrap_or_preserved_newline(e)}}else if(this._flags.last_token.type===_.WORD){this._output.space_before_token=false;var n=this._tokens.peek(-3);if(this._options.space_after_named_function&&n){var r=this._tokens.peek(-4);if(reserved_array(n,["async","function"])||n.text==="*"&&reserved_array(r,["async","function"])){this._output.space_before_token=true}else if(this._flags.mode===v.ObjectLiteral){if(n.text==="{"||n.text===","||n.text==="*"&&(r.text==="{"||r.text===",")){this._output.space_before_token=true}}else if(this._flags.parent&&this._flags.parent.class_start_block){this._output.space_before_token=true}}}else{this.allow_wrap_or_preserved_newline(e)}if(this._flags.last_token.type===_.RESERVED&&(this._flags.last_word==="function"||this._flags.last_word==="typeof")||this._flags.last_token.text==="*"&&(in_array(this._last_last_text,["function","yield"])||this._flags.mode===v.ObjectLiteral&&in_array(this._last_last_text,["{",","]))){this._output.space_before_token=this._options.space_after_anon_function}}if(this._flags.last_token.text===";"||this._flags.last_token.type===_.START_BLOCK){this.print_newline()}else if(this._flags.last_token.type===_.END_EXPR||this._flags.last_token.type===_.START_EXPR||this._flags.last_token.type===_.END_BLOCK||this._flags.last_token.text==="."||this._flags.last_token.type===_.COMMA){this.allow_wrap_or_preserved_newline(e,e.newlines)}this.print_token(e);this.set_mode(t);if(this._options.space_in_paren){this._output.space_before_token=true}this.indent()};Beautifier.prototype.handle_end_expr=function(e){while(this._flags.mode===v.Statement){this.restore_mode()}this.handle_whitespace_and_comments(e);if(this._flags.multiline_frame){this.allow_wrap_or_preserved_newline(e,e.text==="]"&&is_array(this._flags.mode)&&!this._options.keep_array_indentation)}if(this._options.space_in_paren){if(this._flags.last_token.type===_.START_EXPR&&!this._options.space_in_empty_paren){this._output.trim();this._output.space_before_token=false}else{this._output.space_before_token=true}}this.deindent();this.print_token(e);this.restore_mode();remove_redundant_indentation(this._output,this._previous_flags);if(this._flags.do_while&&this._previous_flags.mode===v.Conditional){this._previous_flags.mode=v.Expression;this._flags.do_block=false;this._flags.do_while=false}};Beautifier.prototype.handle_start_block=function(e){this.handle_whitespace_and_comments(e);var t=this._tokens.peek();var n=this._tokens.peek(1);if(this._flags.last_word==="switch"&&this._flags.last_token.type===_.END_EXPR){this.set_mode(v.BlockStatement);this._flags.in_case_statement=true}else if(this._flags.case_body){this.set_mode(v.BlockStatement)}else if(n&&(in_array(n.text,[":",","])&&in_array(t.type,[_.STRING,_.WORD,_.RESERVED])||in_array(t.text,["get","set","..."])&&in_array(n.type,[_.WORD,_.RESERVED]))){if(in_array(this._last_last_text,["class","interface"])&&!in_array(n.text,[":",","])){this.set_mode(v.BlockStatement)}else{this.set_mode(v.ObjectLiteral)}}else if(this._flags.last_token.type===_.OPERATOR&&this._flags.last_token.text==="=>"){this.set_mode(v.BlockStatement)}else if(in_array(this._flags.last_token.type,[_.EQUALS,_.START_EXPR,_.COMMA,_.OPERATOR])||reserved_array(this._flags.last_token,["return","throw","import","default"])){this.set_mode(v.ObjectLiteral)}else{this.set_mode(v.BlockStatement)}if(this._flags.last_token){if(reserved_array(this._flags.last_token.previous,["class","extends"])){this._flags.class_start_block=true}}var r=!t.comments_before&&t.text==="}";var o=r&&this._flags.last_word==="function"&&this._flags.last_token.type===_.END_EXPR;if(this._options.brace_preserve_inline){var l=0;var h=null;this._flags.inline_frame=true;do{l+=1;h=this._tokens.peek(l-1);if(h.newlines){this._flags.inline_frame=false;break}}while(h.type!==_.EOF&&!(h.type===_.END_BLOCK&&h.opened===e))}if((this._options.brace_style==="expand"||this._options.brace_style==="none"&&e.newlines)&&!this._flags.inline_frame){if(this._flags.last_token.type!==_.OPERATOR&&(o||this._flags.last_token.type===_.EQUALS||reserved_array(this._flags.last_token,m)&&this._flags.last_token.text!=="else")){this._output.space_before_token=true}else{this.print_newline(false,true)}}else{if(is_array(this._previous_flags.mode)&&(this._flags.last_token.type===_.START_EXPR||this._flags.last_token.type===_.COMMA)){if(this._flags.last_token.type===_.COMMA||this._options.space_in_paren){this._output.space_before_token=true}if(this._flags.last_token.type===_.COMMA||this._flags.last_token.type===_.START_EXPR&&this._flags.inline_frame){this.allow_wrap_or_preserved_newline(e);this._previous_flags.multiline_frame=this._previous_flags.multiline_frame||this._flags.multiline_frame;this._flags.multiline_frame=false}}if(this._flags.last_token.type!==_.OPERATOR&&this._flags.last_token.type!==_.START_EXPR){if(in_array(this._flags.last_token.type,[_.START_BLOCK,_.SEMICOLON])&&!this._flags.inline_frame){this.print_newline()}else{this._output.space_before_token=true}}}this.print_token(e);this.indent();if(!r&&!(this._options.brace_preserve_inline&&this._flags.inline_frame)){this.print_newline()}};Beautifier.prototype.handle_end_block=function(e){this.handle_whitespace_and_comments(e);while(this._flags.mode===v.Statement){this.restore_mode()}var t=this._flags.last_token.type===_.START_BLOCK;if(this._flags.inline_frame&&!t){this._output.space_before_token=true}else if(this._options.brace_style==="expand"){if(!t){this.print_newline()}}else{if(!t){if(is_array(this._flags.mode)&&this._options.keep_array_indentation){this._options.keep_array_indentation=false;this.print_newline();this._options.keep_array_indentation=true}else{this.print_newline()}}}this.restore_mode();this.print_token(e)};Beautifier.prototype.handle_word=function(e){if(e.type===_.RESERVED){if(in_array(e.text,["set","get"])&&this._flags.mode!==v.ObjectLiteral){e.type=_.WORD}else if(e.text==="import"&&in_array(this._tokens.peek().text,["(","."])){e.type=_.WORD}else if(in_array(e.text,["as","from"])&&!this._flags.import_block){e.type=_.WORD}else if(this._flags.mode===v.ObjectLiteral){var t=this._tokens.peek();if(t.text===":"){e.type=_.WORD}}}if(this.start_of_statement(e)){if(reserved_array(this._flags.last_token,["var","let","const"])&&e.type===_.WORD){this._flags.declaration_statement=true}}else if(e.newlines&&!is_expression(this._flags.mode)&&(this._flags.last_token.type!==_.OPERATOR||(this._flags.last_token.text==="--"||this._flags.last_token.text==="++"))&&this._flags.last_token.type!==_.EQUALS&&(this._options.preserve_newlines||!reserved_array(this._flags.last_token,["var","let","const","set","get"]))){this.handle_whitespace_and_comments(e);this.print_newline()}else{this.handle_whitespace_and_comments(e)}if(this._flags.do_block&&!this._flags.do_while){if(reserved_word(e,"while")){this._output.space_before_token=true;this.print_token(e);this._output.space_before_token=true;this._flags.do_while=true;return}else{this.print_newline();this._flags.do_block=false}}if(this._flags.if_block){if(!this._flags.else_block&&reserved_word(e,"else")){this._flags.else_block=true}else{while(this._flags.mode===v.Statement){this.restore_mode()}this._flags.if_block=false;this._flags.else_block=false}}if(this._flags.in_case_statement&&reserved_array(e,["case","default"])){this.print_newline();if(!this._flags.case_block&&(this._flags.case_body||this._options.jslint_happy)){this.deindent()}this._flags.case_body=false;this.print_token(e);this._flags.in_case=true;return}if(this._flags.last_token.type===_.COMMA||this._flags.last_token.type===_.START_EXPR||this._flags.last_token.type===_.EQUALS||this._flags.last_token.type===_.OPERATOR){if(!this.start_of_object_property()&&!(in_array(this._flags.last_token.text,["+","-"])&&this._last_last_text===":"&&this._flags.parent.mode===v.ObjectLiteral)){this.allow_wrap_or_preserved_newline(e)}}if(reserved_word(e,"function")){if(in_array(this._flags.last_token.text,["}",";"])||this._output.just_added_newline()&&!(in_array(this._flags.last_token.text,["(","[","{",":","=",","])||this._flags.last_token.type===_.OPERATOR)){if(!this._output.just_added_blankline()&&!e.comments_before){this.print_newline();this.print_newline(true)}}if(this._flags.last_token.type===_.RESERVED||this._flags.last_token.type===_.WORD){if(reserved_array(this._flags.last_token,["get","set","new","export"])||reserved_array(this._flags.last_token,E)){this._output.space_before_token=true}else if(reserved_word(this._flags.last_token,"default")&&this._last_last_text==="export"){this._output.space_before_token=true}else if(this._flags.last_token.text==="declare"){this._output.space_before_token=true}else{this.print_newline()}}else if(this._flags.last_token.type===_.OPERATOR||this._flags.last_token.text==="="){this._output.space_before_token=true}else if(!this._flags.multiline_frame&&(is_expression(this._flags.mode)||is_array(this._flags.mode))){}else{this.print_newline()}this.print_token(e);this._flags.last_word=e.text;return}var n="NONE";if(this._flags.last_token.type===_.END_BLOCK){if(this._previous_flags.inline_frame){n="SPACE"}else if(!reserved_array(e,["else","catch","finally","from"])){n="NEWLINE"}else{if(this._options.brace_style==="expand"||this._options.brace_style==="end-expand"||this._options.brace_style==="none"&&e.newlines){n="NEWLINE"}else{n="SPACE";this._output.space_before_token=true}}}else if(this._flags.last_token.type===_.SEMICOLON&&this._flags.mode===v.BlockStatement){n="NEWLINE"}else if(this._flags.last_token.type===_.SEMICOLON&&is_expression(this._flags.mode)){n="SPACE"}else if(this._flags.last_token.type===_.STRING){n="NEWLINE"}else if(this._flags.last_token.type===_.RESERVED||this._flags.last_token.type===_.WORD||this._flags.last_token.text==="*"&&(in_array(this._last_last_text,["function","yield"])||this._flags.mode===v.ObjectLiteral&&in_array(this._last_last_text,["{",","]))){n="SPACE"}else if(this._flags.last_token.type===_.START_BLOCK){if(this._flags.inline_frame){n="SPACE"}else{n="NEWLINE"}}else if(this._flags.last_token.type===_.END_EXPR){this._output.space_before_token=true;n="NEWLINE"}if(reserved_array(e,p)&&this._flags.last_token.text!==")"){if(this._flags.inline_frame||this._flags.last_token.text==="else"||this._flags.last_token.text==="export"){n="SPACE"}else{n="NEWLINE"}}if(reserved_array(e,["else","catch","finally"])){if((!(this._flags.last_token.type===_.END_BLOCK&&this._previous_flags.mode===v.BlockStatement)||this._options.brace_style==="expand"||this._options.brace_style==="end-expand"||this._options.brace_style==="none"&&e.newlines)&&!this._flags.inline_frame){this.print_newline()}else{this._output.trim(true);var r=this._output.current_line;if(r.last()!=="}"){this.print_newline()}this._output.space_before_token=true}}else if(n==="NEWLINE"){if(reserved_array(this._flags.last_token,m)){this._output.space_before_token=true}else if(this._flags.last_token.text==="declare"&&reserved_array(e,["var","let","const"])){this._output.space_before_token=true}else if(this._flags.last_token.type!==_.END_EXPR){if((this._flags.last_token.type!==_.START_EXPR||!reserved_array(e,["var","let","const"]))&&this._flags.last_token.text!==":"){if(reserved_word(e,"if")&&reserved_word(e.previous,"else")){this._output.space_before_token=true}else{this.print_newline()}}}else if(reserved_array(e,p)&&this._flags.last_token.text!==")"){this.print_newline()}}else if(this._flags.multiline_frame&&is_array(this._flags.mode)&&this._flags.last_token.text===","&&this._last_last_text==="}"){this.print_newline()}else if(n==="SPACE"){this._output.space_before_token=true}if(e.previous&&(e.previous.type===_.WORD||e.previous.type===_.RESERVED)){this._output.space_before_token=true}this.print_token(e);this._flags.last_word=e.text;if(e.type===_.RESERVED){if(e.text==="do"){this._flags.do_block=true}else if(e.text==="if"){this._flags.if_block=true}else if(e.text==="import"){this._flags.import_block=true}else if(this._flags.import_block&&reserved_word(e,"from")){this._flags.import_block=false}}};Beautifier.prototype.handle_semicolon=function(e){if(this.start_of_statement(e)){this._output.space_before_token=false}else{this.handle_whitespace_and_comments(e)}var t=this._tokens.peek();while(this._flags.mode===v.Statement&&!(this._flags.if_block&&reserved_word(t,"else"))&&!this._flags.do_block){this.restore_mode()}if(this._flags.import_block){this._flags.import_block=false}this.print_token(e)};Beautifier.prototype.handle_string=function(e){if(e.text.startsWith("`")&&e.newlines===0&&e.whitespace_before===""&&(e.previous.text===")"||this._flags.last_token.type===_.WORD)){}else if(this.start_of_statement(e)){this._output.space_before_token=true}else{this.handle_whitespace_and_comments(e);if(this._flags.last_token.type===_.RESERVED||this._flags.last_token.type===_.WORD||this._flags.inline_frame){this._output.space_before_token=true}else if(this._flags.last_token.type===_.COMMA||this._flags.last_token.type===_.START_EXPR||this._flags.last_token.type===_.EQUALS||this._flags.last_token.type===_.OPERATOR){if(!this.start_of_object_property()){this.allow_wrap_or_preserved_newline(e)}}else if(e.text.startsWith("`")&&this._flags.last_token.type===_.END_EXPR&&(e.previous.text==="]"||e.previous.text===")")&&e.newlines===0){this._output.space_before_token=true}else{this.print_newline()}}this.print_token(e)};Beautifier.prototype.handle_equals=function(e){if(this.start_of_statement(e)){}else{this.handle_whitespace_and_comments(e)}if(this._flags.declaration_statement){this._flags.declaration_assignment=true}this._output.space_before_token=true;this.print_token(e);this._output.space_before_token=true};Beautifier.prototype.handle_comma=function(e){this.handle_whitespace_and_comments(e,true);this.print_token(e);this._output.space_before_token=true;if(this._flags.declaration_statement){if(is_expression(this._flags.parent.mode)){this._flags.declaration_assignment=false}if(this._flags.declaration_assignment){this._flags.declaration_assignment=false;this.print_newline(false,true)}else if(this._options.comma_first){this.allow_wrap_or_preserved_newline(e)}}else if(this._flags.mode===v.ObjectLiteral||this._flags.mode===v.Statement&&this._flags.parent.mode===v.ObjectLiteral){if(this._flags.mode===v.Statement){this.restore_mode()}if(!this._flags.inline_frame){this.print_newline()}}else if(this._options.comma_first){this.allow_wrap_or_preserved_newline(e)}};Beautifier.prototype.handle_operator=function(e){var t=e.text==="*"&&(reserved_array(this._flags.last_token,["function","yield"])||in_array(this._flags.last_token.type,[_.START_BLOCK,_.COMMA,_.END_BLOCK,_.SEMICOLON]));var n=in_array(e.text,["-","+"])&&(in_array(this._flags.last_token.type,[_.START_BLOCK,_.START_EXPR,_.EQUALS,_.OPERATOR])||in_array(this._flags.last_token.text,p)||this._flags.last_token.text===",");if(this.start_of_statement(e)){}else{var r=!t;this.handle_whitespace_and_comments(e,r)}if(e.text==="*"&&this._flags.last_token.type===_.DOT){this.print_token(e);return}if(e.text==="::"){this.print_token(e);return}if(in_array(e.text,["-","+"])&&this.start_of_object_property()){this.print_token(e);return}if(this._flags.last_token.type===_.OPERATOR&&in_array(this._options.operator_position,b)){this.allow_wrap_or_preserved_newline(e)}if(e.text===":"&&this._flags.in_case){this.print_token(e);this._flags.in_case=false;this._flags.case_body=true;if(this._tokens.peek().type!==_.START_BLOCK){this.indent();this.print_newline();this._flags.case_block=false}else{this._flags.case_block=true;this._output.space_before_token=true}return}var o=true;var l=true;var h=false;if(e.text===":"){if(this._flags.ternary_depth===0){o=false}else{this._flags.ternary_depth-=1;h=true}}else if(e.text==="?"){this._flags.ternary_depth+=1}if(!n&&!t&&this._options.preserve_newlines&&in_array(e.text,d)){var f=e.text===":";var g=f&&h;var E=f&&!h;switch(this._options.operator_position){case y.before_newline:this._output.space_before_token=!E;this.print_token(e);if(!f||g){this.allow_wrap_or_preserved_newline(e)}this._output.space_before_token=true;return;case y.after_newline:this._output.space_before_token=true;if(!f||g){if(this._tokens.peek().newlines){this.print_newline(false,true)}else{this.allow_wrap_or_preserved_newline(e)}}else{this._output.space_before_token=false}this.print_token(e);this._output.space_before_token=true;return;case y.preserve_newline:if(!E){this.allow_wrap_or_preserved_newline(e)}o=!(this._output.just_added_newline()||E);this._output.space_before_token=o;this.print_token(e);this._output.space_before_token=true;return}}if(t){this.allow_wrap_or_preserved_newline(e);o=false;var k=this._tokens.peek();l=k&&in_array(k.type,[_.WORD,_.RESERVED])}else if(e.text==="..."){this.allow_wrap_or_preserved_newline(e);o=this._flags.last_token.type===_.START_BLOCK;l=false}else if(in_array(e.text,["--","++","!","~"])||n){if(this._flags.last_token.type===_.COMMA||this._flags.last_token.type===_.START_EXPR){this.allow_wrap_or_preserved_newline(e)}o=false;l=false;if(e.newlines&&(e.text==="--"||e.text==="++"||e.text==="~")){var O=reserved_array(this._flags.last_token,m)&&e.newlines;if(O&&(this._previous_flags.if_block||this._previous_flags.else_block)){this.restore_mode()}this.print_newline(O,true)}if(this._flags.last_token.text===";"&&is_expression(this._flags.mode)){o=true}if(this._flags.last_token.type===_.RESERVED){o=true}else if(this._flags.last_token.type===_.END_EXPR){o=!(this._flags.last_token.text==="]"&&(e.text==="--"||e.text==="++"))}else if(this._flags.last_token.type===_.OPERATOR){o=in_array(e.text,["--","-","++","+"])&&in_array(this._flags.last_token.text,["--","-","++","+"]);if(in_array(e.text,["+","-"])&&in_array(this._flags.last_token.text,["--","++"])){l=true}}if((this._flags.mode===v.BlockStatement&&!this._flags.inline_frame||this._flags.mode===v.Statement)&&(this._flags.last_token.text==="{"||this._flags.last_token.text===";")){this.print_newline()}}this._output.space_before_token=this._output.space_before_token||o;this.print_token(e);this._output.space_before_token=l};Beautifier.prototype.handle_block_comment=function(e,t){if(this._output.raw){this._output.add_raw_token(e);if(e.directives&&e.directives.preserve==="end"){this._output.raw=this._options.test_output_raw}return}if(e.directives){this.print_newline(false,t);this.print_token(e);if(e.directives.preserve==="start"){this._output.raw=true}this.print_newline(false,true);return}if(!l.newline.test(e.text)&&!e.newlines){this._output.space_before_token=true;this.print_token(e);this._output.space_before_token=true;return}else{this.print_block_commment(e,t)}};Beautifier.prototype.print_block_commment=function(e,t){var n=split_linebreaks(e.text);var r;var o=false;var l=false;var h=e.whitespace_before;var f=h.length;this.print_newline(false,t);this.print_token_line_indentation(e);this._output.add_token(n[0]);this.print_newline(false,t);if(n.length>1){n=n.slice(1);o=all_lines_start_with(n,"*");l=each_line_matches_indent(n,h);if(o){this._flags.alignment=1}for(r=0;r<n.length;r++){if(o){this.print_token_line_indentation(e);this._output.add_token(ltrim(n[r]))}else if(l&&n[r]){this.print_token_line_indentation(e);this._output.add_token(n[r].substring(f))}else{this._output.current_line.set_indent(-1);this._output.add_token(n[r])}this.print_newline(false,t)}this._flags.alignment=0}};Beautifier.prototype.handle_comment=function(e,t){if(e.newlines){this.print_newline(false,t)}else{this._output.trim(true)}this._output.space_before_token=true;this.print_token(e);this.print_newline(false,t)};Beautifier.prototype.handle_dot=function(e){if(this.start_of_statement(e)){}else{this.handle_whitespace_and_comments(e,true)}if(this._flags.last_token.text.match("^[0-9]+$")){this._output.space_before_token=true}if(reserved_array(this._flags.last_token,m)){this._output.space_before_token=false}else{this.allow_wrap_or_preserved_newline(e,this._flags.last_token.text===")"&&this._options.break_chained_methods)}if(this._options.unindent_chained_methods&&this._output.just_added_newline()){this.deindent()}this.print_token(e)};Beautifier.prototype.handle_unknown=function(e,t){this.print_token(e);if(e.text[e.text.length-1]==="\n"){this.print_newline(false,t)}};Beautifier.prototype.handle_eof=function(e){while(this._flags.mode===v.Statement){this.restore_mode()}this.handle_whitespace_and_comments(e)};e.exports.P=Beautifier},611:(e,t,n)=>{var r=n(877).P,o=n(833).J;function js_beautify(e,t){var n=new r(e,t);return n.beautify()}e.exports=js_beautify;e.exports.defaultOptions=function(){return new o}},833:(e,t,n)=>{var r=n(301).JY;var o=["before-newline","after-newline","preserve-newline"];function Options(e){r.call(this,e,"js");var t=this.raw_options.brace_style||null;if(t==="expand-strict"){this.raw_options.brace_style="expand"}else if(t==="collapse-preserve-inline"){this.raw_options.brace_style="collapse,preserve-inline"}else if(this.raw_options.braces_on_own_line!==undefined){this.raw_options.brace_style=this.raw_options.braces_on_own_line?"expand":"collapse"}var n=this._get_selection_list("brace_style",["collapse","expand","end-expand","none","preserve-inline"]);this.brace_preserve_inline=false;this.brace_style="collapse";for(var l=0;l<n.length;l++){if(n[l]==="preserve-inline"){this.brace_preserve_inline=true}else{this.brace_style=n[l]}}this.unindent_chained_methods=this._get_boolean("unindent_chained_methods");this.break_chained_methods=this._get_boolean("break_chained_methods");this.space_in_paren=this._get_boolean("space_in_paren");this.space_in_empty_paren=this._get_boolean("space_in_empty_paren");this.jslint_happy=this._get_boolean("jslint_happy");this.space_after_anon_function=this._get_boolean("space_after_anon_function");this.space_after_named_function=this._get_boolean("space_after_named_function");this.keep_array_indentation=this._get_boolean("keep_array_indentation");this.space_before_conditional=this._get_boolean("space_before_conditional",true);this.unescape_strings=this._get_boolean("unescape_strings");this.e4x=this._get_boolean("e4x");this.comma_first=this._get_boolean("comma_first");this.operator_position=this._get_selection("operator_position",o);this.test_output_raw=this._get_boolean("test_output_raw");if(this.jslint_happy){this.space_after_anon_function=true}}Options.prototype=new r;e.exports.J=Options},982:(e,t,n)=>{var r=n(713).z;var o=n(170)._;var l=n(170).C;var h=n(657).D;var f=n(434);var p=n(569).z;var d=n(392).i;function in_array(e,t){return t.indexOf(e)!==-1}var _={START_EXPR:"TK_START_EXPR",END_EXPR:"TK_END_EXPR",START_BLOCK:"TK_START_BLOCK",END_BLOCK:"TK_END_BLOCK",WORD:"TK_WORD",RESERVED:"TK_RESERVED",SEMICOLON:"TK_SEMICOLON",STRING:"TK_STRING",EQUALS:"TK_EQUALS",OPERATOR:"TK_OPERATOR",COMMA:"TK_COMMA",BLOCK_COMMENT:"TK_BLOCK_COMMENT",COMMENT:"TK_COMMENT",DOT:"TK_DOT",UNKNOWN:"TK_UNKNOWN",START:l.START,RAW:l.RAW,EOF:l.EOF};var m=new h(/\/\*/,/\*\//);var g=/0[xX][0123456789abcdefABCDEF_]*n?|0[oO][01234567_]*n?|0[bB][01_]*n?|\d[\d_]*n|(?:\.\d[\d_]*|\d[\d_]*\.?[\d_]*)(?:[eE][+-]?[\d_]+)?/;var y=/[0-9]/;var b=/[^\d\.]/;var v=(">>> === !== &&= ??= ||= "+"<< && >= ** != == <= >> || ?? |> "+"< / - + > : & % ? ^ | *").split(" ");var E=">>>= "+"... >>= <<= === >>> !== **= &&= ??= ||= "+"=> ^= :: /= << <= == && -= >= >> != -- += ** || ?? ++ %= &= *= |= |> "+"= ! ? > < : / ^ - + * & % ~ |";E=E.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&");E="\\?\\.(?!\\d) "+E;E=E.replace(/ /g,"|");var k=new RegExp(E);var O="continue,try,throw,return,var,let,const,if,switch,case,default,for,while,break,function,import,export".split(",");var x=O.concat(["do","in","of","else","get","set","new","catch","finally","typeof","yield","async","await","from","as","class","extends"]);var A=new RegExp("^(?:"+x.join("|")+")$");var w;var Tokenizer=function(e,t){o.call(this,e,t);this._patterns.whitespace=this._patterns.whitespace.matching(/\u00A0\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff/.source,/\u2028\u2029/.source);var n=new p(this._input);var r=new d(this._input).read_options(this._options);this.__patterns={template:r,identifier:r.starting_with(f.identifier).matching(f.identifierMatch),number:n.matching(g),punct:n.matching(k),comment:n.starting_with(/\/\//).until(/[\n\r\u2028\u2029]/),block_comment:n.starting_with(/\/\*/).until_after(/\*\//),html_comment_start:n.matching(/<!--/),html_comment_end:n.matching(/-->/),include:n.starting_with(/#include/).until_after(f.lineBreak),shebang:n.starting_with(/#!/).until_after(f.lineBreak),xml:n.matching(/[\s\S]*?<(\/?)([-a-zA-Z:0-9_.]+|{[^}]+?}|!\[CDATA\[[^\]]*?\]\]|)(\s*{[^}]+?}|\s+[-a-zA-Z:0-9_.]+|\s+[-a-zA-Z:0-9_.]+\s*=\s*('[^']*'|"[^"]*"|{([^{}]|{[^}]+?})+?}))*\s*(\/?)\s*>/),single_quote:r.until(/['\\\n\r\u2028\u2029]/),double_quote:r.until(/["\\\n\r\u2028\u2029]/),template_text:r.until(/[`\\$]/),template_expression:r.until(/[`}\\]/)}};Tokenizer.prototype=new o;Tokenizer.prototype._is_comment=function(e){return e.type===_.COMMENT||e.type===_.BLOCK_COMMENT||e.type===_.UNKNOWN};Tokenizer.prototype._is_opening=function(e){return e.type===_.START_BLOCK||e.type===_.START_EXPR};Tokenizer.prototype._is_closing=function(e,t){return(e.type===_.END_BLOCK||e.type===_.END_EXPR)&&(t&&(e.text==="]"&&t.text==="["||e.text===")"&&t.text==="("||e.text==="}"&&t.text==="{"))};Tokenizer.prototype._reset=function(){w=false};Tokenizer.prototype._get_next_token=function(e,t){var n=null;this._readWhitespace();var r=this._input.peek();if(r===null){return this._create_token(_.EOF,"")}n=n||this._read_non_javascript(r);n=n||this._read_string(r);n=n||this._read_pair(r,this._input.peek(1));n=n||this._read_word(e);n=n||this._read_singles(r);n=n||this._read_comment(r);n=n||this._read_regexp(r,e);n=n||this._read_xml(r,e);n=n||this._read_punctuation();n=n||this._create_token(_.UNKNOWN,this._input.next());return n};Tokenizer.prototype._read_word=function(e){var t;t=this.__patterns.identifier.read();if(t!==""){t=t.replace(f.allLineBreaks,"\n");if(!(e.type===_.DOT||e.type===_.RESERVED&&(e.text==="set"||e.text==="get"))&&A.test(t)){if((t==="in"||t==="of")&&(e.type===_.WORD||e.type===_.STRING)){return this._create_token(_.OPERATOR,t)}return this._create_token(_.RESERVED,t)}return this._create_token(_.WORD,t)}t=this.__patterns.number.read();if(t!==""){return this._create_token(_.WORD,t)}};Tokenizer.prototype._read_singles=function(e){var t=null;if(e==="("||e==="["){t=this._create_token(_.START_EXPR,e)}else if(e===")"||e==="]"){t=this._create_token(_.END_EXPR,e)}else if(e==="{"){t=this._create_token(_.START_BLOCK,e)}else if(e==="}"){t=this._create_token(_.END_BLOCK,e)}else if(e===";"){t=this._create_token(_.SEMICOLON,e)}else if(e==="."&&b.test(this._input.peek(1))){t=this._create_token(_.DOT,e)}else if(e===","){t=this._create_token(_.COMMA,e)}if(t){this._input.next()}return t};Tokenizer.prototype._read_pair=function(e,t){var n=null;if(e==="#"&&t==="{"){n=this._create_token(_.START_BLOCK,e+t)}if(n){this._input.next();this._input.next()}return n};Tokenizer.prototype._read_punctuation=function(){var e=this.__patterns.punct.read();if(e!==""){if(e==="="){return this._create_token(_.EQUALS,e)}else if(e==="?."){return this._create_token(_.DOT,e)}else{return this._create_token(_.OPERATOR,e)}}};Tokenizer.prototype._read_non_javascript=function(e){var t="";if(e==="#"){if(this._is_first_token()){t=this.__patterns.shebang.read();if(t){return this._create_token(_.UNKNOWN,t.trim()+"\n")}}t=this.__patterns.include.read();if(t){return this._create_token(_.UNKNOWN,t.trim()+"\n")}e=this._input.next();var n="#";if(this._input.hasNext()&&this._input.testChar(y)){do{e=this._input.next();n+=e}while(this._input.hasNext()&&e!=="#"&&e!=="=");if(e==="#"){}else if(this._input.peek()==="["&&this._input.peek(1)==="]"){n+="[]";this._input.next();this._input.next()}else if(this._input.peek()==="{"&&this._input.peek(1)==="}"){n+="{}";this._input.next();this._input.next()}return this._create_token(_.WORD,n)}this._input.back()}else if(e==="<"&&this._is_first_token()){t=this.__patterns.html_comment_start.read();if(t){while(this._input.hasNext()&&!this._input.testChar(f.newline)){t+=this._input.next()}w=true;return this._create_token(_.COMMENT,t)}}else if(w&&e==="-"){t=this.__patterns.html_comment_end.read();if(t){w=false;return this._create_token(_.COMMENT,t)}}return null};Tokenizer.prototype._read_comment=function(e){var t=null;if(e==="/"){var n="";if(this._input.peek(1)==="*"){n=this.__patterns.block_comment.read();var r=m.get_directives(n);if(r&&r.ignore==="start"){n+=m.readIgnored(this._input)}n=n.replace(f.allLineBreaks,"\n");t=this._create_token(_.BLOCK_COMMENT,n);t.directives=r}else if(this._input.peek(1)==="/"){n=this.__patterns.comment.read();t=this._create_token(_.COMMENT,n)}}return t};Tokenizer.prototype._read_string=function(e){if(e==="`"||e==="'"||e==='"'){var t=this._input.next();this.has_char_escapes=false;if(e==="`"){t+=this._read_string_recursive("`",true,"${")}else{t+=this._read_string_recursive(e)}if(this.has_char_escapes&&this._options.unescape_strings){t=unescape_string(t)}if(this._input.peek()===e){t+=this._input.next()}t=t.replace(f.allLineBreaks,"\n");return this._create_token(_.STRING,t)}return null};Tokenizer.prototype._allow_regexp_or_xml=function(e){return e.type===_.RESERVED&&in_array(e.text,["return","case","throw","else","do","typeof","yield"])||e.type===_.END_EXPR&&e.text===")"&&e.opened.previous.type===_.RESERVED&&in_array(e.opened.previous.text,["if","while","for"])||in_array(e.type,[_.COMMENT,_.START_EXPR,_.START_BLOCK,_.START,_.END_BLOCK,_.OPERATOR,_.EQUALS,_.EOF,_.SEMICOLON,_.COMMA])};Tokenizer.prototype._read_regexp=function(e,t){if(e==="/"&&this._allow_regexp_or_xml(t)){var n=this._input.next();var r=false;var o=false;while(this._input.hasNext()&&((r||o||this._input.peek()!==e)&&!this._input.testChar(f.newline))){n+=this._input.peek();if(!r){r=this._input.peek()==="\\";if(this._input.peek()==="["){o=true}else if(this._input.peek()==="]"){o=false}}else{r=false}this._input.next()}if(this._input.peek()===e){n+=this._input.next();n+=this._input.read(f.identifier)}return this._create_token(_.STRING,n)}return null};Tokenizer.prototype._read_xml=function(e,t){if(this._options.e4x&&e==="<"&&this._allow_regexp_or_xml(t)){var n="";var r=this.__patterns.xml.read_match();if(r){var o=r[2].replace(/^{\s+/,"{").replace(/\s+}$/,"}");var l=o.indexOf("{")===0;var h=0;while(r){var p=!!r[1];var d=r[2];var m=!!r[r.length-1]||d.slice(0,8)==="![CDATA[";if(!m&&(d===o||l&&d.replace(/^{\s+/,"{").replace(/\s+}$/,"}"))){if(p){--h}else{++h}}n+=r[0];if(h<=0){break}r=this.__patterns.xml.read_match()}if(!r){n+=this._input.match(/[\s\S]*/g)[0]}n=n.replace(f.allLineBreaks,"\n");return this._create_token(_.STRING,n)}}return null};function unescape_string(e){var t="",n=0;var o=new r(e);var l=null;while(o.hasNext()){l=o.match(/([\s]|[^\\]|\\\\)+/g);if(l){t+=l[0]}if(o.peek()==="\\"){o.next();if(o.peek()==="x"){l=o.match(/x([0-9A-Fa-f]{2})/g)}else if(o.peek()==="u"){l=o.match(/u([0-9A-Fa-f]{4})/g);if(!l){l=o.match(/u\{([0-9A-Fa-f]+)\}/g)}}else{t+="\\";if(o.hasNext()){t+=o.next()}continue}if(!l){return e}n=parseInt(l[1],16);if(n>126&&n<=255&&l[0].indexOf("x")===0){return e}else if(n>=0&&n<32){t+="\\"+l[0]}else if(n>1114111){t+="\\"+l[0]}else if(n===34||n===39||n===92){t+="\\"+String.fromCharCode(n)}else{t+=String.fromCharCode(n)}}}return t}Tokenizer.prototype._read_string_recursive=function(e,t,n){var r;var o;if(e==="'"){o=this.__patterns.single_quote}else if(e==='"'){o=this.__patterns.double_quote}else if(e==="`"){o=this.__patterns.template_text}else if(e==="}"){o=this.__patterns.template_expression}var l=o.read();var h="";while(this._input.hasNext()){h=this._input.next();if(h===e||!t&&f.newline.test(h)){this._input.back();break}else if(h==="\\"&&this._input.hasNext()){r=this._input.peek();if(r==="x"||r==="u"){this.has_char_escapes=true}else if(r==="\r"&&this._input.peek(1)==="\n"){this._input.next()}h+=this._input.next()}else if(n){if(n==="${"&&h==="$"&&this._input.peek()==="{"){h+=this._input.next()}if(n===h){if(e==="`"){h+=this._read_string_recursive("}",t,"`")}else{h+=this._read_string_recursive("`",t,"${")}if(this._input.hasNext()){h+=this._input.next()}}}h+=o.read();l+=h}return l};e.exports._F=Tokenizer;e.exports.CV=_;e.exports.OK=v.slice();e.exports.O0=O.slice()},299:function(e,t,n){
/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/
(function(t,n){if(typeof define==="function"&&define.amd){define([],n)}else if(true){e.exports=n()}else{}})(this,(function moduleFactory(){"use strict";var e=function(){if(typeof self!=="undefined"){return self}if(typeof window!=="undefined"){return window}if(typeof e!=="undefined"){return e}return{}}();function getWorkerBlob(){var t=e.URL||e.webkitURL||null;var n=moduleFactory.toString();return h.BLOB_URL||(h.BLOB_URL=t.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",n,")();"],{type:"text/javascript"})))}var t=!e.document&&!!e.postMessage,r=e.IS_PAPA_WORKER||false;var o={},l=0;var h={};h.parse=CsvToJson;h.unparse=JsonToCsv;h.RECORD_SEP=String.fromCharCode(30);h.UNIT_SEP=String.fromCharCode(31);h.BYTE_ORDER_MARK="\ufeff";h.BAD_DELIMITERS=["\r","\n",'"',h.BYTE_ORDER_MARK];h.WORKERS_SUPPORTED=!t&&!!e.Worker;h.NODE_STREAM_INPUT=1;h.LocalChunkSize=1024*1024*10;h.RemoteChunkSize=1024*1024*5;h.DefaultDelimiter=",";h.Parser=Parser;h.ParserHandle=ParserHandle;h.NetworkStreamer=NetworkStreamer;h.FileStreamer=FileStreamer;h.StringStreamer=StringStreamer;h.ReadableStreamStreamer=ReadableStreamStreamer;if(typeof PAPA_BROWSER_CONTEXT==="undefined"){h.DuplexStreamStreamer=DuplexStreamStreamer}if(e.jQuery){var f=e.jQuery;f.fn.parse=function(t){var n=t.config||{};var r=[];this.each((function(t){var o=f(this).prop("tagName").toUpperCase()==="INPUT"&&f(this).attr("type").toLowerCase()==="file"&&e.FileReader;if(!o||!this.files||this.files.length===0)return true;for(var l=0;l<this.files.length;l++){r.push({file:this.files[l],inputElem:this,instanceConfig:f.extend({},n)})}}));parseNextFile();return this;function parseNextFile(){if(r.length===0){if(isFunction(t.complete))t.complete();return}var e=r[0];if(isFunction(t.before)){var n=t.before(e.file,e.inputElem);if(typeof n==="object"){if(n.action==="abort"){error("AbortError",e.file,e.inputElem,n.reason);return}else if(n.action==="skip"){fileComplete();return}else if(typeof n.config==="object")e.instanceConfig=f.extend(e.instanceConfig,n.config)}else if(n==="skip"){fileComplete();return}}var o=e.instanceConfig.complete;e.instanceConfig.complete=function(t){if(isFunction(o))o(t,e.file,e.inputElem);fileComplete()};h.parse(e.file,e.instanceConfig)}function error(e,n,r,o){if(isFunction(t.error))t.error({name:e},n,r,o)}function fileComplete(){r.splice(0,1);parseNextFile()}}}if(r){e.onmessage=workerThreadReceivedMessage}function CsvToJson(t,n){n=n||{};var r=n.dynamicTyping||false;if(isFunction(r)){n.dynamicTypingFunction=r;r={}}n.dynamicTyping=r;n.transform=isFunction(n.transform)?n.transform:false;if(n.worker&&h.WORKERS_SUPPORTED){var o=newWorker();o.userStep=n.step;o.userChunk=n.chunk;o.userComplete=n.complete;o.userError=n.error;n.step=isFunction(n.step);n.chunk=isFunction(n.chunk);n.complete=isFunction(n.complete);n.error=isFunction(n.error);delete n.worker;o.postMessage({input:t,config:n,workerId:o.id});return}var l=null;if(t===h.NODE_STREAM_INPUT&&typeof PAPA_BROWSER_CONTEXT==="undefined"){l=new DuplexStreamStreamer(n);return l.getStream()}else if(typeof t==="string"){t=stripBom(t);if(n.download)l=new NetworkStreamer(n);else l=new StringStreamer(n)}else if(t.readable===true&&isFunction(t.read)&&isFunction(t.on)){l=new ReadableStreamStreamer(n)}else if(e.File&&t instanceof File||t instanceof Object)l=new FileStreamer(n);return l.stream(t);function stripBom(e){if(e.charCodeAt(0)===65279){return e.slice(1)}return e}}function JsonToCsv(e,t){var n=false;var r=true;var o=",";var l="\r\n";var f='"';var p=f+f;var d=false;var _=null;var m=false;unpackConfig();var g=new RegExp(escapeRegExp(f),"g");if(typeof e==="string")e=JSON.parse(e);if(Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return serialize(null,e,d);else if(typeof e[0]==="object")return serialize(_||Object.keys(e[0]),e,d)}else if(typeof e==="object"){if(typeof e.data==="string")e.data=JSON.parse(e.data);if(Array.isArray(e.data)){if(!e.fields)e.fields=e.meta&&e.meta.fields||_;if(!e.fields)e.fields=Array.isArray(e.data[0])?e.fields:typeof e.data[0]==="object"?Object.keys(e.data[0]):[];if(!Array.isArray(e.data[0])&&typeof e.data[0]!=="object")e.data=[e.data]}return serialize(e.fields||[],e.data||[],d)}throw new Error("Unable to serialize unrecognized input");function unpackConfig(){if(typeof t!=="object")return;if(typeof t.delimiter==="string"&&!h.BAD_DELIMITERS.filter((function(e){return t.delimiter.indexOf(e)!==-1})).length){o=t.delimiter}if(typeof t.quotes==="boolean"||typeof t.quotes==="function"||Array.isArray(t.quotes))n=t.quotes;if(typeof t.skipEmptyLines==="boolean"||typeof t.skipEmptyLines==="string")d=t.skipEmptyLines;if(typeof t.newline==="string")l=t.newline;if(typeof t.quoteChar==="string")f=t.quoteChar;if(typeof t.header==="boolean")r=t.header;if(Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");_=t.columns}if(t.escapeChar!==undefined){p=t.escapeChar+f}if(t.escapeFormulae instanceof RegExp){m=t.escapeFormulae}else if(typeof t.escapeFormulae==="boolean"&&t.escapeFormulae){m=/^[=+\-@\t\r].*$/}}function serialize(e,t,n){var h="";if(typeof e==="string")e=JSON.parse(e);if(typeof t==="string")t=JSON.parse(t);var f=Array.isArray(e)&&e.length>0;var p=!Array.isArray(t[0]);if(f&&r){for(var d=0;d<e.length;d++){if(d>0)h+=o;h+=safe(e[d],d)}if(t.length>0)h+=l}for(var _=0;_<t.length;_++){var m=f?e.length:t[_].length;var g=false;var y=f?Object.keys(t[_]).length===0:t[_].length===0;if(n&&!f){g=n==="greedy"?t[_].join("").trim()==="":t[_].length===1&&t[_][0].length===0}if(n==="greedy"&&f){var b=[];for(var v=0;v<m;v++){var E=p?e[v]:v;b.push(t[_][E])}g=b.join("").trim()===""}if(!g){for(var k=0;k<m;k++){if(k>0&&!y)h+=o;var O=f&&p?e[k]:k;h+=safe(t[_][O],k)}if(_<t.length-1&&(!n||m>0&&!y)){h+=l}}}return h}function safe(e,t){if(typeof e==="undefined"||e===null)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);var r=false;if(m&&typeof e==="string"&&m.test(e)){e="'"+e;r=true}var l=e.toString().replace(g,p);r=r||n===true||typeof n==="function"&&n(e,t)||Array.isArray(n)&&n[t]||hasAny(l,h.BAD_DELIMITERS)||l.indexOf(o)>-1||l.charAt(0)===" "||l.charAt(l.length-1)===" ";return r?f+l+f:l}function hasAny(e,t){for(var n=0;n<t.length;n++)if(e.indexOf(t[n])>-1)return true;return false}}function ChunkStreamer(t){this._handle=null;this._finished=false;this._completed=false;this._halted=false;this._input=null;this._baseIndex=0;this._partialLine="";this._rowCount=0;this._start=0;this._nextChunk=null;this.isFirstChunk=true;this._completeResults={data:[],errors:[],meta:{}};replaceConfig.call(this,t);this.parseChunk=function(t,n){const o=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&o>0){let e=this._config.newline;if(!e){const n=this._config.quoteChar||'"';e=this._handle.guessLineEndings(t,n)}const n=t.split(e);t=[...n.slice(o)].join(e)}if(this.isFirstChunk&&isFunction(this._config.beforeFirstChunk)){var l=this._config.beforeFirstChunk(t);if(l!==undefined)t=l}this.isFirstChunk=false;this._halted=false;var f=this._partialLine+t;this._partialLine="";var p=this._handle.parse(f,this._baseIndex,!this._finished);if(this._handle.paused()||this._handle.aborted()){this._halted=true;return}var d=p.meta.cursor;if(!this._finished){this._partialLine=f.substring(d-this._baseIndex);this._baseIndex=d}if(p&&p.data)this._rowCount+=p.data.length;var _=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(r){e.postMessage({results:p,workerId:h.WORKER_ID,finished:_})}else if(isFunction(this._config.chunk)&&!n){this._config.chunk(p,this._handle);if(this._handle.paused()||this._handle.aborted()){this._halted=true;return}p=undefined;this._completeResults=undefined}if(!this._config.step&&!this._config.chunk){this._completeResults.data=this._completeResults.data.concat(p.data);this._completeResults.errors=this._completeResults.errors.concat(p.errors);this._completeResults.meta=p.meta}if(!this._completed&&_&&isFunction(this._config.complete)&&(!p||!p.meta.aborted)){this._config.complete(this._completeResults,this._input);this._completed=true}if(!_&&(!p||!p.meta.paused))this._nextChunk();return p};this._sendError=function(t){if(isFunction(this._config.error))this._config.error(t);else if(r&&this._config.error){e.postMessage({workerId:h.WORKER_ID,error:t,finished:false})}};function replaceConfig(e){var t=copy(e);t.chunkSize=parseInt(t.chunkSize);if(!e.step&&!e.chunk)t.chunkSize=null;this._handle=new ParserHandle(t);this._handle.streamer=this;this._config=t}}function NetworkStreamer(e){e=e||{};if(!e.chunkSize)e.chunkSize=h.RemoteChunkSize;ChunkStreamer.call(this,e);var n;if(t){this._nextChunk=function(){this._readChunk();this._chunkLoaded()}}else{this._nextChunk=function(){this._readChunk()}}this.stream=function(e){this._input=e;this._nextChunk()};this._readChunk=function(){if(this._finished){this._chunkLoaded();return}n=new XMLHttpRequest;if(this._config.withCredentials){n.withCredentials=this._config.withCredentials}if(!t){n.onload=bindFunction(this._chunkLoaded,this);n.onerror=bindFunction(this._chunkError,this)}n.open(this._config.downloadRequestBody?"POST":"GET",this._input,!t);if(this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var r in e){n.setRequestHeader(r,e[r])}}if(this._config.chunkSize){var o=this._start+this._config.chunkSize-1;n.setRequestHeader("Range","bytes="+this._start+"-"+o)}try{n.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}if(t&&n.status===0)this._chunkError()};this._chunkLoaded=function(){if(n.readyState!==4)return;if(n.status<200||n.status>=400){this._chunkError();return}this._start+=this._config.chunkSize?this._config.chunkSize:n.responseText.length;this._finished=!this._config.chunkSize||this._start>=getFileSize(n);this.parseChunk(n.responseText)};this._chunkError=function(e){var t=n.statusText||e;this._sendError(new Error(t))};function getFileSize(e){var t=e.getResponseHeader("Content-Range");if(t===null){return-1}return parseInt(t.substring(t.lastIndexOf("/")+1))}}NetworkStreamer.prototype=Object.create(ChunkStreamer.prototype);NetworkStreamer.prototype.constructor=NetworkStreamer;function FileStreamer(e){e=e||{};if(!e.chunkSize)e.chunkSize=h.LocalChunkSize;ChunkStreamer.call(this,e);var t,n;var r=typeof FileReader!=="undefined";this.stream=function(e){this._input=e;n=e.slice||e.webkitSlice||e.mozSlice;if(r){t=new FileReader;t.onload=bindFunction(this._chunkLoaded,this);t.onerror=bindFunction(this._chunkError,this)}else t=new FileReaderSync;this._nextChunk()};this._nextChunk=function(){if(!this._finished&&(!this._config.preview||this._rowCount<this._config.preview))this._readChunk()};this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var o=Math.min(this._start+this._config.chunkSize,this._input.size);e=n.call(e,this._start,o)}var l=t.readAsText(e,this._config.encoding);if(!r)this._chunkLoaded({target:{result:l}})};this._chunkLoaded=function(e){this._start+=this._config.chunkSize;this._finished=!this._config.chunkSize||this._start>=this._input.size;this.parseChunk(e.target.result)};this._chunkError=function(){this._sendError(t.error)}}FileStreamer.prototype=Object.create(ChunkStreamer.prototype);FileStreamer.prototype.constructor=FileStreamer;function StringStreamer(e){e=e||{};ChunkStreamer.call(this,e);var t;this.stream=function(e){t=e;return this._nextChunk()};this._nextChunk=function(){if(this._finished)return;var e=this._config.chunkSize;var n;if(e){n=t.substring(0,e);t=t.substring(e)}else{n=t;t=""}this._finished=!t;return this.parseChunk(n)}}StringStreamer.prototype=Object.create(StringStreamer.prototype);StringStreamer.prototype.constructor=StringStreamer;function ReadableStreamStreamer(e){e=e||{};ChunkStreamer.call(this,e);var t=[];var n=true;var r=false;this.pause=function(){ChunkStreamer.prototype.pause.apply(this,arguments);this._input.pause()};this.resume=function(){ChunkStreamer.prototype.resume.apply(this,arguments);this._input.resume()};this.stream=function(e){this._input=e;this._input.on("data",this._streamData);this._input.on("end",this._streamEnd);this._input.on("error",this._streamError)};this._checkIsFinished=function(){if(r&&t.length===1){this._finished=true}};this._nextChunk=function(){this._checkIsFinished();if(t.length){this.parseChunk(t.shift())}else{n=true}};this._streamData=bindFunction((function(e){try{t.push(typeof e==="string"?e:e.toString(this._config.encoding));if(n){n=false;this._checkIsFinished();this.parseChunk(t.shift())}}catch(e){this._streamError(e)}}),this);this._streamError=bindFunction((function(e){this._streamCleanUp();this._sendError(e)}),this);this._streamEnd=bindFunction((function(){this._streamCleanUp();r=true;this._streamData("")}),this);this._streamCleanUp=bindFunction((function(){this._input.removeListener("data",this._streamData);this._input.removeListener("end",this._streamEnd);this._input.removeListener("error",this._streamError)}),this)}ReadableStreamStreamer.prototype=Object.create(ChunkStreamer.prototype);ReadableStreamStreamer.prototype.constructor=ReadableStreamStreamer;function DuplexStreamStreamer(e){var t=n(203).Duplex;var r=copy(e);var o=true;var l=false;var h=[];var f=null;this._onCsvData=function(e){var t=e.data;if(!f.push(t)&&!this._handle.paused()){this._handle.pause()}};this._onCsvComplete=function(){f.push(null)};r.step=bindFunction(this._onCsvData,this);r.complete=bindFunction(this._onCsvComplete,this);ChunkStreamer.call(this,r);this._nextChunk=function(){if(l&&h.length===1){this._finished=true}if(h.length){h.shift()()}else{o=true}};this._addToParseQueue=function(e,t){h.push(bindFunction((function(){this.parseChunk(typeof e==="string"?e:e.toString(r.encoding));if(isFunction(t)){return t()}}),this));if(o){o=false;this._nextChunk()}};this._onRead=function(){if(this._handle.paused()){this._handle.resume()}};this._onWrite=function(e,t,n){this._addToParseQueue(e,n)};this._onWriteComplete=function(){l=true;this._addToParseQueue("")};this.getStream=function(){return f};f=new t({readableObjectMode:true,decodeStrings:false,read:bindFunction(this._onRead,this),write:bindFunction(this._onWrite,this)});f.once("finish",bindFunction(this._onWriteComplete,this))}if(typeof PAPA_BROWSER_CONTEXT==="undefined"){DuplexStreamStreamer.prototype=Object.create(ChunkStreamer.prototype);DuplexStreamStreamer.prototype.constructor=DuplexStreamStreamer}function ParserHandle(e){var t=Math.pow(2,53);var n=-t;var r=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/;var o=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/;var l=this;var f=0;var p=0;var d;var _;var m=false;var g=false;var y;var b=[];var v={data:[],errors:[],meta:{}};if(isFunction(e.step)){var E=e.step;e.step=function(t){v=t;if(needsHeaderRow())processResults();else{processResults();if(v.data.length===0)return;f+=t.data.length;if(e.preview&&f>e.preview)_.abort();else{v.data=v.data[0];E(v,l)}}}}this.parse=function(t,n,r){var o=e.quoteChar||'"';if(!e.newline)e.newline=this.guessLineEndings(t,o);y=false;if(!e.delimiter){var l=guessDelimiter(t,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess);if(l.successful)e.delimiter=l.bestDelimiter;else{y=true;e.delimiter=h.DefaultDelimiter}v.meta.delimiter=e.delimiter}else if(isFunction(e.delimiter)){e.delimiter=e.delimiter(t);v.meta.delimiter=e.delimiter}var f=copy(e);if(e.preview&&e.header)f.preview++;d=t;_=new Parser(f);v=_.parse(d,n,r);processResults();return m?{meta:{paused:true}}:v||{meta:{paused:false}}};this.paused=function(){return m};this.pause=function(){m=true;_.abort();d=isFunction(e.chunk)?"":d.substring(_.getCharIndex())};this.resume=function(){if(l.streamer._halted){m=false;l.streamer.parseChunk(d,true)}else{setTimeout(l.resume,3)}};this.aborted=function(){return g};this.abort=function(){g=true;_.abort();v.meta.aborted=true;if(isFunction(e.complete))e.complete(v);d=""};this.guessLineEndings=function(e,t){e=e.substring(0,1024*1024);var n=new RegExp(escapeRegExp(t)+"([^]*?)"+escapeRegExp(t),"gm");e=e.replace(n,"");var r=e.split("\r");var o=e.split("\n");var l=o.length>1&&o[0].length<r[0].length;if(r.length===1||l)return"\n";var h=0;for(var f=0;f<r.length;f++){if(r[f][0]==="\n")h++}return h>=r.length/2?"\r\n":"\r"};function testEmptyLine(t){return e.skipEmptyLines==="greedy"?t.join("").trim()==="":t.length===1&&t[0].length===0}function testFloat(e){if(r.test(e)){var o=parseFloat(e);if(o>n&&o<t){return true}}return false}function processResults(){if(v&&y){addError("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+h.DefaultDelimiter+"'");y=false}if(e.skipEmptyLines){v.data=v.data.filter((function(e){return!testEmptyLine(e)}))}if(needsHeaderRow())fillHeaderFields();return applyHeaderAndDynamicTypingAndTransformation()}function needsHeaderRow(){return e.header&&b.length===0}function fillHeaderFields(){if(!v)return;function addHeader(t,n){if(isFunction(e.transformHeader))t=e.transformHeader(t,n);b.push(t)}if(Array.isArray(v.data[0])){for(var t=0;needsHeaderRow()&&t<v.data.length;t++)v.data[t].forEach(addHeader);v.data.splice(0,1)}else v.data.forEach(addHeader)}function shouldApplyDynamicTyping(t){if(e.dynamicTypingFunction&&e.dynamicTyping[t]===undefined){e.dynamicTyping[t]=e.dynamicTypingFunction(t)}return(e.dynamicTyping[t]||e.dynamicTyping)===true}function parseDynamic(e,t){if(shouldApplyDynamicTyping(e)){if(t==="true"||t==="TRUE")return true;else if(t==="false"||t==="FALSE")return false;else if(testFloat(t))return parseFloat(t);else if(o.test(t))return new Date(t);else return t===""?null:t}return t}function applyHeaderAndDynamicTypingAndTransformation(){if(!v||!e.header&&!e.dynamicTyping&&!e.transform)return v;function processRow(t,n){var r=e.header?{}:[];var o;for(o=0;o<t.length;o++){var l=o;var h=t[o];if(e.header)l=o>=b.length?"__parsed_extra":b[o];if(e.transform)h=e.transform(h,l);h=parseDynamic(l,h);if(l==="__parsed_extra"){r[l]=r[l]||[];r[l].push(h)}else r[l]=h}if(e.header){if(o>b.length)addError("FieldMismatch","TooManyFields","Too many fields: expected "+b.length+" fields but parsed "+o,p+n);else if(o<b.length)addError("FieldMismatch","TooFewFields","Too few fields: expected "+b.length+" fields but parsed "+o,p+n)}return r}var t=1;if(!v.data.length||Array.isArray(v.data[0])){v.data=v.data.map(processRow);t=v.data.length}else v.data=processRow(v.data,0);if(e.header&&v.meta)v.meta.fields=b;p+=t;return v}function guessDelimiter(t,n,r,o,l){var f,p,d,_;l=l||[",","\t","|",";",h.RECORD_SEP,h.UNIT_SEP];for(var m=0;m<l.length;m++){var g=l[m];var y=0,b=0,v=0;d=undefined;var E=new Parser({comments:o,delimiter:g,newline:n,preview:10}).parse(t);for(var k=0;k<E.data.length;k++){if(r&&testEmptyLine(E.data[k])){v++;continue}var O=E.data[k].length;b+=O;if(typeof d==="undefined"){d=O;continue}else if(O>0){y+=Math.abs(O-d);d=O}}if(E.data.length>0)b/=E.data.length-v;if((typeof p==="undefined"||y<=p)&&(typeof _==="undefined"||b>_)&&b>1.99){p=y;f=g;_=b}}e.delimiter=f;return{successful:!!f,bestDelimiter:f}}function addError(e,t,n,r){var o={type:e,code:t,message:n};if(r!==undefined){o.row=r}v.errors.push(o)}}function escapeRegExp(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Parser(e){e=e||{};var t=e.delimiter;var n=e.newline;var r=e.comments;var o=e.step;var l=e.preview;var f=e.fastMode;var p;var d=null;var _=false;if(e.quoteChar===undefined||e.quoteChar===null){p='"'}else{p=e.quoteChar}var m=p;if(e.escapeChar!==undefined){m=e.escapeChar}if(typeof t!=="string"||h.BAD_DELIMITERS.indexOf(t)>-1)t=",";if(r===t)throw new Error("Comment character same as delimiter");else if(r===true)r="#";else if(typeof r!=="string"||h.BAD_DELIMITERS.indexOf(r)>-1)r=false;if(n!=="\n"&&n!=="\r"&&n!=="\r\n")n="\n";var g=0;var y=false;this.parse=function(h,b,v){if(typeof h!=="string")throw new Error("Input must be a string");var E=h.length,k=t.length,O=n.length,x=r.length;var A=isFunction(o);g=0;var w=[],S=[],R=[],N=0;if(!h)return returnable();if(f||f!==false&&h.indexOf(p)===-1){var C=h.split(n);for(var I=0;I<C.length;I++){R=C[I];g+=R.length;if(I!==C.length-1)g+=n.length;else if(v)return returnable();if(r&&R.substring(0,x)===r)continue;if(A){w=[];pushRow(R.split(t));doStep();if(y)return returnable()}else pushRow(R.split(t));if(l&&I>=l){w=w.slice(0,l);return returnable(true)}}return returnable()}var L=h.indexOf(t,g);var P=h.indexOf(n,g);var M=new RegExp(escapeRegExp(m)+escapeRegExp(p),"g");var F=h.indexOf(p,g);for(;;){if(h[g]===p){F=g;g++;for(;;){F=h.indexOf(p,F+1);if(F===-1){if(!v){S.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:w.length,index:g})}return finish()}if(F===E-1){var D=h.substring(g,F).replace(M,p);return finish(D)}if(p===m&&h[F+1]===m){F++;continue}if(p!==m&&F!==0&&h[F-1]===m){continue}if(L!==-1&&L<F+1){L=h.indexOf(t,F+1)}if(P!==-1&&P<F+1){P=h.indexOf(n,F+1)}var U=P===-1?L:Math.min(L,P);var $=extraSpaces(U);if(h.substr(F+1+$,k)===t){R.push(h.substring(g,F).replace(M,p));g=F+1+$+k;if(h[F+1+$+k]!==p){F=h.indexOf(p,g)}L=h.indexOf(t,g);P=h.indexOf(n,g);break}var j=extraSpaces(P);if(h.substring(F+1+j,F+1+j+O)===n){R.push(h.substring(g,F).replace(M,p));saveRow(F+1+j+O);L=h.indexOf(t,g);F=h.indexOf(p,g);if(A){doStep();if(y)return returnable()}if(l&&w.length>=l)return returnable(true);break}S.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:w.length,index:g});F++;continue}continue}if(r&&R.length===0&&h.substring(g,g+x)===r){if(P===-1)return returnable();g=P+O;P=h.indexOf(n,g);L=h.indexOf(t,g);continue}if(L!==-1&&(L<P||P===-1)){R.push(h.substring(g,L));g=L+k;L=h.indexOf(t,g);continue}if(P!==-1){R.push(h.substring(g,P));saveRow(P+O);if(A){doStep();if(y)return returnable()}if(l&&w.length>=l)return returnable(true);continue}break}return finish();function pushRow(e){w.push(e);N=g}function extraSpaces(e){var t=0;if(e!==-1){var n=h.substring(F+1,e);if(n&&n.trim()===""){t=n.length}}return t}function finish(e){if(v)return returnable();if(typeof e==="undefined")e=h.substring(g);R.push(e);g=E;pushRow(R);if(A)doStep();return returnable()}function saveRow(e){g=e;pushRow(R);R=[];P=h.indexOf(n,g)}function returnable(r){if(e.header&&!b&&w.length&&!_){const t=w[0];const n=Object.create(null);const r=new Set(t);let o=false;for(let l=0;l<t.length;l++){let h=t[l];if(isFunction(e.transformHeader))h=e.transformHeader(h,l);if(!n[h]){n[h]=1;t[l]=h}else{let e;let f=n[h];do{e=`${h}_${f}`;f++}while(r.has(e));r.add(e);t[l]=e;n[h]++;o=true;if(d===null){d={}}d[e]=h}r.add(h)}if(o){console.warn("Duplicate headers found and renamed.")}_=true}return{data:w,errors:S,meta:{delimiter:t,linebreak:n,aborted:y,truncated:!!r,cursor:N+(b||0),renamedHeaders:d}}}function doStep(){o(returnable());w=[];S=[]}};this.abort=function(){y=true};this.getCharIndex=function(){return g}}function newWorker(){if(!h.WORKERS_SUPPORTED)return false;var t=getWorkerBlob();var n=new e.Worker(t);n.onmessage=mainThreadReceivedMessage;n.id=l++;o[n.id]=n;return n}function mainThreadReceivedMessage(e){var t=e.data;var n=o[t.workerId];var r=false;if(t.error)n.userError(t.error,t.file);else if(t.results&&t.results.data){var abort=function(){r=true;completeWorker(t.workerId,{data:[],errors:[],meta:{aborted:true}})};var l={abort:abort,pause:notImplemented,resume:notImplemented};if(isFunction(n.userStep)){for(var h=0;h<t.results.data.length;h++){n.userStep({data:t.results.data[h],errors:t.results.errors,meta:t.results.meta},l);if(r)break}delete t.results}else if(isFunction(n.userChunk)){n.userChunk(t.results,l,t.file);delete t.results}}if(t.finished&&!r)completeWorker(t.workerId,t.results)}function completeWorker(e,t){var n=o[e];if(isFunction(n.userComplete))n.userComplete(t);n.terminate();delete o[e]}function notImplemented(){throw new Error("Not implemented.")}function workerThreadReceivedMessage(t){var n=t.data;if(typeof h.WORKER_ID==="undefined"&&n)h.WORKER_ID=n.workerId;if(typeof n.input==="string"){e.postMessage({workerId:h.WORKER_ID,results:h.parse(n.input,n.config),finished:true})}else if(e.File&&n.input instanceof File||n.input instanceof Object){var r=h.parse(n.input,n.config);if(r)e.postMessage({workerId:h.WORKER_ID,results:r,finished:true})}}function copy(e){if(typeof e!=="object"||e===null)return e;var t=Array.isArray(e)?[]:{};for(var n in e)t[n]=copy(e[n]);return t}function bindFunction(e,t){return function(){e.apply(t,arguments)}}function isFunction(e){return typeof e==="function"}return h}))},421:t=>{t.exports=e(import.meta.url)("node:child_process")},474:t=>{t.exports=e(import.meta.url)("node:events")},24:t=>{t.exports=e(import.meta.url)("node:fs")},760:t=>{t.exports=e(import.meta.url)("node:path")},708:t=>{t.exports=e(import.meta.url)("node:process")},203:t=>{t.exports=e(import.meta.url)("stream")},534:(e,t,n)=>{const{Argument:r}=n(343);const{Command:o}=n(623);const{CommanderError:l,InvalidArgumentError:h}=n(568);const{Help:f}=n(727);const{Option:p}=n(177);t.DM=new o;t.gu=e=>new o(e);t.Ww=(e,t)=>new p(e,t);t.er=(e,t)=>new r(e,t);t.uB=o;t.c$=p;t.ef=r;t._V=f;t.b7=l;t.Di=h;t.a2=h},343:(e,t,n)=>{const{InvalidArgumentError:r}=n(568);class Argument{constructor(e,t){this.description=t||"";this.variadic=false;this.parseArg=undefined;this.defaultValue=undefined;this.defaultValueDescription=undefined;this.argChoices=undefined;switch(e[0]){case"<":this.required=true;this._name=e.slice(1,-1);break;case"[":this.required=false;this._name=e.slice(1,-1);break;default:this.required=true;this._name=e;break}if(this._name.endsWith("...")){this.variadic=true;this._name=this._name.slice(0,-3)}}name(){return this._name}_collectValue(e,t){if(t===this.defaultValue||!Array.isArray(t)){return[e]}t.push(e);return t}default(e,t){this.defaultValue=e;this.defaultValueDescription=t;return this}argParser(e){this.parseArg=e;return this}choices(e){this.argChoices=e.slice();this.parseArg=(e,t)=>{if(!this.argChoices.includes(e)){throw new r(`Allowed choices are ${this.argChoices.join(", ")}.`)}if(this.variadic){return this._collectValue(e,t)}return e};return this}argRequired(){this.required=true;return this}argOptional(){this.required=false;return this}}function humanReadableArgName(e){const t=e.name()+(e.variadic===true?"...":"");return e.required?"<"+t+">":"["+t+"]"}t.Argument=Argument;t.humanReadableArgName=humanReadableArgName},623:(e,t,n)=>{const r=n(474).EventEmitter;const o=n(421);const l=n(760);const h=n(24);const f=n(708);const{Argument:p,humanReadableArgName:d}=n(343);const{CommanderError:_}=n(568);const{Help:m,stripColor:g}=n(727);const{Option:y,DualOptions:b}=n(177);const{suggestSimilar:v}=n(779);class Command extends r{constructor(e){super();this.commands=[];this.options=[];this.parent=null;this._allowUnknownOption=false;this._allowExcessArguments=false;this.registeredArguments=[];this._args=this.registeredArguments;this.args=[];this.rawArgs=[];this.processedArgs=[];this._scriptPath=null;this._name=e||"";this._optionValues={};this._optionValueSources={};this._storeOptionsAsProperties=false;this._actionHandler=null;this._executableHandler=false;this._executableFile=null;this._executableDir=null;this._defaultCommandName=null;this._exitCallback=null;this._aliases=[];this._combineFlagAndOptionalValue=true;this._description="";this._summary="";this._argsDescription=undefined;this._enablePositionalOptions=false;this._passThroughOptions=false;this._lifeCycleHooks={};this._showHelpAfterError=false;this._showSuggestionAfterError=true;this._savedState=null;this._outputConfiguration={writeOut:e=>f.stdout.write(e),writeErr:e=>f.stderr.write(e),outputError:(e,t)=>t(e),getOutHelpWidth:()=>f.stdout.isTTY?f.stdout.columns:undefined,getErrHelpWidth:()=>f.stderr.isTTY?f.stderr.columns:undefined,getOutHasColors:()=>useColor()??(f.stdout.isTTY&&f.stdout.hasColors?.()),getErrHasColors:()=>useColor()??(f.stderr.isTTY&&f.stderr.hasColors?.()),stripColor:e=>g(e)};this._hidden=false;this._helpOption=undefined;this._addImplicitHelpCommand=undefined;this._helpCommand=undefined;this._helpConfiguration={};this._helpGroupHeading=undefined;this._defaultCommandGroup=undefined;this._defaultOptionGroup=undefined}copyInheritedSettings(e){this._outputConfiguration=e._outputConfiguration;this._helpOption=e._helpOption;this._helpCommand=e._helpCommand;this._helpConfiguration=e._helpConfiguration;this._exitCallback=e._exitCallback;this._storeOptionsAsProperties=e._storeOptionsAsProperties;this._combineFlagAndOptionalValue=e._combineFlagAndOptionalValue;this._allowExcessArguments=e._allowExcessArguments;this._enablePositionalOptions=e._enablePositionalOptions;this._showHelpAfterError=e._showHelpAfterError;this._showSuggestionAfterError=e._showSuggestionAfterError;return this}_getCommandAndAncestors(){const e=[];for(let t=this;t;t=t.parent){e.push(t)}return e}command(e,t,n){let r=t;let o=n;if(typeof r==="object"&&r!==null){o=r;r=null}o=o||{};const[,l,h]=e.match(/([^ ]+) *(.*)/);const f=this.createCommand(l);if(r){f.description(r);f._executableHandler=true}if(o.isDefault)this._defaultCommandName=f._name;f._hidden=!!(o.noHelp||o.hidden);f._executableFile=o.executableFile||null;if(h)f.arguments(h);this._registerCommand(f);f.parent=this;f.copyInheritedSettings(this);if(r)return this;return f}createCommand(e){return new Command(e)}createHelp(){return Object.assign(new m,this.configureHelp())}configureHelp(e){if(e===undefined)return this._helpConfiguration;this._helpConfiguration=e;return this}configureOutput(e){if(e===undefined)return this._outputConfiguration;this._outputConfiguration={...this._outputConfiguration,...e};return this}showHelpAfterError(e=true){if(typeof e!=="string")e=!!e;this._showHelpAfterError=e;return this}showSuggestionAfterError(e=true){this._showSuggestionAfterError=!!e;return this}addCommand(e,t){if(!e._name){throw new Error(`Command passed to .addCommand() must have a name\n- specify the name in Command constructor or using .name()`)}t=t||{};if(t.isDefault)this._defaultCommandName=e._name;if(t.noHelp||t.hidden)e._hidden=true;this._registerCommand(e);e.parent=this;e._checkForBrokenPassThrough();return this}createArgument(e,t){return new p(e,t)}argument(e,t,n,r){const o=this.createArgument(e,t);if(typeof n==="function"){o.default(r).argParser(n)}else{o.default(n)}this.addArgument(o);return this}arguments(e){e.trim().split(/ +/).forEach((e=>{this.argument(e)}));return this}addArgument(e){const t=this.registeredArguments.slice(-1)[0];if(t?.variadic){throw new Error(`only the last argument can be variadic '${t.name()}'`)}if(e.required&&e.defaultValue!==undefined&&e.parseArg===undefined){throw new Error(`a default value for a required argument is never used: '${e.name()}'`)}this.registeredArguments.push(e);return this}helpCommand(e,t){if(typeof e==="boolean"){this._addImplicitHelpCommand=e;if(e&&this._defaultCommandGroup){this._initCommandGroup(this._getHelpCommand())}return this}const n=e??"help [command]";const[,r,o]=n.match(/([^ ]+) *(.*)/);const l=t??"display help for command";const h=this.createCommand(r);h.helpOption(false);if(o)h.arguments(o);if(l)h.description(l);this._addImplicitHelpCommand=true;this._helpCommand=h;if(e||t)this._initCommandGroup(h);return this}addHelpCommand(e,t){if(typeof e!=="object"){this.helpCommand(e,t);return this}this._addImplicitHelpCommand=true;this._helpCommand=e;this._initCommandGroup(e);return this}_getHelpCommand(){const e=this._addImplicitHelpCommand??(this.commands.length&&!this._actionHandler&&!this._findCommand("help"));if(e){if(this._helpCommand===undefined){this.helpCommand(undefined,undefined)}return this._helpCommand}return null}hook(e,t){const n=["preSubcommand","preAction","postAction"];if(!n.includes(e)){throw new Error(`Unexpected value for event passed to hook : '${e}'.\nExpecting one of '${n.join("', '")}'`)}if(this._lifeCycleHooks[e]){this._lifeCycleHooks[e].push(t)}else{this._lifeCycleHooks[e]=[t]}return this}exitOverride(e){if(e){this._exitCallback=e}else{this._exitCallback=e=>{if(e.code!=="commander.executeSubCommandAsync"){throw e}else{}}}return this}_exit(e,t,n){if(this._exitCallback){this._exitCallback(new _(e,t,n))}f.exit(e)}action(e){const listener=t=>{const n=this.registeredArguments.length;const r=t.slice(0,n);if(this._storeOptionsAsProperties){r[n]=this}else{r[n]=this.opts()}r.push(this);return e.apply(this,r)};this._actionHandler=listener;return this}createOption(e,t){return new y(e,t)}_callParseArg(e,t,n,r){try{return e.parseArg(t,n)}catch(e){if(e.code==="commander.invalidArgument"){const t=`${r} ${e.message}`;this.error(t,{exitCode:e.exitCode,code:e.code})}throw e}}_registerOption(e){const t=e.short&&this._findOption(e.short)||e.long&&this._findOption(e.long);if(t){const n=e.long&&this._findOption(e.long)?e.long:e.short;throw new Error(`Cannot add option '${e.flags}'${this._name&&` to command '${this._name}'`} due to conflicting flag '${n}'\n-  already used by option '${t.flags}'`)}this._initOptionGroup(e);this.options.push(e)}_registerCommand(e){const knownBy=e=>[e.name()].concat(e.aliases());const t=knownBy(e).find((e=>this._findCommand(e)));if(t){const n=knownBy(this._findCommand(t)).join("|");const r=knownBy(e).join("|");throw new Error(`cannot add command '${r}' as already have command '${n}'`)}this._initCommandGroup(e);this.commands.push(e)}addOption(e){this._registerOption(e);const t=e.name();const n=e.attributeName();if(e.negate){const t=e.long.replace(/^--no-/,"--");if(!this._findOption(t)){this.setOptionValueWithSource(n,e.defaultValue===undefined?true:e.defaultValue,"default")}}else if(e.defaultValue!==undefined){this.setOptionValueWithSource(n,e.defaultValue,"default")}const handleOptionValue=(t,r,o)=>{if(t==null&&e.presetArg!==undefined){t=e.presetArg}const l=this.getOptionValue(n);if(t!==null&&e.parseArg){t=this._callParseArg(e,t,l,r)}else if(t!==null&&e.variadic){t=e._collectValue(t,l)}if(t==null){if(e.negate){t=false}else if(e.isBoolean()||e.optional){t=true}else{t=""}}this.setOptionValueWithSource(n,t,o)};this.on("option:"+t,(t=>{const n=`error: option '${e.flags}' argument '${t}' is invalid.`;handleOptionValue(t,n,"cli")}));if(e.envVar){this.on("optionEnv:"+t,(t=>{const n=`error: option '${e.flags}' value '${t}' from env '${e.envVar}' is invalid.`;handleOptionValue(t,n,"env")}))}return this}_optionEx(e,t,n,r,o){if(typeof t==="object"&&t instanceof y){throw new Error("To add an Option object use addOption() instead of option() or requiredOption()")}const l=this.createOption(t,n);l.makeOptionMandatory(!!e.mandatory);if(typeof r==="function"){l.default(o).argParser(r)}else if(r instanceof RegExp){const e=r;r=(t,n)=>{const r=e.exec(t);return r?r[0]:n};l.default(o).argParser(r)}else{l.default(r)}return this.addOption(l)}option(e,t,n,r){return this._optionEx({},e,t,n,r)}requiredOption(e,t,n,r){return this._optionEx({mandatory:true},e,t,n,r)}combineFlagAndOptionalValue(e=true){this._combineFlagAndOptionalValue=!!e;return this}allowUnknownOption(e=true){this._allowUnknownOption=!!e;return this}allowExcessArguments(e=true){this._allowExcessArguments=!!e;return this}enablePositionalOptions(e=true){this._enablePositionalOptions=!!e;return this}passThroughOptions(e=true){this._passThroughOptions=!!e;this._checkForBrokenPassThrough();return this}_checkForBrokenPassThrough(){if(this.parent&&this._passThroughOptions&&!this.parent._enablePositionalOptions){throw new Error(`passThroughOptions cannot be used for '${this._name}' without turning on enablePositionalOptions for parent command(s)`)}}storeOptionsAsProperties(e=true){if(this.options.length){throw new Error("call .storeOptionsAsProperties() before adding options")}if(Object.keys(this._optionValues).length){throw new Error("call .storeOptionsAsProperties() before setting option values")}this._storeOptionsAsProperties=!!e;return this}getOptionValue(e){if(this._storeOptionsAsProperties){return this[e]}return this._optionValues[e]}setOptionValue(e,t){return this.setOptionValueWithSource(e,t,undefined)}setOptionValueWithSource(e,t,n){if(this._storeOptionsAsProperties){this[e]=t}else{this._optionValues[e]=t}this._optionValueSources[e]=n;return this}getOptionValueSource(e){return this._optionValueSources[e]}getOptionValueSourceWithGlobals(e){let t;this._getCommandAndAncestors().forEach((n=>{if(n.getOptionValueSource(e)!==undefined){t=n.getOptionValueSource(e)}}));return t}_prepareUserArgs(e,t){if(e!==undefined&&!Array.isArray(e)){throw new Error("first parameter to parse must be array or undefined")}t=t||{};if(e===undefined&&t.from===undefined){if(f.versions?.electron){t.from="electron"}const e=f.execArgv??[];if(e.includes("-e")||e.includes("--eval")||e.includes("-p")||e.includes("--print")){t.from="eval"}}if(e===undefined){e=f.argv}this.rawArgs=e.slice();let n;switch(t.from){case undefined:case"node":this._scriptPath=e[1];n=e.slice(2);break;case"electron":if(f.defaultApp){this._scriptPath=e[1];n=e.slice(2)}else{n=e.slice(1)}break;case"user":n=e.slice(0);break;case"eval":n=e.slice(1);break;default:throw new Error(`unexpected parse option { from: '${t.from}' }`)}if(!this._name&&this._scriptPath)this.nameFromFilename(this._scriptPath);this._name=this._name||"program";return n}parse(e,t){this._prepareForParse();const n=this._prepareUserArgs(e,t);this._parseCommand([],n);return this}async parseAsync(e,t){this._prepareForParse();const n=this._prepareUserArgs(e,t);await this._parseCommand([],n);return this}_prepareForParse(){if(this._savedState===null){this.saveStateBeforeParse()}else{this.restoreStateBeforeParse()}}saveStateBeforeParse(){this._savedState={_name:this._name,_optionValues:{...this._optionValues},_optionValueSources:{...this._optionValueSources}}}restoreStateBeforeParse(){if(this._storeOptionsAsProperties)throw new Error(`Can not call parse again when storeOptionsAsProperties is true.\n- either make a new Command for each call to parse, or stop storing options as properties`);this._name=this._savedState._name;this._scriptPath=null;this.rawArgs=[];this._optionValues={...this._savedState._optionValues};this._optionValueSources={...this._savedState._optionValueSources};this.args=[];this.processedArgs=[]}_checkForMissingExecutable(e,t,n){if(h.existsSync(e))return;const r=t?`searched for local subcommand relative to directory '${t}'`:"no directory for search for local subcommand, use .executableDir() to supply a custom directory";const o=`'${e}' does not exist\n - if '${n}' is not meant to be an executable command, remove description parameter from '.command()' and use '.description()' instead\n - if the default executable name is not suitable, use the executableFile option to supply a custom name or path\n - ${r}`;throw new Error(o)}_executeSubCommand(e,t){t=t.slice();let n=false;const r=[".js",".ts",".tsx",".mjs",".cjs"];function findFile(e,t){const n=l.resolve(e,t);if(h.existsSync(n))return n;if(r.includes(l.extname(t)))return undefined;const o=r.find((e=>h.existsSync(`${n}${e}`)));if(o)return`${n}${o}`;return undefined}this._checkForMissingMandatoryOptions();this._checkForConflictingOptions();let p=e._executableFile||`${this._name}-${e._name}`;let d=this._executableDir||"";if(this._scriptPath){let e;try{e=h.realpathSync(this._scriptPath)}catch{e=this._scriptPath}d=l.resolve(l.dirname(e),d)}if(d){let t=findFile(d,p);if(!t&&!e._executableFile&&this._scriptPath){const n=l.basename(this._scriptPath,l.extname(this._scriptPath));if(n!==this._name){t=findFile(d,`${n}-${e._name}`)}}p=t||p}n=r.includes(l.extname(p));let m;if(f.platform!=="win32"){if(n){t.unshift(p);t=incrementNodeInspectorPort(f.execArgv).concat(t);m=o.spawn(f.argv[0],t,{stdio:"inherit"})}else{m=o.spawn(p,t,{stdio:"inherit"})}}else{this._checkForMissingExecutable(p,d,e._name);t.unshift(p);t=incrementNodeInspectorPort(f.execArgv).concat(t);m=o.spawn(f.execPath,t,{stdio:"inherit"})}if(!m.killed){const e=["SIGUSR1","SIGUSR2","SIGTERM","SIGINT","SIGHUP"];e.forEach((e=>{f.on(e,(()=>{if(m.killed===false&&m.exitCode===null){m.kill(e)}}))}))}const g=this._exitCallback;m.on("close",(e=>{e=e??1;if(!g){f.exit(e)}else{g(new _(e,"commander.executeSubCommandAsync","(close)"))}}));m.on("error",(t=>{if(t.code==="ENOENT"){this._checkForMissingExecutable(p,d,e._name)}else if(t.code==="EACCES"){throw new Error(`'${p}' not executable`)}if(!g){f.exit(1)}else{const e=new _(1,"commander.executeSubCommandAsync","(error)");e.nestedError=t;g(e)}}));this.runningCommand=m}_dispatchSubcommand(e,t,n){const r=this._findCommand(e);if(!r)this.help({error:true});r._prepareForParse();let o;o=this._chainOrCallSubCommandHook(o,r,"preSubcommand");o=this._chainOrCall(o,(()=>{if(r._executableHandler){this._executeSubCommand(r,t.concat(n))}else{return r._parseCommand(t,n)}}));return o}_dispatchHelpCommand(e){if(!e){this.help()}const t=this._findCommand(e);if(t&&!t._executableHandler){t.help()}return this._dispatchSubcommand(e,[],[this._getHelpOption()?.long??this._getHelpOption()?.short??"--help"])}_checkNumberOfArguments(){this.registeredArguments.forEach(((e,t)=>{if(e.required&&this.args[t]==null){this.missingArgument(e.name())}}));if(this.registeredArguments.length>0&&this.registeredArguments[this.registeredArguments.length-1].variadic){return}if(this.args.length>this.registeredArguments.length){this._excessArguments(this.args)}}_processArguments(){const myParseArg=(e,t,n)=>{let r=t;if(t!==null&&e.parseArg){const o=`error: command-argument value '${t}' is invalid for argument '${e.name()}'.`;r=this._callParseArg(e,t,n,o)}return r};this._checkNumberOfArguments();const e=[];this.registeredArguments.forEach(((t,n)=>{let r=t.defaultValue;if(t.variadic){if(n<this.args.length){r=this.args.slice(n);if(t.parseArg){r=r.reduce(((e,n)=>myParseArg(t,n,e)),t.defaultValue)}}else if(r===undefined){r=[]}}else if(n<this.args.length){r=this.args[n];if(t.parseArg){r=myParseArg(t,r,t.defaultValue)}}e[n]=r}));this.processedArgs=e}_chainOrCall(e,t){if(e?.then&&typeof e.then==="function"){return e.then((()=>t()))}return t()}_chainOrCallHooks(e,t){let n=e;const r=[];this._getCommandAndAncestors().reverse().filter((e=>e._lifeCycleHooks[t]!==undefined)).forEach((e=>{e._lifeCycleHooks[t].forEach((t=>{r.push({hookedCommand:e,callback:t})}))}));if(t==="postAction"){r.reverse()}r.forEach((e=>{n=this._chainOrCall(n,(()=>e.callback(e.hookedCommand,this)))}));return n}_chainOrCallSubCommandHook(e,t,n){let r=e;if(this._lifeCycleHooks[n]!==undefined){this._lifeCycleHooks[n].forEach((e=>{r=this._chainOrCall(r,(()=>e(this,t)))}))}return r}_parseCommand(e,t){const n=this.parseOptions(t);this._parseOptionsEnv();this._parseOptionsImplied();e=e.concat(n.operands);t=n.unknown;this.args=e.concat(t);if(e&&this._findCommand(e[0])){return this._dispatchSubcommand(e[0],e.slice(1),t)}if(this._getHelpCommand()&&e[0]===this._getHelpCommand().name()){return this._dispatchHelpCommand(e[1])}if(this._defaultCommandName){this._outputHelpIfRequested(t);return this._dispatchSubcommand(this._defaultCommandName,e,t)}if(this.commands.length&&this.args.length===0&&!this._actionHandler&&!this._defaultCommandName){this.help({error:true})}this._outputHelpIfRequested(n.unknown);this._checkForMissingMandatoryOptions();this._checkForConflictingOptions();const checkForUnknownOptions=()=>{if(n.unknown.length>0){this.unknownOption(n.unknown[0])}};const r=`command:${this.name()}`;if(this._actionHandler){checkForUnknownOptions();this._processArguments();let n;n=this._chainOrCallHooks(n,"preAction");n=this._chainOrCall(n,(()=>this._actionHandler(this.processedArgs)));if(this.parent){n=this._chainOrCall(n,(()=>{this.parent.emit(r,e,t)}))}n=this._chainOrCallHooks(n,"postAction");return n}if(this.parent?.listenerCount(r)){checkForUnknownOptions();this._processArguments();this.parent.emit(r,e,t)}else if(e.length){if(this._findCommand("*")){return this._dispatchSubcommand("*",e,t)}if(this.listenerCount("command:*")){this.emit("command:*",e,t)}else if(this.commands.length){this.unknownCommand()}else{checkForUnknownOptions();this._processArguments()}}else if(this.commands.length){checkForUnknownOptions();this.help({error:true})}else{checkForUnknownOptions();this._processArguments()}}_findCommand(e){if(!e)return undefined;return this.commands.find((t=>t._name===e||t._aliases.includes(e)))}_findOption(e){return this.options.find((t=>t.is(e)))}_checkForMissingMandatoryOptions(){this._getCommandAndAncestors().forEach((e=>{e.options.forEach((t=>{if(t.mandatory&&e.getOptionValue(t.attributeName())===undefined){e.missingMandatoryOptionValue(t)}}))}))}_checkForConflictingLocalOptions(){const e=this.options.filter((e=>{const t=e.attributeName();if(this.getOptionValue(t)===undefined){return false}return this.getOptionValueSource(t)!=="default"}));const t=e.filter((e=>e.conflictsWith.length>0));t.forEach((t=>{const n=e.find((e=>t.conflictsWith.includes(e.attributeName())));if(n){this._conflictingOption(t,n)}}))}_checkForConflictingOptions(){this._getCommandAndAncestors().forEach((e=>{e._checkForConflictingLocalOptions()}))}parseOptions(e){const t=[];const n=[];let r=t;function maybeOption(e){return e.length>1&&e[0]==="-"}const negativeNumberArg=e=>{if(!/^-(\d+|\d*\.\d+)(e[+-]?\d+)?$/.test(e))return false;return!this._getCommandAndAncestors().some((e=>e.options.map((e=>e.short)).some((e=>/^-\d$/.test(e)))))};let o=null;let l=null;let h=0;while(h<e.length||l){const f=l??e[h++];l=null;if(f==="--"){if(r===n)r.push(f);r.push(...e.slice(h));break}if(o&&(!maybeOption(f)||negativeNumberArg(f))){this.emit(`option:${o.name()}`,f);continue}o=null;if(maybeOption(f)){const t=this._findOption(f);if(t){if(t.required){const n=e[h++];if(n===undefined)this.optionMissingArgument(t);this.emit(`option:${t.name()}`,n)}else if(t.optional){let n=null;if(h<e.length&&(!maybeOption(e[h])||negativeNumberArg(e[h]))){n=e[h++]}this.emit(`option:${t.name()}`,n)}else{this.emit(`option:${t.name()}`)}o=t.variadic?t:null;continue}}if(f.length>2&&f[0]==="-"&&f[1]!=="-"){const e=this._findOption(`-${f[1]}`);if(e){if(e.required||e.optional&&this._combineFlagAndOptionalValue){this.emit(`option:${e.name()}`,f.slice(2))}else{this.emit(`option:${e.name()}`);l=`-${f.slice(2)}`}continue}}if(/^--[^=]+=/.test(f)){const e=f.indexOf("=");const t=this._findOption(f.slice(0,e));if(t&&(t.required||t.optional)){this.emit(`option:${t.name()}`,f.slice(e+1));continue}}if(r===t&&maybeOption(f)&&!(this.commands.length===0&&negativeNumberArg(f))){r=n}if((this._enablePositionalOptions||this._passThroughOptions)&&t.length===0&&n.length===0){if(this._findCommand(f)){t.push(f);n.push(...e.slice(h));break}else if(this._getHelpCommand()&&f===this._getHelpCommand().name()){t.push(f,...e.slice(h));break}else if(this._defaultCommandName){n.push(f,...e.slice(h));break}}if(this._passThroughOptions){r.push(f,...e.slice(h));break}r.push(f)}return{operands:t,unknown:n}}opts(){if(this._storeOptionsAsProperties){const e={};const t=this.options.length;for(let n=0;n<t;n++){const t=this.options[n].attributeName();e[t]=t===this._versionOptionName?this._version:this[t]}return e}return this._optionValues}optsWithGlobals(){return this._getCommandAndAncestors().reduce(((e,t)=>Object.assign(e,t.opts())),{})}error(e,t){this._outputConfiguration.outputError(`${e}\n`,this._outputConfiguration.writeErr);if(typeof this._showHelpAfterError==="string"){this._outputConfiguration.writeErr(`${this._showHelpAfterError}\n`)}else if(this._showHelpAfterError){this._outputConfiguration.writeErr("\n");this.outputHelp({error:true})}const n=t||{};const r=n.exitCode||1;const o=n.code||"commander.error";this._exit(r,o,e)}_parseOptionsEnv(){this.options.forEach((e=>{if(e.envVar&&e.envVar in f.env){const t=e.attributeName();if(this.getOptionValue(t)===undefined||["default","config","env"].includes(this.getOptionValueSource(t))){if(e.required||e.optional){this.emit(`optionEnv:${e.name()}`,f.env[e.envVar])}else{this.emit(`optionEnv:${e.name()}`)}}}}))}_parseOptionsImplied(){const e=new b(this.options);const hasCustomOptionValue=e=>this.getOptionValue(e)!==undefined&&!["default","implied"].includes(this.getOptionValueSource(e));this.options.filter((t=>t.implied!==undefined&&hasCustomOptionValue(t.attributeName())&&e.valueFromOption(this.getOptionValue(t.attributeName()),t))).forEach((e=>{Object.keys(e.implied).filter((e=>!hasCustomOptionValue(e))).forEach((t=>{this.setOptionValueWithSource(t,e.implied[t],"implied")}))}))}missingArgument(e){const t=`error: missing required argument '${e}'`;this.error(t,{code:"commander.missingArgument"})}optionMissingArgument(e){const t=`error: option '${e.flags}' argument missing`;this.error(t,{code:"commander.optionMissingArgument"})}missingMandatoryOptionValue(e){const t=`error: required option '${e.flags}' not specified`;this.error(t,{code:"commander.missingMandatoryOptionValue"})}_conflictingOption(e,t){const findBestOptionFromValue=e=>{const t=e.attributeName();const n=this.getOptionValue(t);const r=this.options.find((e=>e.negate&&t===e.attributeName()));const o=this.options.find((e=>!e.negate&&t===e.attributeName()));if(r&&(r.presetArg===undefined&&n===false||r.presetArg!==undefined&&n===r.presetArg)){return r}return o||e};const getErrorMessage=e=>{const t=findBestOptionFromValue(e);const n=t.attributeName();const r=this.getOptionValueSource(n);if(r==="env"){return`environment variable '${t.envVar}'`}return`option '${t.flags}'`};const n=`error: ${getErrorMessage(e)} cannot be used with ${getErrorMessage(t)}`;this.error(n,{code:"commander.conflictingOption"})}unknownOption(e){if(this._allowUnknownOption)return;let t="";if(e.startsWith("--")&&this._showSuggestionAfterError){let n=[];let r=this;do{const e=r.createHelp().visibleOptions(r).filter((e=>e.long)).map((e=>e.long));n=n.concat(e);r=r.parent}while(r&&!r._enablePositionalOptions);t=v(e,n)}const n=`error: unknown option '${e}'${t}`;this.error(n,{code:"commander.unknownOption"})}_excessArguments(e){if(this._allowExcessArguments)return;const t=this.registeredArguments.length;const n=t===1?"":"s";const r=this.parent?` for '${this.name()}'`:"";const o=`error: too many arguments${r}. Expected ${t} argument${n} but got ${e.length}.`;this.error(o,{code:"commander.excessArguments"})}unknownCommand(){const e=this.args[0];let t="";if(this._showSuggestionAfterError){const n=[];this.createHelp().visibleCommands(this).forEach((e=>{n.push(e.name());if(e.alias())n.push(e.alias())}));t=v(e,n)}const n=`error: unknown command '${e}'${t}`;this.error(n,{code:"commander.unknownCommand"})}version(e,t,n){if(e===undefined)return this._version;this._version=e;t=t||"-V, --version";n=n||"output the version number";const r=this.createOption(t,n);this._versionOptionName=r.attributeName();this._registerOption(r);this.on("option:"+r.name(),(()=>{this._outputConfiguration.writeOut(`${e}\n`);this._exit(0,"commander.version",e)}));return this}description(e,t){if(e===undefined&&t===undefined)return this._description;this._description=e;if(t){this._argsDescription=t}return this}summary(e){if(e===undefined)return this._summary;this._summary=e;return this}alias(e){if(e===undefined)return this._aliases[0];let t=this;if(this.commands.length!==0&&this.commands[this.commands.length-1]._executableHandler){t=this.commands[this.commands.length-1]}if(e===t._name)throw new Error("Command alias can't be the same as its name");const n=this.parent?._findCommand(e);if(n){const t=[n.name()].concat(n.aliases()).join("|");throw new Error(`cannot add alias '${e}' to command '${this.name()}' as already have command '${t}'`)}t._aliases.push(e);return this}aliases(e){if(e===undefined)return this._aliases;e.forEach((e=>this.alias(e)));return this}usage(e){if(e===undefined){if(this._usage)return this._usage;const e=this.registeredArguments.map((e=>d(e)));return[].concat(this.options.length||this._helpOption!==null?"[options]":[],this.commands.length?"[command]":[],this.registeredArguments.length?e:[]).join(" ")}this._usage=e;return this}name(e){if(e===undefined)return this._name;this._name=e;return this}helpGroup(e){if(e===undefined)return this._helpGroupHeading??"";this._helpGroupHeading=e;return this}commandsGroup(e){if(e===undefined)return this._defaultCommandGroup??"";this._defaultCommandGroup=e;return this}optionsGroup(e){if(e===undefined)return this._defaultOptionGroup??"";this._defaultOptionGroup=e;return this}_initOptionGroup(e){if(this._defaultOptionGroup&&!e.helpGroupHeading)e.helpGroup(this._defaultOptionGroup)}_initCommandGroup(e){if(this._defaultCommandGroup&&!e.helpGroup())e.helpGroup(this._defaultCommandGroup)}nameFromFilename(e){this._name=l.basename(e,l.extname(e));return this}executableDir(e){if(e===undefined)return this._executableDir;this._executableDir=e;return this}helpInformation(e){const t=this.createHelp();const n=this._getOutputContext(e);t.prepareContext({error:n.error,helpWidth:n.helpWidth,outputHasColors:n.hasColors});const r=t.formatHelp(this,t);if(n.hasColors)return r;return this._outputConfiguration.stripColor(r)}_getOutputContext(e){e=e||{};const t=!!e.error;let n;let r;let o;if(t){n=e=>this._outputConfiguration.writeErr(e);r=this._outputConfiguration.getErrHasColors();o=this._outputConfiguration.getErrHelpWidth()}else{n=e=>this._outputConfiguration.writeOut(e);r=this._outputConfiguration.getOutHasColors();o=this._outputConfiguration.getOutHelpWidth()}const write=e=>{if(!r)e=this._outputConfiguration.stripColor(e);return n(e)};return{error:t,write:write,hasColors:r,helpWidth:o}}outputHelp(e){let t;if(typeof e==="function"){t=e;e=undefined}const n=this._getOutputContext(e);const r={error:n.error,write:n.write,command:this};this._getCommandAndAncestors().reverse().forEach((e=>e.emit("beforeAllHelp",r)));this.emit("beforeHelp",r);let o=this.helpInformation({error:n.error});if(t){o=t(o);if(typeof o!=="string"&&!Buffer.isBuffer(o)){throw new Error("outputHelp callback must return a string or a Buffer")}}n.write(o);if(this._getHelpOption()?.long){this.emit(this._getHelpOption().long)}this.emit("afterHelp",r);this._getCommandAndAncestors().forEach((e=>e.emit("afterAllHelp",r)))}helpOption(e,t){if(typeof e==="boolean"){if(e){if(this._helpOption===null)this._helpOption=undefined;if(this._defaultOptionGroup){this._initOptionGroup(this._getHelpOption())}}else{this._helpOption=null}return this}this._helpOption=this.createOption(e??"-h, --help",t??"display help for command");if(e||t)this._initOptionGroup(this._helpOption);return this}_getHelpOption(){if(this._helpOption===undefined){this.helpOption(undefined,undefined)}return this._helpOption}addHelpOption(e){this._helpOption=e;this._initOptionGroup(e);return this}help(e){this.outputHelp(e);let t=Number(f.exitCode??0);if(t===0&&e&&typeof e!=="function"&&e.error){t=1}this._exit(t,"commander.help","(outputHelp)")}addHelpText(e,t){const n=["beforeAll","before","after","afterAll"];if(!n.includes(e)){throw new Error(`Unexpected value for position to addHelpText.\nExpecting one of '${n.join("', '")}'`)}const r=`${e}Help`;this.on(r,(e=>{let n;if(typeof t==="function"){n=t({error:e.error,command:e.command})}else{n=t}if(n){e.write(`${n}\n`)}}));return this}_outputHelpIfRequested(e){const t=this._getHelpOption();const n=t&&e.find((e=>t.is(e)));if(n){this.outputHelp();this._exit(0,"commander.helpDisplayed","(outputHelp)")}}}function incrementNodeInspectorPort(e){return e.map((e=>{if(!e.startsWith("--inspect")){return e}let t;let n="127.0.0.1";let r="9229";let o;if((o=e.match(/^(--inspect(-brk)?)$/))!==null){t=o[1]}else if((o=e.match(/^(--inspect(-brk|-port)?)=([^:]+)$/))!==null){t=o[1];if(/^\d+$/.test(o[3])){r=o[3]}else{n=o[3]}}else if((o=e.match(/^(--inspect(-brk|-port)?)=([^:]+):(\d+)$/))!==null){t=o[1];n=o[3];r=o[4]}if(t&&r!=="0"){return`${t}=${n}:${parseInt(r)+1}`}return e}))}function useColor(){if(f.env.NO_COLOR||f.env.FORCE_COLOR==="0"||f.env.FORCE_COLOR==="false")return false;if(f.env.FORCE_COLOR||f.env.CLICOLOR_FORCE!==undefined)return true;return undefined}t.Command=Command;t.useColor=useColor},568:(e,t)=>{class CommanderError extends Error{constructor(e,t,n){super(n);Error.captureStackTrace(this,this.constructor);this.name=this.constructor.name;this.code=t;this.exitCode=e;this.nestedError=undefined}}class InvalidArgumentError extends CommanderError{constructor(e){super(1,"commander.invalidArgument",e);Error.captureStackTrace(this,this.constructor);this.name=this.constructor.name}}t.CommanderError=CommanderError;t.InvalidArgumentError=InvalidArgumentError},727:(e,t,n)=>{const{humanReadableArgName:r}=n(343);class Help{constructor(){this.helpWidth=undefined;this.minWidthToWrap=40;this.sortSubcommands=false;this.sortOptions=false;this.showGlobalOptions=false}prepareContext(e){this.helpWidth=this.helpWidth??e.helpWidth??80}visibleCommands(e){const t=e.commands.filter((e=>!e._hidden));const n=e._getHelpCommand();if(n&&!n._hidden){t.push(n)}if(this.sortSubcommands){t.sort(((e,t)=>e.name().localeCompare(t.name())))}return t}compareOptions(e,t){const getSortKey=e=>e.short?e.short.replace(/^-/,""):e.long.replace(/^--/,"");return getSortKey(e).localeCompare(getSortKey(t))}visibleOptions(e){const t=e.options.filter((e=>!e.hidden));const n=e._getHelpOption();if(n&&!n.hidden){const r=n.short&&e._findOption(n.short);const o=n.long&&e._findOption(n.long);if(!r&&!o){t.push(n)}else if(n.long&&!o){t.push(e.createOption(n.long,n.description))}else if(n.short&&!r){t.push(e.createOption(n.short,n.description))}}if(this.sortOptions){t.sort(this.compareOptions)}return t}visibleGlobalOptions(e){if(!this.showGlobalOptions)return[];const t=[];for(let n=e.parent;n;n=n.parent){const e=n.options.filter((e=>!e.hidden));t.push(...e)}if(this.sortOptions){t.sort(this.compareOptions)}return t}visibleArguments(e){if(e._argsDescription){e.registeredArguments.forEach((t=>{t.description=t.description||e._argsDescription[t.name()]||""}))}if(e.registeredArguments.find((e=>e.description))){return e.registeredArguments}return[]}subcommandTerm(e){const t=e.registeredArguments.map((e=>r(e))).join(" ");return e._name+(e._aliases[0]?"|"+e._aliases[0]:"")+(e.options.length?" [options]":"")+(t?" "+t:"")}optionTerm(e){return e.flags}argumentTerm(e){return e.name()}longestSubcommandTermLength(e,t){return t.visibleCommands(e).reduce(((e,n)=>Math.max(e,this.displayWidth(t.styleSubcommandTerm(t.subcommandTerm(n))))),0)}longestOptionTermLength(e,t){return t.visibleOptions(e).reduce(((e,n)=>Math.max(e,this.displayWidth(t.styleOptionTerm(t.optionTerm(n))))),0)}longestGlobalOptionTermLength(e,t){return t.visibleGlobalOptions(e).reduce(((e,n)=>Math.max(e,this.displayWidth(t.styleOptionTerm(t.optionTerm(n))))),0)}longestArgumentTermLength(e,t){return t.visibleArguments(e).reduce(((e,n)=>Math.max(e,this.displayWidth(t.styleArgumentTerm(t.argumentTerm(n))))),0)}commandUsage(e){let t=e._name;if(e._aliases[0]){t=t+"|"+e._aliases[0]}let n="";for(let t=e.parent;t;t=t.parent){n=t.name()+" "+n}return n+t+" "+e.usage()}commandDescription(e){return e.description()}subcommandDescription(e){return e.summary()||e.description()}optionDescription(e){const t=[];if(e.argChoices){t.push(`choices: ${e.argChoices.map((e=>JSON.stringify(e))).join(", ")}`)}if(e.defaultValue!==undefined){const n=e.required||e.optional||e.isBoolean()&&typeof e.defaultValue==="boolean";if(n){t.push(`default: ${e.defaultValueDescription||JSON.stringify(e.defaultValue)}`)}}if(e.presetArg!==undefined&&e.optional){t.push(`preset: ${JSON.stringify(e.presetArg)}`)}if(e.envVar!==undefined){t.push(`env: ${e.envVar}`)}if(t.length>0){const n=`(${t.join(", ")})`;if(e.description){return`${e.description} ${n}`}return n}return e.description}argumentDescription(e){const t=[];if(e.argChoices){t.push(`choices: ${e.argChoices.map((e=>JSON.stringify(e))).join(", ")}`)}if(e.defaultValue!==undefined){t.push(`default: ${e.defaultValueDescription||JSON.stringify(e.defaultValue)}`)}if(t.length>0){const n=`(${t.join(", ")})`;if(e.description){return`${e.description} ${n}`}return n}return e.description}formatItemList(e,t,n){if(t.length===0)return[];return[n.styleTitle(e),...t,""]}groupItems(e,t,n){const r=new Map;e.forEach((e=>{const t=n(e);if(!r.has(t))r.set(t,[])}));t.forEach((e=>{const t=n(e);if(!r.has(t)){r.set(t,[])}r.get(t).push(e)}));return r}formatHelp(e,t){const n=t.padWidth(e,t);const r=t.helpWidth??80;function callFormatItem(e,r){return t.formatItem(e,n,r,t)}let o=[`${t.styleTitle("Usage:")} ${t.styleUsage(t.commandUsage(e))}`,""];const l=t.commandDescription(e);if(l.length>0){o=o.concat([t.boxWrap(t.styleCommandDescription(l),r),""])}const h=t.visibleArguments(e).map((e=>callFormatItem(t.styleArgumentTerm(t.argumentTerm(e)),t.styleArgumentDescription(t.argumentDescription(e)))));o=o.concat(this.formatItemList("Arguments:",h,t));const f=this.groupItems(e.options,t.visibleOptions(e),(e=>e.helpGroupHeading??"Options:"));f.forEach(((e,n)=>{const r=e.map((e=>callFormatItem(t.styleOptionTerm(t.optionTerm(e)),t.styleOptionDescription(t.optionDescription(e)))));o=o.concat(this.formatItemList(n,r,t))}));if(t.showGlobalOptions){const n=t.visibleGlobalOptions(e).map((e=>callFormatItem(t.styleOptionTerm(t.optionTerm(e)),t.styleOptionDescription(t.optionDescription(e)))));o=o.concat(this.formatItemList("Global Options:",n,t))}const p=this.groupItems(e.commands,t.visibleCommands(e),(e=>e.helpGroup()||"Commands:"));p.forEach(((e,n)=>{const r=e.map((e=>callFormatItem(t.styleSubcommandTerm(t.subcommandTerm(e)),t.styleSubcommandDescription(t.subcommandDescription(e)))));o=o.concat(this.formatItemList(n,r,t))}));return o.join("\n")}displayWidth(e){return stripColor(e).length}styleTitle(e){return e}styleUsage(e){return e.split(" ").map((e=>{if(e==="[options]")return this.styleOptionText(e);if(e==="[command]")return this.styleSubcommandText(e);if(e[0]==="["||e[0]==="<")return this.styleArgumentText(e);return this.styleCommandText(e)})).join(" ")}styleCommandDescription(e){return this.styleDescriptionText(e)}styleOptionDescription(e){return this.styleDescriptionText(e)}styleSubcommandDescription(e){return this.styleDescriptionText(e)}styleArgumentDescription(e){return this.styleDescriptionText(e)}styleDescriptionText(e){return e}styleOptionTerm(e){return this.styleOptionText(e)}styleSubcommandTerm(e){return e.split(" ").map((e=>{if(e==="[options]")return this.styleOptionText(e);if(e[0]==="["||e[0]==="<")return this.styleArgumentText(e);return this.styleSubcommandText(e)})).join(" ")}styleArgumentTerm(e){return this.styleArgumentText(e)}styleOptionText(e){return e}styleArgumentText(e){return e}styleSubcommandText(e){return e}styleCommandText(e){return e}padWidth(e,t){return Math.max(t.longestOptionTermLength(e,t),t.longestGlobalOptionTermLength(e,t),t.longestSubcommandTermLength(e,t),t.longestArgumentTermLength(e,t))}preformatted(e){return/\n[^\S\r\n]/.test(e)}formatItem(e,t,n,r){const o=2;const l=" ".repeat(o);if(!n)return l+e;const h=e.padEnd(t+e.length-r.displayWidth(e));const f=2;const p=this.helpWidth??80;const d=p-t-f-o;let _;if(d<this.minWidthToWrap||r.preformatted(n)){_=n}else{const e=r.boxWrap(n,d);_=e.replace(/\n/g,"\n"+" ".repeat(t+f))}return l+h+" ".repeat(f)+_.replace(/\n/g,`\n${l}`)}boxWrap(e,t){if(t<this.minWidthToWrap)return e;const n=e.split(/\r\n|\n/);const r=/[\s]*[^\s]+/g;const o=[];n.forEach((e=>{const n=e.match(r);if(n===null){o.push("");return}let l=[n.shift()];let h=this.displayWidth(l[0]);n.forEach((e=>{const n=this.displayWidth(e);if(h+n<=t){l.push(e);h+=n;return}o.push(l.join(""));const r=e.trimStart();l=[r];h=this.displayWidth(r)}));o.push(l.join(""))}));return o.join("\n")}}function stripColor(e){const t=/\x1b\[\d*(;\d*)*m/g;return e.replace(t,"")}t.Help=Help;t.stripColor=stripColor},177:(e,t,n)=>{const{InvalidArgumentError:r}=n(568);class Option{constructor(e,t){this.flags=e;this.description=t||"";this.required=e.includes("<");this.optional=e.includes("[");this.variadic=/\w\.\.\.[>\]]$/.test(e);this.mandatory=false;const n=splitOptionFlags(e);this.short=n.shortFlag;this.long=n.longFlag;this.negate=false;if(this.long){this.negate=this.long.startsWith("--no-")}this.defaultValue=undefined;this.defaultValueDescription=undefined;this.presetArg=undefined;this.envVar=undefined;this.parseArg=undefined;this.hidden=false;this.argChoices=undefined;this.conflictsWith=[];this.implied=undefined;this.helpGroupHeading=undefined}default(e,t){this.defaultValue=e;this.defaultValueDescription=t;return this}preset(e){this.presetArg=e;return this}conflicts(e){this.conflictsWith=this.conflictsWith.concat(e);return this}implies(e){let t=e;if(typeof e==="string"){t={[e]:true}}this.implied=Object.assign(this.implied||{},t);return this}env(e){this.envVar=e;return this}argParser(e){this.parseArg=e;return this}makeOptionMandatory(e=true){this.mandatory=!!e;return this}hideHelp(e=true){this.hidden=!!e;return this}_collectValue(e,t){if(t===this.defaultValue||!Array.isArray(t)){return[e]}t.push(e);return t}choices(e){this.argChoices=e.slice();this.parseArg=(e,t)=>{if(!this.argChoices.includes(e)){throw new r(`Allowed choices are ${this.argChoices.join(", ")}.`)}if(this.variadic){return this._collectValue(e,t)}return e};return this}name(){if(this.long){return this.long.replace(/^--/,"")}return this.short.replace(/^-/,"")}attributeName(){if(this.negate){return camelcase(this.name().replace(/^no-/,""))}return camelcase(this.name())}helpGroup(e){this.helpGroupHeading=e;return this}is(e){return this.short===e||this.long===e}isBoolean(){return!this.required&&!this.optional&&!this.negate}}class DualOptions{constructor(e){this.positiveOptions=new Map;this.negativeOptions=new Map;this.dualOptions=new Set;e.forEach((e=>{if(e.negate){this.negativeOptions.set(e.attributeName(),e)}else{this.positiveOptions.set(e.attributeName(),e)}}));this.negativeOptions.forEach(((e,t)=>{if(this.positiveOptions.has(t)){this.dualOptions.add(t)}}))}valueFromOption(e,t){const n=t.attributeName();if(!this.dualOptions.has(n))return true;const r=this.negativeOptions.get(n).presetArg;const o=r!==undefined?r:false;return t.negate===(o===e)}}function camelcase(e){return e.split("-").reduce(((e,t)=>e+t[0].toUpperCase()+t.slice(1)))}function splitOptionFlags(e){let t;let n;const r=/^-[^-]$/;const o=/^--[^-]/;const l=e.split(/[ |,]+/).concat("guard");if(r.test(l[0]))t=l.shift();if(o.test(l[0]))n=l.shift();if(!t&&r.test(l[0]))t=l.shift();if(!t&&o.test(l[0])){t=n;n=l.shift()}if(l[0].startsWith("-")){const t=l[0];const n=`option creation failed due to '${t}' in option flags '${e}'`;if(/^-[^-][^-]/.test(t))throw new Error(`${n}\n- a short flag is a single dash and a single character\n  - either use a single dash and a single character (for a short flag)\n  - or use a double dash for a long option (and can have two, like '--ws, --workspace')`);if(r.test(t))throw new Error(`${n}\n- too many short flags`);if(o.test(t))throw new Error(`${n}\n- too many long flags`);throw new Error(`${n}\n- unrecognised flag format`)}if(t===undefined&&n===undefined)throw new Error(`option creation failed due to no flags found in '${e}'.`);return{shortFlag:t,longFlag:n}}t.Option=Option;t.DualOptions=DualOptions},779:(e,t)=>{const n=3;function editDistance(e,t){if(Math.abs(e.length-t.length)>n)return Math.max(e.length,t.length);const r=[];for(let t=0;t<=e.length;t++){r[t]=[t]}for(let e=0;e<=t.length;e++){r[0][e]=e}for(let n=1;n<=t.length;n++){for(let o=1;o<=e.length;o++){let l=1;if(e[o-1]===t[n-1]){l=0}else{l=1}r[o][n]=Math.min(r[o-1][n]+1,r[o][n-1]+1,r[o-1][n-1]+l);if(o>1&&n>1&&e[o-1]===t[n-2]&&e[o-2]===t[n-1]){r[o][n]=Math.min(r[o][n],r[o-2][n-2]+1)}}}return r[e.length][t.length]}function suggestSimilar(e,t){if(!t||t.length===0)return"";t=Array.from(new Set(t));const r=e.startsWith("--");if(r){e=e.slice(2);t=t.map((e=>e.slice(2)))}let o=[];let l=n;const h=.4;t.forEach((t=>{if(t.length<=1)return;const n=editDistance(e,t);const r=Math.max(e.length,t.length);const f=(r-n)/r;if(f>h){if(n<l){l=n;o=[t]}else if(n===l){o.push(t)}}}));o.sort(((e,t)=>e.localeCompare(t)));if(r){o=o.map((e=>`--${e}`))}if(o.length>1){return`\n(Did you mean one of ${o.join(", ")}?)`}if(o.length===1){return`\n(Did you mean ${o[0]}?)`}return""}t.suggestSimilar=suggestSimilar}};var n={};function __nccwpck_require__(e){var r=n[e];if(r!==undefined){return r.exports}var o=n[e]={id:e,loaded:false,exports:{}};var l=true;try{t[e].call(o.exports,o,o.exports,__nccwpck_require__);l=false}finally{if(l)delete n[e]}o.loaded=true;return o.exports}(()=>{__nccwpck_require__.nmd=e=>{e.paths=[];if(!e.children)e.children=[];return e}})();if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=new URL(".",import.meta.url).pathname.slice(import.meta.url.match(/^file:\/\/\/\w:/)?1:0,-1)+"/";var r={};function arrayEach(e,t){var n=-1,r=e==null?0:e.length;while(++n<r){if(t(e[n],n,e)===false){break}}return e}const o=arrayEach;function createBaseFor(e){return function(t,n,r){var o=-1,l=Object(t),h=r(t),f=h.length;while(f--){var p=h[e?f:++o];if(n(l[p],p,l)===false){break}}return t}}const l=createBaseFor;var h=l();const f=h;function baseTimes(e,t){var n=-1,r=Array(e);while(++n<e){r[n]=t(n)}return r}const p=baseTimes;var d=typeof global=="object"&&global&&global.Object===Object&&global;const _=d;var m=typeof self=="object"&&self&&self.Object===Object&&self;var g=_||m||Function("return this")();const y=g;var b=y.Symbol;const v=b;var E=Object.prototype;var k=E.hasOwnProperty;var O=E.toString;var x=v?v.toStringTag:undefined;function getRawTag(e){var t=k.call(e,x),n=e[x];try{e[x]=undefined;var r=true}catch(e){}var o=O.call(e);if(r){if(t){e[x]=n}else{delete e[x]}}return o}const A=getRawTag;var w=Object.prototype;var S=w.toString;function objectToString(e){return S.call(e)}const R=objectToString;var N="[object Null]",C="[object Undefined]";var I=v?v.toStringTag:undefined;function baseGetTag(e){if(e==null){return e===undefined?C:N}return I&&I in Object(e)?A(e):R(e)}const L=baseGetTag;function isObjectLike(e){return e!=null&&typeof e=="object"}const P=isObjectLike;var M="[object Arguments]";function baseIsArguments(e){return P(e)&&L(e)==M}const F=baseIsArguments;var D=Object.prototype;var U=D.hasOwnProperty;var $=D.propertyIsEnumerable;var j=F(function(){return arguments}())?F:function(e){return P(e)&&U.call(e,"callee")&&!$.call(e,"callee")};const B=j;var W=Array.isArray;const V=W;function stubFalse(){return false}const G=stubFalse;var z=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var H=z&&typeof module=="object"&&module&&!module.nodeType&&module;var K=H&&H.exports===z;var q=K?y.Buffer:undefined;var X=q?q.isBuffer:undefined;var Y=X||G;const Q=Y;var J=9007199254740991;var Z=/^(?:0|[1-9]\d*)$/;function isIndex(e,t){var n=typeof e;t=t==null?J:t;return!!t&&(n=="number"||n!="symbol"&&Z.test(e))&&(e>-1&&e%1==0&&e<t)}const ee=isIndex;var te=9007199254740991;function isLength(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=te}const ne=isLength;var ie="[object Arguments]",re="[object Array]",se="[object Boolean]",ae="[object Date]",oe="[object Error]",ue="[object Function]",le="[object Map]",ce="[object Number]",he="[object Object]",fe="[object RegExp]",pe="[object Set]",de="[object String]",_e="[object WeakMap]";var me="[object ArrayBuffer]",ge="[object DataView]",be="[object Float32Array]",ve="[object Float64Array]",Ee="[object Int8Array]",Te="[object Int16Array]",ke="[object Int32Array]",Oe="[object Uint8Array]",xe="[object Uint8ClampedArray]",Ae="[object Uint16Array]",we="[object Uint32Array]";var Se={};Se[be]=Se[ve]=Se[Ee]=Se[Te]=Se[ke]=Se[Oe]=Se[xe]=Se[Ae]=Se[we]=true;Se[ie]=Se[re]=Se[me]=Se[se]=Se[ge]=Se[ae]=Se[oe]=Se[ue]=Se[le]=Se[ce]=Se[he]=Se[fe]=Se[pe]=Se[de]=Se[_e]=false;function baseIsTypedArray(e){return P(e)&&ne(e.length)&&!!Se[L(e)]}const Re=baseIsTypedArray;function baseUnary(e){return function(t){return e(t)}}const Ce=baseUnary;var Ie=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var Le=Ie&&typeof module=="object"&&module&&!module.nodeType&&module;var Pe=Le&&Le.exports===Ie;var Fe=Pe&&_.process;var De=function(){try{var e=Le&&Le.require&&Le.require("util").types;if(e){return e}return Fe&&Fe.binding&&Fe.binding("util")}catch(e){}}();const Ue=De;var $e=Ue&&Ue.isTypedArray;var je=$e?Ce($e):Re;const Be=je;var We=Object.prototype;var Ve=We.hasOwnProperty;function arrayLikeKeys(e,t){var n=V(e),r=!n&&B(e),o=!n&&!r&&Q(e),l=!n&&!r&&!o&&Be(e),h=n||r||o||l,f=h?p(e.length,String):[],d=f.length;for(var _ in e){if((t||Ve.call(e,_))&&!(h&&(_=="length"||o&&(_=="offset"||_=="parent")||l&&(_=="buffer"||_=="byteLength"||_=="byteOffset")||ee(_,d)))){f.push(_)}}return f}const Ge=arrayLikeKeys;var ze=Object.prototype;function isPrototype(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||ze;return e===n}const He=isPrototype;function overArg(e,t){return function(n){return e(t(n))}}const Ke=overArg;var qe=Ke(Object.keys,Object);const Xe=qe;var Ye=Object.prototype;var Qe=Ye.hasOwnProperty;function baseKeys(e){if(!He(e)){return Xe(e)}var t=[];for(var n in Object(e)){if(Qe.call(e,n)&&n!="constructor"){t.push(n)}}return t}const Je=baseKeys;function isObject(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}const Ze=isObject;var et="[object AsyncFunction]",tt="[object Function]",nt="[object GeneratorFunction]",rt="[object Proxy]";function isFunction(e){if(!Ze(e)){return false}var t=L(e);return t==tt||t==nt||t==et||t==rt}const st=isFunction;function isArrayLike(e){return e!=null&&ne(e.length)&&!st(e)}const ut=isArrayLike;function keys(e){return ut(e)?Ge(e):Je(e)}const lt=keys;function baseForOwn(e,t){return e&&f(e,t,lt)}const ct=baseForOwn;function createBaseEach(e,t){return function(n,r){if(n==null){return n}if(!ut(n)){return e(n,r)}var o=n.length,l=t?o:-1,h=Object(n);while(t?l--:++l<o){if(r(h[l],l,h)===false){break}}return n}}const ht=createBaseEach;var ft=ht(ct);const pt=ft;function identity(e){return e}const dt=identity;function castFunction(e){return typeof e=="function"?e:dt}const _t=castFunction;function forEach(e,t){var n=V(e)?o:pt;return n(e,_t(t))}const mt=forEach;function arrayMap(e,t){var n=-1,r=e==null?0:e.length,o=Array(r);while(++n<r){o[n]=t(e[n],n,e)}return o}const gt=arrayMap;function baseValues(e,t){return gt(t,(function(t){return e[t]}))}const yt=baseValues;function values_values(e){return e==null?[]:yt(e,lt(e))}const bt=values_values;var vt=y["__core-js_shared__"];const Et=vt;var Tt=function(){var e=/[^.]+$/.exec(Et&&Et.keys&&Et.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function isMasked(e){return!!Tt&&Tt in e}const kt=isMasked;var Ot=Function.prototype;var xt=Ot.toString;function toSource(e){if(e!=null){try{return xt.call(e)}catch(e){}try{return e+""}catch(e){}}return""}const At=toSource;var wt=/[\\^$.*+?()[\]{}|]/g;var St=/^\[object .+?Constructor\]$/;var Rt=Function.prototype,Nt=Object.prototype;var Ct=Rt.toString;var It=Nt.hasOwnProperty;var Lt=RegExp("^"+Ct.call(It).replace(wt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(e){if(!Ze(e)||kt(e)){return false}var t=st(e)?Lt:St;return t.test(At(e))}const Pt=baseIsNative;function getValue(e,t){return e==null?undefined:e[t]}const Mt=getValue;function getNative(e,t){var n=Mt(e,t);return Pt(n)?n:undefined}const Ft=getNative;var Dt=Ft(y,"DataView");const Ut=Dt;var $t=Ft(y,"Map");const jt=$t;var Bt=Ft(y,"Promise");const Wt=Bt;var Vt=Ft(y,"Set");const Gt=Vt;var zt=Ft(y,"WeakMap");const Ht=zt;var Kt="[object Map]",qt="[object Object]",Xt="[object Promise]",Yt="[object Set]",Qt="[object WeakMap]";var Jt="[object DataView]";var Zt=At(Ut),en=At(jt),tn=At(Wt),nn=At(Gt),rn=At(Ht);var sn=L;if(Ut&&sn(new Ut(new ArrayBuffer(1)))!=Jt||jt&&sn(new jt)!=Kt||Wt&&sn(Wt.resolve())!=Xt||Gt&&sn(new Gt)!=Yt||Ht&&sn(new Ht)!=Qt){sn=function(e){var t=L(e),n=t==qt?e.constructor:undefined,r=n?At(n):"";if(r){switch(r){case Zt:return Jt;case en:return Kt;case tn:return Xt;case nn:return Yt;case rn:return Qt}}return t}}const an=sn;var on="[object Map]",un="[object Set]";var ln=Object.prototype;var cn=ln.hasOwnProperty;function isEmpty(e){if(e==null){return true}if(ut(e)&&(V(e)||typeof e=="string"||typeof e.splice=="function"||Q(e)||Be(e)||B(e))){return!e.length}var t=an(e);if(t==on||t==un){return!e.size}if(He(e)){return!Je(e).length}for(var n in e){if(cn.call(e,n)){return false}}return true}const hn=isEmpty;function listCacheClear(){this.__data__=[];this.size=0}const fn=listCacheClear;function eq(e,t){return e===t||e!==e&&t!==t}const pn=eq;function assocIndexOf(e,t){var n=e.length;while(n--){if(pn(e[n][0],t)){return n}}return-1}const dn=assocIndexOf;var _n=Array.prototype;var mn=_n.splice;function listCacheDelete(e){var t=this.__data__,n=dn(t,e);if(n<0){return false}var r=t.length-1;if(n==r){t.pop()}else{mn.call(t,n,1)}--this.size;return true}const gn=listCacheDelete;function listCacheGet(e){var t=this.__data__,n=dn(t,e);return n<0?undefined:t[n][1]}const yn=listCacheGet;function listCacheHas(e){return dn(this.__data__,e)>-1}const bn=listCacheHas;function listCacheSet(e,t){var n=this.__data__,r=dn(n,e);if(r<0){++this.size;n.push([e,t])}else{n[r][1]=t}return this}const vn=listCacheSet;function ListCache(e){var t=-1,n=e==null?0:e.length;this.clear();while(++t<n){var r=e[t];this.set(r[0],r[1])}}ListCache.prototype.clear=fn;ListCache.prototype["delete"]=gn;ListCache.prototype.get=yn;ListCache.prototype.has=bn;ListCache.prototype.set=vn;const En=ListCache;function stackClear(){this.__data__=new En;this.size=0}const Tn=stackClear;function stackDelete(e){var t=this.__data__,n=t["delete"](e);this.size=t.size;return n}const kn=stackDelete;function stackGet(e){return this.__data__.get(e)}const On=stackGet;function stackHas(e){return this.__data__.has(e)}const xn=stackHas;var An=Ft(Object,"create");const wn=An;function hashClear(){this.__data__=wn?wn(null):{};this.size=0}const Sn=hashClear;function hashDelete(e){var t=this.has(e)&&delete this.__data__[e];this.size-=t?1:0;return t}const Rn=hashDelete;var Nn="__lodash_hash_undefined__";var Cn=Object.prototype;var In=Cn.hasOwnProperty;function hashGet(e){var t=this.__data__;if(wn){var n=t[e];return n===Nn?undefined:n}return In.call(t,e)?t[e]:undefined}const Ln=hashGet;var Pn=Object.prototype;var Mn=Pn.hasOwnProperty;function hashHas(e){var t=this.__data__;return wn?t[e]!==undefined:Mn.call(t,e)}const Fn=hashHas;var Dn="__lodash_hash_undefined__";function hashSet(e,t){var n=this.__data__;this.size+=this.has(e)?0:1;n[e]=wn&&t===undefined?Dn:t;return this}const Un=hashSet;function Hash(e){var t=-1,n=e==null?0:e.length;this.clear();while(++t<n){var r=e[t];this.set(r[0],r[1])}}Hash.prototype.clear=Sn;Hash.prototype["delete"]=Rn;Hash.prototype.get=Ln;Hash.prototype.has=Fn;Hash.prototype.set=Un;const $n=Hash;function mapCacheClear(){this.size=0;this.__data__={hash:new $n,map:new(jt||En),string:new $n}}const jn=mapCacheClear;function isKeyable(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}const Bn=isKeyable;function getMapData(e,t){var n=e.__data__;return Bn(t)?n[typeof t=="string"?"string":"hash"]:n.map}const Wn=getMapData;function mapCacheDelete(e){var t=Wn(this,e)["delete"](e);this.size-=t?1:0;return t}const Vn=mapCacheDelete;function mapCacheGet(e){return Wn(this,e).get(e)}const Gn=mapCacheGet;function mapCacheHas(e){return Wn(this,e).has(e)}const zn=mapCacheHas;function mapCacheSet(e,t){var n=Wn(this,e),r=n.size;n.set(e,t);this.size+=n.size==r?0:1;return this}const Hn=mapCacheSet;function MapCache(e){var t=-1,n=e==null?0:e.length;this.clear();while(++t<n){var r=e[t];this.set(r[0],r[1])}}MapCache.prototype.clear=jn;MapCache.prototype["delete"]=Vn;MapCache.prototype.get=Gn;MapCache.prototype.has=zn;MapCache.prototype.set=Hn;const Kn=MapCache;var qn=200;function stackSet(e,t){var n=this.__data__;if(n instanceof En){var r=n.__data__;if(!jt||r.length<qn-1){r.push([e,t]);this.size=++n.size;return this}n=this.__data__=new Kn(r)}n.set(e,t);this.size=n.size;return this}const Xn=stackSet;function Stack(e){var t=this.__data__=new En(e);this.size=t.size}Stack.prototype.clear=Tn;Stack.prototype["delete"]=kn;Stack.prototype.get=On;Stack.prototype.has=xn;Stack.prototype.set=Xn;const Yn=Stack;var Qn="__lodash_hash_undefined__";function setCacheAdd(e){this.__data__.set(e,Qn);return this}const Jn=setCacheAdd;function setCacheHas(e){return this.__data__.has(e)}const Zn=setCacheHas;function SetCache(e){var t=-1,n=e==null?0:e.length;this.__data__=new Kn;while(++t<n){this.add(e[t])}}SetCache.prototype.add=SetCache.prototype.push=Jn;SetCache.prototype.has=Zn;const ei=SetCache;function arraySome(e,t){var n=-1,r=e==null?0:e.length;while(++n<r){if(t(e[n],n,e)){return true}}return false}const ti=arraySome;function cacheHas(e,t){return e.has(t)}const ni=cacheHas;var ii=1,ri=2;function equalArrays(e,t,n,r,o,l){var h=n&ii,f=e.length,p=t.length;if(f!=p&&!(h&&p>f)){return false}var d=l.get(e);var _=l.get(t);if(d&&_){return d==t&&_==e}var m=-1,g=true,y=n&ri?new ei:undefined;l.set(e,t);l.set(t,e);while(++m<f){var b=e[m],v=t[m];if(r){var E=h?r(v,b,m,t,e,l):r(b,v,m,e,t,l)}if(E!==undefined){if(E){continue}g=false;break}if(y){if(!ti(t,(function(e,t){if(!ni(y,t)&&(b===e||o(b,e,n,r,l))){return y.push(t)}}))){g=false;break}}else if(!(b===v||o(b,v,n,r,l))){g=false;break}}l["delete"](e);l["delete"](t);return g}const si=equalArrays;var ai=y.Uint8Array;const oi=ai;function mapToArray(e){var t=-1,n=Array(e.size);e.forEach((function(e,r){n[++t]=[r,e]}));return n}const ui=mapToArray;function setToArray(e){var t=-1,n=Array(e.size);e.forEach((function(e){n[++t]=e}));return n}const li=setToArray;var ci=1,hi=2;var fi="[object Boolean]",pi="[object Date]",di="[object Error]",_i="[object Map]",mi="[object Number]",gi="[object RegExp]",yi="[object Set]",bi="[object String]",vi="[object Symbol]";var Ei="[object ArrayBuffer]",Ti="[object DataView]";var ki=v?v.prototype:undefined,Oi=ki?ki.valueOf:undefined;function equalByTag(e,t,n,r,o,l,h){switch(n){case Ti:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset){return false}e=e.buffer;t=t.buffer;case Ei:if(e.byteLength!=t.byteLength||!l(new oi(e),new oi(t))){return false}return true;case fi:case pi:case mi:return pn(+e,+t);case di:return e.name==t.name&&e.message==t.message;case gi:case bi:return e==t+"";case _i:var f=ui;case yi:var p=r&ci;f||(f=li);if(e.size!=t.size&&!p){return false}var d=h.get(e);if(d){return d==t}r|=hi;h.set(e,t);var _=si(f(e),f(t),r,o,l,h);h["delete"](e);return _;case vi:if(Oi){return Oi.call(e)==Oi.call(t)}}return false}const xi=equalByTag;function arrayPush(e,t){var n=-1,r=t.length,o=e.length;while(++n<r){e[o+n]=t[n]}return e}const Ai=arrayPush;function baseGetAllKeys(e,t,n){var r=t(e);return V(e)?r:Ai(r,n(e))}const wi=baseGetAllKeys;function arrayFilter(e,t){var n=-1,r=e==null?0:e.length,o=0,l=[];while(++n<r){var h=e[n];if(t(h,n,e)){l[o++]=h}}return l}const Si=arrayFilter;function stubArray(){return[]}const Ri=stubArray;var Ni=Object.prototype;var Ci=Ni.propertyIsEnumerable;var Ii=Object.getOwnPropertySymbols;var Li=!Ii?Ri:function(e){if(e==null){return[]}e=Object(e);return Si(Ii(e),(function(t){return Ci.call(e,t)}))};const Pi=Li;function getAllKeys(e){return wi(e,lt,Pi)}const Mi=getAllKeys;var Fi=1;var Di=Object.prototype;var Ui=Di.hasOwnProperty;function equalObjects(e,t,n,r,o,l){var h=n&Fi,f=Mi(e),p=f.length,d=Mi(t),_=d.length;if(p!=_&&!h){return false}var m=p;while(m--){var g=f[m];if(!(h?g in t:Ui.call(t,g))){return false}}var y=l.get(e);var b=l.get(t);if(y&&b){return y==t&&b==e}var v=true;l.set(e,t);l.set(t,e);var E=h;while(++m<p){g=f[m];var k=e[g],O=t[g];if(r){var x=h?r(O,k,g,t,e,l):r(k,O,g,e,t,l)}if(!(x===undefined?k===O||o(k,O,n,r,l):x)){v=false;break}E||(E=g=="constructor")}if(v&&!E){var A=e.constructor,w=t.constructor;if(A!=w&&("constructor"in e&&"constructor"in t)&&!(typeof A=="function"&&A instanceof A&&typeof w=="function"&&w instanceof w)){v=false}}l["delete"](e);l["delete"](t);return v}const $i=equalObjects;var ji=1;var Bi="[object Arguments]",Wi="[object Array]",Vi="[object Object]";var Gi=Object.prototype;var zi=Gi.hasOwnProperty;function baseIsEqualDeep(e,t,n,r,o,l){var h=V(e),f=V(t),p=h?Wi:an(e),d=f?Wi:an(t);p=p==Bi?Vi:p;d=d==Bi?Vi:d;var _=p==Vi,m=d==Vi,g=p==d;if(g&&Q(e)){if(!Q(t)){return false}h=true;_=false}if(g&&!_){l||(l=new Yn);return h||Be(e)?si(e,t,n,r,o,l):xi(e,t,p,n,r,o,l)}if(!(n&ji)){var y=_&&zi.call(e,"__wrapped__"),b=m&&zi.call(t,"__wrapped__");if(y||b){var v=y?e.value():e,E=b?t.value():t;l||(l=new Yn);return o(v,E,n,r,l)}}if(!g){return false}l||(l=new Yn);return $i(e,t,n,r,o,l)}const Hi=baseIsEqualDeep;function baseIsEqual(e,t,n,r,o){if(e===t){return true}if(e==null||t==null||!P(e)&&!P(t)){return e!==e&&t!==t}return Hi(e,t,n,r,baseIsEqual,o)}const Ki=baseIsEqual;var qi=1,Xi=2;function baseIsMatch(e,t,n,r){var o=n.length,l=o,h=!r;if(e==null){return!l}e=Object(e);while(o--){var f=n[o];if(h&&f[2]?f[1]!==e[f[0]]:!(f[0]in e)){return false}}while(++o<l){f=n[o];var p=f[0],d=e[p],_=f[1];if(h&&f[2]){if(d===undefined&&!(p in e)){return false}}else{var m=new Yn;if(r){var g=r(d,_,p,e,t,m)}if(!(g===undefined?Ki(_,d,qi|Xi,r,m):g)){return false}}}return true}const Yi=baseIsMatch;function isStrictComparable(e){return e===e&&!Ze(e)}const Qi=isStrictComparable;function getMatchData(e){var t=lt(e),n=t.length;while(n--){var r=t[n],o=e[r];t[n]=[r,o,Qi(o)]}return t}const Ji=getMatchData;function matchesStrictComparable(e,t){return function(n){if(n==null){return false}return n[e]===t&&(t!==undefined||e in Object(n))}}const Zi=matchesStrictComparable;function baseMatches(e){var t=Ji(e);if(t.length==1&&t[0][2]){return Zi(t[0][0],t[0][1])}return function(n){return n===e||Yi(n,e,t)}}const er=baseMatches;var tr="[object Symbol]";function isSymbol(e){return typeof e=="symbol"||P(e)&&L(e)==tr}const nr=isSymbol;var ir=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,rr=/^\w*$/;function isKey(e,t){if(V(e)){return false}var n=typeof e;if(n=="number"||n=="symbol"||n=="boolean"||e==null||nr(e)){return true}return rr.test(e)||!ir.test(e)||t!=null&&e in Object(t)}const sr=isKey;var ar="Expected a function";function memoize(e,t){if(typeof e!="function"||t!=null&&typeof t!="function"){throw new TypeError(ar)}var memoized=function(){var n=arguments,r=t?t.apply(this,n):n[0],o=memoized.cache;if(o.has(r)){return o.get(r)}var l=e.apply(this,n);memoized.cache=o.set(r,l)||o;return l};memoized.cache=new(memoize.Cache||Kn);return memoized}memoize.Cache=Kn;const or=memoize;var ur=500;function memoizeCapped(e){var t=or(e,(function(e){if(n.size===ur){n.clear()}return e}));var n=t.cache;return t}const lr=memoizeCapped;var cr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g;var hr=/\\(\\)?/g;var fr=lr((function(e){var t=[];if(e.charCodeAt(0)===46){t.push("")}e.replace(cr,(function(e,n,r,o){t.push(r?o.replace(hr,"$1"):n||e)}));return t}));const pr=fr;var dr=1/0;var _r=v?v.prototype:undefined,mr=_r?_r.toString:undefined;function baseToString(e){if(typeof e=="string"){return e}if(V(e)){return gt(e,baseToString)+""}if(nr(e)){return mr?mr.call(e):""}var t=e+"";return t=="0"&&1/e==-dr?"-0":t}const gr=baseToString;function toString_toString(e){return e==null?"":gr(e)}const yr=toString_toString;function castPath(e,t){if(V(e)){return e}return sr(e,t)?[e]:pr(yr(e))}const br=castPath;var vr=1/0;function toKey(e){if(typeof e=="string"||nr(e)){return e}var t=e+"";return t=="0"&&1/e==-vr?"-0":t}const Er=toKey;function baseGet(e,t){t=br(t,e);var n=0,r=t.length;while(e!=null&&n<r){e=e[Er(t[n++])]}return n&&n==r?e:undefined}const Tr=baseGet;function get(e,t,n){var r=e==null?undefined:Tr(e,t);return r===undefined?n:r}const kr=get;function baseHasIn(e,t){return e!=null&&t in Object(e)}const Or=baseHasIn;function hasPath(e,t,n){t=br(t,e);var r=-1,o=t.length,l=false;while(++r<o){var h=Er(t[r]);if(!(l=e!=null&&n(e,h))){break}e=e[h]}if(l||++r!=o){return l}o=e==null?0:e.length;return!!o&&ne(o)&&ee(h,o)&&(V(e)||B(e))}const xr=hasPath;function hasIn(e,t){return e!=null&&xr(e,t,Or)}const Ar=hasIn;var wr=1,Sr=2;function baseMatchesProperty(e,t){if(sr(e)&&Qi(t)){return Zi(Er(e),t)}return function(n){var r=kr(n,e);return r===undefined&&r===t?Ar(n,e):Ki(t,r,wr|Sr)}}const Rr=baseMatchesProperty;function baseProperty(e){return function(t){return t==null?undefined:t[e]}}const Nr=baseProperty;function basePropertyDeep(e){return function(t){return Tr(t,e)}}const Cr=basePropertyDeep;function property(e){return sr(e)?Nr(Er(e)):Cr(e)}const Ir=property;function baseIteratee(e){if(typeof e=="function"){return e}if(e==null){return dt}if(typeof e=="object"){return V(e)?Rr(e[0],e[1]):er(e)}return Ir(e)}const Lr=baseIteratee;function baseMap(e,t){var n=-1,r=ut(e)?Array(e.length):[];pt(e,(function(e,o,l){r[++n]=t(e,o,l)}));return r}const Pr=baseMap;function map_map(e,t){var n=V(e)?gt:Pr;return n(e,Lr(t,3))}const Mr=map_map;var Fr=Object.prototype;var Dr=Fr.hasOwnProperty;function baseHas(e,t){return e!=null&&Dr.call(e,t)}const Ur=baseHas;function has(e,t){return e!=null&&xr(e,t,Ur)}const $r=has;var jr=function(){try{var e=Ft(Object,"defineProperty");e({},"",{});return e}catch(e){}}();const Br=jr;function baseAssignValue(e,t,n){if(t=="__proto__"&&Br){Br(e,t,{configurable:true,enumerable:true,value:n,writable:true})}else{e[t]=n}}const Wr=baseAssignValue;var Vr=Object.prototype;var Gr=Vr.hasOwnProperty;function assignValue(e,t,n){var r=e[t];if(!(Gr.call(e,t)&&pn(r,n))||n===undefined&&!(t in e)){Wr(e,t,n)}}const zr=assignValue;function copyObject(e,t,n,r){var o=!n;n||(n={});var l=-1,h=t.length;while(++l<h){var f=t[l];var p=r?r(n[f],e[f],f,n,e):undefined;if(p===undefined){p=e[f]}if(o){Wr(n,f,p)}else{zr(n,f,p)}}return n}const Hr=copyObject;function baseAssign(e,t){return e&&Hr(t,lt(t),e)}const Kr=baseAssign;function nativeKeysIn(e){var t=[];if(e!=null){for(var n in Object(e)){t.push(n)}}return t}const qr=nativeKeysIn;var Xr=Object.prototype;var Yr=Xr.hasOwnProperty;function baseKeysIn(e){if(!Ze(e)){return qr(e)}var t=He(e),n=[];for(var r in e){if(!(r=="constructor"&&(t||!Yr.call(e,r)))){n.push(r)}}return n}const Qr=baseKeysIn;function keysIn(e){return ut(e)?Ge(e,true):Qr(e)}const Jr=keysIn;function baseAssignIn(e,t){return e&&Hr(t,Jr(t),e)}const Zr=baseAssignIn;var es=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var ts=es&&typeof module=="object"&&module&&!module.nodeType&&module;var ns=ts&&ts.exports===es;var is=ns?y.Buffer:undefined,rs=is?is.allocUnsafe:undefined;function cloneBuffer(e,t){if(t){return e.slice()}var n=e.length,r=rs?rs(n):new e.constructor(n);e.copy(r);return r}const ss=cloneBuffer;function copyArray(e,t){var n=-1,r=e.length;t||(t=Array(r));while(++n<r){t[n]=e[n]}return t}const as=copyArray;function copySymbols(e,t){return Hr(e,Pi(e),t)}const os=copySymbols;var us=Ke(Object.getPrototypeOf,Object);const ls=us;var cs=Object.getOwnPropertySymbols;var hs=!cs?Ri:function(e){var t=[];while(e){Ai(t,Pi(e));e=ls(e)}return t};const fs=hs;function copySymbolsIn(e,t){return Hr(e,fs(e),t)}const ps=copySymbolsIn;function getAllKeysIn(e){return wi(e,Jr,fs)}const ds=getAllKeysIn;var _s=Object.prototype;var ms=_s.hasOwnProperty;function initCloneArray(e){var t=e.length,n=new e.constructor(t);if(t&&typeof e[0]=="string"&&ms.call(e,"index")){n.index=e.index;n.input=e.input}return n}const gs=initCloneArray;function cloneArrayBuffer(e){var t=new e.constructor(e.byteLength);new oi(t).set(new oi(e));return t}const ys=cloneArrayBuffer;function cloneDataView(e,t){var n=t?ys(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.byteLength)}const bs=cloneDataView;var vs=/\w*$/;function cloneRegExp(e){var t=new e.constructor(e.source,vs.exec(e));t.lastIndex=e.lastIndex;return t}const Es=cloneRegExp;var Ts=v?v.prototype:undefined,ks=Ts?Ts.valueOf:undefined;function cloneSymbol(e){return ks?Object(ks.call(e)):{}}const Os=cloneSymbol;function cloneTypedArray(e,t){var n=t?ys(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}const xs=cloneTypedArray;var As="[object Boolean]",ws="[object Date]",Ss="[object Map]",Rs="[object Number]",Ns="[object RegExp]",Cs="[object Set]",Is="[object String]",Ls="[object Symbol]";var Ps="[object ArrayBuffer]",Ms="[object DataView]",Fs="[object Float32Array]",Ds="[object Float64Array]",Us="[object Int8Array]",$s="[object Int16Array]",js="[object Int32Array]",Bs="[object Uint8Array]",Ws="[object Uint8ClampedArray]",Vs="[object Uint16Array]",Gs="[object Uint32Array]";function initCloneByTag(e,t,n){var r=e.constructor;switch(t){case Ps:return ys(e);case As:case ws:return new r(+e);case Ms:return bs(e,n);case Fs:case Ds:case Us:case $s:case js:case Bs:case Ws:case Vs:case Gs:return xs(e,n);case Ss:return new r;case Rs:case Is:return new r(e);case Ns:return Es(e);case Cs:return new r;case Ls:return Os(e)}}const zs=initCloneByTag;var Hs=Object.create;var Ks=function(){function object(){}return function(e){if(!Ze(e)){return{}}if(Hs){return Hs(e)}object.prototype=e;var t=new object;object.prototype=undefined;return t}}();const qs=Ks;function initCloneObject(e){return typeof e.constructor=="function"&&!He(e)?qs(ls(e)):{}}const Xs=initCloneObject;var Ys="[object Map]";function baseIsMap(e){return P(e)&&an(e)==Ys}const Qs=baseIsMap;var Js=Ue&&Ue.isMap;var Zs=Js?Ce(Js):Qs;const ea=Zs;var ta="[object Set]";function baseIsSet(e){return P(e)&&an(e)==ta}const na=baseIsSet;var ia=Ue&&Ue.isSet;var ra=ia?Ce(ia):na;const sa=ra;var aa=1,oa=2,ua=4;var la="[object Arguments]",ca="[object Array]",ha="[object Boolean]",fa="[object Date]",pa="[object Error]",da="[object Function]",_a="[object GeneratorFunction]",ma="[object Map]",ga="[object Number]",ya="[object Object]",ba="[object RegExp]",va="[object Set]",Ea="[object String]",Ta="[object Symbol]",ka="[object WeakMap]";var Oa="[object ArrayBuffer]",xa="[object DataView]",Aa="[object Float32Array]",wa="[object Float64Array]",Sa="[object Int8Array]",Ra="[object Int16Array]",Na="[object Int32Array]",Ca="[object Uint8Array]",Ia="[object Uint8ClampedArray]",La="[object Uint16Array]",Pa="[object Uint32Array]";var Ma={};Ma[la]=Ma[ca]=Ma[Oa]=Ma[xa]=Ma[ha]=Ma[fa]=Ma[Aa]=Ma[wa]=Ma[Sa]=Ma[Ra]=Ma[Na]=Ma[ma]=Ma[ga]=Ma[ya]=Ma[ba]=Ma[va]=Ma[Ea]=Ma[Ta]=Ma[Ca]=Ma[Ia]=Ma[La]=Ma[Pa]=true;Ma[pa]=Ma[da]=Ma[ka]=false;function baseClone(e,t,n,r,l,h){var f,p=t&aa,d=t&oa,_=t&ua;if(n){f=l?n(e,r,l,h):n(e)}if(f!==undefined){return f}if(!Ze(e)){return e}var m=V(e);if(m){f=gs(e);if(!p){return as(e,f)}}else{var g=an(e),y=g==da||g==_a;if(Q(e)){return ss(e,p)}if(g==ya||g==la||y&&!l){f=d||y?{}:Xs(e);if(!p){return d?ps(e,Zr(f,e)):os(e,Kr(f,e))}}else{if(!Ma[g]){return l?e:{}}f=zs(e,g,p)}}h||(h=new Yn);var b=h.get(e);if(b){return b}h.set(e,f);if(sa(e)){e.forEach((function(r){f.add(baseClone(r,t,n,r,e,h))}))}else if(ea(e)){e.forEach((function(r,o){f.set(o,baseClone(r,t,n,o,e,h))}))}var v=_?d?ds:Mi:d?Jr:lt;var E=m?undefined:v(e);o(E||e,(function(r,o){if(E){o=r;r=e[o]}zr(f,o,baseClone(r,t,n,o,e,h))}));return f}const Fa=baseClone;var Da=4;function clone(e){return Fa(e,Da)}const Ua=clone;function toFastProperties(e){function FakeConstructor(){}FakeConstructor.prototype=e;const t=new FakeConstructor;function fakeAccess(){return typeof t.bar}fakeAccess();fakeAccess();if(true)return e;(0,eval)(e)}function baseSlice(e,t,n){var r=-1,o=e.length;if(t<0){t=-t>o?0:o+t}n=n>o?o:n;if(n<0){n+=o}o=t>n?0:n-t>>>0;t>>>=0;var l=Array(o);while(++r<o){l[r]=e[r+t]}return l}const $a=baseSlice;var ja=/\s/;function trimmedEndIndex(e){var t=e.length;while(t--&&ja.test(e.charAt(t))){}return t}const Ba=trimmedEndIndex;var Wa=/^\s+/;function baseTrim(e){return e?e.slice(0,Ba(e)+1).replace(Wa,""):e}const Va=baseTrim;var Ga=0/0;var za=/^[-+]0x[0-9a-f]+$/i;var Ha=/^0b[01]+$/i;var Ka=/^0o[0-7]+$/i;var qa=parseInt;function toNumber(e){if(typeof e=="number"){return e}if(nr(e)){return Ga}if(Ze(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Ze(t)?t+"":t}if(typeof e!="string"){return e===0?e:+e}e=Va(e);var n=Ha.test(e);return n||Ka.test(e)?qa(e.slice(2),n?2:8):za.test(e)?Ga:+e}const Xa=toNumber;var Ya=1/0,Qa=17976931348623157e292;function toFinite(e){if(!e){return e===0?e:0}e=Xa(e);if(e===Ya||e===-Ya){var t=e<0?-1:1;return t*Qa}return e===e?e:0}const Ja=toFinite;function toInteger(e){var t=Ja(e),n=t%1;return t===t?n?t-n:t:0}const Za=toInteger;function drop(e,t,n){var r=e==null?0:e.length;if(!r){return[]}t=n||t===undefined?1:Za(t);return $a(e,t<0?0:t,r)}const eo=drop;var to="[object String]";function isString(e){return typeof e=="string"||!V(e)&&P(e)&&L(e)==to}const no=isString;function apply(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}const io=apply;var ro=Math.max;function overRest(e,t,n){t=ro(t===undefined?e.length-1:t,0);return function(){var r=arguments,o=-1,l=ro(r.length-t,0),h=Array(l);while(++o<l){h[o]=r[t+o]}o=-1;var f=Array(t+1);while(++o<t){f[o]=r[o]}f[t]=n(h);return io(e,this,f)}}const so=overRest;function constant(e){return function(){return e}}const ao=constant;var oo=!Br?dt:function(e,t){return Br(e,"toString",{configurable:true,enumerable:false,value:ao(t),writable:true})};const uo=oo;var lo=800,co=16;var ho=Date.now;function shortOut(e){var t=0,n=0;return function(){var r=ho(),o=co-(r-n);n=r;if(o>0){if(++t>=lo){return arguments[0]}}else{t=0}return e.apply(undefined,arguments)}}const fo=shortOut;var po=fo(uo);const _o=po;function baseRest(e,t){return _o(so(e,t,dt),e+"")}const mo=baseRest;function isIterateeCall(e,t,n){if(!Ze(n)){return false}var r=typeof t;if(r=="number"?ut(n)&&ee(t,n.length):r=="string"&&t in n){return pn(n[t],e)}return false}const go=isIterateeCall;function createAssigner(e){return mo((function(t,n){var r=-1,o=n.length,l=o>1?n[o-1]:undefined,h=o>2?n[2]:undefined;l=e.length>3&&typeof l=="function"?(o--,l):undefined;if(h&&go(n[0],n[1],h)){l=o<3?undefined:l;o=1}t=Object(t);while(++r<o){var f=n[r];if(f){e(t,f,r,l)}}return t}))}const yo=createAssigner;var bo=Object.prototype;var vo=bo.hasOwnProperty;var Eo=yo((function(e,t){if(He(t)||ut(t)){Hr(t,lt(t),e);return}for(var n in t){if(vo.call(t,n)){zr(e,n,t[n])}}}));const To=Eo;function baseSet(e,t,n,r){if(!Ze(e)){return e}t=br(t,e);var o=-1,l=t.length,h=l-1,f=e;while(f!=null&&++o<l){var p=Er(t[o]),d=n;if(p==="__proto__"||p==="constructor"||p==="prototype"){return e}if(o!=h){var _=f[p];d=r?r(_,p,f):undefined;if(d===undefined){d=Ze(_)?_:ee(t[o+1])?[]:{}}}zr(f,p,d);f=f[p]}return e}const ko=baseSet;function basePickBy(e,t,n){var r=-1,o=t.length,l={};while(++r<o){var h=t[r],f=Tr(e,h);if(n(f,h)){ko(l,br(h,e),f)}}return l}const Oo=basePickBy;function pickBy(e,t){if(e==null){return{}}var n=gt(ds(e),(function(e){return[e]}));t=Lr(t);return Oo(e,n,(function(e,n){return t(e,n[0])}))}const xo=pickBy;var Ao="[object RegExp]";function baseIsRegExp(e){return P(e)&&L(e)==Ao}const wo=baseIsRegExp;var So=Ue&&Ue.isRegExp;var Ro=So?Ce(So):wo;const No=Ro;function tokenLabel(e){if(hasTokenLabel(e)){return e.LABEL}else{return e.name}}function hasTokenLabel(e){return no(e.LABEL)&&e.LABEL!==""}class AbstractProduction{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){this._definition=e}accept(e){e.visit(this);mt(this.definition,(t=>{t.accept(e)}))}}class model_NonTerminal extends AbstractProduction{constructor(e){super([]);this.idx=1;To(this,xo(e,(e=>e!==undefined)))}set definition(e){}get definition(){if(this.referencedRule!==undefined){return this.referencedRule.definition}return[]}accept(e){e.visit(this)}}class Rule extends AbstractProduction{constructor(e){super(e.definition);this.orgText="";To(this,xo(e,(e=>e!==undefined)))}}class Alternative extends AbstractProduction{constructor(e){super(e.definition);this.ignoreAmbiguities=false;To(this,xo(e,(e=>e!==undefined)))}}class Option extends AbstractProduction{constructor(e){super(e.definition);this.idx=1;To(this,xo(e,(e=>e!==undefined)))}}class RepetitionMandatory extends AbstractProduction{constructor(e){super(e.definition);this.idx=1;To(this,xo(e,(e=>e!==undefined)))}}class RepetitionMandatoryWithSeparator extends AbstractProduction{constructor(e){super(e.definition);this.idx=1;To(this,xo(e,(e=>e!==undefined)))}}class Repetition extends AbstractProduction{constructor(e){super(e.definition);this.idx=1;To(this,xo(e,(e=>e!==undefined)))}}class RepetitionWithSeparator extends AbstractProduction{constructor(e){super(e.definition);this.idx=1;To(this,xo(e,(e=>e!==undefined)))}}class Alternation extends AbstractProduction{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){super(e.definition);this.idx=1;this.ignoreAmbiguities=false;this.hasPredicates=false;To(this,xo(e,(e=>e!==undefined)))}}class Terminal{constructor(e){this.idx=1;To(this,xo(e,(e=>e!==undefined)))}accept(e){e.visit(this)}}function serializeGrammar(e){return Mr(e,serializeProduction)}function serializeProduction(e){function convertDefinition(e){return Mr(e,serializeProduction)}if(e instanceof model_NonTerminal){const t={type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};if(no(e.label)){t.label=e.label}return t}else if(e instanceof Alternative){return{type:"Alternative",definition:convertDefinition(e.definition)}}else if(e instanceof Option){return{type:"Option",idx:e.idx,definition:convertDefinition(e.definition)}}else if(e instanceof RepetitionMandatory){return{type:"RepetitionMandatory",idx:e.idx,definition:convertDefinition(e.definition)}}else if(e instanceof RepetitionMandatoryWithSeparator){return{type:"RepetitionMandatoryWithSeparator",idx:e.idx,separator:serializeProduction(new Terminal({terminalType:e.separator})),definition:convertDefinition(e.definition)}}else if(e instanceof RepetitionWithSeparator){return{type:"RepetitionWithSeparator",idx:e.idx,separator:serializeProduction(new Terminal({terminalType:e.separator})),definition:convertDefinition(e.definition)}}else if(e instanceof Repetition){return{type:"Repetition",idx:e.idx,definition:convertDefinition(e.definition)}}else if(e instanceof Alternation){return{type:"Alternation",idx:e.idx,definition:convertDefinition(e.definition)}}else if(e instanceof Terminal){const t={type:"Terminal",name:e.terminalType.name,label:tokenLabel(e.terminalType),idx:e.idx};if(no(e.label)){t.terminalLabel=e.label}const n=e.terminalType.PATTERN;if(e.terminalType.PATTERN){t.pattern=No(n)?n.source:n}return t}else if(e instanceof Rule){return{type:"Rule",name:e.name,orgText:e.orgText,definition:convertDefinition(e.definition)}}else{throw Error("non exhaustive match")}}class visitor_GAstVisitor{visit(e){const t=e;switch(t.constructor){case model_NonTerminal:return this.visitNonTerminal(t);case Alternative:return this.visitAlternative(t);case Option:return this.visitOption(t);case RepetitionMandatory:return this.visitRepetitionMandatory(t);case RepetitionMandatoryWithSeparator:return this.visitRepetitionMandatoryWithSeparator(t);case RepetitionWithSeparator:return this.visitRepetitionWithSeparator(t);case Repetition:return this.visitRepetition(t);case Alternation:return this.visitAlternation(t);case Terminal:return this.visitTerminal(t);case Rule:return this.visitRule(t);default:throw Error("non exhaustive match")}}visitNonTerminal(e){}visitAlternative(e){}visitOption(e){}visitRepetition(e){}visitRepetitionMandatory(e){}visitRepetitionMandatoryWithSeparator(e){}visitRepetitionWithSeparator(e){}visitAlternation(e){}visitTerminal(e){}visitRule(e){}}function baseSome(e,t){var n;pt(e,(function(e,r,o){n=t(e,r,o);return!n}));return!!n}const Co=baseSome;function some_some(e,t,n){var r=V(e)?ti:Co;if(n&&go(e,t,n)){t=undefined}return r(e,Lr(t,3))}const Io=some_some;function baseFindIndex(e,t,n,r){var o=e.length,l=n+(r?1:-1);while(r?l--:++l<o){if(t(e[l],l,e)){return l}}return-1}const Lo=baseFindIndex;function baseIsNaN(e){return e!==e}const Po=baseIsNaN;function strictIndexOf(e,t,n){var r=n-1,o=e.length;while(++r<o){if(e[r]===t){return r}}return-1}const Mo=strictIndexOf;function baseIndexOf(e,t,n){return t===t?Mo(e,t,n):Lo(e,Po,n)}const Fo=baseIndexOf;var Do=Math.max;function includes(e,t,n,r){e=ut(e)?e:bt(e);n=n&&!r?Za(n):0;var o=e.length;if(n<0){n=Do(o+n,0)}return no(e)?n<=o&&e.indexOf(t,n)>-1:!!o&&Fo(e,t,n)>-1}const Uo=includes;function arrayEvery(e,t){var n=-1,r=e==null?0:e.length;while(++n<r){if(!t(e[n],n,e)){return false}}return true}const $o=arrayEvery;function baseEvery(e,t){var n=true;pt(e,(function(e,r,o){n=!!t(e,r,o);return n}));return n}const jo=baseEvery;function every(e,t,n){var r=V(e)?$o:jo;if(n&&go(e,t,n)){t=undefined}return r(e,Lr(t,3))}const Bo=every;function isSequenceProd(e){return e instanceof Alternative||e instanceof Option||e instanceof Repetition||e instanceof RepetitionMandatory||e instanceof RepetitionMandatoryWithSeparator||e instanceof RepetitionWithSeparator||e instanceof Terminal||e instanceof Rule}function isOptionalProd(e,t=[]){const n=e instanceof Option||e instanceof Repetition||e instanceof RepetitionWithSeparator;if(n){return true}if(e instanceof Alternation){return Io(e.definition,(e=>isOptionalProd(e,t)))}else if(e instanceof model_NonTerminal&&Uo(t,e)){return false}else if(e instanceof AbstractProduction){if(e instanceof model_NonTerminal){t.push(e)}return Bo(e.definition,(e=>isOptionalProd(e,t)))}else{return false}}function isBranchingProd(e){return e instanceof Alternation}function getProductionDslName(e){if(e instanceof model_NonTerminal){return"SUBRULE"}else if(e instanceof Option){return"OPTION"}else if(e instanceof Alternation){return"OR"}else if(e instanceof RepetitionMandatory){return"AT_LEAST_ONE"}else if(e instanceof RepetitionMandatoryWithSeparator){return"AT_LEAST_ONE_SEP"}else if(e instanceof RepetitionWithSeparator){return"MANY_SEP"}else if(e instanceof Repetition){return"MANY"}else if(e instanceof Terminal){return"CONSUME"}else{throw Error("non exhaustive match")}}class RestWalker{walk(e,t=[]){mt(e.definition,((n,r)=>{const o=eo(e.definition,r+1);if(n instanceof model_NonTerminal){this.walkProdRef(n,o,t)}else if(n instanceof Terminal){this.walkTerminal(n,o,t)}else if(n instanceof Alternative){this.walkFlat(n,o,t)}else if(n instanceof Option){this.walkOption(n,o,t)}else if(n instanceof RepetitionMandatory){this.walkAtLeastOne(n,o,t)}else if(n instanceof RepetitionMandatoryWithSeparator){this.walkAtLeastOneSep(n,o,t)}else if(n instanceof RepetitionWithSeparator){this.walkManySep(n,o,t)}else if(n instanceof Repetition){this.walkMany(n,o,t)}else if(n instanceof Alternation){this.walkOr(n,o,t)}else{throw Error("non exhaustive match")}}))}walkTerminal(e,t,n){}walkProdRef(e,t,n){}walkFlat(e,t,n){const r=t.concat(n);this.walk(e,r)}walkOption(e,t,n){const r=t.concat(n);this.walk(e,r)}walkAtLeastOne(e,t,n){const r=[new Option({definition:e.definition})].concat(t,n);this.walk(e,r)}walkAtLeastOneSep(e,t,n){const r=restForRepetitionWithSeparator(e,t,n);this.walk(e,r)}walkMany(e,t,n){const r=[new Option({definition:e.definition})].concat(t,n);this.walk(e,r)}walkManySep(e,t,n){const r=restForRepetitionWithSeparator(e,t,n);this.walk(e,r)}walkOr(e,t,n){const r=t.concat(n);mt(e.definition,(e=>{const t=new Alternative({definition:[e]});this.walk(t,r)}))}}function restForRepetitionWithSeparator(e,t,n){const r=[new Option({definition:[new Terminal({terminalType:e.separator})].concat(e.definition)})];const o=r.concat(t,n);return o}function arrayIncludes(e,t){var n=e==null?0:e.length;return!!n&&Fo(e,t,0)>-1}const Wo=arrayIncludes;function arrayIncludesWith(e,t,n){var r=-1,o=e==null?0:e.length;while(++r<o){if(n(t,e[r])){return true}}return false}const Vo=arrayIncludesWith;function noop(){}const Go=noop;var zo=1/0;var Ho=!(Gt&&1/li(new Gt([,-0]))[1]==zo)?Go:function(e){return new Gt(e)};const Ko=Ho;var qo=200;function baseUniq(e,t,n){var r=-1,o=Wo,l=e.length,h=true,f=[],p=f;if(n){h=false;o=Vo}else if(l>=qo){var d=t?null:Ko(e);if(d){return li(d)}h=false;o=ni;p=new ei}else{p=t?[]:f}e:while(++r<l){var _=e[r],m=t?t(_):_;_=n||_!==0?_:0;if(h&&m===m){var g=p.length;while(g--){if(p[g]===m){continue e}}if(t){p.push(m)}f.push(_)}else if(!o(p,m,n)){if(p!==f){p.push(m)}f.push(_)}}return f}const Xo=baseUniq;function uniq(e){return e&&e.length?Xo(e):[]}const Yo=uniq;var Qo=v?v.isConcatSpreadable:undefined;function isFlattenable(e){return V(e)||B(e)||!!(Qo&&e&&e[Qo])}const Jo=isFlattenable;function baseFlatten(e,t,n,r,o){var l=-1,h=e.length;n||(n=Jo);o||(o=[]);while(++l<h){var f=e[l];if(t>0&&n(f)){if(t>1){baseFlatten(f,t-1,n,r,o)}else{Ai(o,f)}}else if(!r){o[o.length]=f}}return o}const Zo=baseFlatten;function flatten_flatten(e){var t=e==null?0:e.length;return t?Zo(e,1):[]}const eu=flatten_flatten;function first(e){if(e instanceof model_NonTerminal){return first(e.referencedRule)}else if(e instanceof Terminal){return firstForTerminal(e)}else if(isSequenceProd(e)){return firstForSequence(e)}else if(isBranchingProd(e)){return firstForBranching(e)}else{throw Error("non exhaustive match")}}function firstForSequence(e){let t=[];const n=e.definition;let r=0;let o=n.length>r;let l;let h=true;while(o&&h){l=n[r];h=isOptionalProd(l);t=t.concat(first(l));r=r+1;o=n.length>r}return Yo(t)}function firstForBranching(e){const t=Mr(e.definition,(e=>first(e)));return Yo(eu(t))}function firstForTerminal(e){return[e.terminalType]}const tu="_~IN~_";class ResyncFollowsWalker extends RestWalker{constructor(e){super();this.topProd=e;this.follows={}}startWalking(){this.walk(this.topProd);return this.follows}walkTerminal(e,t,n){}walkProdRef(e,t,n){const r=buildBetweenProdsFollowPrefix(e.referencedRule,e.idx)+this.topProd.name;const o=t.concat(n);const l=new Alternative({definition:o});const h=first(l);this.follows[r]=h}}function computeAllProdsFollows(e){const t={};mt(e,(e=>{const n=new ResyncFollowsWalker(e).startWalking();To(t,n)}));return t}function buildBetweenProdsFollowPrefix(e,t){return e.name+t+tu}function buildInProdFollowPrefix(e){const t=e.terminalType.name;return t+e.idx+IN}function isUndefined(e){return e===undefined}const nu=isUndefined;function cc(e){return e.charCodeAt(0)}function insertToSet(e,t){if(Array.isArray(e)){e.forEach((function(e){t.push(e)}))}else{t.push(e)}}function addFlag(e,t){if(e[t]===true){throw"duplicate flag "+t}const n=e[t];e[t]=true}function ASSERT_EXISTS(e){if(e===undefined){throw Error("Internal Error - Should never get here!")}return true}function ASSERT_NEVER_REACH_HERE(){throw Error("Internal Error - Should never get here!")}function isCharacter(e){return e["type"]==="Character"}const iu=[];for(let e=cc("0");e<=cc("9");e++){iu.push(e)}const ru=[cc("_")].concat(iu);for(let e=cc("a");e<=cc("z");e++){ru.push(e)}for(let e=cc("A");e<=cc("Z");e++){ru.push(e)}const su=[cc(" "),cc("\f"),cc("\n"),cc("\r"),cc("\t"),cc("\v"),cc("\t"),cc(""),cc(""),cc(""),cc(""),cc(""),cc(""),cc(""),cc(""),cc(""),cc(""),cc(""),cc(""),cc(""),cc("\u2028"),cc("\u2029"),cc(""),cc(""),cc(""),cc("\ufeff")];const au=/[0-9a-fA-F]/;const ou=/[0-9]/;const uu=/[1-9]/;class RegExpParser{constructor(){this.idx=0;this.input="";this.groupIdx=0}saveState(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}}restoreState(e){this.idx=e.idx;this.input=e.input;this.groupIdx=e.groupIdx}pattern(e){this.idx=0;this.input=e;this.groupIdx=0;this.consumeChar("/");const t=this.disjunction();this.consumeChar("/");const n={type:"Flags",loc:{begin:this.idx,end:e.length},global:false,ignoreCase:false,multiLine:false,unicode:false,sticky:false};while(this.isRegExpFlag()){switch(this.popChar()){case"g":addFlag(n,"global");break;case"i":addFlag(n,"ignoreCase");break;case"m":addFlag(n,"multiLine");break;case"u":addFlag(n,"unicode");break;case"y":addFlag(n,"sticky");break}}if(this.idx!==this.input.length){throw Error("Redundant input: "+this.input.substring(this.idx))}return{type:"Pattern",flags:n,value:t,loc:this.loc(0)}}disjunction(){const e=[];const t=this.idx;e.push(this.alternative());while(this.peekChar()==="|"){this.consumeChar("|");e.push(this.alternative())}return{type:"Disjunction",value:e,loc:this.loc(t)}}alternative(){const e=[];const t=this.idx;while(this.isTerm()){e.push(this.term())}return{type:"Alternative",value:e,loc:this.loc(t)}}term(){if(this.isAssertion()){return this.assertion()}else{return this.atom()}}assertion(){const e=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(e)};case"$":return{type:"EndAnchor",loc:this.loc(e)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(e)};case"B":return{type:"NonWordBoundary",loc:this.loc(e)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");let t;switch(this.popChar()){case"=":t="Lookahead";break;case"!":t="NegativeLookahead";break;case"<":{switch(this.popChar()){case"=":t="Lookbehind";break;case"!":t="NegativeLookbehind"}break}}ASSERT_EXISTS(t);const n=this.disjunction();this.consumeChar(")");return{type:t,value:n,loc:this.loc(e)}}return ASSERT_NEVER_REACH_HERE()}quantifier(e=false){let t=undefined;const n=this.idx;switch(this.popChar()){case"*":t={atLeast:0,atMost:Infinity};break;case"+":t={atLeast:1,atMost:Infinity};break;case"?":t={atLeast:0,atMost:1};break;case"{":const n=this.integerIncludingZero();switch(this.popChar()){case"}":t={atLeast:n,atMost:n};break;case",":let e;if(this.isDigit()){e=this.integerIncludingZero();t={atLeast:n,atMost:e}}else{t={atLeast:n,atMost:Infinity}}this.consumeChar("}");break}if(e===true&&t===undefined){return undefined}ASSERT_EXISTS(t);break}if(e===true&&t===undefined){return undefined}if(ASSERT_EXISTS(t)){if(this.peekChar(0)==="?"){this.consumeChar("?");t.greedy=false}else{t.greedy=true}t.type="Quantifier";t.loc=this.loc(n);return t}}atom(){let e;const t=this.idx;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group();break}if(e===undefined&&this.isPatternCharacter()){e=this.patternCharacter()}if(ASSERT_EXISTS(e)){e.loc=this.loc(t);if(this.isQuantifier()){e.quantifier=this.quantifier()}return e}return ASSERT_NEVER_REACH_HERE()}dotAll(){this.consumeChar(".");return{type:"Set",complement:true,value:[cc("\n"),cc("\r"),cc("\u2028"),cc("\u2029")]}}atomEscape(){this.consumeChar("\\");switch(this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}decimalEscapeAtom(){const e=this.positiveInteger();return{type:"GroupBackReference",value:e}}characterClassEscape(){let e;let t=false;switch(this.popChar()){case"d":e=iu;break;case"D":e=iu;t=true;break;case"s":e=su;break;case"S":e=su;t=true;break;case"w":e=ru;break;case"W":e=ru;t=true;break}if(ASSERT_EXISTS(e)){return{type:"Set",value:e,complement:t}}return ASSERT_NEVER_REACH_HERE()}controlEscapeAtom(){let e;switch(this.popChar()){case"f":e=cc("\f");break;case"n":e=cc("\n");break;case"r":e=cc("\r");break;case"t":e=cc("\t");break;case"v":e=cc("\v");break}if(ASSERT_EXISTS(e)){return{type:"Character",value:e}}return ASSERT_NEVER_REACH_HERE()}controlLetterEscapeAtom(){this.consumeChar("c");const e=this.popChar();if(/[a-zA-Z]/.test(e)===false){throw Error("Invalid ")}const t=e.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:t}}nulCharacterAtom(){this.consumeChar("0");return{type:"Character",value:cc("\0")}}hexEscapeSequenceAtom(){this.consumeChar("x");return this.parseHexDigits(2)}regExpUnicodeEscapeSequenceAtom(){this.consumeChar("u");return this.parseHexDigits(4)}identityEscapeAtom(){const e=this.popChar();return{type:"Character",value:cc(e)}}classPatternCharacterAtom(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:const e=this.popChar();return{type:"Character",value:cc(e)}}}characterClass(){const e=[];let t=false;this.consumeChar("[");if(this.peekChar(0)==="^"){this.consumeChar("^");t=true}while(this.isClassAtom()){const t=this.classAtom();const n=t.type==="Character";if(isCharacter(t)&&this.isRangeDash()){this.consumeChar("-");const n=this.classAtom();const r=n.type==="Character";if(isCharacter(n)){if(n.value<t.value){throw Error("Range out of order in character class")}e.push({from:t.value,to:n.value})}else{insertToSet(t.value,e);e.push(cc("-"));insertToSet(n.value,e)}}else{insertToSet(t.value,e)}}this.consumeChar("]");return{type:"Set",complement:t,value:e}}classAtom(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}}classEscape(){this.consumeChar("\\");switch(this.peekChar()){case"b":this.consumeChar("b");return{type:"Character",value:cc("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}group(){let e=true;this.consumeChar("(");switch(this.peekChar(0)){case"?":this.consumeChar("?");this.consumeChar(":");e=false;break;default:this.groupIdx++;break}const t=this.disjunction();this.consumeChar(")");const n={type:"Group",capturing:e,value:t};if(e){n["idx"]=this.groupIdx}return n}positiveInteger(){let e=this.popChar();if(uu.test(e)===false){throw Error("Expecting a positive integer")}while(ou.test(this.peekChar(0))){e+=this.popChar()}return parseInt(e,10)}integerIncludingZero(){let e=this.popChar();if(ou.test(e)===false){throw Error("Expecting an integer")}while(ou.test(this.peekChar(0))){e+=this.popChar()}return parseInt(e,10)}patternCharacter(){const e=this.popChar();switch(e){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:cc(e)}}}isRegExpFlag(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return true;default:return false}}isRangeDash(){return this.peekChar()==="-"&&this.isClassAtom(1)}isDigit(){return ou.test(this.peekChar(0))}isClassAtom(e=0){switch(this.peekChar(e)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return false;default:return true}}isTerm(){return this.isAtom()||this.isAssertion()}isAtom(){if(this.isPatternCharacter()){return true}switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return true;default:return false}}isAssertion(){switch(this.peekChar(0)){case"^":case"$":return true;case"\\":switch(this.peekChar(1)){case"b":case"B":return true;default:return false}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!"||this.peekChar(2)==="<"&&(this.peekChar(3)==="="||this.peekChar(3)==="!"));default:return false}}isQuantifier(){const e=this.saveState();try{return this.quantifier(true)!==undefined}catch(e){return false}finally{this.restoreState(e)}}isPatternCharacter(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return false;default:return true}}parseHexDigits(e){let t="";for(let n=0;n<e;n++){const e=this.popChar();if(au.test(e)===false){throw Error("Expecting a HexDecimal digits")}t+=e}const n=parseInt(t,16);return{type:"Character",value:n}}peekChar(e=0){return this.input[this.idx+e]}popChar(){const e=this.peekChar(0);this.consumeChar(undefined);return e}consumeChar(e){if(e!==undefined&&this.input[this.idx]!==e){throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx)}if(this.idx>=this.input.length){throw Error("Unexpected end of input")}this.idx++}loc(e){return{begin:e,end:this.idx}}}class BaseRegExpVisitor{visitChildren(e){for(const t in e){const n=e[t];if(e.hasOwnProperty(t)){if(n.type!==undefined){this.visit(n)}else if(Array.isArray(n)){n.forEach((e=>{this.visit(e)}),this)}}}}visit(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Lookbehind":this.visitLookbehind(e);break;case"NegativeLookbehind":this.visitNegativeLookbehind(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e);break}this.visitChildren(e)}visitPattern(e){}visitFlags(e){}visitDisjunction(e){}visitAlternative(e){}visitStartAnchor(e){}visitEndAnchor(e){}visitWordBoundary(e){}visitNonWordBoundary(e){}visitLookahead(e){}visitNegativeLookahead(e){}visitLookbehind(e){}visitNegativeLookbehind(e){}visitCharacter(e){}visitSet(e){}visitGroup(e){}visitGroupBackReference(e){}visitQuantifier(e){}}var lu=Object.prototype;var cu=lu.hasOwnProperty;var hu=mo((function(e,t){e=Object(e);var n=-1;var r=t.length;var o=r>2?t[2]:undefined;if(o&&go(t[0],t[1],o)){r=1}while(++n<r){var l=t[n];var h=Jr(l);var f=-1;var p=h.length;while(++f<p){var d=h[f];var _=e[d];if(_===undefined||pn(_,lu[d])&&!cu.call(e,d)){e[d]=l[d]}}}return e}));const fu=hu;function baseFilter(e,t){var n=[];pt(e,(function(e,r,o){if(t(e,r,o)){n.push(e)}}));return n}const pu=baseFilter;var du="Expected a function";function negate(e){if(typeof e!="function"){throw new TypeError(du)}return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}const _u=negate;function reject(e,t){var n=V(e)?Si:pu;return n(e,_u(Lr(t,3)))}const mu=reject;var gu=Math.max;function indexOf(e,t,n){var r=e==null?0:e.length;if(!r){return-1}var o=n==null?0:Za(n);if(o<0){o=gu(r+o,0)}return Fo(e,t,o)}const yu=indexOf;function arrayReduce(e,t,n,r){var o=-1,l=e==null?0:e.length;if(r&&l){n=e[++o]}while(++o<l){n=t(n,e[o],o,e)}return n}const bu=arrayReduce;function baseReduce(e,t,n,r,o){o(e,(function(e,o,l){n=r?(r=false,e):t(n,e,o,l)}));return n}const vu=baseReduce;function reduce(e,t,n){var r=V(e)?bu:vu,o=arguments.length<3;return r(e,Lr(t,4),n,o,pt)}const Eu=reduce;function filter(e,t){var n=V(e)?Si:pu;return n(e,Lr(t,3))}const Tu=filter;var ku=200;function baseDifference(e,t,n,r){var o=-1,l=Wo,h=true,f=e.length,p=[],d=t.length;if(!f){return p}if(n){t=gt(t,Ce(n))}if(r){l=Vo;h=false}else if(t.length>=ku){l=ni;h=false;t=new ei(t)}e:while(++o<f){var _=e[o],m=n==null?_:n(_);_=r||_!==0?_:0;if(h&&m===m){var g=d;while(g--){if(t[g]===m){continue e}}p.push(_)}else if(!l(t,m,r)){p.push(_)}}return p}const Ou=baseDifference;function isArrayLikeObject(e){return P(e)&&ut(e)}const xu=isArrayLikeObject;var Au=mo((function(e,t){return xu(e)?Ou(e,Zo(t,1,xu,true)):[]}));const wu=Au;function compact(e){var t=-1,n=e==null?0:e.length,r=0,o=[];while(++t<n){var l=e[t];if(l){o[r++]=l}}return o}const Su=compact;function head(e){return e&&e.length?e[0]:undefined}const Ru=head;function createFind(e){return function(t,n,r){var o=Object(t);if(!ut(t)){var l=Lr(n,3);t=lt(t);n=function(e){return l(o[e],e,o)}}var h=e(t,n,r);return h>-1?o[l?t[h]:h]:undefined}}const Nu=createFind;var Cu=Math.max;function findIndex(e,t,n){var r=e==null?0:e.length;if(!r){return-1}var o=n==null?0:Za(n);if(o<0){o=Cu(r+o,0)}return Lo(e,Lr(t,3),o)}const Iu=findIndex;var Lu=Nu(Iu);const Pu=Lu;function PRINT_ERROR(e){if(console&&console.error){console.error(`Error: ${e}`)}}function PRINT_WARNING(e){if(console&&console.warn){console.warn(`Warning: ${e}`)}}let Mu={};const Fu=new RegExpParser;function getRegExpAst(e){const t=e.toString();if(Mu.hasOwnProperty(t)){return Mu[t]}else{const e=Fu.pattern(t);Mu[t]=e;return e}}function clearRegExpParserCache(){Mu={}}const Du="Complement Sets are not supported for first char optimization";const Uu='Unable to use "first char" lexer optimizations:\n';function getOptimizedStartCodesIndices(e,t=false){try{const t=getRegExpAst(e);const n=firstCharOptimizedIndices(t.value,{},t.flags.ignoreCase);return n}catch(n){if(n.message===Du){if(t){PRINT_WARNING(`${Uu}`+`\tUnable to optimize: < ${e.toString()} >\n`+"\tComplement Sets cannot be automatically optimized.\n"+"\tThis will disable the lexer's first char optimizations.\n"+"\tSee: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.")}}else{let n="";if(t){n="\n\tThis will disable the lexer's first char optimizations.\n"+"\tSee: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details."}PRINT_ERROR(`${Uu}\n`+`\tFailed parsing: < ${e.toString()} >\n`+`\tUsing the @chevrotain/regexp-to-ast library\n`+"\tPlease open an issue at: https://github.com/chevrotain/chevrotain/issues"+n)}}return[]}function firstCharOptimizedIndices(e,t,n){switch(e.type){case"Disjunction":for(let r=0;r<e.value.length;r++){firstCharOptimizedIndices(e.value[r],t,n)}break;case"Alternative":const r=e.value;for(let e=0;e<r.length;e++){const o=r[e];switch(o.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"Lookbehind":case"NegativeLookbehind":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}const l=o;switch(l.type){case"Character":addOptimizedIdxToResult(l.value,t,n);break;case"Set":if(l.complement===true){throw Error(Du)}mt(l.value,(e=>{if(typeof e==="number"){addOptimizedIdxToResult(e,t,n)}else{const r=e;if(n===true){for(let e=r.from;e<=r.to;e++){addOptimizedIdxToResult(e,t,n)}}else{for(let e=r.from;e<=r.to&&e<Hu;e++){addOptimizedIdxToResult(e,t,n)}if(r.to>=Hu){const e=r.from>=Hu?r.from:Hu;const n=r.to;const o=charCodeToOptimizedIndex(e);const l=charCodeToOptimizedIndex(n);for(let e=o;e<=l;e++){t[e]=e}}}}}));break;case"Group":firstCharOptimizedIndices(l.value,t,n);break;default:throw Error("Non Exhaustive Match")}const h=l.quantifier!==undefined&&l.quantifier.atLeast===0;if(l.type==="Group"&&isWholeOptional(l)===false||l.type!=="Group"&&h===false){break}}break;default:throw Error("non exhaustive match!")}return bt(t)}function addOptimizedIdxToResult(e,t,n){const r=charCodeToOptimizedIndex(e);t[r]=r;if(n===true){handleIgnoreCase(e,t)}}function handleIgnoreCase(e,t){const n=String.fromCharCode(e);const r=n.toUpperCase();if(r!==n){const e=charCodeToOptimizedIndex(r.charCodeAt(0));t[e]=e}else{const e=n.toLowerCase();if(e!==n){const n=charCodeToOptimizedIndex(e.charCodeAt(0));t[n]=n}}}function findCode(e,t){return Pu(e.value,(e=>{if(typeof e==="number"){return Uo(t,e)}else{const n=e;return Pu(t,(e=>n.from<=e&&e<=n.to))!==undefined}}))}function isWholeOptional(e){const t=e.quantifier;if(t&&t.atLeast===0){return true}if(!e.value){return false}return V(e.value)?Bo(e.value,isWholeOptional):isWholeOptional(e.value)}class CharCodeFinder extends BaseRegExpVisitor{constructor(e){super();this.targetCharCodes=e;this.found=false}visitChildren(e){if(this.found===true){return}switch(e.type){case"Lookahead":this.visitLookahead(e);return;case"NegativeLookahead":this.visitNegativeLookahead(e);return;case"Lookbehind":this.visitLookbehind(e);return;case"NegativeLookbehind":this.visitNegativeLookbehind(e);return}super.visitChildren(e)}visitCharacter(e){if(Uo(this.targetCharCodes,e.value)){this.found=true}}visitSet(e){if(e.complement){if(findCode(e,this.targetCharCodes)===undefined){this.found=true}}else{if(findCode(e,this.targetCharCodes)!==undefined){this.found=true}}}}function canMatchCharCode(e,t){if(t instanceof RegExp){const n=getRegExpAst(t);const r=new CharCodeFinder(e);r.visit(n);return r.found}else{return Pu(t,(t=>Uo(e,t.charCodeAt(0))))!==undefined}}const $u="PATTERN";const ju="defaultMode";const Bu="modes";let Wu=typeof new RegExp("(?:)").sticky==="boolean";function disableSticky(){Wu=false}function enableSticky(){Wu=true}function analyzeTokenTypes(e,t){t=fu(t,{useSticky:Wu,debug:false,safeMode:false,positionTracking:"full",lineTerminatorCharacters:["\r","\n"],tracer:(e,t)=>t()});const n=t.tracer;n("initCharCodeToOptimizedIndexMap",(()=>{initCharCodeToOptimizedIndexMap()}));let r;n("Reject Lexer.NA",(()=>{r=mu(e,(e=>e[$u]===Lexer.NA))}));let o=false;let l;n("Transform Patterns",(()=>{o=false;l=Mr(r,(e=>{const n=e[$u];if(No(n)){const e=n.source;if(e.length===1&&e!=="^"&&e!=="$"&&e!=="."&&!n.ignoreCase){return e}else if(e.length===2&&e[0]==="\\"&&!Uo(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],e[1])){return e[1]}else{return t.useSticky?addStickyFlag(n):addStartOfInput(n)}}else if(st(n)){o=true;return{exec:n}}else if(typeof n==="object"){o=true;return n}else if(typeof n==="string"){if(n.length===1){return n}else{const e=n.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&");const r=new RegExp(e);return t.useSticky?addStickyFlag(r):addStartOfInput(r)}}else{throw Error("non exhaustive match")}}))}));let h;let f;let p;let d;let _;n("misc mapping",(()=>{h=Mr(r,(e=>e.tokenTypeIdx));f=Mr(r,(e=>{const t=e.GROUP;if(t===Lexer.SKIPPED){return undefined}else if(no(t)){return t}else if(nu(t)){return false}else{throw Error("non exhaustive match")}}));p=Mr(r,(e=>{const t=e.LONGER_ALT;if(t){const e=V(t)?Mr(t,(e=>yu(r,e))):[yu(r,t)];return e}}));d=Mr(r,(e=>e.PUSH_MODE));_=Mr(r,(e=>$r(e,"POP_MODE")))}));let m;n("Line Terminator Handling",(()=>{const e=getCharCodes(t.lineTerminatorCharacters);m=Mr(r,(e=>false));if(t.positionTracking!=="onlyOffset"){m=Mr(r,(t=>{if($r(t,"LINE_BREAKS")){return!!t.LINE_BREAKS}else{return checkLineBreaksIssues(t,e)===false&&canMatchCharCode(e,t.PATTERN)}}))}}));let g;let y;let b;let v;n("Misc Mapping #2",(()=>{g=Mr(r,isCustomPattern);y=Mr(l,isShortPattern);b=Eu(r,((e,t)=>{const n=t.GROUP;if(no(n)&&!(n===Lexer.SKIPPED)){e[n]=[]}return e}),{});v=Mr(l,((e,t)=>({pattern:l[t],longerAlt:p[t],canLineTerminator:m[t],isCustom:g[t],short:y[t],group:f[t],push:d[t],pop:_[t],tokenTypeIdx:h[t],tokenType:r[t]})))}));let E=true;let k=[];if(!t.safeMode){n("First Char Optimization",(()=>{k=Eu(r,((e,n,r)=>{if(typeof n.PATTERN==="string"){const t=n.PATTERN.charCodeAt(0);const o=charCodeToOptimizedIndex(t);addToMapOfArrays(e,o,v[r])}else if(V(n.START_CHARS_HINT)){let t;mt(n.START_CHARS_HINT,(n=>{const o=typeof n==="string"?n.charCodeAt(0):n;const l=charCodeToOptimizedIndex(o);if(t!==l){t=l;addToMapOfArrays(e,l,v[r])}}))}else if(No(n.PATTERN)){if(n.PATTERN.unicode){E=false;if(t.ensureOptimizations){PRINT_ERROR(`${Uu}`+`\tUnable to analyze < ${n.PATTERN.toString()} > pattern.\n`+"\tThe regexp unicode flag is not currently supported by the regexp-to-ast library.\n"+"\tThis will disable the lexer's first char optimizations.\n"+"\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE")}}else{const o=getOptimizedStartCodesIndices(n.PATTERN,t.ensureOptimizations);if(hn(o)){E=false}mt(o,(t=>{addToMapOfArrays(e,t,v[r])}))}}else{if(t.ensureOptimizations){PRINT_ERROR(`${Uu}`+`\tTokenType: <${n.name}> is using a custom token pattern without providing <start_chars_hint> parameter.\n`+"\tThis will disable the lexer's first char optimizations.\n"+"\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE")}E=false}return e}),[])}))}return{emptyGroups:b,patternIdxToConfig:v,charCodeToPatternIdxToConfig:k,hasCustom:o,canBeOptimized:E}}function validatePatterns(e,t){let n=[];const r=findMissingPatterns(e);n=n.concat(r.errors);const o=findInvalidPatterns(r.valid);const l=o.valid;n=n.concat(o.errors);n=n.concat(validateRegExpPattern(l));n=n.concat(findInvalidGroupType(l));n=n.concat(findModesThatDoNotExist(l,t));n=n.concat(findUnreachablePatterns(l));return n}function validateRegExpPattern(e){let t=[];const n=Tu(e,(e=>No(e[$u])));t=t.concat(findEndOfInputAnchor(n));t=t.concat(findStartOfInputAnchor(n));t=t.concat(findUnsupportedFlags(n));t=t.concat(findDuplicatePatterns(n));t=t.concat(findEmptyMatchRegExps(n));return t}function findMissingPatterns(e){const t=Tu(e,(e=>!$r(e,$u)));const n=Mr(t,(e=>({message:"Token Type: ->"+e.name+"<- missing static 'PATTERN' property",type:Ju.MISSING_PATTERN,tokenTypes:[e]})));const r=wu(e,t);return{errors:n,valid:r}}function findInvalidPatterns(e){const t=Tu(e,(e=>{const t=e[$u];return!No(t)&&!st(t)&&!$r(t,"exec")&&!no(t)}));const n=Mr(t,(e=>({message:"Token Type: ->"+e.name+"<- static 'PATTERN' can only be a RegExp, a"+" Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:Ju.INVALID_PATTERN,tokenTypes:[e]})));const r=wu(e,t);return{errors:n,valid:r}}const Vu=/[^\\][$]/;function findEndOfInputAnchor(e){class EndAnchorFinder extends BaseRegExpVisitor{constructor(){super(...arguments);this.found=false}visitEndAnchor(e){this.found=true}}const t=Tu(e,(e=>{const t=e.PATTERN;try{const e=getRegExpAst(t);const n=new EndAnchorFinder;n.visit(e);return n.found}catch(e){return Vu.test(t.source)}}));const n=Mr(t,(e=>({message:"Unexpected RegExp Anchor Error:\n"+"\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain end of input anchor '$'\n"+"\tSee chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS"+"\tfor details.",type:Ju.EOI_ANCHOR_FOUND,tokenTypes:[e]})));return n}function findEmptyMatchRegExps(e){const t=Tu(e,(e=>{const t=e.PATTERN;return t.test("")}));const n=Mr(t,(e=>({message:"Token Type: ->"+e.name+"<- static 'PATTERN' must not match an empty string",type:Ju.EMPTY_MATCH_PATTERN,tokenTypes:[e]})));return n}const Gu=/[^\\[][\^]|^\^/;function findStartOfInputAnchor(e){class StartAnchorFinder extends BaseRegExpVisitor{constructor(){super(...arguments);this.found=false}visitStartAnchor(e){this.found=true}}const t=Tu(e,(e=>{const t=e.PATTERN;try{const e=getRegExpAst(t);const n=new StartAnchorFinder;n.visit(e);return n.found}catch(e){return Gu.test(t.source)}}));const n=Mr(t,(e=>({message:"Unexpected RegExp Anchor Error:\n"+"\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain start of input anchor '^'\n"+"\tSee https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS"+"\tfor details.",type:Ju.SOI_ANCHOR_FOUND,tokenTypes:[e]})));return n}function findUnsupportedFlags(e){const t=Tu(e,(e=>{const t=e[$u];return t instanceof RegExp&&(t.multiline||t.global)}));const n=Mr(t,(e=>({message:"Token Type: ->"+e.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:Ju.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[e]})));return n}function findDuplicatePatterns(e){const t=[];let n=Mr(e,(n=>Eu(e,((e,r)=>{if(n.PATTERN.source===r.PATTERN.source&&!Uo(t,r)&&r.PATTERN!==Lexer.NA){t.push(r);e.push(r);return e}return e}),[])));n=Su(n);const r=Tu(n,(e=>e.length>1));const o=Mr(r,(e=>{const t=Mr(e,(e=>e.name));const n=Ru(e).PATTERN;return{message:`The same RegExp pattern ->${n}<-`+`has been used in all of the following Token Types: ${t.join(", ")} <-`,type:Ju.DUPLICATE_PATTERNS_FOUND,tokenTypes:e}}));return o}function findInvalidGroupType(e){const t=Tu(e,(e=>{if(!$r(e,"GROUP")){return false}const t=e.GROUP;return t!==Lexer.SKIPPED&&t!==Lexer.NA&&!no(t)}));const n=Mr(t,(e=>({message:"Token Type: ->"+e.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:Ju.INVALID_GROUP_TYPE_FOUND,tokenTypes:[e]})));return n}function findModesThatDoNotExist(e,t){const n=Tu(e,(e=>e.PUSH_MODE!==undefined&&!Uo(t,e.PUSH_MODE)));const r=Mr(n,(e=>{const t=`Token Type: ->${e.name}<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->${e.PUSH_MODE}<-`+`which does not exist`;return{message:t,type:Ju.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[e]}}));return r}function findUnreachablePatterns(e){const t=[];const n=Eu(e,((e,t,n)=>{const r=t.PATTERN;if(r===Lexer.NA){return e}if(no(r)){e.push({str:r,idx:n,tokenType:t})}else if(No(r)&&noMetaChar(r)){e.push({str:r.source,idx:n,tokenType:t})}return e}),[]);mt(e,((e,r)=>{mt(n,(({str:n,idx:o,tokenType:l})=>{if(r<o&&tryToMatchStrToPattern(n,e.PATTERN)){const n=`Token: ->${l.name}<- can never be matched.\n`+`Because it appears AFTER the Token Type ->${e.name}<-`+`in the lexer's definition.\n`+`See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;t.push({message:n,type:Ju.UNREACHABLE_PATTERN,tokenTypes:[e,l]})}}))}));return t}function tryToMatchStrToPattern(e,t){if(No(t)){if(usesLookAheadOrBehind(t)){return false}const n=t.exec(e);return n!==null&&n.index===0}else if(st(t)){return t(e,0,[],{})}else if($r(t,"exec")){return t.exec(e,0,[],{})}else if(typeof t==="string"){return t===e}else{throw Error("non exhaustive match")}}function noMetaChar(e){const t=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return Pu(t,(t=>e.source.indexOf(t)!==-1))===undefined}function usesLookAheadOrBehind(e){return/(\(\?=)|(\(\?!)|(\(\?<=)|(\(\?<!)/.test(e.source)}function addStartOfInput(e){const t=e.ignoreCase?"i":"";return new RegExp(`^(?:${e.source})`,t)}function addStickyFlag(e){const t=e.ignoreCase?"iy":"y";return new RegExp(`${e.source}`,t)}function performRuntimeChecks(e,t,n){const r=[];if(!$r(e,ju)){r.push({message:"A MultiMode Lexer cannot be initialized without a <"+ju+"> property in its definition\n",type:Ju.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE})}if(!$r(e,Bu)){r.push({message:"A MultiMode Lexer cannot be initialized without a <"+Bu+"> property in its definition\n",type:Ju.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY})}if($r(e,Bu)&&$r(e,ju)&&!$r(e.modes,e.defaultMode)){r.push({message:`A MultiMode Lexer cannot be initialized with a ${ju}: <${e.defaultMode}>`+`which does not exist\n`,type:Ju.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST})}if($r(e,Bu)){mt(e.modes,((e,t)=>{mt(e,((n,o)=>{if(nu(n)){r.push({message:`A Lexer cannot be initialized using an undefined Token Type. Mode:`+`<${t}> at index: <${o}>\n`,type:Ju.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})}else if($r(n,"LONGER_ALT")){const o=V(n.LONGER_ALT)?n.LONGER_ALT:[n.LONGER_ALT];mt(o,(o=>{if(!nu(o)&&!Uo(e,o)){r.push({message:`A MultiMode Lexer cannot be initialized with a longer_alt <${o.name}> on token <${n.name}> outside of mode <${t}>\n`,type:Ju.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE})}}))}}))}))}return r}function performWarningRuntimeChecks(e,t,n){const r=[];let o=false;const l=Su(eu(bt(e.modes)));const h=mu(l,(e=>e[$u]===Lexer.NA));const f=getCharCodes(n);if(t){mt(h,(e=>{const t=checkLineBreaksIssues(e,f);if(t!==false){const n=buildLineBreakIssueMessage(e,t);const o={message:n,type:t.issue,tokenType:e};r.push(o)}else{if($r(e,"LINE_BREAKS")){if(e.LINE_BREAKS===true){o=true}}else{if(canMatchCharCode(f,e.PATTERN)){o=true}}}}))}if(t&&!o){r.push({message:"Warning: No LINE_BREAKS Found.\n"+"\tThis Lexer has been defined to track line and column information,\n"+"\tBut none of the Token Types can be identified as matching a line terminator.\n"+"\tSee https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n"+"\tfor details.",type:Ju.NO_LINE_BREAKS_FLAGS})}return r}function cloneEmptyGroups(e){const t={};const n=lt(e);mt(n,(n=>{const r=e[n];if(V(r)){t[n]=[]}else{throw Error("non exhaustive match")}}));return t}function isCustomPattern(e){const t=e.PATTERN;if(No(t)){return false}else if(st(t)){return true}else if($r(t,"exec")){return true}else if(no(t)){return false}else{throw Error("non exhaustive match")}}function isShortPattern(e){if(no(e)&&e.length===1){return e.charCodeAt(0)}else{return false}}const zu={test:function(e){const t=e.length;for(let n=this.lastIndex;n<t;n++){const t=e.charCodeAt(n);if(t===10){this.lastIndex=n+1;return true}else if(t===13){if(e.charCodeAt(n+1)===10){this.lastIndex=n+2}else{this.lastIndex=n+1}return true}}return false},lastIndex:0};function checkLineBreaksIssues(e,t){if($r(e,"LINE_BREAKS")){return false}else{if(No(e.PATTERN)){try{canMatchCharCode(t,e.PATTERN)}catch(e){return{issue:Ju.IDENTIFY_TERMINATOR,errMsg:e.message}}return false}else if(no(e.PATTERN)){return false}else if(isCustomPattern(e)){return{issue:Ju.CUSTOM_LINE_BREAK}}else{throw Error("non exhaustive match")}}}function buildLineBreakIssueMessage(e,t){if(t.issue===Ju.IDENTIFY_TERMINATOR){return"Warning: unable to identify line terminator usage in pattern.\n"+`\tThe problem is in the <${e.name}> Token Type\n`+`\t Root cause: ${t.errMsg}.\n`+"\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR"}else if(t.issue===Ju.CUSTOM_LINE_BREAK){return"Warning: A Custom Token Pattern should specify the <line_breaks> option.\n"+`\tThe problem is in the <${e.name}> Token Type\n`+"\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK"}else{throw Error("non exhaustive match")}}function getCharCodes(e){const t=Mr(e,(e=>{if(no(e)){return e.charCodeAt(0)}else{return e}}));return t}function addToMapOfArrays(e,t,n){if(e[t]===undefined){e[t]=[n]}else{e[t].push(n)}}const Hu=256;let Ku=[];function charCodeToOptimizedIndex(e){return e<Hu?e:Ku[e]}function initCharCodeToOptimizedIndexMap(){if(hn(Ku)){Ku=new Array(65536);for(let e=0;e<65536;e++){Ku[e]=e>255?255+~~(e/255):e}}}function last(e){var t=e==null?0:e.length;return t?e[t-1]:undefined}const qu=last;function timer(e){const t=(new Date).getTime();const n=e();const r=(new Date).getTime();const o=r-t;return{time:o,value:n}}function tokenStructuredMatcher(e,t){const n=e.tokenTypeIdx;if(n===t.tokenTypeIdx){return true}else{return t.isParent===true&&t.categoryMatchesMap[n]===true}}function tokenStructuredMatcherNoCategories(e,t){return e.tokenTypeIdx===t.tokenTypeIdx}let Xu=1;const Yu={};function augmentTokenTypes(e){const t=expandCategories(e);assignTokenDefaultProps(t);assignCategoriesMapProp(t);assignCategoriesTokensProp(t);mt(t,(e=>{e.isParent=e.categoryMatches.length>0}))}function expandCategories(e){let t=Ua(e);let n=e;let r=true;while(r){n=Su(eu(Mr(n,(e=>e.CATEGORIES))));const e=wu(n,t);t=t.concat(e);if(hn(e)){r=false}else{n=e}}return t}function assignTokenDefaultProps(e){mt(e,(e=>{if(!hasShortKeyProperty(e)){Yu[Xu]=e;e.tokenTypeIdx=Xu++}if(hasCategoriesProperty(e)&&!V(e.CATEGORIES)){e.CATEGORIES=[e.CATEGORIES]}if(!hasCategoriesProperty(e)){e.CATEGORIES=[]}if(!hasExtendingTokensTypesProperty(e)){e.categoryMatches=[]}if(!hasExtendingTokensTypesMapProperty(e)){e.categoryMatchesMap={}}}))}function assignCategoriesTokensProp(e){mt(e,(e=>{e.categoryMatches=[];mt(e.categoryMatchesMap,((t,n)=>{e.categoryMatches.push(Yu[n].tokenTypeIdx)}))}))}function assignCategoriesMapProp(e){mt(e,(e=>{singleAssignCategoriesToksMap([],e)}))}function singleAssignCategoriesToksMap(e,t){mt(e,(e=>{t.categoryMatchesMap[e.tokenTypeIdx]=true}));mt(t.CATEGORIES,(n=>{const r=e.concat(t);if(!Uo(r,n)){singleAssignCategoriesToksMap(r,n)}}))}function hasShortKeyProperty(e){return $r(e,"tokenTypeIdx")}function hasCategoriesProperty(e){return $r(e,"CATEGORIES")}function hasExtendingTokensTypesProperty(e){return $r(e,"categoryMatches")}function hasExtendingTokensTypesMapProperty(e){return $r(e,"categoryMatchesMap")}function isTokenType(e){return $r(e,"tokenTypeIdx")}const Qu={buildUnableToPopLexerModeMessage(e){return`Unable to pop Lexer Mode after encountering Token ->${e.image}<- The Mode Stack is empty`},buildUnexpectedCharactersMessage(e,t,n,r,o,l){return`unexpected character: ->${e.charAt(t)}<- at offset: ${t},`+` skipped ${n} characters.`}};var Ju;(function(e){e[e["MISSING_PATTERN"]=0]="MISSING_PATTERN";e[e["INVALID_PATTERN"]=1]="INVALID_PATTERN";e[e["EOI_ANCHOR_FOUND"]=2]="EOI_ANCHOR_FOUND";e[e["UNSUPPORTED_FLAGS_FOUND"]=3]="UNSUPPORTED_FLAGS_FOUND";e[e["DUPLICATE_PATTERNS_FOUND"]=4]="DUPLICATE_PATTERNS_FOUND";e[e["INVALID_GROUP_TYPE_FOUND"]=5]="INVALID_GROUP_TYPE_FOUND";e[e["PUSH_MODE_DOES_NOT_EXIST"]=6]="PUSH_MODE_DOES_NOT_EXIST";e[e["MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE"]=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE";e[e["MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY"]=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY";e[e["MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST"]=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST";e[e["LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED"]=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED";e[e["SOI_ANCHOR_FOUND"]=11]="SOI_ANCHOR_FOUND";e[e["EMPTY_MATCH_PATTERN"]=12]="EMPTY_MATCH_PATTERN";e[e["NO_LINE_BREAKS_FLAGS"]=13]="NO_LINE_BREAKS_FLAGS";e[e["UNREACHABLE_PATTERN"]=14]="UNREACHABLE_PATTERN";e[e["IDENTIFY_TERMINATOR"]=15]="IDENTIFY_TERMINATOR";e[e["CUSTOM_LINE_BREAK"]=16]="CUSTOM_LINE_BREAK";e[e["MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE"]=17]="MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE"})(Ju||(Ju={}));const Zu={deferDefinitionErrorsHandling:false,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:false,safeMode:false,errorMessageProvider:Qu,traceInitPerf:false,skipValidations:false,recoveryEnabled:true};Object.freeze(Zu);class Lexer{constructor(e,t=Zu){this.lexerDefinition=e;this.lexerDefinitionErrors=[];this.lexerDefinitionWarning=[];this.patternIdxToConfig={};this.charCodeToPatternIdxToConfig={};this.modes=[];this.emptyGroups={};this.trackStartLines=true;this.trackEndLines=true;this.hasCustom=false;this.canModeBeOptimized={};this.TRACE_INIT=(e,t)=>{if(this.traceInitPerf===true){this.traceInitIndent++;const n=new Array(this.traceInitIndent+1).join("\t");if(this.traceInitIndent<this.traceInitMaxIdent){console.log(`${n}--\x3e <${e}>`)}const{time:r,value:o}=timer(t);const l=r>10?console.warn:console.log;if(this.traceInitIndent<this.traceInitMaxIdent){l(`${n}<-- <${e}> time: ${r}ms`)}this.traceInitIndent--;return o}else{return t()}};if(typeof t==="boolean"){throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\n"+"a boolean 2nd argument is no longer supported")}this.config=To({},Zu,t);const n=this.config.traceInitPerf;if(n===true){this.traceInitMaxIdent=Infinity;this.traceInitPerf=true}else if(typeof n==="number"){this.traceInitMaxIdent=n;this.traceInitPerf=true}this.traceInitIndent=-1;this.TRACE_INIT("Lexer Constructor",(()=>{let n;let r=true;this.TRACE_INIT("Lexer Config handling",(()=>{if(this.config.lineTerminatorsPattern===Zu.lineTerminatorsPattern){this.config.lineTerminatorsPattern=zu}else{if(this.config.lineTerminatorCharacters===Zu.lineTerminatorCharacters){throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n"+"\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS")}}if(t.safeMode&&t.ensureOptimizations){throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.')}this.trackStartLines=/full|onlyStart/i.test(this.config.positionTracking);this.trackEndLines=/full/i.test(this.config.positionTracking);if(V(e)){n={modes:{defaultMode:Ua(e)},defaultMode:ju}}else{r=false;n=Ua(e)}}));if(this.config.skipValidations===false){this.TRACE_INIT("performRuntimeChecks",(()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(performRuntimeChecks(n,this.trackStartLines,this.config.lineTerminatorCharacters))}));this.TRACE_INIT("performWarningRuntimeChecks",(()=>{this.lexerDefinitionWarning=this.lexerDefinitionWarning.concat(performWarningRuntimeChecks(n,this.trackStartLines,this.config.lineTerminatorCharacters))}))}n.modes=n.modes?n.modes:{};mt(n.modes,((e,t)=>{n.modes[t]=mu(e,(e=>nu(e)))}));const o=lt(n.modes);mt(n.modes,((e,n)=>{this.TRACE_INIT(`Mode: <${n}> processing`,(()=>{this.modes.push(n);if(this.config.skipValidations===false){this.TRACE_INIT(`validatePatterns`,(()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(validatePatterns(e,o))}))}if(hn(this.lexerDefinitionErrors)){augmentTokenTypes(e);let r;this.TRACE_INIT(`analyzeTokenTypes`,(()=>{r=analyzeTokenTypes(e,{lineTerminatorCharacters:this.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:this.TRACE_INIT})}));this.patternIdxToConfig[n]=r.patternIdxToConfig;this.charCodeToPatternIdxToConfig[n]=r.charCodeToPatternIdxToConfig;this.emptyGroups=To({},this.emptyGroups,r.emptyGroups);this.hasCustom=r.hasCustom||this.hasCustom;this.canModeBeOptimized[n]=r.canBeOptimized}}))}));this.defaultMode=n.defaultMode;if(!hn(this.lexerDefinitionErrors)&&!this.config.deferDefinitionErrorsHandling){const e=Mr(this.lexerDefinitionErrors,(e=>e.message));const t=e.join("-----------------------\n");throw new Error("Errors detected in definition of Lexer:\n"+t)}mt(this.lexerDefinitionWarning,(e=>{PRINT_WARNING(e.message)}));this.TRACE_INIT("Choosing sub-methods implementations",(()=>{if(Wu){this.chopInput=dt;this.match=this.matchWithTest}else{this.updateLastIndex=Go;this.match=this.matchWithExec}if(r){this.handleModes=Go}if(this.trackStartLines===false){this.computeNewColumn=dt}if(this.trackEndLines===false){this.updateTokenEndLineColumnLocation=Go}if(/full/i.test(this.config.positionTracking)){this.createTokenInstance=this.createFullToken}else if(/onlyStart/i.test(this.config.positionTracking)){this.createTokenInstance=this.createStartOnlyToken}else if(/onlyOffset/i.test(this.config.positionTracking)){this.createTokenInstance=this.createOffsetOnlyToken}else{throw Error(`Invalid <positionTracking> config option: "${this.config.positionTracking}"`)}if(this.hasCustom){this.addToken=this.addTokenUsingPush;this.handlePayload=this.handlePayloadWithCustom}else{this.addToken=this.addTokenUsingMemberAccess;this.handlePayload=this.handlePayloadNoCustom}}));this.TRACE_INIT("Failed Optimization Warnings",(()=>{const e=Eu(this.canModeBeOptimized,((e,t,n)=>{if(t===false){e.push(n)}return e}),[]);if(t.ensureOptimizations&&!hn(e)){throw Error(`Lexer Modes: < ${e.join(", ")} > cannot be optimized.\n`+'\t Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.\n'+"\t Or inspect the console log for details on how to resolve these issues.")}}));this.TRACE_INIT("clearRegExpParserCache",(()=>{clearRegExpParserCache()}));this.TRACE_INIT("toFastProperties",(()=>{toFastProperties(this)}))}))}tokenize(e,t=this.defaultMode){if(!hn(this.lexerDefinitionErrors)){const e=Mr(this.lexerDefinitionErrors,(e=>e.message));const t=e.join("-----------------------\n");throw new Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+t)}return this.tokenizeInternal(e,t)}tokenizeInternal(e,t){let n,r,o,l,h,f,p,d,_,m,g,y,b,v,E,k;const O=e;const x=O.length;let A=0;let w=0;const S=this.hasCustom?0:Math.floor(e.length/10);const R=new Array(S);const N=[];let C=this.trackStartLines?1:undefined;let I=this.trackStartLines?1:undefined;const L=cloneEmptyGroups(this.emptyGroups);const P=this.trackStartLines;const M=this.config.lineTerminatorsPattern;let F=0;let D=[];let U=[];const $=[];const j=[];Object.freeze(j);let B;function getPossiblePatternsSlow(){return D}function getPossiblePatternsOptimized(e){const t=charCodeToOptimizedIndex(e);const n=U[t];if(n===undefined){return j}else{return n}}const pop_mode=e=>{if($.length===1&&e.tokenType.PUSH_MODE===undefined){const t=this.config.errorMessageProvider.buildUnableToPopLexerModeMessage(e);N.push({offset:e.startOffset,line:e.startLine,column:e.startColumn,length:e.image.length,message:t})}else{$.pop();const e=qu($);D=this.patternIdxToConfig[e];U=this.charCodeToPatternIdxToConfig[e];F=D.length;const t=this.canModeBeOptimized[e]&&this.config.safeMode===false;if(U&&t){B=getPossiblePatternsOptimized}else{B=getPossiblePatternsSlow}}};function push_mode(e){$.push(e);U=this.charCodeToPatternIdxToConfig[e];D=this.patternIdxToConfig[e];F=D.length;F=D.length;const t=this.canModeBeOptimized[e]&&this.config.safeMode===false;if(U&&t){B=getPossiblePatternsOptimized}else{B=getPossiblePatternsSlow}}push_mode.call(this,t);let W;const V=this.config.recoveryEnabled;while(A<x){f=null;const t=O.charCodeAt(A);const v=B(t);const S=v.length;for(n=0;n<S;n++){W=v[n];const r=W.pattern;p=null;const _=W.short;if(_!==false){if(t===_){f=r}}else if(W.isCustom===true){k=r.exec(O,A,R,L);if(k!==null){f=k[0];if(k.payload!==undefined){p=k.payload}}else{f=null}}else{this.updateLastIndex(r,A);f=this.match(r,e,A)}if(f!==null){h=W.longerAlt;if(h!==undefined){const t=h.length;for(o=0;o<t;o++){const t=D[h[o]];const n=t.pattern;d=null;if(t.isCustom===true){k=n.exec(O,A,R,L);if(k!==null){l=k[0];if(k.payload!==undefined){d=k.payload}}else{l=null}}else{this.updateLastIndex(n,A);l=this.match(n,e,A)}if(l&&l.length>f.length){f=l;p=d;W=t;break}}}break}}if(f!==null){_=f.length;m=W.group;if(m!==undefined){g=W.tokenTypeIdx;y=this.createTokenInstance(f,A,g,W.tokenType,C,I,_);this.handlePayload(y,p);if(m===false){w=this.addToken(R,w,y)}else{L[m].push(y)}}e=this.chopInput(e,_);A=A+_;I=this.computeNewColumn(I,_);if(P===true&&W.canLineTerminator===true){let e=0;let t;let n;M.lastIndex=0;do{t=M.test(f);if(t===true){n=M.lastIndex-1;e++}}while(t===true);if(e!==0){C=C+e;I=_-n;this.updateTokenEndLineColumnLocation(y,m,n,e,C,I,_)}}this.handleModes(W,pop_mode,push_mode,y)}else{const t=A;const n=C;const o=I;let l=V===false;while(l===false&&A<x){e=this.chopInput(e,1);A++;for(r=0;r<F;r++){const t=D[r];const n=t.pattern;const o=t.short;if(o!==false){if(O.charCodeAt(A)===o){l=true}}else if(t.isCustom===true){l=n.exec(O,A,R,L)!==null}else{this.updateLastIndex(n,A);l=n.exec(e)!==null}if(l===true){break}}}b=A-t;I=this.computeNewColumn(I,b);E=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(O,t,b,n,o,qu($));N.push({offset:t,line:n,column:o,length:b,message:E});if(V===false){break}}}if(!this.hasCustom){R.length=w}return{tokens:R,groups:L,errors:N}}handleModes(e,t,n,r){if(e.pop===true){const o=e.push;t(r);if(o!==undefined){n.call(this,o)}}else if(e.push!==undefined){n.call(this,e.push)}}chopInput(e,t){return e.substring(t)}updateLastIndex(e,t){e.lastIndex=t}updateTokenEndLineColumnLocation(e,t,n,r,o,l,h){let f,p;if(t!==undefined){f=n===h-1;p=f?-1:0;if(!(r===1&&f===true)){e.endLine=o+p;e.endColumn=l-1+-p}}}computeNewColumn(e,t){return e+t}createOffsetOnlyToken(e,t,n,r){return{image:e,startOffset:t,tokenTypeIdx:n,tokenType:r}}createStartOnlyToken(e,t,n,r,o,l){return{image:e,startOffset:t,startLine:o,startColumn:l,tokenTypeIdx:n,tokenType:r}}createFullToken(e,t,n,r,o,l,h){return{image:e,startOffset:t,endOffset:t+h-1,startLine:o,endLine:o,startColumn:l,endColumn:l+h-1,tokenTypeIdx:n,tokenType:r}}addTokenUsingPush(e,t,n){e.push(n);return t}addTokenUsingMemberAccess(e,t,n){e[t]=n;t++;return t}handlePayloadNoCustom(e,t){}handlePayloadWithCustom(e,t){if(t!==null){e.payload=t}}matchWithTest(e,t,n){const r=e.test(t);if(r===true){return t.substring(n,e.lastIndex)}return null}matchWithExec(e,t){const n=e.exec(t);return n!==null?n[0]:null}}Lexer.SKIPPED="This marks a skipped Token pattern, this means each token identified by it will "+"be consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.";Lexer.NA=/NOT_APPLICABLE/;function tokens_public_tokenLabel(e){if(tokens_public_hasTokenLabel(e)){return e.LABEL}else{return e.name}}function tokenName(e){return e.name}function tokens_public_hasTokenLabel(e){return no(e.LABEL)&&e.LABEL!==""}const el="parent";const tl="categories";const nl="label";const il="group";const rl="push_mode";const sl="pop_mode";const al="longer_alt";const ol="line_breaks";const ul="start_chars_hint";function createToken(e){return createTokenInternal(e)}function createTokenInternal(e){const t=e.pattern;const n={};n.name=e.name;if(!nu(t)){n.PATTERN=t}if($r(e,el)){throw"The parent property is no longer supported.\n"+"See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details."}if($r(e,tl)){n.CATEGORIES=e[tl]}augmentTokenTypes([n]);if($r(e,nl)){n.LABEL=e[nl]}if($r(e,il)){n.GROUP=e[il]}if($r(e,sl)){n.POP_MODE=e[sl]}if($r(e,rl)){n.PUSH_MODE=e[rl]}if($r(e,al)){n.LONGER_ALT=e[al]}if($r(e,ol)){n.LINE_BREAKS=e[ol]}if($r(e,ul)){n.START_CHARS_HINT=e[ul]}return n}const ll=createToken({name:"EOF",pattern:Lexer.NA});augmentTokenTypes([ll]);function createTokenInstance(e,t,n,r,o,l,h,f){return{image:t,startOffset:n,endOffset:r,startLine:o,endLine:l,startColumn:h,endColumn:f,tokenTypeIdx:e.tokenTypeIdx,tokenType:e}}function tokenMatcher(e,t){return tokenStructuredMatcher(e,t)}const cl={buildMismatchTokenMessage({expected:e,actual:t,previous:n,ruleName:r}){const o=tokens_public_hasTokenLabel(e);const l=o?`--\x3e ${tokens_public_tokenLabel(e)} <--`:`token of type --\x3e ${e.name} <--`;const h=`Expecting ${l} but found --\x3e '${t.image}' <--`;return h},buildNotAllInputParsedMessage({firstRedundant:e,ruleName:t}){return"Redundant input, expecting EOF but found: "+e.image},buildNoViableAltMessage({expectedPathsPerAlt:e,actual:t,previous:n,customUserDescription:r,ruleName:o}){const l="Expecting: ";const h=Ru(t).image;const f="\nbut found: '"+h+"'";if(r){return l+r+f}else{const t=Eu(e,((e,t)=>e.concat(t)),[]);const n=Mr(t,(e=>`[${Mr(e,(e=>tokens_public_tokenLabel(e))).join(", ")}]`));const r=Mr(n,((e,t)=>`  ${t+1}. ${e}`));const o=`one of these possible Token sequences:\n${r.join("\n")}`;return l+o+f}},buildEarlyExitMessage({expectedIterationPaths:e,actual:t,customUserDescription:n,ruleName:r}){const o="Expecting: ";const l=Ru(t).image;const h="\nbut found: '"+l+"'";if(n){return o+n+h}else{const t=Mr(e,(e=>`[${Mr(e,(e=>tokens_public_tokenLabel(e))).join(",")}]`));const n=`expecting at least one iteration which starts with one of these possible Token sequences::\n  `+`<${t.join(" ,")}>`;return o+n+h}}};Object.freeze(cl);const hl={buildRuleNotFoundError(e,t){const n="Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+"<-\n"+"inside top level rule: ->"+e.name+"<-";return n}};const fl={buildDuplicateFoundError(e,t){function getExtraProductionArgument(e){if(e instanceof Terminal){return e.terminalType.name}else if(e instanceof model_NonTerminal){return e.nonTerminalName}else{return""}}const n=e.name;const r=Ru(t);const o=r.idx;const l=getProductionDslName(r);const h=getExtraProductionArgument(r);const f=o>0;let p=`->${l}${f?o:""}<- ${h?`with argument: ->${h}<-`:""}\n                  appears more than once (${t.length} times) in the top level rule: ->${n}<-.                  \n                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES \n                  `;p=p.replace(/[ \t]+/g," ");p=p.replace(/\s\s+/g,"\n");return p},buildNamespaceConflictError(e){const t=`Namespace conflict found in grammar.\n`+`The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <${e.name}>.\n`+`To resolve this make sure each Terminal and Non-Terminal names are unique\n`+`This is easy to accomplish by using the convention that Terminal names start with an uppercase letter\n`+`and Non-Terminal names start with a lower case letter.`;return t},buildAlternationPrefixAmbiguityError(e){const t=Mr(e.prefixPath,(e=>tokens_public_tokenLabel(e))).join(", ");const n=e.alternation.idx===0?"":e.alternation.idx;const r=`Ambiguous alternatives: <${e.ambiguityIndices.join(" ,")}> due to common lookahead prefix\n`+`in <OR${n}> inside <${e.topLevelRule.name}> Rule,\n`+`<${t}> may appears as a prefix path in all these alternatives.\n`+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX\n`+`For Further details.`;return r},buildAlternationAmbiguityError(e){const t=Mr(e.prefixPath,(e=>tokens_public_tokenLabel(e))).join(", ");const n=e.alternation.idx===0?"":e.alternation.idx;let r=`Ambiguous Alternatives Detected: <${e.ambiguityIndices.join(" ,")}> in <OR${n}>`+` inside <${e.topLevelRule.name}> Rule,\n`+`<${t}> may appears as a prefix path in all these alternatives.\n`;r=r+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES\n`+`For Further details.`;return r},buildEmptyRepetitionError(e){let t=getProductionDslName(e.repetition);if(e.repetition.idx!==0){t+=e.repetition.idx}const n=`The repetition <${t}> within Rule <${e.topLevelRule.name}> can never consume any tokens.\n`+`This could lead to an infinite loop.`;return n},buildTokenNameError(e){return"deprecated"},buildEmptyAlternationError(e){const t=`Ambiguous empty alternative: <${e.emptyChoiceIdx+1}>`+` in <OR${e.alternation.idx}> inside <${e.topLevelRule.name}> Rule.\n`+`Only the last alternative may be an empty alternative.`;return t},buildTooManyAlternativesError(e){const t=`An Alternation cannot have more than 256 alternatives:\n`+`<OR${e.alternation.idx}> inside <${e.topLevelRule.name}> Rule.\n has ${e.alternation.definition.length+1} alternatives.`;return t},buildLeftRecursionError(e){const t=e.topLevelRule.name;const n=Mr(e.leftRecursionPath,(e=>e.name));const r=`${t} --\x3e ${n.concat([t]).join(" --\x3e ")}`;const o=`Left Recursion found in grammar.\n`+`rule: <${t}> can be invoked from itself (directly or indirectly)\n`+`without consuming any Tokens. The grammar path that causes this is: \n ${r}\n`+` To fix this refactor your grammar to remove the left recursion.\n`+`see: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`;return o},buildInvalidRuleNameError(e){return"deprecated"},buildDuplicateRuleNameError(e){let t;if(e.topLevelRule instanceof Rule){t=e.topLevelRule.name}else{t=e.topLevelRule}const n=`Duplicate definition, rule: ->${t}<- is already defined in the grammar: ->${e.grammarName}<-`;return n}};function resolveGrammar(e,t){const n=new GastRefResolverVisitor(e,t);n.resolveRefs();return n.errors}class GastRefResolverVisitor extends visitor_GAstVisitor{constructor(e,t){super();this.nameToTopRule=e;this.errMsgProvider=t;this.errors=[]}resolveRefs(){mt(bt(this.nameToTopRule),(e=>{this.currTopLevel=e;e.accept(this)}))}visitNonTerminal(e){const t=this.nameToTopRule[e.nonTerminalName];if(!t){const t=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:t,type:Zl.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}else{e.referencedRule=t}}}function flatMap(e,t){return Zo(Mr(e,t),1)}const pl=flatMap;function arrayAggregator(e,t,n,r){var o=-1,l=e==null?0:e.length;while(++o<l){var h=e[o];t(r,h,n(h),e)}return r}const dl=arrayAggregator;function baseAggregator(e,t,n,r){pt(e,(function(e,o,l){t(r,e,n(e),l)}));return r}const _l=baseAggregator;function createAggregator(e,t){return function(n,r){var o=V(n)?dl:_l,l=t?t():{};return o(n,e,Lr(r,2),l)}}const ml=createAggregator;var gl=Object.prototype;var yl=gl.hasOwnProperty;var bl=ml((function(e,t,n){if(yl.call(e,n)){e[n].push(t)}else{Wr(e,n,[t])}}));const vl=bl;function dropRight(e,t,n){var r=e==null?0:e.length;if(!r){return[]}t=n||t===undefined?1:Za(t);t=r-t;return $a(e,0,t<0?0:t)}const El=dropRight;class AbstractNextPossibleTokensWalker extends RestWalker{constructor(e,t){super();this.topProd=e;this.path=t;this.possibleTokTypes=[];this.nextProductionName="";this.nextProductionOccurrence=0;this.found=false;this.isAtEndOfPath=false}startWalking(){this.found=false;if(this.path.ruleStack[0]!==this.topProd.name){throw Error("The path does not start with the walker's top Rule!")}this.ruleStack=Ua(this.path.ruleStack).reverse();this.occurrenceStack=Ua(this.path.occurrenceStack).reverse();this.ruleStack.pop();this.occurrenceStack.pop();this.updateExpectedNext();this.walk(this.topProd);return this.possibleTokTypes}walk(e,t=[]){if(!this.found){super.walk(e,t)}}walkProdRef(e,t,n){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){const r=t.concat(n);this.updateExpectedNext();this.walk(e.referencedRule,r)}}updateExpectedNext(){if(hn(this.ruleStack)){this.nextProductionName="";this.nextProductionOccurrence=0;this.isAtEndOfPath=true}else{this.nextProductionName=this.ruleStack.pop();this.nextProductionOccurrence=this.occurrenceStack.pop()}}}class NextAfterTokenWalker extends AbstractNextPossibleTokensWalker{constructor(e,t){super(e,t);this.path=t;this.nextTerminalName="";this.nextTerminalOccurrence=0;this.nextTerminalName=this.path.lastTok.name;this.nextTerminalOccurrence=this.path.lastTokOccurrence}walkTerminal(e,t,n){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){const e=t.concat(n);const r=new Alternative({definition:e});this.possibleTokTypes=first(r);this.found=true}}}class AbstractNextTerminalAfterProductionWalker extends RestWalker{constructor(e,t){super();this.topRule=e;this.occurrence=t;this.result={token:undefined,occurrence:undefined,isEndOfRule:undefined}}startWalking(){this.walk(this.topRule);return this.result}}class NextTerminalAfterManyWalker extends AbstractNextTerminalAfterProductionWalker{walkMany(e,t,n){if(e.idx===this.occurrence){const e=Ru(t.concat(n));this.result.isEndOfRule=e===undefined;if(e instanceof Terminal){this.result.token=e.terminalType;this.result.occurrence=e.idx}}else{super.walkMany(e,t,n)}}}class NextTerminalAfterManySepWalker extends AbstractNextTerminalAfterProductionWalker{walkManySep(e,t,n){if(e.idx===this.occurrence){const e=Ru(t.concat(n));this.result.isEndOfRule=e===undefined;if(e instanceof Terminal){this.result.token=e.terminalType;this.result.occurrence=e.idx}}else{super.walkManySep(e,t,n)}}}class NextTerminalAfterAtLeastOneWalker extends AbstractNextTerminalAfterProductionWalker{walkAtLeastOne(e,t,n){if(e.idx===this.occurrence){const e=Ru(t.concat(n));this.result.isEndOfRule=e===undefined;if(e instanceof Terminal){this.result.token=e.terminalType;this.result.occurrence=e.idx}}else{super.walkAtLeastOne(e,t,n)}}}class NextTerminalAfterAtLeastOneSepWalker extends AbstractNextTerminalAfterProductionWalker{walkAtLeastOneSep(e,t,n){if(e.idx===this.occurrence){const e=Ru(t.concat(n));this.result.isEndOfRule=e===undefined;if(e instanceof Terminal){this.result.token=e.terminalType;this.result.occurrence=e.idx}}else{super.walkAtLeastOneSep(e,t,n)}}}function possiblePathsFrom(e,t,n=[]){n=Ua(n);let r=[];let o=0;function remainingPathWith(t){return t.concat(eo(e,o+1))}function getAlternativesForProd(e){const o=possiblePathsFrom(remainingPathWith(e),t,n);return r.concat(o)}while(n.length<t&&o<e.length){const t=e[o];if(t instanceof Alternative){return getAlternativesForProd(t.definition)}else if(t instanceof model_NonTerminal){return getAlternativesForProd(t.definition)}else if(t instanceof Option){r=getAlternativesForProd(t.definition)}else if(t instanceof RepetitionMandatory){const e=t.definition.concat([new Repetition({definition:t.definition})]);return getAlternativesForProd(e)}else if(t instanceof RepetitionMandatoryWithSeparator){const e=[new Alternative({definition:t.definition}),new Repetition({definition:[new Terminal({terminalType:t.separator})].concat(t.definition)})];return getAlternativesForProd(e)}else if(t instanceof RepetitionWithSeparator){const e=t.definition.concat([new Repetition({definition:[new Terminal({terminalType:t.separator})].concat(t.definition)})]);r=getAlternativesForProd(e)}else if(t instanceof Repetition){const e=t.definition.concat([new Repetition({definition:t.definition})]);r=getAlternativesForProd(e)}else if(t instanceof Alternation){mt(t.definition,(e=>{if(hn(e.definition)===false){r=getAlternativesForProd(e.definition)}}));return r}else if(t instanceof Terminal){n.push(t.terminalType)}else{throw Error("non exhaustive match")}o++}r.push({partialPath:n,suffixDef:eo(e,o)});return r}function nextPossibleTokensAfter(e,t,n,r){const o="EXIT_NONE_TERMINAL";const l=[o];const h="EXIT_ALTERNATIVE";let f=false;const p=t.length;const d=p-r-1;const _=[];const m=[];m.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});while(!hn(m)){const e=m.pop();if(e===h){if(f&&qu(m).idx<=d){m.pop()}continue}const r=e.def;const g=e.idx;const y=e.ruleStack;const b=e.occurrenceStack;if(hn(r)){continue}const v=r[0];if(v===o){const e={idx:g,def:eo(r),ruleStack:El(y),occurrenceStack:El(b)};m.push(e)}else if(v instanceof Terminal){if(g<p-1){const e=g+1;const o=t[e];if(n(o,v.terminalType)){const t={idx:e,def:eo(r),ruleStack:y,occurrenceStack:b};m.push(t)}}else if(g===p-1){_.push({nextTokenType:v.terminalType,nextTokenOccurrence:v.idx,ruleStack:y,occurrenceStack:b});f=true}else{throw Error("non exhaustive match")}}else if(v instanceof model_NonTerminal){const e=Ua(y);e.push(v.nonTerminalName);const t=Ua(b);t.push(v.idx);const n={idx:g,def:v.definition.concat(l,eo(r)),ruleStack:e,occurrenceStack:t};m.push(n)}else if(v instanceof Option){const e={idx:g,def:eo(r),ruleStack:y,occurrenceStack:b};m.push(e);m.push(h);const t={idx:g,def:v.definition.concat(eo(r)),ruleStack:y,occurrenceStack:b};m.push(t)}else if(v instanceof RepetitionMandatory){const e=new Repetition({definition:v.definition,idx:v.idx});const t=v.definition.concat([e],eo(r));const n={idx:g,def:t,ruleStack:y,occurrenceStack:b};m.push(n)}else if(v instanceof RepetitionMandatoryWithSeparator){const e=new Terminal({terminalType:v.separator});const t=new Repetition({definition:[e].concat(v.definition),idx:v.idx});const n=v.definition.concat([t],eo(r));const o={idx:g,def:n,ruleStack:y,occurrenceStack:b};m.push(o)}else if(v instanceof RepetitionWithSeparator){const e={idx:g,def:eo(r),ruleStack:y,occurrenceStack:b};m.push(e);m.push(h);const t=new Terminal({terminalType:v.separator});const n=new Repetition({definition:[t].concat(v.definition),idx:v.idx});const o=v.definition.concat([n],eo(r));const l={idx:g,def:o,ruleStack:y,occurrenceStack:b};m.push(l)}else if(v instanceof Repetition){const e={idx:g,def:eo(r),ruleStack:y,occurrenceStack:b};m.push(e);m.push(h);const t=new Repetition({definition:v.definition,idx:v.idx});const n=v.definition.concat([t],eo(r));const o={idx:g,def:n,ruleStack:y,occurrenceStack:b};m.push(o)}else if(v instanceof Alternation){for(let e=v.definition.length-1;e>=0;e--){const t=v.definition[e];const n={idx:g,def:t.definition.concat(eo(r)),ruleStack:y,occurrenceStack:b};m.push(n);m.push(h)}}else if(v instanceof Alternative){m.push({idx:g,def:v.definition.concat(eo(r)),ruleStack:y,occurrenceStack:b})}else if(v instanceof Rule){m.push(expandTopLevelRule(v,g,y,b))}else{throw Error("non exhaustive match")}}return _}function expandTopLevelRule(e,t,n,r){const o=Ua(n);o.push(e.name);const l=Ua(r);l.push(1);return{idx:t,def:e.definition,ruleStack:o,occurrenceStack:l}}var Tl;(function(e){e[e["OPTION"]=0]="OPTION";e[e["REPETITION"]=1]="REPETITION";e[e["REPETITION_MANDATORY"]=2]="REPETITION_MANDATORY";e[e["REPETITION_MANDATORY_WITH_SEPARATOR"]=3]="REPETITION_MANDATORY_WITH_SEPARATOR";e[e["REPETITION_WITH_SEPARATOR"]=4]="REPETITION_WITH_SEPARATOR";e[e["ALTERNATION"]=5]="ALTERNATION"})(Tl||(Tl={}));function getProdType(e){if(e instanceof Option||e==="Option"){return Tl.OPTION}else if(e instanceof Repetition||e==="Repetition"){return Tl.REPETITION}else if(e instanceof RepetitionMandatory||e==="RepetitionMandatory"){return Tl.REPETITION_MANDATORY}else if(e instanceof RepetitionMandatoryWithSeparator||e==="RepetitionMandatoryWithSeparator"){return Tl.REPETITION_MANDATORY_WITH_SEPARATOR}else if(e instanceof RepetitionWithSeparator||e==="RepetitionWithSeparator"){return Tl.REPETITION_WITH_SEPARATOR}else if(e instanceof Alternation||e==="Alternation"){return Tl.ALTERNATION}else{throw Error("non exhaustive match")}}function getLookaheadPaths(e){const{occurrence:t,rule:n,prodType:r,maxLookahead:o}=e;const l=getProdType(r);if(l===Tl.ALTERNATION){return getLookaheadPathsForOr(t,n,o)}else{return getLookaheadPathsForOptionalProd(t,n,l,o)}}function buildLookaheadFuncForOr(e,t,n,r,o,l){const h=getLookaheadPathsForOr(e,t,n);const f=areTokenCategoriesNotUsed(h)?tokenStructuredMatcherNoCategories:tokenStructuredMatcher;return l(h,r,f,o)}function buildLookaheadFuncForOptionalProd(e,t,n,r,o,l){const h=getLookaheadPathsForOptionalProd(e,t,o,n);const f=areTokenCategoriesNotUsed(h)?tokenStructuredMatcherNoCategories:tokenStructuredMatcher;return l(h[0],f,r)}function buildAlternativesLookAheadFunc(e,t,n,r){const o=e.length;const l=Bo(e,(e=>Bo(e,(e=>e.length===1))));if(t){return function(t){const r=Mr(t,(e=>e.GATE));for(let t=0;t<o;t++){const o=e[t];const l=o.length;const h=r[t];if(h!==undefined&&h.call(this)===false){continue}e:for(let e=0;e<l;e++){const r=o[e];const l=r.length;for(let e=0;e<l;e++){const t=this.LA(e+1);if(n(t,r[e])===false){continue e}}return t}}return undefined}}else if(l&&!r){const t=Mr(e,(e=>eu(e)));const n=Eu(t,((e,t,n)=>{mt(t,(t=>{if(!$r(e,t.tokenTypeIdx)){e[t.tokenTypeIdx]=n}mt(t.categoryMatches,(t=>{if(!$r(e,t)){e[t]=n}}))}));return e}),{});return function(){const e=this.LA(1);return n[e.tokenTypeIdx]}}else{return function(){for(let t=0;t<o;t++){const r=e[t];const o=r.length;e:for(let e=0;e<o;e++){const o=r[e];const l=o.length;for(let e=0;e<l;e++){const t=this.LA(e+1);if(n(t,o[e])===false){continue e}}return t}}return undefined}}}function buildSingleAlternativeLookaheadFunction(e,t,n){const r=Bo(e,(e=>e.length===1));const o=e.length;if(r&&!n){const t=eu(e);if(t.length===1&&hn(t[0].categoryMatches)){const e=t[0];const n=e.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===n}}else{const e=Eu(t,((e,t,n)=>{e[t.tokenTypeIdx]=true;mt(t.categoryMatches,(t=>{e[t]=true}));return e}),[]);return function(){const t=this.LA(1);return e[t.tokenTypeIdx]===true}}}else{return function(){e:for(let n=0;n<o;n++){const r=e[n];const o=r.length;for(let e=0;e<o;e++){const n=this.LA(e+1);if(t(n,r[e])===false){continue e}}return true}return false}}}class RestDefinitionFinderWalker extends RestWalker{constructor(e,t,n){super();this.topProd=e;this.targetOccurrence=t;this.targetProdType=n}startWalking(){this.walk(this.topProd);return this.restDef}checkIsTarget(e,t,n,r){if(e.idx===this.targetOccurrence&&this.targetProdType===t){this.restDef=n.concat(r);return true}return false}walkOption(e,t,n){if(!this.checkIsTarget(e,Tl.OPTION,t,n)){super.walkOption(e,t,n)}}walkAtLeastOne(e,t,n){if(!this.checkIsTarget(e,Tl.REPETITION_MANDATORY,t,n)){super.walkOption(e,t,n)}}walkAtLeastOneSep(e,t,n){if(!this.checkIsTarget(e,Tl.REPETITION_MANDATORY_WITH_SEPARATOR,t,n)){super.walkOption(e,t,n)}}walkMany(e,t,n){if(!this.checkIsTarget(e,Tl.REPETITION,t,n)){super.walkOption(e,t,n)}}walkManySep(e,t,n){if(!this.checkIsTarget(e,Tl.REPETITION_WITH_SEPARATOR,t,n)){super.walkOption(e,t,n)}}}class InsideDefinitionFinderVisitor extends visitor_GAstVisitor{constructor(e,t,n){super();this.targetOccurrence=e;this.targetProdType=t;this.targetRef=n;this.result=[]}checkIsTarget(e,t){if(e.idx===this.targetOccurrence&&this.targetProdType===t&&(this.targetRef===undefined||e===this.targetRef)){this.result=e.definition}}visitOption(e){this.checkIsTarget(e,Tl.OPTION)}visitRepetition(e){this.checkIsTarget(e,Tl.REPETITION)}visitRepetitionMandatory(e){this.checkIsTarget(e,Tl.REPETITION_MANDATORY)}visitRepetitionMandatoryWithSeparator(e){this.checkIsTarget(e,Tl.REPETITION_MANDATORY_WITH_SEPARATOR)}visitRepetitionWithSeparator(e){this.checkIsTarget(e,Tl.REPETITION_WITH_SEPARATOR)}visitAlternation(e){this.checkIsTarget(e,Tl.ALTERNATION)}}function initializeArrayOfArrays(e){const t=new Array(e);for(let n=0;n<e;n++){t[n]=[]}return t}function pathToHashKeys(e){let t=[""];for(let n=0;n<e.length;n++){const r=e[n];const o=[];for(let e=0;e<t.length;e++){const n=t[e];o.push(n+"_"+r.tokenTypeIdx);for(let e=0;e<r.categoryMatches.length;e++){const t="_"+r.categoryMatches[e];o.push(n+t)}}t=o}return t}function isUniquePrefixHash(e,t,n){for(let r=0;r<e.length;r++){if(r===n){continue}const o=e[r];for(let e=0;e<t.length;e++){const n=t[e];if(o[n]===true){return false}}}return true}function lookAheadSequenceFromAlternatives(e,t){const n=Mr(e,(e=>possiblePathsFrom([e],1)));const r=initializeArrayOfArrays(n.length);const o=Mr(n,(e=>{const t={};mt(e,(e=>{const n=pathToHashKeys(e.partialPath);mt(n,(e=>{t[e]=true}))}));return t}));let l=n;for(let e=1;e<=t;e++){const n=l;l=initializeArrayOfArrays(n.length);for(let h=0;h<n.length;h++){const f=n[h];for(let n=0;n<f.length;n++){const p=f[n].partialPath;const d=f[n].suffixDef;const _=pathToHashKeys(p);const m=isUniquePrefixHash(o,_,h);if(m||hn(d)||p.length===t){const e=r[h];if(containsPath(e,p)===false){e.push(p);for(let e=0;e<_.length;e++){const t=_[e];o[h][t]=true}}}else{const t=possiblePathsFrom(d,e+1,p);l[h]=l[h].concat(t);mt(t,(e=>{const t=pathToHashKeys(e.partialPath);mt(t,(e=>{o[h][e]=true}))}))}}}}return r}function getLookaheadPathsForOr(e,t,n,r){const o=new InsideDefinitionFinderVisitor(e,Tl.ALTERNATION,r);t.accept(o);return lookAheadSequenceFromAlternatives(o.result,n)}function getLookaheadPathsForOptionalProd(e,t,n,r){const o=new InsideDefinitionFinderVisitor(e,n);t.accept(o);const l=o.result;const h=new RestDefinitionFinderWalker(t,e,n);const f=h.startWalking();const p=new Alternative({definition:l});const d=new Alternative({definition:f});return lookAheadSequenceFromAlternatives([p,d],r)}function containsPath(e,t){e:for(let n=0;n<e.length;n++){const r=e[n];if(r.length!==t.length){continue}for(let e=0;e<r.length;e++){const n=t[e];const o=r[e];const l=n===o||o.categoryMatchesMap[n.tokenTypeIdx]!==undefined;if(l===false){continue e}}return true}return false}function isStrictPrefixOfPath(e,t){return e.length<t.length&&Bo(e,((e,n)=>{const r=t[n];return e===r||r.categoryMatchesMap[e.tokenTypeIdx]}))}function areTokenCategoriesNotUsed(e){return Bo(e,(e=>Bo(e,(e=>Bo(e,(e=>hn(e.categoryMatches)))))))}function validateLookahead(e){const t=e.lookaheadStrategy.validate({rules:e.rules,tokenTypes:e.tokenTypes,grammarName:e.grammarName});return Mr(t,(e=>Object.assign({type:Zl.CUSTOM_LOOKAHEAD_VALIDATION},e)))}function validateGrammar(e,t,n,r){const o=pl(e,(e=>validateDuplicateProductions(e,n)));const l=checkTerminalAndNoneTerminalsNameSpace(e,t,n);const h=pl(e,(e=>validateTooManyAlts(e,n)));const f=pl(e,(t=>validateRuleDoesNotAlreadyExist(t,e,r,n)));return o.concat(l,h,f)}function validateDuplicateProductions(e,t){const n=new OccurrenceValidationCollector;e.accept(n);const r=n.allProductions;const o=vl(r,identifyProductionForDuplicates);const l=xo(o,(e=>e.length>1));const h=Mr(bt(l),(n=>{const r=Ru(n);const o=t.buildDuplicateFoundError(e,n);const l=getProductionDslName(r);const h={message:o,type:Zl.DUPLICATE_PRODUCTIONS,ruleName:e.name,dslName:l,occurrence:r.idx};const f=getExtraProductionArgument(r);if(f){h.parameter=f}return h}));return h}function identifyProductionForDuplicates(e){return`${getProductionDslName(e)}_#_${e.idx}_#_${getExtraProductionArgument(e)}`}function getExtraProductionArgument(e){if(e instanceof Terminal){return e.terminalType.name}else if(e instanceof model_NonTerminal){return e.nonTerminalName}else{return""}}class OccurrenceValidationCollector extends visitor_GAstVisitor{constructor(){super(...arguments);this.allProductions=[]}visitNonTerminal(e){this.allProductions.push(e)}visitOption(e){this.allProductions.push(e)}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}visitAlternation(e){this.allProductions.push(e)}visitTerminal(e){this.allProductions.push(e)}}function validateRuleDoesNotAlreadyExist(e,t,n,r){const o=[];const l=Eu(t,((t,n)=>{if(n.name===e.name){return t+1}return t}),0);if(l>1){const t=r.buildDuplicateRuleNameError({topLevelRule:e,grammarName:n});o.push({message:t,type:Zl.DUPLICATE_RULE_NAME,ruleName:e.name})}return o}function validateRuleIsOverridden(e,t,n){const r=[];let o;if(!Uo(t,e)){o=`Invalid rule override, rule: ->${e}<- cannot be overridden in the grammar: ->${n}<-`+`as it is not defined in any of the super grammars `;r.push({message:o,type:Zl.INVALID_RULE_OVERRIDE,ruleName:e})}return r}function validateNoLeftRecursion(e,t,n,r=[]){const o=[];const l=getFirstNoneTerminal(t.definition);if(hn(l)){return[]}else{const t=e.name;const h=Uo(l,e);if(h){o.push({message:n.buildLeftRecursionError({topLevelRule:e,leftRecursionPath:r}),type:Zl.LEFT_RECURSION,ruleName:t})}const f=wu(l,r.concat([e]));const p=pl(f,(t=>{const o=Ua(r);o.push(t);return validateNoLeftRecursion(e,t,n,o)}));return o.concat(p)}}function getFirstNoneTerminal(e){let t=[];if(hn(e)){return t}const n=Ru(e);if(n instanceof model_NonTerminal){t.push(n.referencedRule)}else if(n instanceof Alternative||n instanceof Option||n instanceof RepetitionMandatory||n instanceof RepetitionMandatoryWithSeparator||n instanceof RepetitionWithSeparator||n instanceof Repetition){t=t.concat(getFirstNoneTerminal(n.definition))}else if(n instanceof Alternation){t=eu(Mr(n.definition,(e=>getFirstNoneTerminal(e.definition))))}else if(n instanceof Terminal){}else{throw Error("non exhaustive match")}const r=isOptionalProd(n);const o=e.length>1;if(r&&o){const n=eo(e);return t.concat(getFirstNoneTerminal(n))}else{return t}}class OrCollector extends visitor_GAstVisitor{constructor(){super(...arguments);this.alternations=[]}visitAlternation(e){this.alternations.push(e)}}function validateEmptyOrAlternative(e,t){const n=new OrCollector;e.accept(n);const r=n.alternations;const o=pl(r,(n=>{const r=El(n.definition);return pl(r,((r,o)=>{const l=nextPossibleTokensAfter([r],[],tokenStructuredMatcher,1);if(hn(l)){return[{message:t.buildEmptyAlternationError({topLevelRule:e,alternation:n,emptyChoiceIdx:o}),type:Zl.NONE_LAST_EMPTY_ALT,ruleName:e.name,occurrence:n.idx,alternative:o+1}]}else{return[]}}))}));return o}function validateAmbiguousAlternationAlternatives(e,t,n){const r=new OrCollector;e.accept(r);let o=r.alternations;o=mu(o,(e=>e.ignoreAmbiguities===true));const l=pl(o,(r=>{const o=r.idx;const l=r.maxLookahead||t;const h=getLookaheadPathsForOr(o,e,l,r);const f=checkAlternativesAmbiguities(h,r,e,n);const p=checkPrefixAlternativesAmbiguities(h,r,e,n);return f.concat(p)}));return l}class RepetitionCollector extends visitor_GAstVisitor{constructor(){super(...arguments);this.allProductions=[]}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}}function validateTooManyAlts(e,t){const n=new OrCollector;e.accept(n);const r=n.alternations;const o=pl(r,(n=>{if(n.definition.length>255){return[{message:t.buildTooManyAlternativesError({topLevelRule:e,alternation:n}),type:Zl.TOO_MANY_ALTS,ruleName:e.name,occurrence:n.idx}]}else{return[]}}));return o}function validateSomeNonEmptyLookaheadPath(e,t,n){const r=[];mt(e,(e=>{const o=new RepetitionCollector;e.accept(o);const l=o.allProductions;mt(l,(o=>{const l=getProdType(o);const h=o.maxLookahead||t;const f=o.idx;const p=getLookaheadPathsForOptionalProd(f,e,l,h);const d=p[0];if(hn(eu(d))){const t=n.buildEmptyRepetitionError({topLevelRule:e,repetition:o});r.push({message:t,type:Zl.NO_NON_EMPTY_LOOKAHEAD,ruleName:e.name})}}))}));return r}function checkAlternativesAmbiguities(e,t,n,r){const o=[];const l=Eu(e,((n,r,l)=>{if(t.definition[l].ignoreAmbiguities===true){return n}mt(r,(r=>{const h=[l];mt(e,((e,n)=>{if(l!==n&&containsPath(e,r)&&t.definition[n].ignoreAmbiguities!==true){h.push(n)}}));if(h.length>1&&!containsPath(o,r)){o.push(r);n.push({alts:h,path:r})}}));return n}),[]);const h=Mr(l,(e=>{const o=Mr(e.alts,(e=>e+1));const l=r.buildAlternationAmbiguityError({topLevelRule:n,alternation:t,ambiguityIndices:o,prefixPath:e.path});return{message:l,type:Zl.AMBIGUOUS_ALTS,ruleName:n.name,occurrence:t.idx,alternatives:e.alts}}));return h}function checkPrefixAlternativesAmbiguities(e,t,n,r){const o=Eu(e,((e,t,n)=>{const r=Mr(t,(e=>({idx:n,path:e})));return e.concat(r)}),[]);const l=Su(pl(o,(e=>{const l=t.definition[e.idx];if(l.ignoreAmbiguities===true){return[]}const h=e.idx;const f=e.path;const p=Tu(o,(e=>t.definition[e.idx].ignoreAmbiguities!==true&&e.idx<h&&isStrictPrefixOfPath(e.path,f)));const d=Mr(p,(e=>{const o=[e.idx+1,h+1];const l=t.idx===0?"":t.idx;const f=r.buildAlternationPrefixAmbiguityError({topLevelRule:n,alternation:t,ambiguityIndices:o,prefixPath:e.path});return{message:f,type:Zl.AMBIGUOUS_PREFIX_ALTS,ruleName:n.name,occurrence:l,alternatives:o}}));return d})));return l}function checkTerminalAndNoneTerminalsNameSpace(e,t,n){const r=[];const o=Mr(t,(e=>e.name));mt(e,(e=>{const t=e.name;if(Uo(o,t)){const o=n.buildNamespaceConflictError(e);r.push({message:o,type:Zl.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:t})}}));return r}function gast_resolver_public_resolveGrammar(e){const t=fu(e,{errMsgProvider:hl});const n={};mt(e.rules,(e=>{n[e.name]=e}));return resolveGrammar(n,t.errMsgProvider)}function gast_resolver_public_validateGrammar(e){e=fu(e,{errMsgProvider:fl});return validateGrammar(e.rules,e.tokenTypes,e.errMsgProvider,e.grammarName)}const kl="MismatchedTokenException";const Ol="NoViableAltException";const xl="EarlyExitException";const Al="NotAllInputParsedException";const wl=[kl,Ol,xl,Al];Object.freeze(wl);function isRecognitionException(e){return Uo(wl,e.name)}class RecognitionException extends Error{constructor(e,t){super(e);this.token=t;this.resyncedTokens=[];Object.setPrototypeOf(this,new.target.prototype);if(Error.captureStackTrace){Error.captureStackTrace(this,this.constructor)}}}class MismatchedTokenException extends RecognitionException{constructor(e,t,n){super(e,t);this.previousToken=n;this.name=kl}}class NoViableAltException extends RecognitionException{constructor(e,t,n){super(e,t);this.previousToken=n;this.name=Ol}}class NotAllInputParsedException extends RecognitionException{constructor(e,t){super(e,t);this.name=Al}}class EarlyExitException extends RecognitionException{constructor(e,t,n){super(e,t);this.previousToken=n;this.name=xl}}const Sl={};const Rl="InRuleRecoveryException";class InRuleRecoveryException extends Error{constructor(e){super(e);this.name=Rl}}class Recoverable{initRecoverable(e){this.firstAfterRepMap={};this.resyncFollows={};this.recoveryEnabled=$r(e,"recoveryEnabled")?e.recoveryEnabled:Ql.recoveryEnabled;if(this.recoveryEnabled){this.attemptInRepetitionRecovery=attemptInRepetitionRecovery}}getTokenToInsert(e){const t=createTokenInstance(e,"",NaN,NaN,NaN,NaN,NaN,NaN);t.isInsertedInRecovery=true;return t}canTokenTypeBeInsertedInRecovery(e){return true}canTokenTypeBeDeletedInRecovery(e){return true}tryInRepetitionRecovery(e,t,n,r){const o=this.findReSyncTokenType();const l=this.exportLexerState();const h=[];let f=false;const p=this.LA(1);let d=this.LA(1);const generateErrorMessage=()=>{const e=this.LA(0);const t=this.errorMessageProvider.buildMismatchTokenMessage({expected:r,actual:p,previous:e,ruleName:this.getCurrRuleFullName()});const n=new MismatchedTokenException(t,p,this.LA(0));n.resyncedTokens=El(h);this.SAVE_ERROR(n)};while(!f){if(this.tokenMatcher(d,r)){generateErrorMessage();return}else if(n.call(this)){generateErrorMessage();e.apply(this,t);return}else if(this.tokenMatcher(d,o)){f=true}else{d=this.SKIP_TOKEN();this.addToResyncTokens(d,h)}}this.importLexerState(l)}shouldInRepetitionRecoveryBeTried(e,t,n){if(n===false){return false}if(this.tokenMatcher(this.LA(1),e)){return false}if(this.isBackTracking()){return false}if(this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t))){return false}return true}getFollowsForInRuleRecovery(e,t){const n=this.getCurrentGrammarPath(e,t);const r=this.getNextPossibleTokenTypes(n);return r}tryInRuleRecovery(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t)){const t=this.getTokenToInsert(e);return t}if(this.canRecoverWithSingleTokenDeletion(e)){const e=this.SKIP_TOKEN();this.consumeToken();return e}throw new InRuleRecoveryException("sad sad panda")}canPerformInRuleRecovery(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)}canRecoverWithSingleTokenInsertion(e,t){if(!this.canTokenTypeBeInsertedInRecovery(e)){return false}if(hn(t)){return false}const n=this.LA(1);const r=Pu(t,(e=>this.tokenMatcher(n,e)))!==undefined;return r}canRecoverWithSingleTokenDeletion(e){if(!this.canTokenTypeBeDeletedInRecovery(e)){return false}const t=this.tokenMatcher(this.LA(2),e);return t}isInCurrentRuleReSyncSet(e){const t=this.getCurrFollowKey();const n=this.getFollowSetFromFollowKey(t);return Uo(n,e)}findReSyncTokenType(){const e=this.flattenFollowSet();let t=this.LA(1);let n=2;while(true){const r=Pu(e,(e=>{const n=tokenMatcher(t,e);return n}));if(r!==undefined){return r}t=this.LA(n);n++}}getCurrFollowKey(){if(this.RULE_STACK.length===1){return Sl}const e=this.getLastExplicitRuleShortName();const t=this.getLastExplicitRuleOccurrenceIndex();const n=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(n)}}buildFullFollowKeyStack(){const e=this.RULE_STACK;const t=this.RULE_OCCURRENCE_STACK;return Mr(e,((n,r)=>{if(r===0){return Sl}return{ruleName:this.shortRuleNameToFullName(n),idxInCallingRule:t[r],inRule:this.shortRuleNameToFullName(e[r-1])}}))}flattenFollowSet(){const e=Mr(this.buildFullFollowKeyStack(),(e=>this.getFollowSetFromFollowKey(e)));return eu(e)}getFollowSetFromFollowKey(e){if(e===Sl){return[ll]}const t=e.ruleName+e.idxInCallingRule+tu+e.inRule;return this.resyncFollows[t]}addToResyncTokens(e,t){if(!this.tokenMatcher(e,ll)){t.push(e)}return t}reSyncTo(e){const t=[];let n=this.LA(1);while(this.tokenMatcher(n,e)===false){n=this.SKIP_TOKEN();this.addToResyncTokens(n,t)}return El(t)}attemptInRepetitionRecovery(e,t,n,r,o,l,h){}getCurrentGrammarPath(e,t){const n=this.getHumanReadableRuleStack();const r=Ua(this.RULE_OCCURRENCE_STACK);const o={ruleStack:n,occurrenceStack:r,lastTok:e,lastTokOccurrence:t};return o}getHumanReadableRuleStack(){return Mr(this.RULE_STACK,(e=>this.shortRuleNameToFullName(e)))}}function attemptInRepetitionRecovery(e,t,n,r,o,l,h){const f=this.getKeyForAutomaticLookahead(r,o);let p=this.firstAfterRepMap[f];if(p===undefined){const e=this.getCurrRuleFullName();const t=this.getGAstProductions()[e];const n=new l(t,o);p=n.startWalking();this.firstAfterRepMap[f]=p}let d=p.token;let _=p.occurrence;const m=p.isEndOfRule;if(this.RULE_STACK.length===1&&m&&d===undefined){d=ll;_=1}if(d===undefined||_===undefined){return}if(this.shouldInRepetitionRecoveryBeTried(d,_,h)){this.tryInRepetitionRecovery(e,t,n,d)}}const Nl=4;const Cl=8;const Il=12;const Ll=8;const Pl=1<<Cl;const Ml=2<<Cl;const Fl=3<<Cl;const Dl=4<<Cl;const Ul=5<<Cl;const $l=6<<Cl;function getKeyForAutomaticLookahead(e,t,n){return n|t|e}const jl=32-Ll;class LLkLookaheadStrategy{constructor(e){var t;this.maxLookahead=(t=e===null||e===void 0?void 0:e.maxLookahead)!==null&&t!==void 0?t:Ql.maxLookahead}validate(e){const t=this.validateNoLeftRecursion(e.rules);if(hn(t)){const n=this.validateEmptyOrAlternatives(e.rules);const r=this.validateAmbiguousAlternationAlternatives(e.rules,this.maxLookahead);const o=this.validateSomeNonEmptyLookaheadPath(e.rules,this.maxLookahead);const l=[...t,...n,...r,...o];return l}return t}validateNoLeftRecursion(e){return pl(e,(e=>validateNoLeftRecursion(e,e,fl)))}validateEmptyOrAlternatives(e){return pl(e,(e=>validateEmptyOrAlternative(e,fl)))}validateAmbiguousAlternationAlternatives(e,t){return pl(e,(e=>validateAmbiguousAlternationAlternatives(e,t,fl)))}validateSomeNonEmptyLookaheadPath(e,t){return validateSomeNonEmptyLookaheadPath(e,t,fl)}buildLookaheadForAlternation(e){return buildLookaheadFuncForOr(e.prodOccurrence,e.rule,e.maxLookahead,e.hasPredicates,e.dynamicTokensEnabled,buildAlternativesLookAheadFunc)}buildLookaheadForOptional(e){return buildLookaheadFuncForOptionalProd(e.prodOccurrence,e.rule,e.maxLookahead,e.dynamicTokensEnabled,getProdType(e.prodType),buildSingleAlternativeLookaheadFunction)}}class LooksAhead{initLooksAhead(e){this.dynamicTokensEnabled=$r(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:Ql.dynamicTokensEnabled;this.maxLookahead=$r(e,"maxLookahead")?e.maxLookahead:Ql.maxLookahead;this.lookaheadStrategy=$r(e,"lookaheadStrategy")?e.lookaheadStrategy:new LLkLookaheadStrategy({maxLookahead:this.maxLookahead});this.lookAheadFuncsCache=new Map}preComputeLookaheadFunctions(e){mt(e,(e=>{this.TRACE_INIT(`${e.name} Rule Lookahead`,(()=>{const{alternation:t,repetition:n,option:r,repetitionMandatory:o,repetitionMandatoryWithSeparator:l,repetitionWithSeparator:h}=collectMethods(e);mt(t,(t=>{const n=t.idx===0?"":t.idx;this.TRACE_INIT(`${getProductionDslName(t)}${n}`,(()=>{const n=this.lookaheadStrategy.buildLookaheadForAlternation({prodOccurrence:t.idx,rule:e,maxLookahead:t.maxLookahead||this.maxLookahead,hasPredicates:t.hasPredicates,dynamicTokensEnabled:this.dynamicTokensEnabled});const r=getKeyForAutomaticLookahead(this.fullRuleNameToShort[e.name],Pl,t.idx);this.setLaFuncCache(r,n)}))}));mt(n,(t=>{this.computeLookaheadFunc(e,t.idx,Fl,"Repetition",t.maxLookahead,getProductionDslName(t))}));mt(r,(t=>{this.computeLookaheadFunc(e,t.idx,Ml,"Option",t.maxLookahead,getProductionDslName(t))}));mt(o,(t=>{this.computeLookaheadFunc(e,t.idx,Dl,"RepetitionMandatory",t.maxLookahead,getProductionDslName(t))}));mt(l,(t=>{this.computeLookaheadFunc(e,t.idx,$l,"RepetitionMandatoryWithSeparator",t.maxLookahead,getProductionDslName(t))}));mt(h,(t=>{this.computeLookaheadFunc(e,t.idx,Ul,"RepetitionWithSeparator",t.maxLookahead,getProductionDslName(t))}))}))}))}computeLookaheadFunc(e,t,n,r,o,l){this.TRACE_INIT(`${l}${t===0?"":t}`,(()=>{const l=this.lookaheadStrategy.buildLookaheadForOptional({prodOccurrence:t,rule:e,maxLookahead:o||this.maxLookahead,dynamicTokensEnabled:this.dynamicTokensEnabled,prodType:r});const h=getKeyForAutomaticLookahead(this.fullRuleNameToShort[e.name],n,t);this.setLaFuncCache(h,l)}))}getKeyForAutomaticLookahead(e,t){const n=this.getLastExplicitRuleShortName();return getKeyForAutomaticLookahead(n,e,t)}getLaFuncFromCache(e){return this.lookAheadFuncsCache.get(e)}setLaFuncCache(e,t){this.lookAheadFuncsCache.set(e,t)}}class DslMethodsCollectorVisitor extends visitor_GAstVisitor{constructor(){super(...arguments);this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}reset(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}visitOption(e){this.dslMethods.option.push(e)}visitRepetitionWithSeparator(e){this.dslMethods.repetitionWithSeparator.push(e)}visitRepetitionMandatory(e){this.dslMethods.repetitionMandatory.push(e)}visitRepetitionMandatoryWithSeparator(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)}visitRepetition(e){this.dslMethods.repetition.push(e)}visitAlternation(e){this.dslMethods.alternation.push(e)}}const Bl=new DslMethodsCollectorVisitor;function collectMethods(e){Bl.reset();e.accept(Bl);const t=Bl.dslMethods;Bl.reset();return t}function setNodeLocationOnlyOffset(e,t){if(isNaN(e.startOffset)===true){e.startOffset=t.startOffset;e.endOffset=t.endOffset}else if(e.endOffset<t.endOffset===true){e.endOffset=t.endOffset}}function setNodeLocationFull(e,t){if(isNaN(e.startOffset)===true){e.startOffset=t.startOffset;e.startColumn=t.startColumn;e.startLine=t.startLine;e.endOffset=t.endOffset;e.endColumn=t.endColumn;e.endLine=t.endLine}else if(e.endOffset<t.endOffset===true){e.endOffset=t.endOffset;e.endColumn=t.endColumn;e.endLine=t.endLine}}function addTerminalToCst(e,t,n){if(e.children[n]===undefined){e.children[n]=[t]}else{e.children[n].push(t)}}function addNoneTerminalToCst(e,t,n){if(e.children[t]===undefined){e.children[t]=[n]}else{e.children[t].push(n)}}const Wl="name";function defineNameProp(e,t){Object.defineProperty(e,Wl,{enumerable:false,configurable:true,writable:false,value:t})}function defaultVisit(e,t){const n=lt(e);const r=n.length;for(let o=0;o<r;o++){const r=n[o];const l=e[r];const h=l.length;for(let e=0;e<h;e++){const n=l[e];if(n.tokenTypeIdx===undefined){this[n.name](n.children,t)}}}}function createBaseSemanticVisitorConstructor(e,t){const derivedConstructor=function(){};defineNameProp(derivedConstructor,e+"BaseSemantics");const n={visit:function(e,t){if(V(e)){e=e[0]}if(nu(e)){return undefined}return this[e.name](e.children,t)},validateVisitor:function(){const e=validateVisitor(this,t);if(!hn(e)){const t=Mr(e,(e=>e.msg));throw Error(`Errors Detected in CST Visitor <${this.constructor.name}>:\n\t`+`${t.join("\n\n").replace(/\n/g,"\n\t")}`)}}};derivedConstructor.prototype=n;derivedConstructor.prototype.constructor=derivedConstructor;derivedConstructor._RULE_NAMES=t;return derivedConstructor}function createBaseVisitorConstructorWithDefaults(e,t,n){const derivedConstructor=function(){};defineNameProp(derivedConstructor,e+"BaseSemanticsWithDefaults");const r=Object.create(n.prototype);mt(t,(e=>{r[e]=defaultVisit}));derivedConstructor.prototype=r;derivedConstructor.prototype.constructor=derivedConstructor;return derivedConstructor}var Vl;(function(e){e[e["REDUNDANT_METHOD"]=0]="REDUNDANT_METHOD";e[e["MISSING_METHOD"]=1]="MISSING_METHOD"})(Vl||(Vl={}));function validateVisitor(e,t){const n=validateMissingCstMethods(e,t);return n}function validateMissingCstMethods(e,t){const n=Tu(t,(t=>st(e[t])===false));const r=Mr(n,(t=>({msg:`Missing visitor method: <${t}> on ${e.constructor.name} CST Visitor.`,type:Vl.MISSING_METHOD,methodName:t})));return Su(r)}class TreeBuilder{initTreeBuilder(e){this.CST_STACK=[];this.outputCst=e.outputCst;this.nodeLocationTracking=$r(e,"nodeLocationTracking")?e.nodeLocationTracking:Ql.nodeLocationTracking;if(!this.outputCst){this.cstInvocationStateUpdate=Go;this.cstFinallyStateUpdate=Go;this.cstPostTerminal=Go;this.cstPostNonTerminal=Go;this.cstPostRule=Go}else{if(/full/i.test(this.nodeLocationTracking)){if(this.recoveryEnabled){this.setNodeLocationFromToken=setNodeLocationFull;this.setNodeLocationFromNode=setNodeLocationFull;this.cstPostRule=Go;this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery}else{this.setNodeLocationFromToken=Go;this.setNodeLocationFromNode=Go;this.cstPostRule=this.cstPostRuleFull;this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular}}else if(/onlyOffset/i.test(this.nodeLocationTracking)){if(this.recoveryEnabled){this.setNodeLocationFromToken=setNodeLocationOnlyOffset;this.setNodeLocationFromNode=setNodeLocationOnlyOffset;this.cstPostRule=Go;this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery}else{this.setNodeLocationFromToken=Go;this.setNodeLocationFromNode=Go;this.cstPostRule=this.cstPostRuleOnlyOffset;this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular}}else if(/none/i.test(this.nodeLocationTracking)){this.setNodeLocationFromToken=Go;this.setNodeLocationFromNode=Go;this.cstPostRule=Go;this.setInitialNodeLocation=Go}else{throw Error(`Invalid <nodeLocationTracking> config option: "${e.nodeLocationTracking}"`)}}}setInitialNodeLocationOnlyOffsetRecovery(e){e.location={startOffset:NaN,endOffset:NaN}}setInitialNodeLocationOnlyOffsetRegular(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}}setInitialNodeLocationFullRecovery(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}}setInitialNodeLocationFullRegular(e){const t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}}cstInvocationStateUpdate(e){const t={name:e,children:Object.create(null)};this.setInitialNodeLocation(t);this.CST_STACK.push(t)}cstFinallyStateUpdate(){this.CST_STACK.pop()}cstPostRuleFull(e){const t=this.LA(0);const n=e.location;if(n.startOffset<=t.startOffset===true){n.endOffset=t.endOffset;n.endLine=t.endLine;n.endColumn=t.endColumn}else{n.startOffset=NaN;n.startLine=NaN;n.startColumn=NaN}}cstPostRuleOnlyOffset(e){const t=this.LA(0);const n=e.location;if(n.startOffset<=t.startOffset===true){n.endOffset=t.endOffset}else{n.startOffset=NaN}}cstPostTerminal(e,t){const n=this.CST_STACK[this.CST_STACK.length-1];addTerminalToCst(n,t,e);this.setNodeLocationFromToken(n.location,t)}cstPostNonTerminal(e,t){const n=this.CST_STACK[this.CST_STACK.length-1];addNoneTerminalToCst(n,t,e);this.setNodeLocationFromNode(n.location,e.location)}getBaseCstVisitorConstructor(){if(nu(this.baseCstVisitorConstructor)){const e=createBaseSemanticVisitorConstructor(this.className,lt(this.gastProductionsCache));this.baseCstVisitorConstructor=e;return e}return this.baseCstVisitorConstructor}getBaseCstVisitorConstructorWithDefaults(){if(nu(this.baseCstVisitorWithDefaultsConstructor)){const e=createBaseVisitorConstructorWithDefaults(this.className,lt(this.gastProductionsCache),this.getBaseCstVisitorConstructor());this.baseCstVisitorWithDefaultsConstructor=e;return e}return this.baseCstVisitorWithDefaultsConstructor}getLastExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-1]}getPreviousExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-2]}getLastExplicitRuleOccurrenceIndex(){const e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]}}class LexerAdapter{initLexerAdapter(){this.tokVector=[];this.tokVectorLength=0;this.currIdx=-1}set input(e){if(this.selfAnalysisDone!==true){throw Error(`Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.`)}this.reset();this.tokVector=e;this.tokVectorLength=e.length}get input(){return this.tokVector}SKIP_TOKEN(){if(this.currIdx<=this.tokVector.length-2){this.consumeToken();return this.LA(1)}else{return Yl}}LA(e){const t=this.currIdx+e;if(t<0||this.tokVectorLength<=t){return Yl}else{return this.tokVector[t]}}consumeToken(){this.currIdx++}exportLexerState(){return this.currIdx}importLexerState(e){this.currIdx=e}resetLexerState(){this.currIdx=-1}moveToTerminatedState(){this.currIdx=this.tokVector.length-1}getLexerPosition(){return this.exportLexerState()}}class RecognizerApi{ACTION(e){return e.call(this)}consume(e,t,n){return this.consumeInternal(t,e,n)}subrule(e,t,n){return this.subruleInternal(t,e,n)}option(e,t){return this.optionInternal(t,e)}or(e,t){return this.orInternal(t,e)}many(e,t){return this.manyInternal(e,t)}atLeastOne(e,t){return this.atLeastOneInternal(e,t)}CONSUME(e,t){return this.consumeInternal(e,0,t)}CONSUME1(e,t){return this.consumeInternal(e,1,t)}CONSUME2(e,t){return this.consumeInternal(e,2,t)}CONSUME3(e,t){return this.consumeInternal(e,3,t)}CONSUME4(e,t){return this.consumeInternal(e,4,t)}CONSUME5(e,t){return this.consumeInternal(e,5,t)}CONSUME6(e,t){return this.consumeInternal(e,6,t)}CONSUME7(e,t){return this.consumeInternal(e,7,t)}CONSUME8(e,t){return this.consumeInternal(e,8,t)}CONSUME9(e,t){return this.consumeInternal(e,9,t)}SUBRULE(e,t){return this.subruleInternal(e,0,t)}SUBRULE1(e,t){return this.subruleInternal(e,1,t)}SUBRULE2(e,t){return this.subruleInternal(e,2,t)}SUBRULE3(e,t){return this.subruleInternal(e,3,t)}SUBRULE4(e,t){return this.subruleInternal(e,4,t)}SUBRULE5(e,t){return this.subruleInternal(e,5,t)}SUBRULE6(e,t){return this.subruleInternal(e,6,t)}SUBRULE7(e,t){return this.subruleInternal(e,7,t)}SUBRULE8(e,t){return this.subruleInternal(e,8,t)}SUBRULE9(e,t){return this.subruleInternal(e,9,t)}OPTION(e){return this.optionInternal(e,0)}OPTION1(e){return this.optionInternal(e,1)}OPTION2(e){return this.optionInternal(e,2)}OPTION3(e){return this.optionInternal(e,3)}OPTION4(e){return this.optionInternal(e,4)}OPTION5(e){return this.optionInternal(e,5)}OPTION6(e){return this.optionInternal(e,6)}OPTION7(e){return this.optionInternal(e,7)}OPTION8(e){return this.optionInternal(e,8)}OPTION9(e){return this.optionInternal(e,9)}OR(e){return this.orInternal(e,0)}OR1(e){return this.orInternal(e,1)}OR2(e){return this.orInternal(e,2)}OR3(e){return this.orInternal(e,3)}OR4(e){return this.orInternal(e,4)}OR5(e){return this.orInternal(e,5)}OR6(e){return this.orInternal(e,6)}OR7(e){return this.orInternal(e,7)}OR8(e){return this.orInternal(e,8)}OR9(e){return this.orInternal(e,9)}MANY(e){this.manyInternal(0,e)}MANY1(e){this.manyInternal(1,e)}MANY2(e){this.manyInternal(2,e)}MANY3(e){this.manyInternal(3,e)}MANY4(e){this.manyInternal(4,e)}MANY5(e){this.manyInternal(5,e)}MANY6(e){this.manyInternal(6,e)}MANY7(e){this.manyInternal(7,e)}MANY8(e){this.manyInternal(8,e)}MANY9(e){this.manyInternal(9,e)}MANY_SEP(e){this.manySepFirstInternal(0,e)}MANY_SEP1(e){this.manySepFirstInternal(1,e)}MANY_SEP2(e){this.manySepFirstInternal(2,e)}MANY_SEP3(e){this.manySepFirstInternal(3,e)}MANY_SEP4(e){this.manySepFirstInternal(4,e)}MANY_SEP5(e){this.manySepFirstInternal(5,e)}MANY_SEP6(e){this.manySepFirstInternal(6,e)}MANY_SEP7(e){this.manySepFirstInternal(7,e)}MANY_SEP8(e){this.manySepFirstInternal(8,e)}MANY_SEP9(e){this.manySepFirstInternal(9,e)}AT_LEAST_ONE(e){this.atLeastOneInternal(0,e)}AT_LEAST_ONE1(e){return this.atLeastOneInternal(1,e)}AT_LEAST_ONE2(e){this.atLeastOneInternal(2,e)}AT_LEAST_ONE3(e){this.atLeastOneInternal(3,e)}AT_LEAST_ONE4(e){this.atLeastOneInternal(4,e)}AT_LEAST_ONE5(e){this.atLeastOneInternal(5,e)}AT_LEAST_ONE6(e){this.atLeastOneInternal(6,e)}AT_LEAST_ONE7(e){this.atLeastOneInternal(7,e)}AT_LEAST_ONE8(e){this.atLeastOneInternal(8,e)}AT_LEAST_ONE9(e){this.atLeastOneInternal(9,e)}AT_LEAST_ONE_SEP(e){this.atLeastOneSepFirstInternal(0,e)}AT_LEAST_ONE_SEP1(e){this.atLeastOneSepFirstInternal(1,e)}AT_LEAST_ONE_SEP2(e){this.atLeastOneSepFirstInternal(2,e)}AT_LEAST_ONE_SEP3(e){this.atLeastOneSepFirstInternal(3,e)}AT_LEAST_ONE_SEP4(e){this.atLeastOneSepFirstInternal(4,e)}AT_LEAST_ONE_SEP5(e){this.atLeastOneSepFirstInternal(5,e)}AT_LEAST_ONE_SEP6(e){this.atLeastOneSepFirstInternal(6,e)}AT_LEAST_ONE_SEP7(e){this.atLeastOneSepFirstInternal(7,e)}AT_LEAST_ONE_SEP8(e){this.atLeastOneSepFirstInternal(8,e)}AT_LEAST_ONE_SEP9(e){this.atLeastOneSepFirstInternal(9,e)}RULE(e,t,n=Jl){if(Uo(this.definedRulesNames,e)){const t=fl.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className});const n={message:t,type:Zl.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(n)}this.definedRulesNames.push(e);const r=this.defineRule(e,t,n);this[e]=r;return r}OVERRIDE_RULE(e,t,n=Jl){const r=validateRuleIsOverridden(e,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(r);const o=this.defineRule(e,t,n);this[e]=o;return o}BACKTRACK(e,t){return function(){this.isBackTrackingStack.push(1);const n=this.saveRecogState();try{e.apply(this,t);return true}catch(e){if(isRecognitionException(e)){return false}else{throw e}}finally{this.reloadRecogState(n);this.isBackTrackingStack.pop()}}}getGAstProductions(){return this.gastProductionsCache}getSerializedGastProductions(){return serializeGrammar(bt(this.gastProductionsCache))}}class RecognizerEngine{initRecognizerEngine(e,t){this.className=this.constructor.name;this.shortRuleNameToFull={};this.fullRuleNameToShort={};this.ruleShortNameIdx=256;this.tokenMatcher=tokenStructuredMatcherNoCategories;this.subruleIdx=0;this.definedRulesNames=[];this.tokensMap={};this.isBackTrackingStack=[];this.RULE_STACK=[];this.RULE_OCCURRENCE_STACK=[];this.gastProductionsCache={};if($r(t,"serializedGrammar")){throw Error("The Parser's configuration can no longer contain a <serializedGrammar> property.\n"+"\tSee: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0\n"+"\tFor Further details.")}if(V(e)){if(hn(e)){throw Error("A Token Vocabulary cannot be empty.\n"+"\tNote that the first argument for the parser constructor\n"+"\tis no longer a Token vector (since v4.0).")}if(typeof e[0].startOffset==="number"){throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n"+"\tSee: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0\n"+"\tFor Further details.")}}if(V(e)){this.tokensMap=Eu(e,((e,t)=>{e[t.name]=t;return e}),{})}else if($r(e,"modes")&&Bo(eu(bt(e.modes)),isTokenType)){const t=eu(bt(e.modes));const n=Yo(t);this.tokensMap=Eu(n,((e,t)=>{e[t.name]=t;return e}),{})}else if(Ze(e)){this.tokensMap=Ua(e)}else{throw new Error("<tokensDictionary> argument must be An Array of Token constructors,"+" A dictionary of Token constructors or an IMultiModeLexerDefinition")}this.tokensMap["EOF"]=ll;const n=$r(e,"modes")?eu(bt(e.modes)):bt(e);const r=Bo(n,(e=>hn(e.categoryMatches)));this.tokenMatcher=r?tokenStructuredMatcherNoCategories:tokenStructuredMatcher;augmentTokenTypes(bt(this.tokensMap))}defineRule(e,t,n){if(this.selfAnalysisDone){throw Error(`Grammar rule <${e}> may not be defined after the 'performSelfAnalysis' method has been called'\n`+`Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`)}const r=$r(n,"resyncEnabled")?n.resyncEnabled:Jl.resyncEnabled;const o=$r(n,"recoveryValueFunc")?n.recoveryValueFunc:Jl.recoveryValueFunc;const l=this.ruleShortNameIdx<<Nl+Cl;this.ruleShortNameIdx++;this.shortRuleNameToFull[l]=e;this.fullRuleNameToShort[e]=l;let h;if(this.outputCst===true){h=function invokeRuleWithTry(...n){try{this.ruleInvocationStateUpdate(l,e,this.subruleIdx);t.apply(this,n);const r=this.CST_STACK[this.CST_STACK.length-1];this.cstPostRule(r);return r}catch(e){return this.invokeRuleCatch(e,r,o)}finally{this.ruleFinallyStateUpdate()}}}else{h=function invokeRuleWithTryCst(...n){try{this.ruleInvocationStateUpdate(l,e,this.subruleIdx);return t.apply(this,n)}catch(e){return this.invokeRuleCatch(e,r,o)}finally{this.ruleFinallyStateUpdate()}}}const f=Object.assign(h,{ruleName:e,originalGrammarAction:t});return f}invokeRuleCatch(e,t,n){const r=this.RULE_STACK.length===1;const o=t&&!this.isBackTracking()&&this.recoveryEnabled;if(isRecognitionException(e)){const t=e;if(o){const r=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(r)){t.resyncedTokens=this.reSyncTo(r);if(this.outputCst){const e=this.CST_STACK[this.CST_STACK.length-1];e.recoveredNode=true;return e}else{return n(e)}}else{if(this.outputCst){const e=this.CST_STACK[this.CST_STACK.length-1];e.recoveredNode=true;t.partialCstResult=e}throw t}}else if(r){this.moveToTerminatedState();return n(e)}else{throw t}}else{throw e}}optionInternal(e,t){const n=this.getKeyForAutomaticLookahead(Ml,t);return this.optionInternalLogic(e,t,n)}optionInternalLogic(e,t,n){let r=this.getLaFuncFromCache(n);let o;if(typeof e!=="function"){o=e.DEF;const t=e.GATE;if(t!==undefined){const e=r;r=()=>t.call(this)&&e.call(this)}}else{o=e}if(r.call(this)===true){return o.call(this)}return undefined}atLeastOneInternal(e,t){const n=this.getKeyForAutomaticLookahead(Dl,e);return this.atLeastOneInternalLogic(e,t,n)}atLeastOneInternalLogic(e,t,n){let r=this.getLaFuncFromCache(n);let o;if(typeof t!=="function"){o=t.DEF;const e=t.GATE;if(e!==undefined){const t=r;r=()=>e.call(this)&&t.call(this)}}else{o=t}if(r.call(this)===true){let e=this.doSingleRepetition(o);while(r.call(this)===true&&e===true){e=this.doSingleRepetition(o)}}else{throw this.raiseEarlyExitException(e,Tl.REPETITION_MANDATORY,t.ERR_MSG)}this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],r,Dl,e,NextTerminalAfterAtLeastOneWalker)}atLeastOneSepFirstInternal(e,t){const n=this.getKeyForAutomaticLookahead($l,e);this.atLeastOneSepFirstInternalLogic(e,t,n)}atLeastOneSepFirstInternalLogic(e,t,n){const r=t.DEF;const o=t.SEP;const l=this.getLaFuncFromCache(n);if(l.call(this)===true){r.call(this);const separatorLookAheadFunc=()=>this.tokenMatcher(this.LA(1),o);while(this.tokenMatcher(this.LA(1),o)===true){this.CONSUME(o);r.call(this)}this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,separatorLookAheadFunc,r,NextTerminalAfterAtLeastOneSepWalker],separatorLookAheadFunc,$l,e,NextTerminalAfterAtLeastOneSepWalker)}else{throw this.raiseEarlyExitException(e,Tl.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG)}}manyInternal(e,t){const n=this.getKeyForAutomaticLookahead(Fl,e);return this.manyInternalLogic(e,t,n)}manyInternalLogic(e,t,n){let r=this.getLaFuncFromCache(n);let o;if(typeof t!=="function"){o=t.DEF;const e=t.GATE;if(e!==undefined){const t=r;r=()=>e.call(this)&&t.call(this)}}else{o=t}let l=true;while(r.call(this)===true&&l===true){l=this.doSingleRepetition(o)}this.attemptInRepetitionRecovery(this.manyInternal,[e,t],r,Fl,e,NextTerminalAfterManyWalker,l)}manySepFirstInternal(e,t){const n=this.getKeyForAutomaticLookahead(Ul,e);this.manySepFirstInternalLogic(e,t,n)}manySepFirstInternalLogic(e,t,n){const r=t.DEF;const o=t.SEP;const l=this.getLaFuncFromCache(n);if(l.call(this)===true){r.call(this);const separatorLookAheadFunc=()=>this.tokenMatcher(this.LA(1),o);while(this.tokenMatcher(this.LA(1),o)===true){this.CONSUME(o);r.call(this)}this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,o,separatorLookAheadFunc,r,NextTerminalAfterManySepWalker],separatorLookAheadFunc,Ul,e,NextTerminalAfterManySepWalker)}}repetitionSepSecondInternal(e,t,n,r,o){while(n()){this.CONSUME(t);r.call(this)}this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,n,r,o],n,$l,e,o)}doSingleRepetition(e){const t=this.getLexerPosition();e.call(this);const n=this.getLexerPosition();return n>t}orInternal(e,t){const n=this.getKeyForAutomaticLookahead(Pl,t);const r=V(e)?e:e.DEF;const o=this.getLaFuncFromCache(n);const l=o.call(this,r);if(l!==undefined){const e=r[l];return e.ALT.call(this)}this.raiseNoAltException(t,e.ERR_MSG)}ruleFinallyStateUpdate(){this.RULE_STACK.pop();this.RULE_OCCURRENCE_STACK.pop();this.cstFinallyStateUpdate();if(this.RULE_STACK.length===0&&this.isAtEndOfInput()===false){const e=this.LA(1);const t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new NotAllInputParsedException(t,e))}}subruleInternal(e,t,n){let r;try{const o=n!==undefined?n.ARGS:undefined;this.subruleIdx=t;r=e.apply(this,o);this.cstPostNonTerminal(r,n!==undefined&&n.LABEL!==undefined?n.LABEL:e.ruleName);return r}catch(t){throw this.subruleInternalError(t,n,e.ruleName)}}subruleInternalError(e,t,n){if(isRecognitionException(e)&&e.partialCstResult!==undefined){this.cstPostNonTerminal(e.partialCstResult,t!==undefined&&t.LABEL!==undefined?t.LABEL:n);delete e.partialCstResult}throw e}consumeInternal(e,t,n){let r;try{const t=this.LA(1);if(this.tokenMatcher(t,e)===true){this.consumeToken();r=t}else{this.consumeInternalError(e,t,n)}}catch(n){r=this.consumeInternalRecovery(e,t,n)}this.cstPostTerminal(n!==undefined&&n.LABEL!==undefined?n.LABEL:e.name,r);return r}consumeInternalError(e,t,n){let r;const o=this.LA(0);if(n!==undefined&&n.ERR_MSG){r=n.ERR_MSG}else{r=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:o,ruleName:this.getCurrRuleFullName()})}throw this.SAVE_ERROR(new MismatchedTokenException(r,t,o))}consumeInternalRecovery(e,t,n){if(this.recoveryEnabled&&n.name==="MismatchedTokenException"&&!this.isBackTracking()){const r=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,r)}catch(e){if(e.name===Rl){throw n}else{throw e}}}else{throw n}}saveRecogState(){const e=this.errors;const t=Ua(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK}}reloadRecogState(e){this.errors=e.errors;this.importLexerState(e.lexerState);this.RULE_STACK=e.RULE_STACK}ruleInvocationStateUpdate(e,t,n){this.RULE_OCCURRENCE_STACK.push(n);this.RULE_STACK.push(e);this.cstInvocationStateUpdate(t)}isBackTracking(){return this.isBackTrackingStack.length!==0}getCurrRuleFullName(){const e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]}shortRuleNameToFullName(e){return this.shortRuleNameToFull[e]}isAtEndOfInput(){return this.tokenMatcher(this.LA(1),ll)}reset(){this.resetLexerState();this.subruleIdx=0;this.isBackTrackingStack=[];this.errors=[];this.RULE_STACK=[];this.CST_STACK=[];this.RULE_OCCURRENCE_STACK=[]}}class ErrorHandler{initErrorHandler(e){this._errors=[];this.errorMessageProvider=$r(e,"errorMessageProvider")?e.errorMessageProvider:Ql.errorMessageProvider}SAVE_ERROR(e){if(isRecognitionException(e)){e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Ua(this.RULE_OCCURRENCE_STACK)};this._errors.push(e);return e}else{throw Error("Trying to save an Error which is not a RecognitionException")}}get errors(){return Ua(this._errors)}set errors(e){this._errors=e}raiseEarlyExitException(e,t,n){const r=this.getCurrRuleFullName();const o=this.getGAstProductions()[r];const l=getLookaheadPathsForOptionalProd(e,o,t,this.maxLookahead);const h=l[0];const f=[];for(let e=1;e<=this.maxLookahead;e++){f.push(this.LA(e))}const p=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:h,actual:f,previous:this.LA(0),customUserDescription:n,ruleName:r});throw this.SAVE_ERROR(new EarlyExitException(p,this.LA(1),this.LA(0)))}raiseNoAltException(e,t){const n=this.getCurrRuleFullName();const r=this.getGAstProductions()[n];const o=getLookaheadPathsForOr(e,r,this.maxLookahead);const l=[];for(let e=1;e<=this.maxLookahead;e++){l.push(this.LA(e))}const h=this.LA(0);const f=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:o,actual:l,previous:h,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new NoViableAltException(f,this.LA(1),h))}}class ContentAssist{initContentAssist(){}computeContentAssist(e,t){const n=this.gastProductionsCache[e];if(nu(n)){throw Error(`Rule ->${e}<- does not exist in this grammar.`)}return nextPossibleTokensAfter([n],t,this.tokenMatcher,this.maxLookahead)}getNextPossibleTokenTypes(e){const t=Ru(e.ruleStack);const n=this.getGAstProductions();const r=n[t];const o=new NextAfterTokenWalker(r,e).startWalking();return o}}const Gl={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(Gl);const zl=true;const Hl=Math.pow(2,Cl)-1;const Kl=createToken({name:"RECORDING_PHASE_TOKEN",pattern:Lexer.NA});augmentTokenTypes([Kl]);const ql=createTokenInstance(Kl,"This IToken indicates the Parser is in Recording Phase\n\t"+""+"See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details",-1,-1,-1,-1,-1,-1);Object.freeze(ql);const Xl={name:"This CSTNode indicates the Parser is in Recording Phase\n\t"+"See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details",children:{}};class GastRecorder{initGastRecorder(e){this.recordingProdStack=[];this.RECORDING_PHASE=false}enableRecording(){this.RECORDING_PHASE=true;this.TRACE_INIT("Enable Recording",(()=>{for(let e=0;e<10;e++){const t=e>0?e:"";this[`CONSUME${t}`]=function(t,n){return this.consumeInternalRecord(t,e,n)};this[`SUBRULE${t}`]=function(t,n){return this.subruleInternalRecord(t,e,n)};this[`OPTION${t}`]=function(t){return this.optionInternalRecord(t,e)};this[`OR${t}`]=function(t){return this.orInternalRecord(t,e)};this[`MANY${t}`]=function(t){this.manyInternalRecord(e,t)};this[`MANY_SEP${t}`]=function(t){this.manySepFirstInternalRecord(e,t)};this[`AT_LEAST_ONE${t}`]=function(t){this.atLeastOneInternalRecord(e,t)};this[`AT_LEAST_ONE_SEP${t}`]=function(t){this.atLeastOneSepFirstInternalRecord(e,t)}}this[`consume`]=function(e,t,n){return this.consumeInternalRecord(t,e,n)};this[`subrule`]=function(e,t,n){return this.subruleInternalRecord(t,e,n)};this[`option`]=function(e,t){return this.optionInternalRecord(t,e)};this[`or`]=function(e,t){return this.orInternalRecord(t,e)};this[`many`]=function(e,t){this.manyInternalRecord(e,t)};this[`atLeastOne`]=function(e,t){this.atLeastOneInternalRecord(e,t)};this.ACTION=this.ACTION_RECORD;this.BACKTRACK=this.BACKTRACK_RECORD;this.LA=this.LA_RECORD}))}disableRecording(){this.RECORDING_PHASE=false;this.TRACE_INIT("Deleting Recording methods",(()=>{const e=this;for(let t=0;t<10;t++){const n=t>0?t:"";delete e[`CONSUME${n}`];delete e[`SUBRULE${n}`];delete e[`OPTION${n}`];delete e[`OR${n}`];delete e[`MANY${n}`];delete e[`MANY_SEP${n}`];delete e[`AT_LEAST_ONE${n}`];delete e[`AT_LEAST_ONE_SEP${n}`]}delete e[`consume`];delete e[`subrule`];delete e[`option`];delete e[`or`];delete e[`many`];delete e[`atLeastOne`];delete e.ACTION;delete e.BACKTRACK;delete e.LA}))}ACTION_RECORD(e){}BACKTRACK_RECORD(e,t){return()=>true}LA_RECORD(e){return Yl}topLevelRuleRecord(e,t){try{const n=new Rule({definition:[],name:e});n.name=e;this.recordingProdStack.push(n);t.call(this);this.recordingProdStack.pop();return n}catch(e){if(e.KNOWN_RECORDER_ERROR!==true){try{e.message=e.message+'\n\t This error was thrown during the "grammar recording phase" For more info see:\n\t'+"https://chevrotain.io/docs/guide/internals.html#grammar-recording"}catch(t){throw e}}throw e}}optionInternalRecord(e,t){return recordProd.call(this,Option,e,t)}atLeastOneInternalRecord(e,t){recordProd.call(this,RepetitionMandatory,t,e)}atLeastOneSepFirstInternalRecord(e,t){recordProd.call(this,RepetitionMandatoryWithSeparator,t,e,zl)}manyInternalRecord(e,t){recordProd.call(this,Repetition,t,e)}manySepFirstInternalRecord(e,t){recordProd.call(this,RepetitionWithSeparator,t,e,zl)}orInternalRecord(e,t){return recordOrProd.call(this,e,t)}subruleInternalRecord(e,t,n){assertMethodIdxIsValid(t);if(!e||$r(e,"ruleName")===false){const n=new Error(`<SUBRULE${getIdxSuffix(t)}> argument is invalid`+` expecting a Parser method reference but got: <${JSON.stringify(e)}>`+`\n inside top level rule: <${this.recordingProdStack[0].name}>`);n.KNOWN_RECORDER_ERROR=true;throw n}const r=qu(this.recordingProdStack);const o=e.ruleName;const l=new model_NonTerminal({idx:t,nonTerminalName:o,label:n===null||n===void 0?void 0:n.LABEL,referencedRule:undefined});r.definition.push(l);return this.outputCst?Xl:Gl}consumeInternalRecord(e,t,n){assertMethodIdxIsValid(t);if(!hasShortKeyProperty(e)){const n=new Error(`<CONSUME${getIdxSuffix(t)}> argument is invalid`+` expecting a TokenType reference but got: <${JSON.stringify(e)}>`+`\n inside top level rule: <${this.recordingProdStack[0].name}>`);n.KNOWN_RECORDER_ERROR=true;throw n}const r=qu(this.recordingProdStack);const o=new Terminal({idx:t,terminalType:e,label:n===null||n===void 0?void 0:n.LABEL});r.definition.push(o);return ql}}function recordProd(e,t,n,r=false){assertMethodIdxIsValid(n);const o=qu(this.recordingProdStack);const l=st(t)?t:t.DEF;const h=new e({definition:[],idx:n});if(r){h.separator=t.SEP}if($r(t,"MAX_LOOKAHEAD")){h.maxLookahead=t.MAX_LOOKAHEAD}this.recordingProdStack.push(h);l.call(this);o.definition.push(h);this.recordingProdStack.pop();return Gl}function recordOrProd(e,t){assertMethodIdxIsValid(t);const n=qu(this.recordingProdStack);const r=V(e)===false;const o=r===false?e:e.DEF;const l=new Alternation({definition:[],idx:t,ignoreAmbiguities:r&&e.IGNORE_AMBIGUITIES===true});if($r(e,"MAX_LOOKAHEAD")){l.maxLookahead=e.MAX_LOOKAHEAD}const h=Io(o,(e=>st(e.GATE)));l.hasPredicates=h;n.definition.push(l);mt(o,(e=>{const t=new Alternative({definition:[]});l.definition.push(t);if($r(e,"IGNORE_AMBIGUITIES")){t.ignoreAmbiguities=e.IGNORE_AMBIGUITIES}else if($r(e,"GATE")){t.ignoreAmbiguities=true}this.recordingProdStack.push(t);e.ALT.call(this);this.recordingProdStack.pop()}));return Gl}function getIdxSuffix(e){return e===0?"":`${e}`}function assertMethodIdxIsValid(e){if(e<0||e>Hl){const t=new Error(`Invalid DSL Method idx value: <${e}>\n\t`+`Idx value must be a none negative value smaller than ${Hl+1}`);t.KNOWN_RECORDER_ERROR=true;throw t}}class PerformanceTracer{initPerformanceTracer(e){if($r(e,"traceInitPerf")){const t=e.traceInitPerf;const n=typeof t==="number";this.traceInitMaxIdent=n?t:Infinity;this.traceInitPerf=n?t>0:t}else{this.traceInitMaxIdent=0;this.traceInitPerf=Ql.traceInitPerf}this.traceInitIndent=-1}TRACE_INIT(e,t){if(this.traceInitPerf===true){this.traceInitIndent++;const n=new Array(this.traceInitIndent+1).join("\t");if(this.traceInitIndent<this.traceInitMaxIdent){console.log(`${n}--\x3e <${e}>`)}const{time:r,value:o}=timer(t);const l=r>10?console.warn:console.log;if(this.traceInitIndent<this.traceInitMaxIdent){l(`${n}<-- <${e}> time: ${r}ms`)}this.traceInitIndent--;return o}else{return t()}}}function applyMixins(e,t){t.forEach((t=>{const n=t.prototype;Object.getOwnPropertyNames(n).forEach((r=>{if(r==="constructor"){return}const o=Object.getOwnPropertyDescriptor(n,r);if(o&&(o.get||o.set)){Object.defineProperty(e.prototype,r,o)}else{e.prototype[r]=t.prototype[r]}}))}))}const Yl=createTokenInstance(ll,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(Yl);const Ql=Object.freeze({recoveryEnabled:false,maxLookahead:3,dynamicTokensEnabled:false,outputCst:true,errorMessageProvider:cl,nodeLocationTracking:"none",traceInitPerf:false,skipValidations:false});const Jl=Object.freeze({recoveryValueFunc:()=>undefined,resyncEnabled:true});var Zl;(function(e){e[e["INVALID_RULE_NAME"]=0]="INVALID_RULE_NAME";e[e["DUPLICATE_RULE_NAME"]=1]="DUPLICATE_RULE_NAME";e[e["INVALID_RULE_OVERRIDE"]=2]="INVALID_RULE_OVERRIDE";e[e["DUPLICATE_PRODUCTIONS"]=3]="DUPLICATE_PRODUCTIONS";e[e["UNRESOLVED_SUBRULE_REF"]=4]="UNRESOLVED_SUBRULE_REF";e[e["LEFT_RECURSION"]=5]="LEFT_RECURSION";e[e["NONE_LAST_EMPTY_ALT"]=6]="NONE_LAST_EMPTY_ALT";e[e["AMBIGUOUS_ALTS"]=7]="AMBIGUOUS_ALTS";e[e["CONFLICT_TOKENS_RULES_NAMESPACE"]=8]="CONFLICT_TOKENS_RULES_NAMESPACE";e[e["INVALID_TOKEN_NAME"]=9]="INVALID_TOKEN_NAME";e[e["NO_NON_EMPTY_LOOKAHEAD"]=10]="NO_NON_EMPTY_LOOKAHEAD";e[e["AMBIGUOUS_PREFIX_ALTS"]=11]="AMBIGUOUS_PREFIX_ALTS";e[e["TOO_MANY_ALTS"]=12]="TOO_MANY_ALTS";e[e["CUSTOM_LOOKAHEAD_VALIDATION"]=13]="CUSTOM_LOOKAHEAD_VALIDATION"})(Zl||(Zl={}));function EMPTY_ALT(e=undefined){return function(){return e}}class Parser{static performSelfAnalysis(e){throw Error("The **static** `performSelfAnalysis` method has been deprecated."+"\t\nUse the **instance** method with the same name instead.")}performSelfAnalysis(){this.TRACE_INIT("performSelfAnalysis",(()=>{let e;this.selfAnalysisDone=true;const t=this.className;this.TRACE_INIT("toFastProps",(()=>{toFastProperties(this)}));this.TRACE_INIT("Grammar Recording",(()=>{try{this.enableRecording();mt(this.definedRulesNames,(e=>{const t=this[e];const n=t["originalGrammarAction"];let r;this.TRACE_INIT(`${e} Rule`,(()=>{r=this.topLevelRuleRecord(e,n)}));this.gastProductionsCache[e]=r}))}finally{this.disableRecording()}}));let n=[];this.TRACE_INIT("Grammar Resolving",(()=>{n=gast_resolver_public_resolveGrammar({rules:bt(this.gastProductionsCache)});this.definitionErrors=this.definitionErrors.concat(n)}));this.TRACE_INIT("Grammar Validations",(()=>{if(hn(n)&&this.skipValidations===false){const e=gast_resolver_public_validateGrammar({rules:bt(this.gastProductionsCache),tokenTypes:bt(this.tokensMap),errMsgProvider:fl,grammarName:t});const n=validateLookahead({lookaheadStrategy:this.lookaheadStrategy,rules:bt(this.gastProductionsCache),tokenTypes:bt(this.tokensMap),grammarName:t});this.definitionErrors=this.definitionErrors.concat(e,n)}}));if(hn(this.definitionErrors)){if(this.recoveryEnabled){this.TRACE_INIT("computeAllProdsFollows",(()=>{const e=computeAllProdsFollows(bt(this.gastProductionsCache));this.resyncFollows=e}))}this.TRACE_INIT("ComputeLookaheadFunctions",(()=>{var e,t;(t=(e=this.lookaheadStrategy).initialize)===null||t===void 0?void 0:t.call(e,{rules:bt(this.gastProductionsCache)});this.preComputeLookaheadFunctions(bt(this.gastProductionsCache))}))}if(!Parser.DEFER_DEFINITION_ERRORS_HANDLING&&!hn(this.definitionErrors)){e=Mr(this.definitionErrors,(e=>e.message));throw new Error(`Parser Definition Errors detected:\n ${e.join("\n-------------------------------\n")}`)}}))}constructor(e,t){this.definitionErrors=[];this.selfAnalysisDone=false;const n=this;n.initErrorHandler(t);n.initLexerAdapter();n.initLooksAhead(t);n.initRecognizerEngine(e,t);n.initRecoverable(t);n.initTreeBuilder(t);n.initContentAssist();n.initGastRecorder(t);n.initPerformanceTracer(t);if($r(t,"ignoredIssues")){throw new Error("The <ignoredIssues> IParserConfig property has been deprecated.\n\t"+"Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.\n\t"+"See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES\n\t"+"For further details.")}this.skipValidations=$r(t,"skipValidations")?t.skipValidations:Ql.skipValidations}}Parser.DEFER_DEFINITION_ERRORS_HANDLING=false;applyMixins(Parser,[Recoverable,LooksAhead,TreeBuilder,LexerAdapter,RecognizerEngine,RecognizerApi,ErrorHandler,ContentAssist,GastRecorder,PerformanceTracer]);class CstParser extends Parser{constructor(e,t=Ql){const n=Ua(t);n.outputCst=true;super(e,n)}}class EmbeddedActionsParser extends Parser{constructor(e,t=Ql){const n=Ua(t);n.outputCst=false;super(e,n)}}function model_buildModel(e){const t=new CstNodeDefinitionGenerator;const n=values(e);return map(n,(e=>t.visitRule(e)))}class CstNodeDefinitionGenerator extends(null&&GAstVisitor){visitRule(e){const t=this.visitEach(e.definition);const n=groupBy(t,(e=>e.propertyName));const r=map(n,((e,t)=>{const n=!some(e,(e=>!e.canBeNull));let r=e[0].type;if(e.length>1){r=map(e,(e=>e.type))}return{name:t,type:r,optional:n}}));return{name:e.name,properties:r}}visitAlternative(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:true})}visitOption(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:true})}visitRepetition(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:true})}visitRepetitionMandatory(e){return this.visitEach(e.definition)}visitRepetitionMandatoryWithSeparator(e){return this.visitEach(e.definition).concat({propertyName:e.separator.name,canBeNull:true,type:getType(e.separator)})}visitRepetitionWithSeparator(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:true}).concat({propertyName:e.separator.name,canBeNull:true,type:getType(e.separator)})}visitAlternation(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:true})}visitTerminal(e){return[{propertyName:e.label||e.terminalType.name,canBeNull:false,type:getType(e)}]}visitNonTerminal(e){return[{propertyName:e.label||e.nonTerminalName,canBeNull:false,type:getType(e)}]}visitEachAndOverrideWith(e,t){return map(this.visitEach(e),(e=>assign({},e,t)))}visitEach(e){return flatten(map(e,(e=>this.visit(e))))}}function getType(e){if(e instanceof NonTerminal){return{kind:"rule",name:e.referencedRule.name}}return{kind:"token"}}const ec={includeVisitorInterface:true,visitorInterfaceName:"ICstNodeVisitor"};function generateCstDts(e,t){const n=Object.assign(Object.assign({},ec),t);const r=buildModel(e);return genDts(r,n)}function clearCache(){console.warn("The clearCache function was 'soft' removed from the Chevrotain API."+"\n\t It performs no action other than printing this message."+"\n\t Please avoid using it as it will be completely removed in the future")}class api_Parser{constructor(){throw new Error("The Parser class has been deprecated, use CstParser or EmbeddedActionsParser instead.\t\n"+"See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_7-0-0")}}const tc="\n";function toXml(e,t){let n="";if(t.format&&t.indentBy.length>0){n=tc}return arrToStr(e,t,"",n)}function arrToStr(e,t,n,r){let o="";let l=false;for(let h=0;h<e.length;h++){const f=e[h];const p=propName(f);if(p===undefined)continue;let d="";if(n.length===0)d=p;else d=`${n}.${p}`;if(p===t.textNodeName){let e=f[p];if(!isStopNode(d,t)){e=t.tagValueProcessor(p,e);e=replaceEntitiesValue(e,t)}if(l){o+=r}o+=e;l=false;continue}else if(p===t.cdataPropName){if(l){o+=r}o+=`<![CDATA[${f[p][0][t.textNodeName]}]]>`;l=false;continue}else if(p===t.commentPropName){o+=r+`\x3c!--${f[p][0][t.textNodeName]}--\x3e`;l=true;continue}else if(p[0]==="?"){const e=attr_to_str(f[":@"],t);const n=p==="?xml"?"":r;let h=f[p][0][t.textNodeName];h=h.length!==0?" "+h:"";o+=n+`<${p}${h}${e}?>`;l=true;continue}let _=r;if(_!==""){_+=t.indentBy}const m=attr_to_str(f[":@"],t);const g=r+`<${p}${m}`;const y=arrToStr(f[p],t,d,_);if(t.unpairedTags.indexOf(p)!==-1){if(t.suppressUnpairedNode)o+=g+">";else o+=g+"/>"}else if((!y||y.length===0)&&t.suppressEmptyNode){o+=g+"/>"}else if(y&&y.endsWith(">")){o+=g+`>${y}${r}</${p}>`}else{o+=g+">";if(y&&r!==""&&(y.includes("/>")||y.includes("</"))){o+=r+t.indentBy+y+r}else{o+=y}o+=`</${p}>`}l=true}return o}function propName(e){const t=Object.keys(e);for(let n=0;n<t.length;n++){const r=t[n];if(!e.hasOwnProperty(r))continue;if(r!==":@")return r}}function attr_to_str(e,t){let n="";if(e&&!t.ignoreAttributes){for(let r in e){if(!e.hasOwnProperty(r))continue;let o=t.attributeValueProcessor(r,e[r]);o=replaceEntitiesValue(o,t);if(o===true&&t.suppressBooleanAttributes){n+=` ${r.substr(t.attributeNamePrefix.length)}`}else{n+=` ${r.substr(t.attributeNamePrefix.length)}="${o}"`}}}return n}function isStopNode(e,t){e=e.substr(0,e.length-t.textNodeName.length-1);let n=e.substr(e.lastIndexOf(".")+1);for(let r in t.stopNodes){if(t.stopNodes[r]===e||t.stopNodes[r]==="*."+n)return true}return false}function replaceEntitiesValue(e,t){if(e&&e.length>0&&t.processEntities){for(let n=0;n<t.entities.length;n++){const r=t.entities[n];e=e.replace(r.regex,r.val)}}return e}function getIgnoreAttributesFn(e){if(typeof e==="function"){return e}if(Array.isArray(e)){return t=>{for(const n of e){if(typeof n==="string"&&t===n){return true}if(n instanceof RegExp&&n.test(t)){return true}}}}return()=>false}const nc={attributeNamePrefix:"@_",attributesGroupName:false,textNodeName:"#text",ignoreAttributes:true,cdataPropName:false,format:false,indentBy:"  ",suppressEmptyNode:false,suppressUnpairedNode:true,suppressBooleanAttributes:true,tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},preserveOrder:false,commentPropName:false,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:true,stopNodes:[],oneListGroup:false};function Builder(e){this.options=Object.assign({},nc,e);if(this.options.ignoreAttributes===true||this.options.attributesGroupName){this.isAttribute=function(){return false}}else{this.ignoreAttributesFn=getIgnoreAttributesFn(this.options.ignoreAttributes);this.attrPrefixLen=this.options.attributeNamePrefix.length;this.isAttribute=isAttribute}this.processTextOrObjNode=processTextOrObjNode;if(this.options.format){this.indentate=indentate;this.tagEndChar=">\n";this.newLine="\n"}else{this.indentate=function(){return""};this.tagEndChar=">";this.newLine=""}}Builder.prototype.build=function(e){if(this.options.preserveOrder){return toXml(e,this.options)}else{if(Array.isArray(e)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1){e={[this.options.arrayNodeName]:e}}return this.j2x(e,0,[]).val}};Builder.prototype.j2x=function(e,t,n){let r="";let o="";const l=n.join(".");for(let h in e){if(!Object.prototype.hasOwnProperty.call(e,h))continue;if(typeof e[h]==="undefined"){if(this.isAttribute(h)){o+=""}}else if(e[h]===null){if(this.isAttribute(h)){o+=""}else if(h===this.options.cdataPropName){o+=""}else if(h[0]==="?"){o+=this.indentate(t)+"<"+h+"?"+this.tagEndChar}else{o+=this.indentate(t)+"<"+h+"/"+this.tagEndChar}}else if(e[h]instanceof Date){o+=this.buildTextValNode(e[h],h,"",t)}else if(typeof e[h]!=="object"){const n=this.isAttribute(h);if(n&&!this.ignoreAttributesFn(n,l)){r+=this.buildAttrPairStr(n,""+e[h])}else if(!n){if(h===this.options.textNodeName){let t=this.options.tagValueProcessor(h,""+e[h]);o+=this.replaceEntitiesValue(t)}else{o+=this.buildTextValNode(e[h],h,"",t)}}}else if(Array.isArray(e[h])){const r=e[h].length;let l="";let f="";for(let p=0;p<r;p++){const r=e[h][p];if(typeof r==="undefined"){}else if(r===null){if(h[0]==="?")o+=this.indentate(t)+"<"+h+"?"+this.tagEndChar;else o+=this.indentate(t)+"<"+h+"/"+this.tagEndChar}else if(typeof r==="object"){if(this.options.oneListGroup){const e=this.j2x(r,t+1,n.concat(h));l+=e.val;if(this.options.attributesGroupName&&r.hasOwnProperty(this.options.attributesGroupName)){f+=e.attrStr}}else{l+=this.processTextOrObjNode(r,h,t,n)}}else{if(this.options.oneListGroup){let e=this.options.tagValueProcessor(h,r);e=this.replaceEntitiesValue(e);l+=e}else{l+=this.buildTextValNode(r,h,"",t)}}}if(this.options.oneListGroup){l=this.buildObjectNode(l,h,f,t)}o+=l}else{if(this.options.attributesGroupName&&h===this.options.attributesGroupName){const t=Object.keys(e[h]);const n=t.length;for(let o=0;o<n;o++){r+=this.buildAttrPairStr(t[o],""+e[h][t[o]])}}else{o+=this.processTextOrObjNode(e[h],h,t,n)}}}return{attrStr:r,val:o}};Builder.prototype.buildAttrPairStr=function(e,t){t=this.options.attributeValueProcessor(e,""+t);t=this.replaceEntitiesValue(t);if(this.options.suppressBooleanAttributes&&t==="true"){return" "+e}else return" "+e+'="'+t+'"'};function processTextOrObjNode(e,t,n,r){const o=this.j2x(e,n+1,r.concat(t));if(e[this.options.textNodeName]!==undefined&&Object.keys(e).length===1){return this.buildTextValNode(e[this.options.textNodeName],t,o.attrStr,n)}else{return this.buildObjectNode(o.val,t,o.attrStr,n)}}Builder.prototype.buildObjectNode=function(e,t,n,r){if(e===""){if(t[0]==="?")return this.indentate(r)+"<"+t+n+"?"+this.tagEndChar;else{return this.indentate(r)+"<"+t+n+this.closeTag(t)+this.tagEndChar}}else{let o="</"+t+this.tagEndChar;let l="";if(t[0]==="?"){l="?";o=""}if((n||n==="")&&e.indexOf("<")===-1){return this.indentate(r)+"<"+t+n+l+">"+e+o}else if(this.options.commentPropName!==false&&t===this.options.commentPropName&&l.length===0){return this.indentate(r)+`\x3c!--${e}--\x3e`+this.newLine}else{return this.indentate(r)+"<"+t+n+l+this.tagEndChar+e+this.indentate(r)+o}}};Builder.prototype.closeTag=function(e){let t="";if(this.options.unpairedTags.indexOf(e)!==-1){if(!this.options.suppressUnpairedNode)t="/"}else if(this.options.suppressEmptyNode){t="/"}else{t=`></${e}`}return t};function buildEmptyObjNode(e,t,n,r){if(e!==""){return this.buildObjectNode(e,t,n,r)}else{if(t[0]==="?")return this.indentate(r)+"<"+t+n+"?"+this.tagEndChar;else{return this.indentate(r)+"<"+t+n+"/"+this.tagEndChar}}}Builder.prototype.buildTextValNode=function(e,t,n,r){if(this.options.cdataPropName!==false&&t===this.options.cdataPropName){return this.indentate(r)+`<![CDATA[${e}]]>`+this.newLine}else if(this.options.commentPropName!==false&&t===this.options.commentPropName){return this.indentate(r)+`\x3c!--${e}--\x3e`+this.newLine}else if(t[0]==="?"){return this.indentate(r)+"<"+t+n+"?"+this.tagEndChar}else{let o=this.options.tagValueProcessor(t,e);o=this.replaceEntitiesValue(o);if(o===""){return this.indentate(r)+"<"+t+n+this.closeTag(t)+this.tagEndChar}else{return this.indentate(r)+"<"+t+n+">"+o+"</"+t+this.tagEndChar}}};Builder.prototype.replaceEntitiesValue=function(e){if(e&&e.length>0&&this.options.processEntities){for(let t=0;t<this.options.entities.length;t++){const n=this.options.entities[t];e=e.replace(n.regex,n.val)}}return e};function indentate(e){return this.options.indentBy.repeat(e)}function isAttribute(e){if(e.startsWith(this.options.attributeNamePrefix)&&e!==this.options.textNodeName){return e.substr(this.attrPrefixLen)}else{return false}}const ic={preserveOrder:false,attributeNamePrefix:"@_",attributesGroupName:false,textNodeName:"#text",ignoreAttributes:true,removeNSPrefix:false,allowBooleanAttributes:false,parseTagValue:true,parseAttributeValue:false,trimValues:true,cdataPropName:false,numberParseOptions:{hex:true,leadingZeros:true,eNotation:true},tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},stopNodes:[],alwaysCreateTextNode:false,isArray:()=>false,commentPropName:false,unpairedTags:[],processEntities:true,htmlEntities:false,ignoreDeclaration:false,ignorePiTags:false,transformTagName:false,transformAttributeName:false,updateTag:function(e,t,n){return e},captureMetaData:false};const buildOptions=function(e){return Object.assign({},ic,e)};const rc=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD";const sc=rc+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040";const ac="["+rc+"]["+sc+"]*";const oc=new RegExp("^"+ac+"$");function getAllMatches(e,t){const n=[];let r=t.exec(e);while(r){const o=[];o.startIndex=t.lastIndex-r[0].length;const l=r.length;for(let e=0;e<l;e++){o.push(r[e])}n.push(o);r=t.exec(e)}return n}const isName=function(e){const t=oc.exec(e);return!(t===null||typeof t==="undefined")};function isExist(e){return typeof e!=="undefined"}function isEmptyObject(e){return Object.keys(e).length===0}function merge(e,t,n){if(t){const r=Object.keys(t);const o=r.length;for(let l=0;l<o;l++){if(n==="strict"){e[r[l]]=[t[r[l]]]}else{e[r[l]]=t[r[l]]}}}}function util_getValue(e){if(exports.isExist(e)){return e}else{return""}}let uc;if(typeof Symbol!=="function"){uc="@@xmlMetadata"}else{uc=Symbol("XML Node Metadata")}class XmlNode{constructor(e){this.tagname=e;this.child=[];this[":@"]={}}add(e,t){if(e==="__proto__")e="#__proto__";this.child.push({[e]:t})}addChild(e,t){if(e.tagname==="__proto__")e.tagname="#__proto__";if(e[":@"]&&Object.keys(e[":@"]).length>0){this.child.push({[e.tagname]:e.child,[":@"]:e[":@"]})}else{this.child.push({[e.tagname]:e.child})}if(t!==undefined){this.child[this.child.length-1][uc]={startIndex:t}}}static getMetaDataSymbol(){return uc}}class DocTypeReader{constructor(e){this.suppressValidationErr=!e}readDocType(e,t){const n={};if(e[t+3]==="O"&&e[t+4]==="C"&&e[t+5]==="T"&&e[t+6]==="Y"&&e[t+7]==="P"&&e[t+8]==="E"){t=t+9;let r=1;let o=false,l=false;let h="";for(;t<e.length;t++){if(e[t]==="<"&&!l){if(o&&hasSeq(e,"!ENTITY",t)){t+=7;let r,o;[r,o,t]=this.readEntityExp(e,t+1,this.suppressValidationErr);if(o.indexOf("&")===-1)n[r]={regx:RegExp(`&${r};`,"g"),val:o}}else if(o&&hasSeq(e,"!ELEMENT",t)){t+=8;const{index:n}=this.readElementExp(e,t+1);t=n}else if(o&&hasSeq(e,"!ATTLIST",t)){t+=8}else if(o&&hasSeq(e,"!NOTATION",t)){t+=9;const{index:n}=this.readNotationExp(e,t+1,this.suppressValidationErr);t=n}else if(hasSeq(e,"!--",t))l=true;else throw new Error(`Invalid DOCTYPE`);r++;h=""}else if(e[t]===">"){if(l){if(e[t-1]==="-"&&e[t-2]==="-"){l=false;r--}}else{r--}if(r===0){break}}else if(e[t]==="["){o=true}else{h+=e[t]}}if(r!==0){throw new Error(`Unclosed DOCTYPE`)}}else{throw new Error(`Invalid Tag instead of DOCTYPE`)}return{entities:n,i:t}}readEntityExp(e,t){t=skipWhitespace(e,t);let n="";while(t<e.length&&!/\s/.test(e[t])&&e[t]!=='"'&&e[t]!=="'"){n+=e[t];t++}validateEntityName(n);t=skipWhitespace(e,t);if(!this.suppressValidationErr){if(e.substring(t,t+6).toUpperCase()==="SYSTEM"){throw new Error("External entities are not supported")}else if(e[t]==="%"){throw new Error("Parameter entities are not supported")}}let r="";[t,r]=this.readIdentifierVal(e,t,"entity");t--;return[n,r,t]}readNotationExp(e,t){t=skipWhitespace(e,t);let n="";while(t<e.length&&!/\s/.test(e[t])){n+=e[t];t++}!this.suppressValidationErr&&validateEntityName(n);t=skipWhitespace(e,t);const r=e.substring(t,t+6).toUpperCase();if(!this.suppressValidationErr&&r!=="SYSTEM"&&r!=="PUBLIC"){throw new Error(`Expected SYSTEM or PUBLIC, found "${r}"`)}t+=r.length;t=skipWhitespace(e,t);let o=null;let l=null;if(r==="PUBLIC"){[t,o]=this.readIdentifierVal(e,t,"publicIdentifier");t=skipWhitespace(e,t);if(e[t]==='"'||e[t]==="'"){[t,l]=this.readIdentifierVal(e,t,"systemIdentifier")}}else if(r==="SYSTEM"){[t,l]=this.readIdentifierVal(e,t,"systemIdentifier");if(!this.suppressValidationErr&&!l){throw new Error("Missing mandatory system identifier for SYSTEM notation")}}return{notationName:n,publicIdentifier:o,systemIdentifier:l,index:--t}}readIdentifierVal(e,t,n){let r="";const o=e[t];if(o!=='"'&&o!=="'"){throw new Error(`Expected quoted string, found "${o}"`)}t++;while(t<e.length&&e[t]!==o){r+=e[t];t++}if(e[t]!==o){throw new Error(`Unterminated ${n} value`)}t++;return[t,r]}readElementExp(e,t){t=skipWhitespace(e,t);let n="";while(t<e.length&&!/\s/.test(e[t])){n+=e[t];t++}if(!this.suppressValidationErr&&!isName(n)){throw new Error(`Invalid element name: "${n}"`)}t=skipWhitespace(e,t);let r="";if(e[t]==="E"&&hasSeq(e,"MPTY",t))t+=4;else if(e[t]==="A"&&hasSeq(e,"NY",t))t+=2;else if(e[t]==="("){t++;while(t<e.length&&e[t]!==")"){r+=e[t];t++}if(e[t]!==")"){throw new Error("Unterminated content model")}}else if(!this.suppressValidationErr){throw new Error(`Invalid Element Expression, found "${e[t]}"`)}return{elementName:n,contentModel:r.trim(),index:t}}readAttlistExp(e,t){t=skipWhitespace(e,t);let n="";while(t<e.length&&!/\s/.test(e[t])){n+=e[t];t++}validateEntityName(n);t=skipWhitespace(e,t);let r="";while(t<e.length&&!/\s/.test(e[t])){r+=e[t];t++}if(!validateEntityName(r)){throw new Error(`Invalid attribute name: "${r}"`)}t=skipWhitespace(e,t);let o="";if(e.substring(t,t+8).toUpperCase()==="NOTATION"){o="NOTATION";t+=8;t=skipWhitespace(e,t);if(e[t]!=="("){throw new Error(`Expected '(', found "${e[t]}"`)}t++;let n=[];while(t<e.length&&e[t]!==")"){let r="";while(t<e.length&&e[t]!=="|"&&e[t]!==")"){r+=e[t];t++}r=r.trim();if(!validateEntityName(r)){throw new Error(`Invalid notation name: "${r}"`)}n.push(r);if(e[t]==="|"){t++;t=skipWhitespace(e,t)}}if(e[t]!==")"){throw new Error("Unterminated list of notations")}t++;o+=" ("+n.join("|")+")"}else{while(t<e.length&&!/\s/.test(e[t])){o+=e[t];t++}const n=["CDATA","ID","IDREF","IDREFS","ENTITY","ENTITIES","NMTOKEN","NMTOKENS"];if(!this.suppressValidationErr&&!n.includes(o.toUpperCase())){throw new Error(`Invalid attribute type: "${o}"`)}}t=skipWhitespace(e,t);let l="";if(e.substring(t,t+8).toUpperCase()==="#REQUIRED"){l="#REQUIRED";t+=8}else if(e.substring(t,t+7).toUpperCase()==="#IMPLIED"){l="#IMPLIED";t+=7}else{[t,l]=this.readIdentifierVal(e,t,"ATTLIST")}return{elementName:n,attributeName:r,attributeType:o,defaultValue:l,index:t}}}const skipWhitespace=(e,t)=>{while(t<e.length&&/\s/.test(e[t])){t++}return t};function hasSeq(e,t,n){for(let r=0;r<t.length;r++){if(t[r]!==e[n+r+1])return false}return true}function validateEntityName(e){if(isName(e))return e;else throw new Error(`Invalid entity name ${e}`)}const lc=/^[-+]?0x[a-fA-F0-9]+$/;const hc=/^([\-\+])?(0*)([0-9]*(\.[0-9]*)?)$/;const fc={hex:true,leadingZeros:true,decimalPoint:".",eNotation:true};function strnum_toNumber(e,t={}){t=Object.assign({},fc,t);if(!e||typeof e!=="string")return e;let n=e.trim();if(t.skipLike!==undefined&&t.skipLike.test(n))return e;else if(e==="0")return 0;else if(t.hex&&lc.test(n)){return parse_int(n,16)}else if(n.includes("e")||n.includes("E")){return resolveEnotation(e,n,t)}else{const r=hc.exec(n);if(r){const o=r[1]||"";const l=r[2];let h=trimZeros(r[3]);const f=o?e[l.length+1]===".":e[l.length]===".";if(!t.leadingZeros&&(l.length>1||l.length===1&&!f)){return e}else{const r=Number(n);const f=String(r);if(r===0)return r;if(f.search(/[eE]/)!==-1){if(t.eNotation)return r;else return e}else if(n.indexOf(".")!==-1){if(f==="0")return r;else if(f===h)return r;else if(f===`${o}${h}`)return r;else return e}let p=l?h:n;if(l){return p===f||o+p===f?r:e}else{return p===f||p===o+f?r:e}}}else{return e}}}const pc=/^([-+])?(0*)(\d*(\.\d*)?[eE][-\+]?\d+)$/;function resolveEnotation(e,t,n){if(!n.eNotation)return e;const r=t.match(pc);if(r){let o=r[1]||"";const l=r[3].indexOf("e")===-1?"E":"e";const h=r[2];const f=o?e[h.length+1]===l:e[h.length]===l;if(h.length>1&&f)return e;else if(h.length===1&&(r[3].startsWith(`.${l}`)||r[3][0]===l)){return Number(t)}else if(n.leadingZeros&&!f){t=(r[1]||"")+r[3];return Number(t)}else return e}else{return e}}function trimZeros(e){if(e&&e.indexOf(".")!==-1){e=e.replace(/0+$/,"");if(e===".")e="0";else if(e[0]===".")e="0"+e;else if(e[e.length-1]===".")e=e.substring(0,e.length-1);return e}return e}function parse_int(e,t){if(parseInt)return parseInt(e,t);else if(Number.parseInt)return Number.parseInt(e,t);else if(window&&window.parseInt)return window.parseInt(e,t);else throw new Error("parseInt, Number.parseInt, window.parseInt are not supported")}class OrderedObjParser{constructor(e){this.options=e;this.currentNode=null;this.tagsNodeStack=[];this.docTypeEntities={};this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}};this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"};this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:""},pound:{regex:/&(pound|#163);/g,val:""},yen:{regex:/&(yen|#165);/g,val:""},euro:{regex:/&(euro|#8364);/g,val:""},copyright:{regex:/&(copy|#169);/g,val:""},reg:{regex:/&(reg|#174);/g,val:""},inr:{regex:/&(inr|#8377);/g,val:""},num_dec:{regex:/&#([0-9]{1,7});/g,val:(e,t)=>fromCodePoint(t,10,"&#")},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(e,t)=>fromCodePoint(t,16,"&#x")}};this.addExternalEntities=addExternalEntities;this.parseXml=parseXml;this.parseTextData=parseTextData;this.resolveNameSpace=resolveNameSpace;this.buildAttributesMap=buildAttributesMap;this.isItStopNode=isItStopNode;this.replaceEntitiesValue=OrderedObjParser_replaceEntitiesValue;this.readStopNodeData=readStopNodeData;this.saveTextToParentTag=saveTextToParentTag;this.addChild=addChild;this.ignoreAttributesFn=getIgnoreAttributesFn(this.options.ignoreAttributes);if(this.options.stopNodes&&this.options.stopNodes.length>0){this.stopNodesExact=new Set;this.stopNodesWildcard=new Set;for(let e=0;e<this.options.stopNodes.length;e++){const t=this.options.stopNodes[e];if(typeof t!=="string")continue;if(t.startsWith("*.")){this.stopNodesWildcard.add(t.substring(2))}else{this.stopNodesExact.add(t)}}}}}function addExternalEntities(e){const t=Object.keys(e);for(let n=0;n<t.length;n++){const r=t[n];this.lastEntities[r]={regex:new RegExp("&"+r+";","g"),val:e[r]}}}function parseTextData(e,t,n,r,o,l,h){if(e!==undefined){if(this.options.trimValues&&!r){e=e.trim()}if(e.length>0){if(!h)e=this.replaceEntitiesValue(e);const r=this.options.tagValueProcessor(t,e,n,o,l);if(r===null||r===undefined){return e}else if(typeof r!==typeof e||r!==e){return r}else if(this.options.trimValues){return parseValue(e,this.options.parseTagValue,this.options.numberParseOptions)}else{const t=e.trim();if(t===e){return parseValue(e,this.options.parseTagValue,this.options.numberParseOptions)}else{return e}}}}}function resolveNameSpace(e){if(this.options.removeNSPrefix){const t=e.split(":");const n=e.charAt(0)==="/"?"/":"";if(t[0]==="xmlns"){return""}if(t.length===2){e=n+t[1]}}return e}const dc=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm");function buildAttributesMap(e,t){if(this.options.ignoreAttributes!==true&&typeof e==="string"){const n=getAllMatches(e,dc);const r=n.length;const o={};for(let e=0;e<r;e++){const r=this.resolveNameSpace(n[e][1]);if(this.ignoreAttributesFn(r,t)){continue}let l=n[e][4];let h=this.options.attributeNamePrefix+r;if(r.length){if(this.options.transformAttributeName){h=this.options.transformAttributeName(h)}if(h==="__proto__")h="#__proto__";if(l!==undefined){if(this.options.trimValues){l=l.trim()}l=this.replaceEntitiesValue(l);const e=this.options.attributeValueProcessor(r,l,t);if(e===null||e===undefined){o[h]=l}else if(typeof e!==typeof l||e!==l){o[h]=e}else{o[h]=parseValue(l,this.options.parseAttributeValue,this.options.numberParseOptions)}}else if(this.options.allowBooleanAttributes){o[h]=true}}}if(!Object.keys(o).length){return}if(this.options.attributesGroupName){const e={};e[this.options.attributesGroupName]=o;return e}return o}}const parseXml=function(e){e=e.replace(/\r\n?/g,"\n");const t=new XmlNode("!xml");let n=t;let r="";let o="";const l=new DocTypeReader(this.options.processEntities);for(let h=0;h<e.length;h++){const f=e[h];if(f==="<"){if(e[h+1]==="/"){const t=findClosingIndex(e,">",h,"Closing Tag is not closed.");let l=e.substring(h+2,t).trim();if(this.options.removeNSPrefix){const e=l.indexOf(":");if(e!==-1){l=l.substr(e+1)}}if(this.options.transformTagName){l=this.options.transformTagName(l)}if(n){r=this.saveTextToParentTag(r,n,o)}const f=o.substring(o.lastIndexOf(".")+1);if(l&&this.options.unpairedTags.indexOf(l)!==-1){throw new Error(`Unpaired tag can not be used as closing tag: </${l}>`)}let p=0;if(f&&this.options.unpairedTags.indexOf(f)!==-1){p=o.lastIndexOf(".",o.lastIndexOf(".")-1);this.tagsNodeStack.pop()}else{p=o.lastIndexOf(".")}o=o.substring(0,p);n=this.tagsNodeStack.pop();r="";h=t}else if(e[h+1]==="?"){let t=readTagExp(e,h,false,"?>");if(!t)throw new Error("Pi Tag is not closed.");r=this.saveTextToParentTag(r,n,o);if(this.options.ignoreDeclaration&&t.tagName==="?xml"||this.options.ignorePiTags){}else{const e=new XmlNode(t.tagName);e.add(this.options.textNodeName,"");if(t.tagName!==t.tagExp&&t.attrExpPresent){e[":@"]=this.buildAttributesMap(t.tagExp,o)}this.addChild(n,e,o,h)}h=t.closeIndex+1}else if(e.substr(h+1,3)==="!--"){const t=findClosingIndex(e,"--\x3e",h+4,"Comment is not closed.");if(this.options.commentPropName){const l=e.substring(h+4,t-2);r=this.saveTextToParentTag(r,n,o);n.add(this.options.commentPropName,[{[this.options.textNodeName]:l}])}h=t}else if(e.substr(h+1,2)==="!D"){const t=l.readDocType(e,h);this.docTypeEntities=t.entities;h=t.i}else if(e.substr(h+1,2)==="!["){const t=findClosingIndex(e,"]]>",h,"CDATA is not closed.")-2;const l=e.substring(h+9,t);r=this.saveTextToParentTag(r,n,o);let f=this.parseTextData(l,n.tagname,o,true,false,true,true);if(f==undefined)f="";if(this.options.cdataPropName){n.add(this.options.cdataPropName,[{[this.options.textNodeName]:l}])}else{n.add(this.options.textNodeName,f)}h=t+2}else{let l=readTagExp(e,h,this.options.removeNSPrefix);let f=l.tagName;const p=l.rawTagName;let d=l.tagExp;let _=l.attrExpPresent;let m=l.closeIndex;if(this.options.transformTagName){const e=this.options.transformTagName(f);if(d===f){d=e}f=e}if(n&&r){if(n.tagname!=="!xml"){r=this.saveTextToParentTag(r,n,o,false)}}const g=n;if(g&&this.options.unpairedTags.indexOf(g.tagname)!==-1){n=this.tagsNodeStack.pop();o=o.substring(0,o.lastIndexOf("."))}if(f!==t.tagname){o+=o?"."+f:f}const y=h;if(this.isItStopNode(this.stopNodesExact,this.stopNodesWildcard,o,f)){let t="";if(d.length>0&&d.lastIndexOf("/")===d.length-1){if(f[f.length-1]==="/"){f=f.substr(0,f.length-1);o=o.substr(0,o.length-1);d=f}else{d=d.substr(0,d.length-1)}h=l.closeIndex}else if(this.options.unpairedTags.indexOf(f)!==-1){h=l.closeIndex}else{const n=this.readStopNodeData(e,p,m+1);if(!n)throw new Error(`Unexpected end of ${p}`);h=n.i;t=n.tagContent}const r=new XmlNode(f);if(f!==d&&_){r[":@"]=this.buildAttributesMap(d,o)}if(t){t=this.parseTextData(t,f,o,true,_,true,true)}o=o.substr(0,o.lastIndexOf("."));r.add(this.options.textNodeName,t);this.addChild(n,r,o,y)}else{if(d.length>0&&d.lastIndexOf("/")===d.length-1){if(f[f.length-1]==="/"){f=f.substr(0,f.length-1);o=o.substr(0,o.length-1);d=f}else{d=d.substr(0,d.length-1)}if(this.options.transformTagName){const e=this.options.transformTagName(f);if(d===f){d=e}f=e}const e=new XmlNode(f);if(f!==d&&_){e[":@"]=this.buildAttributesMap(d,o)}this.addChild(n,e,o,y);o=o.substr(0,o.lastIndexOf("."))}else{const e=new XmlNode(f);this.tagsNodeStack.push(n);if(f!==d&&_){e[":@"]=this.buildAttributesMap(d,o)}this.addChild(n,e,o,y);n=e}r="";h=m}}}else{r+=e[h]}}return t.child};function addChild(e,t,n,r){if(!this.options.captureMetaData)r=undefined;const o=this.options.updateTag(t.tagname,n,t[":@"]);if(o===false){}else if(typeof o==="string"){t.tagname=o;e.addChild(t,r)}else{e.addChild(t,r)}}const OrderedObjParser_replaceEntitiesValue=function(e){if(this.options.processEntities){for(let t in this.docTypeEntities){const n=this.docTypeEntities[t];e=e.replace(n.regx,n.val)}for(let t in this.lastEntities){const n=this.lastEntities[t];e=e.replace(n.regex,n.val)}if(this.options.htmlEntities){for(let t in this.htmlEntities){const n=this.htmlEntities[t];e=e.replace(n.regex,n.val)}}e=e.replace(this.ampEntity.regex,this.ampEntity.val)}return e};function saveTextToParentTag(e,t,n,r){if(e){if(r===undefined)r=t.child.length===0;e=this.parseTextData(e,t.tagname,n,false,t[":@"]?Object.keys(t[":@"]).length!==0:false,r);if(e!==undefined&&e!=="")t.add(this.options.textNodeName,e);e=""}return e}function isItStopNode(e,t,n,r){if(t&&t.has(r))return true;if(e&&e.has(n))return true;return false}function tagExpWithClosingIndex(e,t,n=">"){let r;let o="";for(let l=t;l<e.length;l++){let t=e[l];if(r){if(t===r)r=""}else if(t==='"'||t==="'"){r=t}else if(t===n[0]){if(n[1]){if(e[l+1]===n[1]){return{data:o,index:l}}}else{return{data:o,index:l}}}else if(t==="\t"){t=" "}o+=t}}function findClosingIndex(e,t,n,r){const o=e.indexOf(t,n);if(o===-1){throw new Error(r)}else{return o+t.length-1}}function readTagExp(e,t,n,r=">"){const o=tagExpWithClosingIndex(e,t+1,r);if(!o)return;let l=o.data;const h=o.index;const f=l.search(/\s/);let p=l;let d=true;if(f!==-1){p=l.substring(0,f);l=l.substring(f+1).trimStart()}const _=p;if(n){const e=p.indexOf(":");if(e!==-1){p=p.substr(e+1);d=p!==o.data.substr(e+1)}}return{tagName:p,tagExp:l,closeIndex:h,attrExpPresent:d,rawTagName:_}}function readStopNodeData(e,t,n){const r=n;let o=1;for(;n<e.length;n++){if(e[n]==="<"){if(e[n+1]==="/"){const l=findClosingIndex(e,">",n,`${t} is not closed`);let h=e.substring(n+2,l).trim();if(h===t){o--;if(o===0){return{tagContent:e.substring(r,n),i:l}}}n=l}else if(e[n+1]==="?"){const t=findClosingIndex(e,"?>",n+1,"StopNode is not closed.");n=t}else if(e.substr(n+1,3)==="!--"){const t=findClosingIndex(e,"--\x3e",n+3,"StopNode is not closed.");n=t}else if(e.substr(n+1,2)==="!["){const t=findClosingIndex(e,"]]>",n,"StopNode is not closed.")-2;n=t}else{const r=readTagExp(e,n,">");if(r){const e=r&&r.tagName;if(e===t&&r.tagExp[r.tagExp.length-1]!=="/"){o++}n=r.closeIndex}}}}}function parseValue(e,t,n){if(t&&typeof e==="string"){const t=e.trim();if(t==="true")return true;else if(t==="false")return false;else return strnum_toNumber(e,n)}else{if(isExist(e)){return e}else{return""}}}function fromCodePoint(e,t,n){const r=Number.parseInt(e,t);if(r>=0&&r<=1114111){return String.fromCodePoint(r)}else{return n+e+";"}}const _c=XmlNode.getMetaDataSymbol();function prettify(e,t){return compress(e,t)}function compress(e,t,n){let r;const o={};for(let l=0;l<e.length;l++){const h=e[l];const f=node2json_propName(h);let p="";if(n===undefined)p=f;else p=n+"."+f;if(f===t.textNodeName){if(r===undefined)r=h[f];else r+=""+h[f]}else if(f===undefined){continue}else if(h[f]){let e=compress(h[f],t,p);const n=isLeafTag(e,t);if(h[_c]!==undefined){e[_c]=h[_c]}if(h[":@"]){assignAttributes(e,h[":@"],p,t)}else if(Object.keys(e).length===1&&e[t.textNodeName]!==undefined&&!t.alwaysCreateTextNode){e=e[t.textNodeName]}else if(Object.keys(e).length===0){if(t.alwaysCreateTextNode)e[t.textNodeName]="";else e=""}if(o[f]!==undefined&&o.hasOwnProperty(f)){if(!Array.isArray(o[f])){o[f]=[o[f]]}o[f].push(e)}else{if(t.isArray(f,p,n)){o[f]=[e]}else{o[f]=e}}}}if(typeof r==="string"){if(r.length>0)o[t.textNodeName]=r}else if(r!==undefined)o[t.textNodeName]=r;return o}function node2json_propName(e){const t=Object.keys(e);for(let e=0;e<t.length;e++){const n=t[e];if(n!==":@")return n}}function assignAttributes(e,t,n,r){if(t){const o=Object.keys(t);const l=o.length;for(let h=0;h<l;h++){const l=o[h];if(r.isArray(l,n+"."+l,true,true)){e[l]=[t[l]]}else{e[l]=t[l]}}}}function isLeafTag(e,t){const{textNodeName:n}=t;const r=Object.keys(e).length;if(r===0){return true}if(r===1&&(e[n]||typeof e[n]==="boolean"||e[n]===0)){return true}return false}const mc={allowBooleanAttributes:false,unpairedTags:[]};function validate(e,t){t=Object.assign({},mc,t);const n=[];let r=false;let o=false;if(e[0]==="\ufeff"){e=e.substr(1)}for(let l=0;l<e.length;l++){if(e[l]==="<"&&e[l+1]==="?"){l+=2;l=readPI(e,l);if(l.err)return l}else if(e[l]==="<"){let h=l;l++;if(e[l]==="!"){l=readCommentAndCDATA(e,l);continue}else{let f=false;if(e[l]==="/"){f=true;l++}let p="";for(;l<e.length&&e[l]!==">"&&e[l]!==" "&&e[l]!=="\t"&&e[l]!=="\n"&&e[l]!=="\r";l++){p+=e[l]}p=p.trim();if(p[p.length-1]==="/"){p=p.substring(0,p.length-1);l--}if(!validateTagName(p)){let t;if(p.trim().length===0){t="Invalid space after '<'."}else{t="Tag '"+p+"' is an invalid name."}return getErrorObject("InvalidTag",t,getLineNumberForPosition(e,l))}const d=readAttributeStr(e,l);if(d===false){return getErrorObject("InvalidAttr","Attributes for '"+p+"' have open quote.",getLineNumberForPosition(e,l))}let _=d.value;l=d.index;if(_[_.length-1]==="/"){const n=l-_.length;_=_.substring(0,_.length-1);const o=validateAttributeString(_,t);if(o===true){r=true}else{return getErrorObject(o.err.code,o.err.msg,getLineNumberForPosition(e,n+o.err.line))}}else if(f){if(!d.tagClosed){return getErrorObject("InvalidTag","Closing tag '"+p+"' doesn't have proper closing.",getLineNumberForPosition(e,l))}else if(_.trim().length>0){return getErrorObject("InvalidTag","Closing tag '"+p+"' can't have attributes or invalid starting.",getLineNumberForPosition(e,h))}else if(n.length===0){return getErrorObject("InvalidTag","Closing tag '"+p+"' has not been opened.",getLineNumberForPosition(e,h))}else{const t=n.pop();if(p!==t.tagName){let n=getLineNumberForPosition(e,t.tagStartPos);return getErrorObject("InvalidTag","Expected closing tag '"+t.tagName+"' (opened in line "+n.line+", col "+n.col+") instead of closing tag '"+p+"'.",getLineNumberForPosition(e,h))}if(n.length==0){o=true}}}else{const f=validateAttributeString(_,t);if(f!==true){return getErrorObject(f.err.code,f.err.msg,getLineNumberForPosition(e,l-_.length+f.err.line))}if(o===true){return getErrorObject("InvalidXml","Multiple possible root nodes found.",getLineNumberForPosition(e,l))}else if(t.unpairedTags.indexOf(p)!==-1){}else{n.push({tagName:p,tagStartPos:h})}r=true}for(l++;l<e.length;l++){if(e[l]==="<"){if(e[l+1]==="!"){l++;l=readCommentAndCDATA(e,l);continue}else if(e[l+1]==="?"){l=readPI(e,++l);if(l.err)return l}else{break}}else if(e[l]==="&"){const t=validateAmpersand(e,l);if(t==-1)return getErrorObject("InvalidChar","char '&' is not expected.",getLineNumberForPosition(e,l));l=t}else{if(o===true&&!isWhiteSpace(e[l])){return getErrorObject("InvalidXml","Extra text at the end",getLineNumberForPosition(e,l))}}}if(e[l]==="<"){l--}}}else{if(isWhiteSpace(e[l])){continue}return getErrorObject("InvalidChar","char '"+e[l]+"' is not expected.",getLineNumberForPosition(e,l))}}if(!r){return getErrorObject("InvalidXml","Start tag expected.",1)}else if(n.length==1){return getErrorObject("InvalidTag","Unclosed tag '"+n[0].tagName+"'.",getLineNumberForPosition(e,n[0].tagStartPos))}else if(n.length>0){return getErrorObject("InvalidXml","Invalid '"+JSON.stringify(n.map((e=>e.tagName)),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}return true}function isWhiteSpace(e){return e===" "||e==="\t"||e==="\n"||e==="\r"}function readPI(e,t){const n=t;for(;t<e.length;t++){if(e[t]=="?"||e[t]==" "){const r=e.substr(n,t-n);if(t>5&&r==="xml"){return getErrorObject("InvalidXml","XML declaration allowed only at the start of the document.",getLineNumberForPosition(e,t))}else if(e[t]=="?"&&e[t+1]==">"){t++;break}else{continue}}}return t}function readCommentAndCDATA(e,t){if(e.length>t+5&&e[t+1]==="-"&&e[t+2]==="-"){for(t+=3;t<e.length;t++){if(e[t]==="-"&&e[t+1]==="-"&&e[t+2]===">"){t+=2;break}}}else if(e.length>t+8&&e[t+1]==="D"&&e[t+2]==="O"&&e[t+3]==="C"&&e[t+4]==="T"&&e[t+5]==="Y"&&e[t+6]==="P"&&e[t+7]==="E"){let n=1;for(t+=8;t<e.length;t++){if(e[t]==="<"){n++}else if(e[t]===">"){n--;if(n===0){break}}}}else if(e.length>t+9&&e[t+1]==="["&&e[t+2]==="C"&&e[t+3]==="D"&&e[t+4]==="A"&&e[t+5]==="T"&&e[t+6]==="A"&&e[t+7]==="["){for(t+=8;t<e.length;t++){if(e[t]==="]"&&e[t+1]==="]"&&e[t+2]===">"){t+=2;break}}}return t}const gc='"';const yc="'";function readAttributeStr(e,t){let n="";let r="";let o=false;for(;t<e.length;t++){if(e[t]===gc||e[t]===yc){if(r===""){r=e[t]}else if(r!==e[t]){}else{r=""}}else if(e[t]===">"){if(r===""){o=true;break}}n+=e[t]}if(r!==""){return false}return{value:n,index:t,tagClosed:o}}const bc=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function validateAttributeString(e,t){const n=getAllMatches(e,bc);const r={};for(let e=0;e<n.length;e++){if(n[e][1].length===0){return getErrorObject("InvalidAttr","Attribute '"+n[e][2]+"' has no space in starting.",getPositionFromMatch(n[e]))}else if(n[e][3]!==undefined&&n[e][4]===undefined){return getErrorObject("InvalidAttr","Attribute '"+n[e][2]+"' is without value.",getPositionFromMatch(n[e]))}else if(n[e][3]===undefined&&!t.allowBooleanAttributes){return getErrorObject("InvalidAttr","boolean attribute '"+n[e][2]+"' is not allowed.",getPositionFromMatch(n[e]))}const o=n[e][2];if(!validateAttrName(o)){return getErrorObject("InvalidAttr","Attribute '"+o+"' is an invalid name.",getPositionFromMatch(n[e]))}if(!r.hasOwnProperty(o)){r[o]=1}else{return getErrorObject("InvalidAttr","Attribute '"+o+"' is repeated.",getPositionFromMatch(n[e]))}}return true}function validateNumberAmpersand(e,t){let n=/\d/;if(e[t]==="x"){t++;n=/[\da-fA-F]/}for(;t<e.length;t++){if(e[t]===";")return t;if(!e[t].match(n))break}return-1}function validateAmpersand(e,t){t++;if(e[t]===";")return-1;if(e[t]==="#"){t++;return validateNumberAmpersand(e,t)}let n=0;for(;t<e.length;t++,n++){if(e[t].match(/\w/)&&n<20)continue;if(e[t]===";")break;return-1}return t}function getErrorObject(e,t,n){return{err:{code:e,msg:t,line:n.line||n,col:n.col}}}function validateAttrName(e){return isName(e)}function validateTagName(e){return isName(e)}function getLineNumberForPosition(e,t){const n=e.substring(0,t).split(/\r?\n/);return{line:n.length,col:n[n.length-1].length+1}}function getPositionFromMatch(e){return e.startIndex+e[1].length}class XMLParser{constructor(e){this.externalEntities={};this.options=buildOptions(e)}parse(e,t){if(typeof e!=="string"&&e.toString){e=e.toString()}else if(typeof e!=="string"){throw new Error("XML data is accepted in String or Bytes[] form.")}if(t){if(t===true)t={};const n=validate(e,t);if(n!==true){throw Error(`${n.err.msg}:${n.err.line}:${n.err.col}`)}}const n=new OrderedObjParser(this.options);n.addExternalEntities(this.externalEntities);const r=n.parseXml(e);if(this.options.preserveOrder||r===undefined)return r;else return prettify(r,this.options)}addEntity(e,t){if(t.indexOf("&")!==-1){throw new Error("Entity value can't have '&'")}else if(e.indexOf("&")!==-1||e.indexOf(";")!==-1){throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'")}else if(t==="&"){throw new Error("An entity with value '&' is not permitted")}else{this.externalEntities[e]=t}}static getMetaDataSymbol(){return XmlNode.getMetaDataSymbol()}}var vc=__nccwpck_require__(299);var Ec=__nccwpck_require__(54);var Tc=createToken({name:"WhiteSpace",pattern:/\s+/,group:Lexer.SKIPPED}),kc=createToken({name:"LineComment",pattern:/\/\/[^\n\r]*/,group:Lexer.SKIPPED}),Oc=createToken({name:"BlockComment",pattern:/\/\*[\s\S]*?\*\//,group:Lexer.SKIPPED}),xc=createToken({name:"Identifier",pattern:/[a-zA-Z_$][a-zA-Z0-9_.[\]]*/}),Ac=createToken({name:"QuotedIdentifier",pattern:/`([^`\\]|\\.)*`/}),wc=createToken({name:"From",pattern:/from/i,longer_alt:xc}),Sc=createToken({name:"To",pattern:/to/i,longer_alt:xc}),Rc=createToken({name:"Transform",pattern:/transform/i,longer_alt:xc}),Nc=createToken({name:"Set",pattern:/set/i,longer_alt:xc}),Cc=createToken({name:"Section",pattern:/section/i,longer_alt:xc}),Ic=createToken({name:"Multiple",pattern:/multiple/i,longer_alt:xc}),Lc=createToken({name:"Clone",pattern:/clone/i,longer_alt:xc}),Pc=createToken({name:"Delete",pattern:/delete/i,longer_alt:xc}),Mc=createToken({name:"Define",pattern:/define/i,longer_alt:xc}),Fc=createToken({name:"Modify",pattern:/modify/i,longer_alt:xc}),Dc=createToken({name:"If",pattern:/if/i,longer_alt:xc}),Uc=createToken({name:"Else",pattern:/else/i,longer_alt:xc}),$c=createToken({name:"True",pattern:/true/i,longer_alt:xc}),jc=createToken({name:"False",pattern:/false/i,longer_alt:xc}),Bc=createToken({name:"Null",pattern:/null/i,longer_alt:xc}),Wc=createToken({name:"Return",pattern:/return/i,longer_alt:xc}),Vc=createToken({name:"Unsafe",pattern:/unsafe/i,longer_alt:xc}),Gc=createToken({name:"Where",pattern:/where/i,longer_alt:xc}),zc=createToken({name:"EqualsEquals",pattern:/==/}),Hc=createToken({name:"EqualsEqualsEquals",pattern:/===/}),Kc=createToken({name:"NotEquals",pattern:/!=/}),qc=createToken({name:"NotEqualsEquals",pattern:/!==/}),Xc=createToken({name:"LessThanOrEqual",pattern:/<=/}),Yc=createToken({name:"GreaterThanOrEqual",pattern:/>=/}),Qc=createToken({name:"LessThan",pattern:/</}),Jc=createToken({name:"GreaterThan",pattern:/>/}),Zc=createToken({name:"And",pattern:/&&/}),eh=createToken({name:"Or",pattern:/\|\|/}),th=createToken({name:"Not",pattern:/!/}),nh=createToken({name:"Equals",pattern:/=/}),ih=createToken({name:"Plus",pattern:/\+/}),rh=createToken({name:"Minus",pattern:/-/}),sh=createToken({name:"Times",pattern:/\*/}),ah=createToken({name:"Divide",pattern:/\//}),oh=createToken({name:"LParen",pattern:/\(/}),uh=createToken({name:"RParen",pattern:/\)/}),lh=createToken({name:"Comma",pattern:/,/}),ch=createToken({name:"StringLiteral",pattern:/"(?:[^"\\]|\\.)*"|'(?:[^'\\]|\\.)*'/}),hh=createToken({name:"NumericLiteral",pattern:/-?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/}),fh=[Tc,kc,Oc,wc,Sc,Rc,Nc,Cc,Ic,Lc,Pc,Mc,Fc,Dc,Uc,$c,jc,Bc,Wc,Vc,Gc,Hc,zc,qc,Kc,Xc,Yc,Zc,eh,nh,Qc,Jc,th,ih,rh,sh,ah,oh,uh,lh,ch,hh,Ac,xc],ph=new Lexer(fh);var dh=class extends CstParser{constructor(){super(fh),this.performSelfAnalysis()}query=this.RULE("query",(()=>{this.CONSUME(wc),this.SUBRULE(this.typeFormat,{LABEL:"sourceType"}),this.CONSUME(Sc),this.SUBRULE1(this.typeFormat,{LABEL:"targetType"}),this.OPTION((()=>{this.CONSUME(Rc),this.OPTION1((()=>{this.CONSUME(Vc)})),this.MANY((()=>{this.SUBRULE(this.action)}))}))}));typeFormat=this.RULE("typeFormat",(()=>{this.SUBRULE(this.anyIdentifier,{LABEL:"name"}),this.OPTION((()=>{this.CONSUME(oh),this.MANY_SEP({SEP:lh,DEF:()=>{this.SUBRULE(this.typeFormatParameter,{LABEL:"params"})}}),this.CONSUME(uh)}))}));typeFormatParameter=this.RULE("typeFormatParameter",(()=>{this.OR([{GATE:()=>this.LA(2).tokenType===nh,ALT:()=>this.SUBRULE(this.namedParameter)},{ALT:()=>this.SUBRULE(this.literal)}])}));namedParameter=this.RULE("namedParameter",(()=>{this.SUBRULE(this.anyIdentifier,{LABEL:"key"}),this.CONSUME(nh),this.SUBRULE(this.literal,{LABEL:"value"})}));anyIdentifier=this.RULE("anyIdentifier",(()=>{this.OR([{ALT:()=>this.CONSUME(xc)},{ALT:()=>this.CONSUME(Ac)}])}));literal=this.RULE("literal",(()=>{this.OR([{ALT:()=>this.CONSUME(ch)},{ALT:()=>this.CONSUME(hh)},{ALT:()=>this.CONSUME($c)},{ALT:()=>this.CONSUME(jc)},{ALT:()=>this.CONSUME(Bc)}])}));action=this.RULE("action",(()=>{this.OR([{ALT:()=>this.SUBRULE(this.setRule)},{ALT:()=>this.SUBRULE(this.modifyRule)},{ALT:()=>this.SUBRULE(this.sectionRule)},{ALT:()=>this.SUBRULE(this.cloneRule)},{ALT:()=>this.SUBRULE(this.deleteRule)},{ALT:()=>this.SUBRULE(this.ifAction)},{ALT:()=>this.SUBRULE(this.defineRule)},{ALT:()=>this.SUBRULE(this.returnRule)}])}));returnRule=this.RULE("returnRule",(()=>{this.CONSUME(Wc),this.SUBRULE(this.expression,{LABEL:"expr"})}));deleteRule=this.RULE("deleteRule",(()=>{this.CONSUME(Pc),this.SUBRULE(this.anyIdentifier,{LABEL:"field"})}));ifAction=this.RULE("ifAction",(()=>{this.CONSUME(Dc),this.CONSUME(oh),this.SUBRULE(this.expression,{LABEL:"condition"}),this.CONSUME(uh),this.CONSUME2(oh),this.MANY((()=>{this.SUBRULE(this.action,{LABEL:"thenActions"})})),this.CONSUME2(uh),this.OPTION((()=>{this.CONSUME(Uc),this.CONSUME3(oh),this.MANY2((()=>{this.SUBRULE2(this.action,{LABEL:"elseActions"})})),this.CONSUME3(uh)}))}));cloneRule=this.RULE("cloneRule",(()=>{this.CONSUME(Lc),this.OPTION((()=>{this.CONSUME(oh),this.MANY_SEP({SEP:lh,DEF:()=>{this.SUBRULE(this.anyIdentifier,{LABEL:"fields"})}}),this.CONSUME(uh)}))}));setRule=this.RULE("setRule",(()=>{this.CONSUME(Nc),this.SUBRULE(this.anyIdentifier,{LABEL:"left"}),this.CONSUME(nh),this.SUBRULE(this.expression,{LABEL:"right"})}));modifyRule=this.RULE("modifyRule",(()=>{this.CONSUME(Fc),this.SUBRULE(this.anyIdentifier,{LABEL:"left"}),this.CONSUME(nh),this.SUBRULE(this.expression,{LABEL:"right"})}));expression=this.RULE("expression",(()=>{this.SUBRULE(this.logicalOr)}));logicalOr=this.RULE("logicalOr",(()=>{this.SUBRULE(this.logicalAnd,{LABEL:"lhs"}),this.MANY((()=>{this.CONSUME(eh),this.SUBRULE1(this.logicalAnd,{LABEL:"rhs"})}))}));logicalAnd=this.RULE("logicalAnd",(()=>{this.SUBRULE(this.comparison,{LABEL:"lhs"}),this.MANY((()=>{this.CONSUME(Zc),this.SUBRULE1(this.comparison,{LABEL:"rhs"})}))}));comparison=this.RULE("comparison",(()=>{this.SUBRULE(this.addition,{LABEL:"lhs"}),this.OPTION((()=>{this.OR([{ALT:()=>this.CONSUME(zc,{LABEL:"ops"})},{ALT:()=>this.CONSUME(Hc,{LABEL:"ops"})},{ALT:()=>this.CONSUME(Kc,{LABEL:"ops"})},{ALT:()=>this.CONSUME(qc,{LABEL:"ops"})},{ALT:()=>this.CONSUME(Xc,{LABEL:"ops"})},{ALT:()=>this.CONSUME(Yc,{LABEL:"ops"})},{ALT:()=>this.CONSUME(Qc,{LABEL:"ops"})},{ALT:()=>this.CONSUME(Jc,{LABEL:"ops"})}]),this.SUBRULE1(this.addition,{LABEL:"rhs"})}))}));addition=this.RULE("addition",(()=>{this.SUBRULE(this.multiplication,{LABEL:"lhs"}),this.MANY((()=>{this.OR([{ALT:()=>this.CONSUME(ih,{LABEL:"ops"})},{ALT:()=>this.CONSUME(rh,{LABEL:"ops"})}]),this.SUBRULE1(this.multiplication,{LABEL:"rhs"})}))}));multiplication=this.RULE("multiplication",(()=>{this.SUBRULE(this.unaryExpression,{LABEL:"lhs"}),this.MANY((()=>{this.OR([{ALT:()=>this.CONSUME(sh,{LABEL:"ops"})},{ALT:()=>this.CONSUME(ah,{LABEL:"ops"})}]),this.SUBRULE1(this.unaryExpression,{LABEL:"rhs"})}))}));unaryExpression=this.RULE("unaryExpression",(()=>{this.OPTION((()=>{this.OR([{ALT:()=>this.CONSUME(rh,{LABEL:"sign"})},{ALT:()=>this.CONSUME(th,{LABEL:"sign"})}])})),this.SUBRULE(this.atomic)}));atomic=this.RULE("atomic",(()=>{this.OR([{ALT:()=>this.SUBRULE(this.literal)},{GATE:()=>this.LA(2).tokenType===oh,ALT:()=>this.SUBRULE(this.functionCall)},{ALT:()=>this.SUBRULE(this.anyIdentifier)},{ALT:()=>{this.CONSUME(oh),this.SUBRULE(this.expression),this.CONSUME(uh)}}])}));functionCall=this.RULE("functionCall",(()=>{this.OR([{ALT:()=>this.CONSUME(xc,{LABEL:"name"})},{ALT:()=>this.CONSUME(Dc,{LABEL:"name"})}]),this.CONSUME(oh),this.MANY_SEP({SEP:lh,DEF:()=>{this.SUBRULE(this.expression,{LABEL:"args"})}}),this.CONSUME(uh)}));sectionRule=this.RULE("sectionRule",(()=>{this.CONSUME(Cc),this.OPTION((()=>{this.CONSUME(Ic)})),this.SUBRULE(this.anyIdentifier,{LABEL:"sectionName"}),this.CONSUME(oh),this.OPTION1((()=>{this.CONSUME(wc,{LABEL:"subqueryFrom"}),this.SUBRULE(this.typeFormat,{LABEL:"subquerySourceType"}),this.CONSUME(Sc,{LABEL:"subqueryTo"}),this.SUBRULE1(this.typeFormat,{LABEL:"subqueryTargetType"}),this.OPTION2((()=>{this.CONSUME(Rc,{LABEL:"subqueryTransform"})}))})),this.MANY((()=>{this.SUBRULE(this.action)})),this.CONSUME(uh),this.OPTION3((()=>{this.CONSUME1(wc,{LABEL:"followFrom"}),this.SUBRULE(this.expression,{LABEL:"followExpr"})})),this.OPTION4((()=>{this.CONSUME(Gc,{LABEL:"whereClause"}),this.SUBRULE1(this.expression,{LABEL:"whereExpr"})}))}));defineRule=this.RULE("defineRule",(()=>{this.CONSUME(Mc),this.SUBRULE(this.anyIdentifier,{LABEL:"left"}),this.CONSUME(nh),this.SUBRULE(this.expression,{LABEL:"right"})}))},_h=new dh;var mh={substring:(e,t)=>{if(e.length<2)throw new Error("substring() requires at least 2 arguments (string, start, [length])");let[n,r,o]=e;return o!==void 0?`String(${n}).slice(${r}, (${r}) + (${o}))`:`String(${n}).slice(${r})`},if:(e,t)=>{if(e.length!==3)throw new Error("if() requires exactly 3 arguments (condition, trueValue, falseValue)");let[n,r,o]=e;return`((${n}) ? (${r}) : (${o}))`},text:(e,t)=>{if(e.length!==1)throw new Error("text() requires exactly 1 argument (string or number)");let[n]=e;return`String(${n})`},replace:(e,t)=>{if(e.length!==3)throw new Error("replace() requires exactly 3 arguments (string, search, replacement)");let[n,r,o]=e;return`String(${n}).replace(${r}, ${o})`},number:(e,t)=>{if(e.length!==1)throw new Error("number() requires exactly 1 argument (string)");let[n]=e;return`Number(${n})`},extractnumber:(e,t)=>{if(e.length!==1)throw new Error("extractNumber() requires exactly 1 argument (string)");let[n]=e;return`(() => { const match = String(${n}).match(/\\d+(\\.\\d+)?/); return match ? Number(match[0]) : null; })()`},uppercase:(e,t)=>{if(e.length!==1)throw new Error("uppercase() requires exactly 1 argument (string)");let[n]=e;return`String(${n}).toUpperCase()`},lowercase:(e,t)=>{if(e.length!==1)throw new Error("lowercase() requires exactly 1 argument (string)");let[n]=e;return`String(${n}).toLowerCase()`},xmlnode:(e,t)=>{if(e.length<1)throw new Error("xmlnode() requires at least 1 argument (string)");let[n,...r]=e,o=r.join(", ");return`env.functions.xmlnode(${n}${o?", "+o:""})`},split:(e,t)=>{if(e.length<1)throw new Error("split() requires at least 1 argument (string)");let[n,r,o]=e,l=r!==void 0?r:'""',h=o!==void 0?`, ${o}`:"";return`String(${n}).split(${l}${h})`},to_base64:(e,t)=>{if(e.length!==1)throw new Error("to_base64() requires exactly 1 argument (string)");let[n]=e;return`env.functions.to_base64(${n})`},from_base64:(e,t)=>{if(e.length!==1)throw new Error("from_base64() requires exactly 1 argument (string)");let[n]=e;return`env.functions.from_base64(${n})`},aslist:(e,t)=>{if(e.length!==1)throw new Error("aslist() requires exactly 1 argument");let[n]=e;return`env.functions.aslist(${n})`},spreadsheet:(e,t)=>{if(e.length!==1)throw new Error("spreadsheet() requires exactly 1 argument");let[n]=e;return`env.functions.spreadsheet(${n})`},unpack:(e,t)=>{if(e.length<2)throw new Error("unpack() requires at least 2 arguments (string, fieldSpec1, [fieldSpec2, ...])");let[n,...r]=e;r.forEach((e=>{let t=e.replace(/^["']|["']$/g,""),n=t.split(":");if(n.length<3)throw new Error(`Invalid field spec for unpack(): ${t}. Expected "name:start:length[:modifier]"`);let[r,o,l]=n;if(!/^[a-zA-Z_$][a-zA-Z0-9_$]*$/.test(r))throw new Error(`Invalid field name in unpack() spec: "${r}". Must be a valid JavaScript identifier.`);let h=parseInt(o,10),f=parseInt(l,10);if(isNaN(h)||isNaN(f))throw new Error(`Invalid character positions in unpack() spec: ${t}`)}));let o=r.join(", ");return`env.functions.unpack(${n}, ${o})`},pack:(e,t)=>{if(e.length<2)throw new Error("pack() requires at least 2 arguments (object, fieldSpec1, [fieldSpec2, ...])");let[n,...r]=e;r.forEach((e=>{let t=e.replace(/^["']|["']$/g,""),n=t.split(":");if(n.length<3)throw new Error(`Invalid field spec for pack(): ${t}. Expected "name:start:length[:modifier]"`);let[r,o,l]=n;if(!/^[a-zA-Z_$][a-zA-Z0-9_$]*$/.test(r))throw new Error(`Invalid field name in pack() spec: "${r}". Must be a valid JavaScript identifier.`);let h=parseInt(o,10),f=parseInt(l,10);if(isNaN(h)||isNaN(f))throw new Error(`Invalid character positions in pack() spec: ${t}`)}));let o=r.join(", ");return`env.functions.pack(${n}, ${o})`},concat:(e,t)=>`env.functions.concat(${e.join(", ")})`,transpose:(e,t)=>{if(e.length<2)throw new Error("transpose() requires at least 2 arguments (source, key1, [key2, ...])");return`env.functions.transpose(${e.join(", ")})`},list:(e,t)=>`[${e.join(", ")}]`,array:(e,t)=>`[${e.join(", ")}]`,extract:(e,t)=>{if(e.length<2)throw new Error("extract() requires at least 2 arguments (source, key1, [key2, ...])");let[n,...r]=e;return`env.functions.extract(${n}, ${t.safeMode}, ${r.join(", ")})`}};var gh=class{sourceRoot={type:"object",properties:{}};targetRoot={type:"object",properties:{}};sourceStack=[this.sourceRoot];targetStack=[this.targetRoot];getCurrentSource(){return this.sourceStack[this.sourceStack.length-1]}getCurrentTarget(){return this.targetStack[this.targetStack.length-1]}recordAccess(e,t="any",n=false){let r=n?this.getCurrentTarget():this.getCurrentSource();this.setInNode(r,e,t)}recordAssignment(e,t="any"){this.setInNode(this.getCurrentTarget(),e,t)}recordClone(e){let t=this.getCurrentTarget();e?e.forEach((e=>{this.setInNode(this.getCurrentSource(),e,"any"),this.setInNode(t,e,"any")})):t.isOpen=true}recordDelete(e){let t=this.getCurrentTarget();this.deleteInNode(t,e)}pushSection(e,t,n){t!=="parent"&&this.setInNode(this.getCurrentSource(),t,n?"array":"object");let r={type:n?"array":"object"};n?r.items={type:"object",properties:{}}:r.properties={};let o={type:"object",properties:{}};this.setInNodeExplicit(this.getCurrentTarget(),e,r),this.targetStack.push(n?r.items:r),this.sourceStack.push(o)}popSection(e,t){let n=this.sourceStack.pop();this.targetStack.pop();let r=this.getCurrentSource();if(e!=="parent"){let o=this.getOrSetNode(r,e,t?"array":"object"),l=t?o.items:o;l&&(l.properties||(l.properties={}),Object.assign(l.properties,n.properties||{}))}else r.properties||(r.properties={}),Object.assign(r.properties,n.properties||{})}parsePath(e){if(!e)return[];let t=[],n=e.split(".");for(let e of n){let n=e.match(/^([^[\]]*)((?:\[\d+\])*)$/);if(n){n[1]&&t.push(n[1]);let e=n[2].match(/\[\d+\]/g);if(e)for(let n of e)t.push("[]")}else t.push(e)}return t}setInNode(e,t,n){let r=this.parsePath(t),o=e;for(let e=0;e<r.length;e++){let t=r[e],l=e===r.length-1;if(t==="[]"){o.type="array",o.items||(o.items={type:l?n:"object",properties:{}}),o=o.items;continue}o.properties||(o.properties={}),l?(!o.properties[t]||o.properties[t].type==="any")&&(o.properties[t]={type:n},n==="object"?o.properties[t].properties={}:n==="array"&&(o.properties[t].items={type:"object",properties:{}})):(o.properties[t]||(o.properties[t]={type:"object",properties:{}}),o=o.properties[t])}}setInNodeExplicit(e,t,n){let r=this.parsePath(t),o=e;for(let e=0;e<r.length;e++){let t=r[e],l=e===r.length-1;if(t==="[]"){o.type="array",o.items||(o.items={type:l?n.type:"object",properties:{}}),l?o.items=n:o=o.items;continue}o.properties||(o.properties={}),l?o.properties[t]=n:(o.properties[t]||(o.properties[t]={type:"object",properties:{}}),o=o.properties[t])}}deleteInNode(e,t){let n=this.parsePath(t),r=e;for(let e=0;e<n.length;e++){let t=n[e],o=e===n.length-1;if(t==="[]"){if(!r.items)return;o?(delete r.items,r.type="any"):r=r.items;continue}if(!r.properties)return;if(o)delete r.properties[t];else if(r=r.properties[t],!r)return}}getOrSetNode(e,t,n){let r=this.parsePath(t),o=e;for(let e=0;e<r.length;e++){let t=r[e],l=e===r.length-1;if(t==="[]"){if(o.type="array",!o.items){let e=l?n:"object";o.items={type:e},e==="object"?o.items.properties={}:e==="array"&&(o.items.items={type:"object",properties:{}})}o=o.items;continue}let h=l?n:"object";o.properties||(o.properties={}),o.properties[t]||(o.properties[t]={type:h},h==="object"?o.properties[t].properties={}:h==="array"&&(o.properties[t].items={type:"object",properties:{}})),o=o.properties[t]}return o}getResult(){return{source:this.sourceRoot,target:this.targetRoot}}};var yh=_h.getBaseCstVisitorConstructor(),bh=class extends yh{readFrom="source";scopeStack=[];safeMode=true;isAnalyzing=false;tracker=new gh;lastInferredType="any";constructor(){super(),this.validateVisitor()}reset(){this.readFrom="source",this.scopeStack=[],this.tracker=new gh,this.lastInferredType="any"}visitWithContext(e,t){let n=this.readFrom;this.readFrom=t.readFrom;try{return this.visit(e)}finally{this.readFrom=n}}query(e){this.reset(),this.isAnalyzing&&(this.tracker=new gh);let t=this.visit(e.sourceType),n=this.visit(e.targetType),r=!!e.Unsafe;this.safeMode=!r,this.scopeStack.push({format:n.name,options:n.options,isSerializationScope:true});try{let r=e.action?e.action.map((e=>this.visit(e))):[];e.Transform||r.push("Object.assign(target, source);");let o=t.name,l=n.name,h=JSON.stringify(t.options),f=JSON.stringify(n.options),p=r.some((e=>typeof e=="string"&&e.trim().startsWith("return ")));return{code:`\n      return function(input, env) {\n        // 1. Parse Input\n        const _safeSource = (v) => (typeof v === 'object' && v !== null) ? (Array.isArray(v) ? [...v] : { ...v }) : (v || {});\n        const _parsedSource = env.parse('${o}', input, ${h});\n        const source = _safeSource(_parsedSource);\n        const _rootSource = source;\n        \n        // 2. Transform\n        const target = {};\n        const _rootTarget = target;\n        ${r.join(`\n        `)}\n\n        // 3. Serialize Output\n        ${p?"":`return env.serialize('${l}', target, ${f});`}\n      }\n    `,sourceType:t,targetType:n,analysis:this.isAnalyzing?this.tracker.getResult():void 0}}finally{this.scopeStack.pop()}}typeFormat(e){let t=this.visit(e.name),n={params:[]};return e.params&&e.params.forEach((e=>{let t=this.visit(e);typeof t=="object"&&"key"in t?n[t.key]=this.parseLiteral(t.value):n.params.push(this.parseLiteral(t))})),{name:t.name,options:n}}typeFormatParameter(e){if(e.namedParameter)return this.visit(e.namedParameter);if(e.literal)return this.visit(e.literal)}namedParameter(e){let t=this.visit(e.key).name,n=this.visit(e.value);return{key:t,value:n}}parseLiteral(e){if(e==="true")return true;if(e==="false")return false;if(e==="null")return null;if(e.startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'"))return e.slice(1,-1);let t=Number(e);return isNaN(t)?e:t}isSimplePath(e){return e?!/[()+*/-]/.test(e)&&!e.includes(" "):false}safify(e){return this.safeMode?e.replace(/\.(?!\?)/g,"?.").replace(/\[/g,"?.["):e}genAccess(e,t,n=false){if(!this.safeMode||n)return t.quoted||t.name.includes("-")&&!t.name.includes(".")&&!t.name.includes("[")?`${e}["${t.name}"]`:`${e}.${t.name}`;if(t.quoted)return`${e}?.[${JSON.stringify(t.name)}]`;let r=this.safify(t.name);return`${e}?.${r}`}anyIdentifier(e){if(e.Identifier)return{name:e.Identifier[0].image,quoted:false};if(e.QuotedIdentifier)return{name:e.QuotedIdentifier[0].image.slice(1,-1).replace(/\\(.)/g,"$1"),quoted:true}}literal(e){if(e.StringLiteral)return this.lastInferredType="string",e.StringLiteral[0].image;if(e.NumericLiteral)return this.lastInferredType="number",e.NumericLiteral[0].image;if(e.True)return this.lastInferredType="boolean","true";if(e.False)return this.lastInferredType="boolean","false";if(e.Null)return this.lastInferredType="null","null"}action(e){if(e.setRule)return this.visit(e.setRule);if(e.modifyRule)return this.visit(e.modifyRule);if(e.sectionRule)return this.visit(e.sectionRule);if(e.cloneRule)return this.visit(e.cloneRule);if(e.ifAction)return this.visit(e.ifAction);if(e.deleteRule)return this.visit(e.deleteRule);if(e.defineRule)return this.visit(e.defineRule);if(e.returnRule)return this.visit(e.returnRule)}deleteRule(e){let t=this.visit(e.field);return this.isAnalyzing&&this.tracker.recordDelete(t.name),`delete ${this.genAccess("target",t,true)};`}ifAction(e){let t=this.visit(e.condition),n=e.thenActions?e.thenActions.map((e=>this.visit(e))).join(`\n`):"",r=e.elseActions?`else { ${e.elseActions.map((e=>this.visit(e))).join(`\n`)} }`:"";return`if (${t}) {\n       ${n}\n     } ${r}`}cloneRule(e){if(e.fields){let t=e.fields.map((e=>this.visit(e)));return this.isAnalyzing&&this.tracker.recordClone(t.map((e=>e.name))),t.map((e=>`${this.genAccess("target",e,true)} = ${this.genAccess("source",e)};`)).join(`\n        `)}return this.isAnalyzing&&this.tracker.recordClone(),"Object.assign(target, source);"}setRule(e){let t=this.visit(e.left);this.lastInferredType="any";let n=this.visit(e.right);return this.isAnalyzing&&this.tracker.recordAssignment(t.name,this.lastInferredType),`${this.genAccess("target",t,true)} = ${n};`}modifyRule(e){let t=this.visit(e.left);this.lastInferredType="any";let n=this.visitWithContext(e.right,{readFrom:"target"});return this.isAnalyzing&&this.tracker.recordAssignment(t.name,this.lastInferredType),`${this.genAccess("target",t,true)} = ${n};`}defineRule(e){let t=this.visit(e.left);this.lastInferredType="any";let n=this.visit(e.right);return this.isAnalyzing&&this.tracker.recordAssignment(t.name,this.lastInferredType),`${this.genAccess("source",t,true)} = ${n};`}returnRule(e){let t=this.visitWithContext(e.expr,{readFrom:"target"}),n=this.scopeStack[this.scopeStack.length-1];if(n&&n.isSerializationScope){let e=JSON.stringify(n.options);return`return env.serialize('${n.format}', ${t}, ${e});`}return`return ${t};`}expression(e){return this.visit(e.logicalOr)}logicalOr(e){let t=this.visit(e.lhs);if(e.rhs&&e.rhs.length>0){this.lastInferredType="boolean";for(let n=0;n<e.rhs.length;n++){let r=this.visit(e.rhs[n]);t=`${t} || ${r}`}}return t}logicalAnd(e){let t=this.visit(e.lhs);if(e.rhs&&e.rhs.length>0){this.lastInferredType="boolean";for(let n=0;n<e.rhs.length;n++){let r=this.visit(e.rhs[n]);t=`${t} && ${r}`}}return t}comparison(e){let t=this.visit(e.lhs);if(e.rhs){this.lastInferredType="boolean";let n=e.ops[0].image,r=this.visit(e.rhs[0]);t=`${t} ${n} ${r}`}return t}addition(e){let t=this.visit(e.lhs),n=this.lastInferredType,r=t;if(e.rhs&&e.rhs.length>0){let t=n==="string",o=n==="number";for(let n=0;n<e.rhs.length;n++){let l=e.ops[n].image,h=this.visit(e.rhs[n]);this.lastInferredType==="string"&&(t=true),this.lastInferredType!=="number"&&(o=false),r=`${r} ${l} ${h}`}t?this.lastInferredType="string":o?this.lastInferredType="number":this.lastInferredType="any"}else this.lastInferredType=n;return r}multiplication(e){let t=this.visit(e.lhs);if(e.rhs&&e.rhs.length>0){this.lastInferredType="number";for(let n=0;n<e.rhs.length;n++){let r=e.ops[n].image,o=this.visit(e.rhs[n]);t=`${t} ${r} ${o}`}}return t}unaryExpression(e){let t=this.visit(e.atomic);if(e.sign){let n=e.sign[0].image;return n==="!"&&(this.lastInferredType="boolean"),n==="-"&&(this.lastInferredType="number"),`${n}${t}`}return t}atomic(e){if(e.literal)return this.visit(e.literal);if(e.functionCall)return this.visit(e.functionCall);if(e.anyIdentifier){this.lastInferredType="any";let t=this.visit(e.anyIdentifier);if(["true","false","null"].includes(t.name)&&!t.quoted)return t.name;if(t.name==="_key"&&!t.quoted)return"_key";if(!t.quoted){if(t.name.startsWith("source.")||t.name.startsWith("source[")){let e=t.name.startsWith("source.")?t.name.substring(7):t.name.substring(6);return this.isAnalyzing&&e&&this.tracker.recordAccess(e,"any",false),this.safeMode?this.safify(t.name):t.name}if(t.name.startsWith("target.")||t.name.startsWith("target[")){let e=t.name.startsWith("target.")?t.name.substring(7):t.name.substring(6);return this.isAnalyzing&&e&&this.tracker.recordAccess(e,"any",true),this.safeMode?this.safify(t.name):t.name}if(t.name==="target")return"target";if(t.name==="source")return"source";if(t.name==="_source"||t.name.startsWith("_source.")||t.name.startsWith("_source[")){let e=t.name.substring(7);if(this.isAnalyzing){let t=e.startsWith(".")?e.substring(1):e;t&&this.tracker.recordAccess(t,"any",false)}return`_rootSource${this.safeMode?this.safify(e):e}`}if(t.name==="_target"||t.name.startsWith("_target.")||t.name.startsWith("_target[")){let e=t.name.substring(7);if(this.isAnalyzing){let t=e.startsWith(".")?e.substring(1):e;t&&this.tracker.recordAccess(t,"any",true)}return`_rootTarget${this.safeMode?this.safify(e):e}`}}return this.isAnalyzing&&this.tracker.recordAccess(t.name,"any",this.readFrom==="target"),this.genAccess(this.readFrom,t)}if(e.expression)return`(${this.visit(e.expression)})`}functionCall(e){let t=e.name[0].image,n=(t.startsWith("`")?t.slice(1,-1):t).toLowerCase(),r=e.args?e.args.map((e=>this.visit(e))):[],o=mh[n];if(o)return["substring","text","replace","uppercase","lowercase","to_base64","from_base64"].includes(n)?this.lastInferredType="string":["number","extractnumber"].includes(n)?this.lastInferredType="number":["aslist","transpose","list","array"].includes(n)?this.lastInferredType="array":n==="asobject"&&(this.lastInferredType="object"),o(r,this);throw new Error(`Unknown function: ${t}`)}sectionRule(e){let t=this.visit(e.sectionName),n=t.name,r=this.genAccess("target",t,true),o,l;if(e.followExpr){let t=this.visit(e.followExpr),n=t.replace(/\?\./g,".");n==="source.parent"||n==="this.source.parent"||n===`${this.readFrom.replace(/\?\./g,".")}.parent`?(o="source",l="parent"):(o=t,l=o)}else o=this.genAccess("source",t),l=t.name;let h=!!e.Multiple,f=!!e.whereExpr,p="";if(f&&(p=this.visit(e.whereExpr)),!!e.subqueryFrom){let t=this.visit(e.subquerySourceType),n=this.visit(e.subqueryTargetType);this.scopeStack.push({format:n.name,options:n.options,isSerializationScope:true});try{let l=!!e.subqueryTransform,d=e.action?e.action.map((e=>this.visit(e))):[];l||d.push("Object.assign(target, source);");let _=JSON.stringify(t.options),m=JSON.stringify(n.options),g=o.includes("(")||o.includes("[")||o.includes(" ")?"_sectionSource":o,y=g==="_sectionSource"?`const _sectionSource = ${o};\n`:"";if(h){let e=f?`.filter((item, index) => { const source = item; const _key = index; return ${p}; })`:"";return`\n        {\n          ${y}if (${g} && Array.isArray(${g})) {\n            ${r} = ${g}${e}.map((item, index) => {\n              const subSource = env.parse('${t.name}', item, ${_});\n              const source = _safeSource(subSource);\n              const _key = index;\n              const target = {};\n              ${d.join(`\n              `)}\n              return env.serialize('${n.name}', target, ${m});\n            });\n          }\n        }\n        `}else return f?`\n        {\n          ${y}if (${g} && Array.isArray(${g})) {\n            const _filtered = ${g}.find((item, index) => { const source = item; const _key = index; return ${p}; });\n            if (_filtered) {\n              ${r} = (function(innerSource, innerIndex) {\n                const subSource = env.parse('${t.name}', innerSource, ${_});\n                const source = _safeSource(subSource);\n                const _key = innerIndex;\n                const target = {};\n                ${d.join(`\n                `)}\n                return env.serialize('${n.name}', target, ${m});\n              })(_filtered, ${g}.indexOf(_filtered));\n            }\n          }\n        }\n        `:`\n        {\n          ${y}if (${g}) {\n            ${r} = (function(innerSource) {\n              const subSource = env.parse('${t.name}', innerSource, ${_});\n              const source = _safeSource(subSource);\n              const _key = 0; // Single section without where, index is effectively 0 if we consider it an "iteration"\n              const target = {};\n              ${d.join(`\n              `)}\n              return env.serialize('${n.name}', target, ${m});\n            })(${g});\n          }\n        }\n        `}finally{this.scopeStack.pop()}}this.scopeStack.push({format:"object",options:{},isSerializationScope:false});try{let t=l;t!=="parent"&&(t=t.replace(/^source\??\./,"").replace(/^this\.source\??\./,"").replace(/\?\./g,".")),this.isAnalyzing&&(t==="parent"||this.isSimplePath(t)?this.tracker.pushSection(n,t,h):this.tracker.pushSection(n,"parent",h));try{let t=e.action?e.action.map((e=>this.visit(e))):[],n=o.includes("(")||o.includes("[")||o.includes(" ")?"_sectionSource":o,l=n==="_sectionSource"?`const _sectionSource = ${o};\n`:"";if(h){let e=f?`.filter((item, index) => { const source = _safeSource(item); const _key = index; return ${p}; })`:"";return`\n      {\n        ${l}if (${n} && Array.isArray(${n})) {\n          ${r} = ${n}${e}.map((item, index) => {\n            const source = _safeSource(item);\n            const _key = index;\n            const target = {};\n            ${t.join(`\n            `)}\n            return target;\n          });\n        }\n      }\n      `}else return f?`\n      {\n        ${l}if (${n} && Array.isArray(${n})) {\n          const _filtered = ${n}.find((item, index) => { const source = _safeSource(item); const _key = index; return ${p}; });\n          if (_filtered) {\n            ${r} = (function(innerSource, innerIndex) {\n              const source = _safeSource(innerSource);\n              const _key = innerIndex;\n              const target = {};\n              ${t.join(`\n              `)}\n              return target;\n            })(_filtered, ${n}.indexOf(_filtered));\n          }\n        }\n      }\n      `:`\n      {\n        ${l}if (${n}) {\n          ${r} = (function(innerSource) {\n            const source = _safeSource(innerSource);\n            const _key = 0;\n            const target = {};\n            ${t.join(`\n            `)}\n            return target;\n          })(${n});\n        }\n      }\n      `}finally{if(this.isAnalyzing){let e=t==="parent"||this.isSimplePath(t)?t:"parent";this.tracker.popSection(e,h)}}}finally{this.scopeStack.pop()}}},vh=new bh;var Eh={};function T(e,t){Eh[e.toLowerCase()]=t}function ye(e){let t=Eh[e.toLowerCase()];if(!t)throw new Error(`No adapter found for format: ${e}`);return t}function Me(e){let t="";for(;e>=0;)t=String.fromCharCode(e%26+65)+t,e=Math.floor(e/26)-1;return t}T("json",{parse:e=>typeof e!="string"?e:JSON.parse(e),serialize:e=>JSON.stringify(e,null,2)});var Th=new Builder({ignoreAttributes:false,attributeNamePrefix:"$",textNodeName:"_",format:true});T("xml",{parse:(e,t)=>typeof e!="string"?e:new XMLParser({ignoreAttributes:false,removeNSPrefix:true,...t}).parse(e),serialize:(e,t)=>{let n=t?.rootGenerated??t?.params?.[0]??"root";return(t?new Builder({ignoreAttributes:false,attributeNamePrefix:"$",textNodeName:"_",format:true,...t}):Th).build({[n]:e})}});T("csv",{parse:(e,t)=>{if(typeof e!="string")return e;let n=t?.delimiter??t?.params?.[0]??",";return{rows:vc.parse(e,{delimiter:n,skipEmptyLines:true,...t}).data.map((e=>{let t={};return Array.isArray(e)&&e.forEach(((e,n)=>{t[Me(n)]=e})),t}))}},serialize:(e,t)=>{if(!e||!Array.isArray(e.rows))return"";let n=t?.delimiter??t?.params?.[0]??",",r=e.rows.map((e=>Object.keys(e).filter((e=>/^[A-Z]+$/.test(e))).sort(((e,t)=>e.length!==t.length?e.length-t.length:e.localeCompare(t))).map((t=>e[t]))));return vc.unparse(r,{delimiter:n,...t})}});T("edifact",{parse:(e,t)=>{if(typeof e!="string")return e;let n="'",r="+",o=":",l="?",h=e.trim();if(h.startsWith("UNA")){let e=h.substring(3,9);o=e[0],r=e[1],l=e[3],n=e[5],h=h.substring(9).trim()}t&&(t.segmentTerminator&&(n=t.segmentTerminator),t.elementSeparator&&(r=t.elementSeparator),t.componentSeparator&&(o=t.componentSeparator),t.releaseChar&&(l=t.releaseChar));let f={},c=(e,t,n)=>{let r=[],o="";for(let l=0;l<e.length;l++){let h=e[l];h===n&&l+1<e.length?o+=n+e[++l]:h===t?(r.push(o),o=""):o+=h}return r.push(o),r},u=(e,t)=>{let n="";for(let r=0;r<e.length;r++)e[r]===t&&r+1<e.length?n+=e[++r]:n+=e[r];return n},p=c(h,n,l).map((e=>e.trim())).filter((e=>e.length>0));for(let e of p){let t=c(e,r,l),n=u(t[0],l),h=t.slice(1).map((e=>{let t=c(e,o,l).map((e=>u(e,l)));return t.length>1?t:t[0]}));f[n]||(f[n]=[]),f[n].push(h)}return f},serialize:(e,t)=>{if(!e||typeof e!="object")return"";let n=t?.segmentTerminator??"'",r=t?.elementSeparator??"+",o=t?.componentSeparator??":",l=t?.releaseChar??"?",a=e=>{if(e==null)return"";let t=String(e),h="";for(let e of t)(e===n||e===r||e===o||e===l)&&(h+=l),h+=e;return h},h="";t?.includeUNA&&(h+=`UNA${o}${r}.${l} ${n}`);for(let t in e){let l=Array.isArray(e[t])?e[t]:[e[t]];for(let e of l){if(h+=t,Array.isArray(e))for(let t of e)h+=r,Array.isArray(t)?h+=t.map(a).join(o):h+=a(t);h+=n}}return h}});T("object",{parse:e=>{if(typeof e=="string"&&(e.trim().startsWith("{")||e.trim().startsWith("[")))try{return JSON.parse(e)}catch{return e}return e},serialize:e=>e});T("plaintext",{parse:(e,t)=>{if(typeof e!="string")return e;let n=t?.separator??t?.params?.[0]??/\r?\n/;return{rows:e.split(n).filter((e=>e.length>0))}},serialize:(e,t)=>{if(!e||!Array.isArray(e.rows))return"";let n=t?.separator??t?.params?.[0]??`\n`;return e.rows.join(n)}});var kh={spreadsheet:e=>{let t=Array.isArray(e)?e:e==null?[]:[e];if(!Array.isArray(e)&&e&&typeof e=="object"&&Array.isArray(e.rows)&&(t=e.rows),t.length===0)return[];let n=[],r=[],o=[];for(let e=0;e<t.length;e++){let l=t[e];if(!(!l||typeof l!="object"))if(e===0){o=Object.keys(l);for(let e of o)r.push(String(l[e]))}else{let e={};for(let t=0;t<o.length;t++){let n=o[t],h=r[t];e[h]=l[n]}n.push(e)}}return n},aslist:e=>Array.isArray(e)?e:e==null?[]:[e],to_base64:e=>{let t=String(e);return typeof btoa=="function"?btoa(unescape(encodeURIComponent(t))):Buffer.from(t,"utf-8").toString("base64")},from_base64:e=>{let t=String(e);return typeof atob=="function"?decodeURIComponent(escape(atob(t))):Buffer.from(t,"base64").toString("utf-8")},xmlnode:(e,...t)=>{if(t.length>0){let n=[];for(let e=0;e<t.length;e+=2)n.push([t[e],t[e+1]]);let r=n.map((([e,t])=>[`$${e}`,t])),o=Object.fromEntries(r);return{_:e,...o}}return e},unpack:(e,...t)=>{let n=String(e||""),r={};for(let e of t){let t=e.split(":");if(t.length<3)continue;let[o,l,h,f]=t,p=parseInt(l,10),d=parseInt(h,10);if(isNaN(p)||isNaN(d))continue;let _=n.substring(p,p+d);f!=="raw"&&(_=_.trim()),r[o]=_}return r},pack:(e,...t)=>{let n=e||{},r=t.map((e=>{let t=e.split(":");if(t.length<3)return null;let[n,r,o,l]=t;return{name:n,start:parseInt(r,10),length:parseInt(o,10),left:l==="left"}})).filter((e=>e!==null)),o=r.reduce(((e,t)=>Math.max(e,t.start+t.length)),0),l=" ".repeat(o);for(let e of r){let t=String(n[e.name]??""),r=(e.left?t.padStart(e.length):t.padEnd(e.length)).substring(0,e.length);l=l.substring(0,e.start)+r+l.substring(e.start+e.length)}return l},concat:(...e)=>e.reduce(((e,t)=>e.concat(Array.isArray(t)?t:t==null?[]:[t])),[]),transpose:(e,...t)=>{if(!e||typeof e!="object"||t.length===0)return[];let n=0;for(let r of t){let t=e[r];Array.isArray(t)?n=Math.max(n,t.length):t!=null&&(n=Math.max(n,1))}let r=[];for(let o=0;o<n;o++){let n={};for(let r of t){let t=e[r];Array.isArray(t)?n[r]=t[o]:n[r]=o===0?t:void 0}r.push(n)}return r},extract:(e,t,...n)=>{if(!e||typeof e!="object")return{};let s=(e,t,n)=>{if(!t)return e;let r=t.split("."),o=e;for(let e of r)if(n){if(o==null)return;o=o[e]}else o=o[e];return o},r={};for(let o of n){let n=o.indexOf(":"),l,h;n!==-1?(l=o.substring(0,n),h=o.substring(n+1)):(l=o,h=o),r[l]=s(e,h,t)}return r}};async function it(e,t){if(t?.cache){let n=await t.cache.retrieve(e);if(n)return Ne(n)}let n=ph.tokenize(e);if(n.errors.length>0)throw new Error(`Lexing errors: ${n.errors[0].message}`);_h.input=n.tokens;let r=_h.query();if(_h.errors.length>0)throw new Error(`Parsing errors: ${_h.errors[0].message}`);vh.isAnalyzing=!!t?.analyze;let{code:o,analysis:l,sourceType:h,targetType:f}=vh.visit(r),p=Ec.js(o,{indent_size:2,space_in_empty_paren:true,end_with_newline:true});t?.cache&&await t.cache.save(e,p);let d=Ne(p);return l&&(l.sourceFormat=h.name,l.targetFormat=f.name,d.analysis=l),d}function Ne(e){let t=new Function(e)(),n={parse:(e,t,n)=>ye(e).parse(t,n),serialize:(e,t,n)=>ye(e).serialize(t,n),functions:kh},i=e=>t(e,n);return i.code=e,i}function at(e,...t){return e.reduce(((e,n,r)=>e+n+(t[r]??"")),"")}function ot(e){return`Hello, ${e}! The Morph engine is ready.`}const Oh=e(import.meta.url)("fs");const xh=e(import.meta.url)("path");const Ah=e(import.meta.url)("crypto");var wh=__nccwpck_require__(534);const{DM:Sh,gu:Rh,er:Nh,Ww:Ch,b7:Ih,Di:Lh,a2:Ph,uB:Mh,ef:Fh,c$:Dh,_V:Uh}=wh;const $h=e(import.meta.url)("fs/promises");var jh=class{cacheDir;constructor(e=".compiled"){this.cacheDir=xh.resolve(process.cwd(),e)}async retrieve(e){try{const t=this.getHash(e);const n=xh.join(this.cacheDir,`morph_${t}.js`);if(Oh.existsSync(n)){return Oh.promises.readFile(n,"utf8")}}catch(e){}return null}async save(e,t){try{if(!Oh.existsSync(this.cacheDir)){Oh.mkdirSync(this.cacheDir,{recursive:true})}const n=this.getHash(e);const r=xh.join(this.cacheDir,`morph_${n}.js`);const o=`/* \nQuery:\n${e}\n*/\n\n${t}`;await Oh.promises.writeFile(r,o,"utf8")}catch(e){}}getHash(e){return(0,Ah.createHash)("sha256").update(e).digest("hex").substring(0,12)}};function createLogger(e="text"){const getTimestamp=()=>{const e=new Date;return e.toISOString().split("T")[1].split(".")[0]};const write=(t,n,r)=>{if(e==="json"){const e={ts:(new Date).toISOString(),level:t,msg:n,...r};process.stderr.write(JSON.stringify(e)+"\n")}else{const e=getTimestamp();let o="";if(r){if(r.input&&r.output){o=` ${r.input}  ${r.output}`;if(r.duration!==void 0)o+=` (${r.duration}ms)`}else if(r.processed!==void 0){o=`: ${r.processed} files processed, ${r.errors||0} errors`;if(r.duration!==void 0)o+=` in ${r.duration}ms`}}process.stderr.write(`[${e}] ${t.toUpperCase()}: ${n}${o}\n`)}};return{info(e,t){write("info",e,t)},error(e,t){write("error",e,t)},summary(e){write("info","Summary",e)}}}function resolveQuery(e,t){if(e)return e;if(t){if(!(0,Oh.existsSync)(t)){throw new Error(`Query file not found: ${t}`)}return(0,Oh.readFileSync)(t,"utf8").trim()}throw new Error("Either --query (-q) or --query-file (-Q) must be provided.")}function formatToExtension(e){const t=e.toLowerCase();switch(t){case"json":case"object":return".json";case"xml":return".xml";case"csv":return".csv";case"edifact":return".edi";case"plaintext":return".txt";default:return".json"}}function extractTargetFormat(e){const t=e.match(/to\s+(\w+)/i);return t?t[1]:"json"}function resolveOutputPath(e,t,n,r){const o=xh.relative(t,e);const l=formatToExtension(r);const h=xh.parse(o);return xh.join(n,xh.join(h.dir,h.name+l))}function matchesPattern(e,t){if(e.startsWith(".")&&!t.startsWith(".")){return false}if(t==="*")return true;const n=t.replace(/[.+^${}()|[\]\\]/g,"\\$&");const r=new RegExp(`^${n.replace(/\*/g,".*").replace(/\?/g,".")}$`);return r.test(e)}async function processFile(e){const t=Date.now();const{inputPath:n,outputPath:r,engine:o,doneDir:l,errorDir:h}=e;try{const h=await $h.readFile(n,"utf8");const f=await o(h);const p=xh.dirname(r);if(!(0,Oh.existsSync)(p)){await $h.mkdir(p,{recursive:true})}await $h.writeFile(r,f,"utf8");if(l){if(!(0,Oh.existsSync)(l))await $h.mkdir(l,{recursive:true});const e=xh.join(l,xh.basename(n));await $h.rename(n,e)}else if(e.deleteSource){await $h.unlink(n)}return{success:true,inputPath:n,outputPath:r,duration:Date.now()-t}}catch(e){if(h){try{if(!(0,Oh.existsSync)(h))await $h.mkdir(h,{recursive:true});const e=xh.join(h,xh.basename(n));await $h.rename(n,e)}catch{}}return{success:false,inputPath:n,error:e.message}}}async function batchAction(e){const t=createLogger(e.logFormat);const n=Date.now();try{const{in:r,out:o,pattern:l,cacheDir:h,doneDir:f,errorDir:p}=e;if(!(0,Oh.existsSync)(r)){t.error(`Input directory does not exist: ${r}`);process.exit(1)}const d=xh.resolve(process.cwd(),r);const _=xh.resolve(process.cwd(),o);const m=f?xh.resolve(process.cwd(),f):void 0;const g=p?xh.resolve(process.cwd(),p):void 0;if(!(0,Oh.existsSync)(_))await $h.mkdir(_,{recursive:true});const y=resolveQuery(e.query,e.queryFile);const b=new jh(h);const v=await it(y,{cache:b});const E=extractTargetFormat(y);const k=await $h.readdir(d);const O=k.filter((e=>matchesPattern(e,l)));if(O.length===0){t.info("No files found matching pattern",{pattern:l,in:r});return}t.info(`Starting batch processing of ${O.length} files...`);let x=0;let A=0;for(const n of O){const r=xh.join(d,n);const o=resolveOutputPath(r,d,_,E);const l=await processFile({engine:v,inputPath:r,outputPath:o,doneDir:m,errorDir:g,deleteSource:e.delete});if(l.success){x++;t.info("Transformed",{input:xh.basename(r),output:xh.basename(l.outputPath),duration:l.duration})}else{A++;t.error(l.error||"Unknown error",{input:xh.basename(r)})}}t.summary({processed:x,errors:A,duration:Date.now()-n});if(A>0){process.exit(1)}}catch(e){t.error(`Batch execution failed: ${e.message}`);process.exit(1)}}async function watchAction(e){const t=createLogger(e.logFormat);try{const{in:n,out:r,pattern:o,cacheDir:l,doneDir:h,errorDir:f,pidFile:p}=e;if(!(0,Oh.existsSync)(n)){t.error(`Input directory does not exist: ${n}`);process.exit(1)}const d=xh.resolve(process.cwd(),n);const _=xh.resolve(process.cwd(),r);const m=h?xh.resolve(process.cwd(),h):void 0;const g=f?xh.resolve(process.cwd(),f):void 0;if(!(0,Oh.existsSync)(_))await $h.mkdir(_,{recursive:true});const y=resolveQuery(e.query,e.queryFile);const b=new jh(l);const v=await it(y,{cache:b});const E=extractTargetFormat(y);t.info("Starting initial sweep...");const k=await $h.readdir(d);for(const t of k){if(matchesPattern(t,o)){const n=xh.join(d,t);const r=resolveOutputPath(n,d,_,E);await processFile({engine:v,inputPath:n,outputPath:r,doneDir:m,errorDir:g,deleteSource:e.delete})}}if(p){(0,Oh.writeFileSync)(p,process.pid.toString());t.info(`PID ${process.pid} written to ${p}`)}const cleanup=()=>{if(p&&(0,Oh.existsSync)(p)){(0,Oh.unlinkSync)(p)}t.info("Shutting down watch mode...");process.exit(0)};process.on("SIGINT",cleanup);process.on("SIGTERM",cleanup);t.info(`Watching directory: ${d} [Pattern: ${o}]`);const O=new Map;(0,Oh.watch)(d,{recursive:false},(async(n,r)=>{if(!r||!matchesPattern(r,o))return;const l=xh.join(d,r);const h=O.get(r);if(h)clearTimeout(h);O.set(r,setTimeout((async()=>{O.delete(r);if(!(0,Oh.existsSync)(l))return;const n=await $h.stat(l);if(n.isDirectory())return;const o=resolveOutputPath(l,d,_,E);const h=await processFile({engine:v,inputPath:l,outputPath:o,doneDir:m,errorDir:g,deleteSource:e.delete});if(h.success){t.info("Transformed",{input:r,output:xh.basename(h.outputPath),duration:h.duration})}else{t.error(h.error||"Unknown error",{input:r})}}),100))}))}catch(e){t.error(`Watch execution failed: ${e.message}`);process.exit(1)}}async function readStdin(){const e=[];for await(const t of process.stdin){e.push(t)}return Buffer.concat(e).toString("utf8")}var Bh=new Mh;Bh.name("morphql").description("CLI tool for morphql - transform structural data from the command line.").version("0.1.25");Bh.command("batch").description("Transform all files in a directory").option("-q, --query <string>","MorphQL query string").option("-Q, --query-file <path>","Path to a file containing the MorphQL query").requiredOption("--in <path>","Input directory").requiredOption("--out <path>","Output directory").option("--pattern <glob>","Include pattern for source files","*").option("--done-dir <path>","Move processed files here").option("--error-dir <path>","Move failed files here").option("--delete","Delete source files after successful processing (if --done-dir is missing)").option("--cache-dir <path>","Directory for compiled cache",".compiled").option("--log-format <format>","Log output format: text or json","text").action(batchAction);Bh.command("watch").description("Watch a directory and transform new files").option("-q, --query <string>","MorphQL query string").option("-Q, --query-file <path>","Path to a file containing the MorphQL query").requiredOption("--in <path>","Input directory").requiredOption("--out <path>","Output directory").option("--pattern <glob>","Include pattern for source files","*").option("--done-dir <path>","Move processed files here").option("--error-dir <path>","Move failed files here").option("--delete","Delete source files after successful processing (if --done-dir is missing)").option("--cache-dir <path>","Directory for compiled cache",".compiled").option("--pid-file <path>","Write PID to file for process management").option("--log-format <format>","Log output format: text or json","text").action(watchAction);Bh.option("-f, --from <path>","Path to the source file").option("-i, --input <string>","Raw source content as string").option("-t, --to <path>","Path to the destination file (if omitted, result is printed to stdout)").option("-q, --query <string>","MorphQL query string").option("-Q, --query-file <path>","Path to a file containing the MorphQL query").option("--cache-dir <path>","Directory for compiled cache",".compiled").option("--log-format <format>","Log output format: text or json","text").action((async e=>{if(!e.query&&!e.queryFile){Bh.help();return}const t=createLogger(e.logFormat);try{const{from:n,input:r,to:o,cacheDir:l}=e;const h=resolveQuery(e.query,e.queryFile);let f;if(r){f=r}else if(n){if(!(0,Oh.existsSync)(n)){t.error(`Source file not found: ${n}`);process.exit(1)}f=await $h.readFile(n,"utf8")}else if(!process.stdin.isTTY){f=await readStdin()}else{t.error("Either --from <path>, --input <string>, or pipe data via stdin must be provided.");process.exit(1)}const p=new jh(l);const d=await it(h,{cache:p});const _=await d(f);if(o){const e=xh.dirname(o);if(!(0,Oh.existsSync)(e)){await $h.mkdir(e,{recursive:true})}await $h.writeFile(o,_,"utf8");t.info(`Successfully transformed to ${o}`)}else{process.stdout.write(_+"\n")}}catch(e){t.error(`Error during transformation: ${e.message}`);process.exit(1)}}));Bh.parse();
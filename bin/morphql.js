#!/usr/bin/env node
import{createRequire as e}from"module";var t={54:(e,t,r)=>{e=r.nmd(e);function get_beautify(e,t,r){var beautify=function(t,r){return e.js_beautify(t,r)};beautify.js=e.js_beautify;beautify.css=t.css_beautify;beautify.html=r.html_beautify;beautify.js_beautify=e.js_beautify;beautify.css_beautify=t.css_beautify;beautify.html_beautify=r.html_beautify;return beautify}if(typeof define==="function"&&define.amd){define(["./lib/beautify","./lib/beautify-css","./lib/beautify-html"],(function(e,t,r){return get_beautify(e,t,r)}))}else{(function(e){var t=r(975);t.js_beautify=t.js;t.css_beautify=t.css;t.html_beautify=t.html;e.exports=get_beautify(t,t,t)})(e)}},657:e=>{function Directives(e,t){e=typeof e==="string"?e:e.source;t=typeof t==="string"?t:t.source;this.__directives_block_pattern=new RegExp(e+/ beautify( \w+[:]\w+)+ /.source+t,"g");this.__directive_pattern=/ (\w+)[:](\w+)/g;this.__directives_end_ignore_pattern=new RegExp(e+/\sbeautify\signore:end\s/.source+t,"g")}Directives.prototype.get_directives=function(e){if(!e.match(this.__directives_block_pattern)){return null}var t={};this.__directive_pattern.lastIndex=0;var r=this.__directive_pattern.exec(e);while(r){t[r[1]]=r[2];r=this.__directive_pattern.exec(e)}return t};Directives.prototype.readIgnored=function(e){return e.readUntilAfter(this.__directives_end_ignore_pattern)};e.exports.D=Directives},713:e=>{var t=RegExp.prototype.hasOwnProperty("sticky");function InputScanner(e){this.__input=e||"";this.__input_length=this.__input.length;this.__position=0}InputScanner.prototype.restart=function(){this.__position=0};InputScanner.prototype.back=function(){if(this.__position>0){this.__position-=1}};InputScanner.prototype.hasNext=function(){return this.__position<this.__input_length};InputScanner.prototype.next=function(){var e=null;if(this.hasNext()){e=this.__input.charAt(this.__position);this.__position+=1}return e};InputScanner.prototype.peek=function(e){var t=null;e=e||0;e+=this.__position;if(e>=0&&e<this.__input_length){t=this.__input.charAt(e)}return t};InputScanner.prototype.__match=function(e,r){e.lastIndex=r;var s=e.exec(this.__input);if(s&&!(t&&e.sticky)){if(s.index!==r){s=null}}return s};InputScanner.prototype.test=function(e,t){t=t||0;t+=this.__position;if(t>=0&&t<this.__input_length){return!!this.__match(e,t)}else{return false}};InputScanner.prototype.testChar=function(e,t){var r=this.peek(t);e.lastIndex=0;return r!==null&&e.test(r)};InputScanner.prototype.match=function(e){var t=this.__match(e,this.__position);if(t){this.__position+=t[0].length}else{t=null}return t};InputScanner.prototype.read=function(e,t,r){var s="";var a;if(e){a=this.match(e);if(a){s+=a[0]}}if(t&&(a||!e)){s+=this.readUntil(t,r)}return s};InputScanner.prototype.readUntil=function(e,t){var r="";var s=this.__position;e.lastIndex=this.__position;var a=e.exec(this.__input);if(a){s=a.index;if(t){s+=a[0].length}}else{s=this.__input_length}r=this.__input.substring(this.__position,s);this.__position=s;return r};InputScanner.prototype.readUntilAfter=function(e){return this.readUntil(e,true)};InputScanner.prototype.get_regexp=function(e,r){var s=null;var a="g";if(r&&t){a="y"}if(typeof e==="string"&&e!==""){s=new RegExp(e,a)}else if(e){s=new RegExp(e.source,a)}return s};InputScanner.prototype.get_literal_regexp=function(e){return RegExp(e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"))};InputScanner.prototype.peekUntilAfter=function(e){var t=this.__position;var r=this.readUntilAfter(e);this.__position=t;return r};InputScanner.prototype.lookBack=function(e){var t=this.__position-1;return t>=e.length&&this.__input.substring(t-e.length,t).toLowerCase()===e};e.exports.z=InputScanner},301:e=>{var t;function Options(e,t){this.raw_options=_mergeOpts(e,t);this.disabled=this._get_boolean("disabled");this.eol=this._get_characters("eol","auto");this.end_with_newline=this._get_boolean("end_with_newline");this.indent_size=this._get_number("indent_size",4);this.indent_char=this._get_characters("indent_char"," ");this.indent_level=this._get_number("indent_level");this.preserve_newlines=this._get_boolean("preserve_newlines",true);this.max_preserve_newlines=this._get_number("max_preserve_newlines",32786);if(!this.preserve_newlines){this.max_preserve_newlines=0}this.indent_with_tabs=this._get_boolean("indent_with_tabs",this.indent_char==="\t");if(this.indent_with_tabs){this.indent_char="\t";if(this.indent_size===1){this.indent_size=4}}this.wrap_line_length=this._get_number("wrap_line_length",this._get_number("max_char"));this.indent_empty_lines=this._get_boolean("indent_empty_lines");this.templating=this._get_selection_list("templating",["auto","none","angular","django","erb","handlebars","php","smarty"],["auto"])}Options.prototype._get_array=function(e,t){var r=this.raw_options[e];var s=t||[];if(typeof r==="object"){if(r!==null&&typeof r.concat==="function"){s=r.concat()}}else if(typeof r==="string"){s=r.split(/[^a-zA-Z0-9_\/\-]+/)}return s};Options.prototype._get_boolean=function(e,t){var r=this.raw_options[e];var s=r===undefined?!!t:!!r;return s};Options.prototype._get_characters=function(e,t){var r=this.raw_options[e];var s=t||"";if(typeof r==="string"){s=r.replace(/\\r/,"\r").replace(/\\n/,"\n").replace(/\\t/,"\t")}return s};Options.prototype._get_number=function(e,t){var r=this.raw_options[e];t=parseInt(t,10);if(isNaN(t)){t=0}var s=parseInt(r,10);if(isNaN(s)){s=t}return s};Options.prototype._get_selection=function(e,t,r){var s=this._get_selection_list(e,t,r);if(s.length!==1){throw new Error("Invalid Option Value: The option '"+e+"' can only be one of the following values:\n"+t+"\nYou passed in: '"+this.raw_options[e]+"'")}return s[0]};Options.prototype._get_selection_list=function(e,t,r){if(!t||t.length===0){throw new Error("Selection list cannot be empty.")}r=r||[t[0]];if(!this._is_valid_selection(r,t)){throw new Error("Invalid Default Value!")}var s=this._get_array(e,r);if(!this._is_valid_selection(s,t)){throw new Error("Invalid Option Value: The option '"+e+"' can contain only the following values:\n"+t+"\nYou passed in: '"+this.raw_options[e]+"'")}return s};Options.prototype._is_valid_selection=function(e,t){return e.length&&t.length&&!e.some((function(e){return t.indexOf(e)===-1}))};function _mergeOpts(e,t){var r={};e=_normalizeOpts(e);var s;for(s in e){if(s!==t){r[s]=e[s]}}if(t&&e[t]){for(s in e[t]){r[s]=e[t][s]}}return r}function _normalizeOpts(e){var t={};var r;for(r in e){var s=r.replace(/-/g,"_");t[s]=e[r]}return t}e.exports.JY=Options;t=_normalizeOpts;t=_mergeOpts},498:e=>{function OutputLine(e){this.__parent=e;this.__character_count=0;this.__indent_count=-1;this.__alignment_count=0;this.__wrap_point_index=0;this.__wrap_point_character_count=0;this.__wrap_point_indent_count=-1;this.__wrap_point_alignment_count=0;this.__items=[]}OutputLine.prototype.clone_empty=function(){var e=new OutputLine(this.__parent);e.set_indent(this.__indent_count,this.__alignment_count);return e};OutputLine.prototype.item=function(e){if(e<0){return this.__items[this.__items.length+e]}else{return this.__items[e]}};OutputLine.prototype.has_match=function(e){for(var t=this.__items.length-1;t>=0;t--){if(this.__items[t].match(e)){return true}}return false};OutputLine.prototype.set_indent=function(e,t){if(this.is_empty()){this.__indent_count=e||0;this.__alignment_count=t||0;this.__character_count=this.__parent.get_indent_size(this.__indent_count,this.__alignment_count)}};OutputLine.prototype._set_wrap_point=function(){if(this.__parent.wrap_line_length){this.__wrap_point_index=this.__items.length;this.__wrap_point_character_count=this.__character_count;this.__wrap_point_indent_count=this.__parent.next_line.__indent_count;this.__wrap_point_alignment_count=this.__parent.next_line.__alignment_count}};OutputLine.prototype._should_wrap=function(){return this.__wrap_point_index&&this.__character_count>this.__parent.wrap_line_length&&this.__wrap_point_character_count>this.__parent.next_line.__character_count};OutputLine.prototype._allow_wrap=function(){if(this._should_wrap()){this.__parent.add_new_line();var e=this.__parent.current_line;e.set_indent(this.__wrap_point_indent_count,this.__wrap_point_alignment_count);e.__items=this.__items.slice(this.__wrap_point_index);this.__items=this.__items.slice(0,this.__wrap_point_index);e.__character_count+=this.__character_count-this.__wrap_point_character_count;this.__character_count=this.__wrap_point_character_count;if(e.__items[0]===" "){e.__items.splice(0,1);e.__character_count-=1}return true}return false};OutputLine.prototype.is_empty=function(){return this.__items.length===0};OutputLine.prototype.last=function(){if(!this.is_empty()){return this.__items[this.__items.length-1]}else{return null}};OutputLine.prototype.push=function(e){this.__items.push(e);var t=e.lastIndexOf("\n");if(t!==-1){this.__character_count=e.length-t}else{this.__character_count+=e.length}};OutputLine.prototype.pop=function(){var e=null;if(!this.is_empty()){e=this.__items.pop();this.__character_count-=e.length}return e};OutputLine.prototype._remove_indent=function(){if(this.__indent_count>0){this.__indent_count-=1;this.__character_count-=this.__parent.indent_size}};OutputLine.prototype._remove_wrap_indent=function(){if(this.__wrap_point_indent_count>0){this.__wrap_point_indent_count-=1}};OutputLine.prototype.trim=function(){while(this.last()===" "){this.__items.pop();this.__character_count-=1}};OutputLine.prototype.toString=function(){var e="";if(this.is_empty()){if(this.__parent.indent_empty_lines){e=this.__parent.get_indent_string(this.__indent_count)}}else{e=this.__parent.get_indent_string(this.__indent_count,this.__alignment_count);e+=this.__items.join("")}return e};function IndentStringCache(e,t){this.__cache=[""];this.__indent_size=e.indent_size;this.__indent_string=e.indent_char;if(!e.indent_with_tabs){this.__indent_string=new Array(e.indent_size+1).join(e.indent_char)}t=t||"";if(e.indent_level>0){t=new Array(e.indent_level+1).join(this.__indent_string)}this.__base_string=t;this.__base_string_length=t.length}IndentStringCache.prototype.get_indent_size=function(e,t){var r=this.__base_string_length;t=t||0;if(e<0){r=0}r+=e*this.__indent_size;r+=t;return r};IndentStringCache.prototype.get_indent_string=function(e,t){var r=this.__base_string;t=t||0;if(e<0){e=0;r=""}t+=e*this.__indent_size;this.__ensure_cache(t);r+=this.__cache[t];return r};IndentStringCache.prototype.__ensure_cache=function(e){while(e>=this.__cache.length){this.__add_column()}};IndentStringCache.prototype.__add_column=function(){var e=this.__cache.length;var t=0;var r="";if(this.__indent_size&&e>=this.__indent_size){t=Math.floor(e/this.__indent_size);e-=t*this.__indent_size;r=new Array(t+1).join(this.__indent_string)}if(e){r+=new Array(e+1).join(" ")}this.__cache.push(r)};function Output(e,t){this.__indent_cache=new IndentStringCache(e,t);this.raw=false;this._end_with_newline=e.end_with_newline;this.indent_size=e.indent_size;this.wrap_line_length=e.wrap_line_length;this.indent_empty_lines=e.indent_empty_lines;this.__lines=[];this.previous_line=null;this.current_line=null;this.next_line=new OutputLine(this);this.space_before_token=false;this.non_breaking_space=false;this.previous_token_wrapped=false;this.__add_outputline()}Output.prototype.__add_outputline=function(){this.previous_line=this.current_line;this.current_line=this.next_line.clone_empty();this.__lines.push(this.current_line)};Output.prototype.get_line_number=function(){return this.__lines.length};Output.prototype.get_indent_string=function(e,t){return this.__indent_cache.get_indent_string(e,t)};Output.prototype.get_indent_size=function(e,t){return this.__indent_cache.get_indent_size(e,t)};Output.prototype.is_empty=function(){return!this.previous_line&&this.current_line.is_empty()};Output.prototype.add_new_line=function(e){if(this.is_empty()||!e&&this.just_added_newline()){return false}if(!this.raw){this.__add_outputline()}return true};Output.prototype.get_code=function(e){this.trim(true);var t=this.current_line.pop();if(t){if(t[t.length-1]==="\n"){t=t.replace(/\n+$/g,"")}this.current_line.push(t)}if(this._end_with_newline){this.__add_outputline()}var r=this.__lines.join("\n");if(e!=="\n"){r=r.replace(/[\n]/g,e)}return r};Output.prototype.set_wrap_point=function(){this.current_line._set_wrap_point()};Output.prototype.set_indent=function(e,t){e=e||0;t=t||0;this.next_line.set_indent(e,t);if(this.__lines.length>1){this.current_line.set_indent(e,t);return true}this.current_line.set_indent();return false};Output.prototype.add_raw_token=function(e){for(var t=0;t<e.newlines;t++){this.__add_outputline()}this.current_line.set_indent(-1);this.current_line.push(e.whitespace_before);this.current_line.push(e.text);this.space_before_token=false;this.non_breaking_space=false;this.previous_token_wrapped=false};Output.prototype.add_token=function(e){this.__add_space_before_token();this.current_line.push(e);this.space_before_token=false;this.non_breaking_space=false;this.previous_token_wrapped=this.current_line._allow_wrap()};Output.prototype.__add_space_before_token=function(){if(this.space_before_token&&!this.just_added_newline()){if(!this.non_breaking_space){this.set_wrap_point()}this.current_line.push(" ")}};Output.prototype.remove_indent=function(e){var t=this.__lines.length;while(e<t){this.__lines[e]._remove_indent();e++}this.current_line._remove_wrap_indent()};Output.prototype.trim=function(e){e=e===undefined?false:e;this.current_line.trim();while(e&&this.__lines.length>1&&this.current_line.is_empty()){this.__lines.pop();this.current_line=this.__lines[this.__lines.length-1];this.current_line.trim()}this.previous_line=this.__lines.length>1?this.__lines[this.__lines.length-2]:null};Output.prototype.just_added_newline=function(){return this.current_line.is_empty()};Output.prototype.just_added_blankline=function(){return this.is_empty()||this.current_line.is_empty()&&this.previous_line.is_empty()};Output.prototype.ensure_empty_line_above=function(e,t){var r=this.__lines.length-2;while(r>=0){var s=this.__lines[r];if(s.is_empty()){break}else if(s.item(0).indexOf(e)!==0&&s.item(-1)!==t){this.__lines.splice(r+1,0,new OutputLine(this));this.previous_line=this.__lines[this.__lines.length-2];break}r--}};e.exports.k=Output},569:e=>{function Pattern(e,t){this._input=e;this._starting_pattern=null;this._match_pattern=null;this._until_pattern=null;this._until_after=false;if(t){this._starting_pattern=this._input.get_regexp(t._starting_pattern,true);this._match_pattern=this._input.get_regexp(t._match_pattern,true);this._until_pattern=this._input.get_regexp(t._until_pattern);this._until_after=t._until_after}}Pattern.prototype.read=function(){var e=this._input.read(this._starting_pattern);if(!this._starting_pattern||e){e+=this._input.read(this._match_pattern,this._until_pattern,this._until_after)}return e};Pattern.prototype.read_match=function(){return this._input.match(this._match_pattern)};Pattern.prototype.until_after=function(e){var t=this._create();t._until_after=true;t._until_pattern=this._input.get_regexp(e);t._update();return t};Pattern.prototype.until=function(e){var t=this._create();t._until_after=false;t._until_pattern=this._input.get_regexp(e);t._update();return t};Pattern.prototype.starting_with=function(e){var t=this._create();t._starting_pattern=this._input.get_regexp(e,true);t._update();return t};Pattern.prototype.matching=function(e){var t=this._create();t._match_pattern=this._input.get_regexp(e,true);t._update();return t};Pattern.prototype._create=function(){return new Pattern(this._input,this)};Pattern.prototype._update=function(){};e.exports.z=Pattern},392:(e,t,r)=>{var s=r(569).z;var a={django:false,erb:false,handlebars:false,php:false,smarty:false,angular:false};function TemplatablePattern(e,t){s.call(this,e,t);this.__template_pattern=null;this._disabled=Object.assign({},a);this._excluded=Object.assign({},a);if(t){this.__template_pattern=this._input.get_regexp(t.__template_pattern);this._excluded=Object.assign(this._excluded,t._excluded);this._disabled=Object.assign(this._disabled,t._disabled)}var r=new s(e);this.__patterns={handlebars_comment:r.starting_with(/{{!--/).until_after(/--}}/),handlebars_unescaped:r.starting_with(/{{{/).until_after(/}}}/),handlebars:r.starting_with(/{{/).until_after(/}}/),php:r.starting_with(/<\?(?:[= ]|php)/).until_after(/\?>/),erb:r.starting_with(/<%[^%]/).until_after(/[^%]%>/),django:r.starting_with(/{%/).until_after(/%}/),django_value:r.starting_with(/{{/).until_after(/}}/),django_comment:r.starting_with(/{#/).until_after(/#}/),smarty:r.starting_with(/{(?=[^}{\s\n])/).until_after(/[^\s\n]}/),smarty_comment:r.starting_with(/{\*/).until_after(/\*}/),smarty_literal:r.starting_with(/{literal}/).until_after(/{\/literal}/)}}TemplatablePattern.prototype=new s;TemplatablePattern.prototype._create=function(){return new TemplatablePattern(this._input,this)};TemplatablePattern.prototype._update=function(){this.__set_templated_pattern()};TemplatablePattern.prototype.disable=function(e){var t=this._create();t._disabled[e]=true;t._update();return t};TemplatablePattern.prototype.read_options=function(e){var t=this._create();for(var r in a){t._disabled[r]=e.templating.indexOf(r)===-1}t._update();return t};TemplatablePattern.prototype.exclude=function(e){var t=this._create();t._excluded[e]=true;t._update();return t};TemplatablePattern.prototype.read=function(){var e="";if(this._match_pattern){e=this._input.read(this._starting_pattern)}else{e=this._input.read(this._starting_pattern,this.__template_pattern)}var t=this._read_template();while(t){if(this._match_pattern){t+=this._input.read(this._match_pattern)}else{t+=this._input.readUntil(this.__template_pattern)}e+=t;t=this._read_template()}if(this._until_after){e+=this._input.readUntilAfter(this._until_pattern)}return e};TemplatablePattern.prototype.__set_templated_pattern=function(){var e=[];if(!this._disabled.php){e.push(this.__patterns.php._starting_pattern.source)}if(!this._disabled.handlebars){e.push(this.__patterns.handlebars._starting_pattern.source)}if(!this._disabled.angular){e.push(this.__patterns.handlebars._starting_pattern.source)}if(!this._disabled.erb){e.push(this.__patterns.erb._starting_pattern.source)}if(!this._disabled.django){e.push(this.__patterns.django._starting_pattern.source);e.push(this.__patterns.django_value._starting_pattern.source);e.push(this.__patterns.django_comment._starting_pattern.source)}if(!this._disabled.smarty){e.push(this.__patterns.smarty._starting_pattern.source)}if(this._until_pattern){e.push(this._until_pattern.source)}this.__template_pattern=this._input.get_regexp("(?:"+e.join("|")+")")};TemplatablePattern.prototype._read_template=function(){var e="";var t=this._input.peek();if(t==="<"){var r=this._input.peek(1);if(!this._disabled.php&&!this._excluded.php&&r==="?"){e=e||this.__patterns.php.read()}if(!this._disabled.erb&&!this._excluded.erb&&r==="%"){e=e||this.__patterns.erb.read()}}else if(t==="{"){if(!this._disabled.handlebars&&!this._excluded.handlebars){e=e||this.__patterns.handlebars_comment.read();e=e||this.__patterns.handlebars_unescaped.read();e=e||this.__patterns.handlebars.read()}if(!this._disabled.django){if(!this._excluded.django&&!this._excluded.handlebars){e=e||this.__patterns.django_value.read()}if(!this._excluded.django){e=e||this.__patterns.django_comment.read();e=e||this.__patterns.django.read()}}if(!this._disabled.smarty){if(this._disabled.django&&this._disabled.handlebars){e=e||this.__patterns.smarty_comment.read();e=e||this.__patterns.smarty_literal.read();e=e||this.__patterns.smarty.read()}}}return e};e.exports.i=TemplatablePattern},658:e=>{function Token(e,t,r,s){this.type=e;this.text=t;this.comments_before=null;this.newlines=r||0;this.whitespace_before=s||"";this.parent=null;this.next=null;this.previous=null;this.opened=null;this.closed=null;this.directives=null}e.exports.o=Token},170:(e,t,r)=>{var s=r(713).z;var a=r(658).o;var u=r(914).e;var l=r(974).g;var h={START:"TK_START",RAW:"TK_RAW",EOF:"TK_EOF"};var Tokenizer=function(e,t){this._input=new s(e);this._options=t||{};this.__tokens=null;this._patterns={};this._patterns.whitespace=new l(this._input)};Tokenizer.prototype.tokenize=function(){this._input.restart();this.__tokens=new u;this._reset();var e;var t=new a(h.START,"");var r=null;var s=[];var l=new u;while(t.type!==h.EOF){e=this._get_next_token(t,r);while(this._is_comment(e)){l.add(e);e=this._get_next_token(t,r)}if(!l.isEmpty()){e.comments_before=l;l=new u}e.parent=r;if(this._is_opening(e)){s.push(r);r=e}else if(r&&this._is_closing(e,r)){e.opened=r;r.closed=e;r=s.pop();e.parent=r}e.previous=t;t.next=e;this.__tokens.add(e);t=e}return this.__tokens};Tokenizer.prototype._is_first_token=function(){return this.__tokens.isEmpty()};Tokenizer.prototype._reset=function(){};Tokenizer.prototype._get_next_token=function(e,t){this._readWhitespace();var r=this._input.read(/.+/g);if(r){return this._create_token(h.RAW,r)}else{return this._create_token(h.EOF,"")}};Tokenizer.prototype._is_comment=function(e){return false};Tokenizer.prototype._is_opening=function(e){return false};Tokenizer.prototype._is_closing=function(e,t){return false};Tokenizer.prototype._create_token=function(e,t){var r=new a(e,t,this._patterns.whitespace.newline_count,this._patterns.whitespace.whitespace_before_token);return r};Tokenizer.prototype._readWhitespace=function(){return this._patterns.whitespace.read()};e.exports._=Tokenizer;e.exports.C=h},914:e=>{function TokenStream(e){this.__tokens=[];this.__tokens_length=this.__tokens.length;this.__position=0;this.__parent_token=e}TokenStream.prototype.restart=function(){this.__position=0};TokenStream.prototype.isEmpty=function(){return this.__tokens_length===0};TokenStream.prototype.hasNext=function(){return this.__position<this.__tokens_length};TokenStream.prototype.next=function(){var e=null;if(this.hasNext()){e=this.__tokens[this.__position];this.__position+=1}return e};TokenStream.prototype.peek=function(e){var t=null;e=e||0;e+=this.__position;if(e>=0&&e<this.__tokens_length){t=this.__tokens[e]}return t};TokenStream.prototype.add=function(e){if(this.__parent_token){e.parent=this.__parent_token}this.__tokens.push(e);this.__tokens_length+=1};e.exports.e=TokenStream},974:(e,t,r)=>{var s=r(569).z;function WhitespacePattern(e,t){s.call(this,e,t);if(t){this._line_regexp=this._input.get_regexp(t._line_regexp)}else{this.__set_whitespace_patterns("","")}this.newline_count=0;this.whitespace_before_token=""}WhitespacePattern.prototype=new s;WhitespacePattern.prototype.__set_whitespace_patterns=function(e,t){e+="\\t ";t+="\\n\\r";this._match_pattern=this._input.get_regexp("["+e+t+"]+",true);this._newline_regexp=this._input.get_regexp("\\r\\n|["+t+"]")};WhitespacePattern.prototype.read=function(){this.newline_count=0;this.whitespace_before_token="";var e=this._input.read(this._match_pattern);if(e===" "){this.whitespace_before_token=" "}else if(e){var t=this.__split(this._newline_regexp,e);this.newline_count=t.length-1;this.whitespace_before_token=t[this.newline_count]}return e};WhitespacePattern.prototype.matching=function(e,t){var r=this._create();r.__set_whitespace_patterns(e,t);r._update();return r};WhitespacePattern.prototype._create=function(){return new WhitespacePattern(this._input,this)};WhitespacePattern.prototype.__split=function(e,t){e.lastIndex=0;var r=0;var s=[];var a=e.exec(t);while(a){s.push(t.substring(r,a.index));r=a.index+a[0].length;a=e.exec(t)}if(r<t.length){s.push(t.substring(r,t.length))}else{s.push("")}return s};e.exports.g=WhitespacePattern},481:(e,t,r)=>{var s=r(221).J;var a=r(498).k;var u=r(713).z;var l=r(657).D;var h=new l(/\/\*/,/\*\//);var f=/\r\n|[\r\n]/;var d=/\r\n|[\r\n]/g;var _=/\s/;var m=/(?:\s|\n)+/g;var g=/\/\*(?:[\s\S]*?)((?:\*\/)|$)/g;var y=/\/\/(?:[^\n\r\u2028\u2029]*)/g;function Beautifier(e,t){this._source_text=e||"";this._options=new s(t);this._ch=null;this._input=null;this.NESTED_AT_RULE={page:true,"font-face":true,keyframes:true,media:true,supports:true,document:true};this.CONDITIONAL_GROUP_RULE={media:true,supports:true,document:true};this.NON_SEMICOLON_NEWLINE_PROPERTY=["grid-template-areas","grid-template"]}Beautifier.prototype.eatString=function(e){var t="";this._ch=this._input.next();while(this._ch){t+=this._ch;if(this._ch==="\\"){t+=this._input.next()}else if(e.indexOf(this._ch)!==-1||this._ch==="\n"){break}this._ch=this._input.next()}return t};Beautifier.prototype.eatWhitespace=function(e){var t=_.test(this._input.peek());var r=0;while(_.test(this._input.peek())){this._ch=this._input.next();if(e&&this._ch==="\n"){if(r===0||r<this._options.max_preserve_newlines){r++;this._output.add_new_line(true)}}}return t};Beautifier.prototype.foundNestedPseudoClass=function(){var e=0;var t=1;var r=this._input.peek(t);while(r){if(r==="{"){return true}else if(r==="("){e+=1}else if(r===")"){if(e===0){return false}e-=1}else if(r===";"||r==="}"){return false}t++;r=this._input.peek(t)}return false};Beautifier.prototype.print_string=function(e){this._output.set_indent(this._indentLevel);this._output.non_breaking_space=true;this._output.add_token(e)};Beautifier.prototype.preserveSingleSpace=function(e){if(e){this._output.space_before_token=true}};Beautifier.prototype.indent=function(){this._indentLevel++};Beautifier.prototype.outdent=function(){if(this._indentLevel>0){this._indentLevel--}};Beautifier.prototype.beautify=function(){if(this._options.disabled){return this._source_text}var e=this._source_text;var t=this._options.eol;if(t==="auto"){t="\n";if(e&&f.test(e||"")){t=e.match(f)[0]}}e=e.replace(d,"\n");var r=e.match(/^[\t ]*/)[0];this._output=new a(this._options,r);this._input=new u(e);this._indentLevel=0;this._nestedLevel=0;this._ch=null;var s=0;var l=false;var b=false;var v=false;var E=false;var T=false;var k=this._ch;var x=false;var O;var A;var w;while(true){O=this._input.read(m);A=O!=="";w=k;this._ch=this._input.next();if(this._ch==="\\"&&this._input.hasNext()){this._ch+=this._input.next()}k=this._ch;if(!this._ch){break}else if(this._ch==="/"&&this._input.peek()==="*"){this._output.add_new_line();this._input.back();var S=this._input.read(g);var R=h.get_directives(S);if(R&&R.ignore==="start"){S+=h.readIgnored(this._input)}this.print_string(S);this.eatWhitespace(true);this._output.add_new_line()}else if(this._ch==="/"&&this._input.peek()==="/"){this._output.space_before_token=true;this._input.back();this.print_string(this._input.read(y));this.eatWhitespace(true)}else if(this._ch==="$"){this.preserveSingleSpace(A);this.print_string(this._ch);var C=this._input.peekUntilAfter(/[: ,;{}()[\]\/='"]/g);if(C.match(/[ :]$/)){C=this.eatString(": ").replace(/\s+$/,"");this.print_string(C);this._output.space_before_token=true}if(s===0&&C.indexOf(":")!==-1){b=true;this.indent()}}else if(this._ch==="@"){this.preserveSingleSpace(A);if(this._input.peek()==="{"){this.print_string(this._ch+this.eatString("}"))}else{this.print_string(this._ch);var I=this._input.peekUntilAfter(/[: ,;{}()[\]\/='"]/g);if(I.match(/[ :]$/)){I=this.eatString(": ").replace(/\s+$/,"");this.print_string(I);this._output.space_before_token=true}if(s===0&&I.indexOf(":")!==-1){b=true;this.indent()}else if(I in this.NESTED_AT_RULE){this._nestedLevel+=1;if(I in this.CONDITIONAL_GROUP_RULE){v=true}}else if(s===0&&!b){E=true}}}else if(this._ch==="#"&&this._input.peek()==="{"){this.preserveSingleSpace(A);this.print_string(this._ch+this.eatString("}"))}else if(this._ch==="{"){if(b){b=false;this.outdent()}E=false;if(v){v=false;l=this._indentLevel>=this._nestedLevel}else{l=this._indentLevel>=this._nestedLevel-1}if(this._options.newline_between_rules&&l){if(this._output.previous_line&&this._output.previous_line.item(-1)!=="{"){this._output.ensure_empty_line_above("/",",")}}this._output.space_before_token=true;if(this._options.brace_style==="expand"){this._output.add_new_line();this.print_string(this._ch);this.indent();this._output.set_indent(this._indentLevel)}else{if(w==="("){this._output.space_before_token=false}else if(w!==","){this.indent()}this.print_string(this._ch)}this.eatWhitespace(true);this._output.add_new_line()}else if(this._ch==="}"){this.outdent();this._output.add_new_line();if(w==="{"){this._output.trim(true)}if(b){this.outdent();b=false}this.print_string(this._ch);l=false;if(this._nestedLevel){this._nestedLevel--}this.eatWhitespace(true);this._output.add_new_line();if(this._options.newline_between_rules&&!this._output.just_added_blankline()){if(this._input.peek()!=="}"){this._output.add_new_line(true)}}if(this._input.peek()===")"){this._output.trim(true);if(this._options.brace_style==="expand"){this._output.add_new_line(true)}}}else if(this._ch===":"){for(var L=0;L<this.NON_SEMICOLON_NEWLINE_PROPERTY.length;L++){if(this._input.lookBack(this.NON_SEMICOLON_NEWLINE_PROPERTY[L])){x=true;break}}if((l||v)&&!(this._input.lookBack("&")||this.foundNestedPseudoClass())&&!this._input.lookBack("(")&&!E&&s===0){this.print_string(":");if(!b){b=true;this._output.space_before_token=true;this.eatWhitespace(true);this.indent()}}else{if(this._input.lookBack(" ")){this._output.space_before_token=true}if(this._input.peek()===":"){this._ch=this._input.next();this.print_string("::")}else{this.print_string(":")}}}else if(this._ch==='"'||this._ch==="'"){var P=w==='"'||w==="'";this.preserveSingleSpace(P||A);this.print_string(this._ch+this.eatString(this._ch));this.eatWhitespace(true)}else if(this._ch===";"){x=false;if(s===0){if(b){this.outdent();b=false}E=false;this.print_string(this._ch);this.eatWhitespace(true);if(this._input.peek()!=="/"){this._output.add_new_line()}}else{this.print_string(this._ch);this.eatWhitespace(true);this._output.space_before_token=true}}else if(this._ch==="("){if(this._input.lookBack("url")){this.print_string(this._ch);this.eatWhitespace();s++;this.indent();this._ch=this._input.next();if(this._ch===")"||this._ch==='"'||this._ch==="'"){this._input.back()}else if(this._ch){this.print_string(this._ch+this.eatString(")"));if(s){s--;this.outdent()}}}else{var M=false;if(this._input.lookBack("with")){M=true}this.preserveSingleSpace(A||M);this.print_string(this._ch);if(b&&w==="$"&&this._options.selector_separator_newline){this._output.add_new_line();T=true}else{this.eatWhitespace();s++;this.indent()}}}else if(this._ch===")"){if(s){s--;this.outdent()}if(T&&this._input.peek()===";"&&this._options.selector_separator_newline){T=false;this.outdent();this._output.add_new_line()}this.print_string(this._ch)}else if(this._ch===","){this.print_string(this._ch);this.eatWhitespace(true);if(this._options.selector_separator_newline&&(!b||T)&&s===0&&!E){this._output.add_new_line()}else{this._output.space_before_token=true}}else if((this._ch===">"||this._ch==="+"||this._ch==="~")&&!b&&s===0){if(this._options.space_around_combinator){this._output.space_before_token=true;this.print_string(this._ch);this._output.space_before_token=true}else{this.print_string(this._ch);this.eatWhitespace();if(this._ch&&_.test(this._ch)){this._ch=""}}}else if(this._ch==="]"){this.print_string(this._ch)}else if(this._ch==="["){this.preserveSingleSpace(A);this.print_string(this._ch)}else if(this._ch==="="){this.eatWhitespace();this.print_string("=");if(_.test(this._ch)){this._ch=""}}else if(this._ch==="!"&&!this._input.lookBack("\\")){this._output.space_before_token=true;this.print_string(this._ch)}else{var F=w==='"'||w==="'";this.preserveSingleSpace(F||A);this.print_string(this._ch);if(!this._output.just_added_newline()&&this._input.peek()==="\n"&&x){this._output.add_new_line()}}}var D=this._output.get_code(t);return D};e.exports.P=Beautifier},295:(e,t,r)=>{var s=r(481).P,a=r(221).J;function css_beautify(e,t){var r=new s(e,t);return r.beautify()}e.exports=css_beautify;e.exports.defaultOptions=function(){return new a}},221:(e,t,r)=>{var s=r(301).JY;function Options(e){s.call(this,e,"css");this.selector_separator_newline=this._get_boolean("selector_separator_newline",true);this.newline_between_rules=this._get_boolean("newline_between_rules",true);var t=this._get_boolean("space_around_selector_separator");this.space_around_combinator=this._get_boolean("space_around_combinator")||t;var r=this._get_selection_list("brace_style",["collapse","expand","end-expand","none","preserve-inline"]);this.brace_style="collapse";for(var a=0;a<r.length;a++){if(r[a]!=="expand"){this.brace_style="collapse"}else{this.brace_style=r[a]}}}Options.prototype=new s;e.exports.J=Options},327:(e,t,r)=>{var s=r(83).J;var a=r(498).k;var u=r(772)._;var l=r(772).C;var h=/\r\n|[\r\n]/;var f=/\r\n|[\r\n]/g;var Printer=function(e,t){this.indent_level=0;this.alignment_size=0;this.max_preserve_newlines=e.max_preserve_newlines;this.preserve_newlines=e.preserve_newlines;this._output=new a(e,t)};Printer.prototype.current_line_has_match=function(e){return this._output.current_line.has_match(e)};Printer.prototype.set_space_before_token=function(e,t){this._output.space_before_token=e;this._output.non_breaking_space=t};Printer.prototype.set_wrap_point=function(){this._output.set_indent(this.indent_level,this.alignment_size);this._output.set_wrap_point()};Printer.prototype.add_raw_token=function(e){this._output.add_raw_token(e)};Printer.prototype.print_preserved_newlines=function(e){var t=0;if(e.type!==l.TEXT&&e.previous.type!==l.TEXT){t=e.newlines?1:0}if(this.preserve_newlines){t=e.newlines<this.max_preserve_newlines+1?e.newlines:this.max_preserve_newlines+1}for(var r=0;r<t;r++){this.print_newline(r>0)}return t!==0};Printer.prototype.traverse_whitespace=function(e){if(e.whitespace_before||e.newlines){if(!this.print_preserved_newlines(e)){this._output.space_before_token=true}return true}return false};Printer.prototype.previous_token_wrapped=function(){return this._output.previous_token_wrapped};Printer.prototype.print_newline=function(e){this._output.add_new_line(e)};Printer.prototype.print_token=function(e){if(e.text){this._output.set_indent(this.indent_level,this.alignment_size);this._output.add_token(e.text)}};Printer.prototype.indent=function(){this.indent_level++};Printer.prototype.deindent=function(){if(this.indent_level>0){this.indent_level--;this._output.set_indent(this.indent_level,this.alignment_size)}};Printer.prototype.get_full_indent=function(e){e=this.indent_level+(e||0);if(e<1){return""}return this._output.get_indent_string(e)};var get_type_attribute=function(e){var t=null;var r=e.next;while(r.type!==l.EOF&&e.closed!==r){if(r.type===l.ATTRIBUTE&&r.text==="type"){if(r.next&&r.next.type===l.EQUALS&&r.next.next&&r.next.next.type===l.VALUE){t=r.next.next.text}break}r=r.next}return t};var get_custom_beautifier_name=function(e,t){var r=null;var s=null;if(!t.closed){return null}if(e==="script"){r="text/javascript"}else if(e==="style"){r="text/css"}r=get_type_attribute(t)||r;if(r.search("text/css")>-1){s="css"}else if(r.search(/module|((text|application|dojo)\/(x-)?(javascript|ecmascript|jscript|livescript|(ld\+)?json|method|aspect))/)>-1){s="javascript"}else if(r.search(/(text|application|dojo)\/(x-)?(html)/)>-1){s="html"}else if(r.search(/test\/null/)>-1){s="null"}return s};function in_array(e,t){return t.indexOf(e)!==-1}function TagFrame(e,t,r){this.parent=e||null;this.tag=t?t.tag_name:"";this.indent_level=r||0;this.parser_token=t||null}function TagStack(e){this._printer=e;this._current_frame=null}TagStack.prototype.get_parser_token=function(){return this._current_frame?this._current_frame.parser_token:null};TagStack.prototype.record_tag=function(e){var t=new TagFrame(this._current_frame,e,this._printer.indent_level);this._current_frame=t};TagStack.prototype._try_pop_frame=function(e){var t=null;if(e){t=e.parser_token;this._printer.indent_level=e.indent_level;this._current_frame=e.parent}return t};TagStack.prototype._get_frame=function(e,t){var r=this._current_frame;while(r){if(e.indexOf(r.tag)!==-1){break}else if(t&&t.indexOf(r.tag)!==-1){r=null;break}r=r.parent}return r};TagStack.prototype.try_pop=function(e,t){var r=this._get_frame([e],t);return this._try_pop_frame(r)};TagStack.prototype.indent_to_tag=function(e){var t=this._get_frame(e);if(t){this._printer.indent_level=t.indent_level}};function Beautifier(e,t,r,a){this._source_text=e||"";t=t||{};this._js_beautify=r;this._css_beautify=a;this._tag_stack=null;var u=new s(t,"html");this._options=u;this._is_wrap_attributes_force=this._options.wrap_attributes.substr(0,"force".length)==="force";this._is_wrap_attributes_force_expand_multiline=this._options.wrap_attributes==="force-expand-multiline";this._is_wrap_attributes_force_aligned=this._options.wrap_attributes==="force-aligned";this._is_wrap_attributes_aligned_multiple=this._options.wrap_attributes==="aligned-multiple";this._is_wrap_attributes_preserve=this._options.wrap_attributes.substr(0,"preserve".length)==="preserve";this._is_wrap_attributes_preserve_aligned=this._options.wrap_attributes==="preserve-aligned"}Beautifier.prototype.beautify=function(){if(this._options.disabled){return this._source_text}var e=this._source_text;var t=this._options.eol;if(this._options.eol==="auto"){t="\n";if(e&&h.test(e)){t=e.match(h)[0]}}e=e.replace(f,"\n");var r=e.match(/^[\t ]*/)[0];var s={text:"",type:""};var a=new TagOpenParserToken(this._options);var d=new Printer(this._options,r);var _=new u(e,this._options).tokenize();this._tag_stack=new TagStack(d);var m=null;var g=_.next();while(g.type!==l.EOF){if(g.type===l.TAG_OPEN||g.type===l.COMMENT){m=this._handle_tag_open(d,g,a,s,_);a=m}else if(g.type===l.ATTRIBUTE||g.type===l.EQUALS||g.type===l.VALUE||g.type===l.TEXT&&!a.tag_complete){m=this._handle_inside_tag(d,g,a,s)}else if(g.type===l.TAG_CLOSE){m=this._handle_tag_close(d,g,a)}else if(g.type===l.TEXT){m=this._handle_text(d,g,a)}else if(g.type===l.CONTROL_FLOW_OPEN){m=this._handle_control_flow_open(d,g)}else if(g.type===l.CONTROL_FLOW_CLOSE){m=this._handle_control_flow_close(d,g)}else{d.add_raw_token(g)}s=m;g=_.next()}var y=d._output.get_code(t);return y};Beautifier.prototype._handle_control_flow_open=function(e,t){var r={text:t.text,type:t.type};e.set_space_before_token(t.newlines||t.whitespace_before!=="",true);if(t.newlines){e.print_preserved_newlines(t)}else{e.set_space_before_token(t.newlines||t.whitespace_before!=="",true)}e.print_token(t);e.indent();return r};Beautifier.prototype._handle_control_flow_close=function(e,t){var r={text:t.text,type:t.type};e.deindent();if(t.newlines){e.print_preserved_newlines(t)}else{e.set_space_before_token(t.newlines||t.whitespace_before!=="",true)}e.print_token(t);return r};Beautifier.prototype._handle_tag_close=function(e,t,r){var s={text:t.text,type:t.type};e.alignment_size=0;r.tag_complete=true;e.set_space_before_token(t.newlines||t.whitespace_before!=="",true);if(r.is_unformatted){e.add_raw_token(t)}else{if(r.tag_start_char==="<"){e.set_space_before_token(t.text[0]==="/",true);if(this._is_wrap_attributes_force_expand_multiline&&r.has_wrapped_attrs){e.print_newline(false)}}e.print_token(t)}if(r.indent_content&&!(r.is_unformatted||r.is_content_unformatted)){e.indent();r.indent_content=false}if(!r.is_inline_element&&!(r.is_unformatted||r.is_content_unformatted)){e.set_wrap_point()}return s};Beautifier.prototype._handle_inside_tag=function(e,t,r,s){var a=r.has_wrapped_attrs;var u={text:t.text,type:t.type};e.set_space_before_token(t.newlines||t.whitespace_before!=="",true);if(r.is_unformatted){e.add_raw_token(t)}else if(r.tag_start_char==="{"&&t.type===l.TEXT){if(e.print_preserved_newlines(t)){t.newlines=0;e.add_raw_token(t)}else{e.print_token(t)}}else{if(t.type===l.ATTRIBUTE){e.set_space_before_token(true)}else if(t.type===l.EQUALS){e.set_space_before_token(false)}else if(t.type===l.VALUE&&t.previous.type===l.EQUALS){e.set_space_before_token(false)}if(t.type===l.ATTRIBUTE&&r.tag_start_char==="<"){if(this._is_wrap_attributes_preserve||this._is_wrap_attributes_preserve_aligned){e.traverse_whitespace(t);a=a||t.newlines!==0}if(this._is_wrap_attributes_force&&r.attr_count>=this._options.wrap_attributes_min_attrs&&(s.type!==l.TAG_OPEN||this._is_wrap_attributes_force_expand_multiline)){e.print_newline(false);a=true}}e.print_token(t);a=a||e.previous_token_wrapped();r.has_wrapped_attrs=a}return u};Beautifier.prototype._handle_text=function(e,t,r){var s={text:t.text,type:"TK_CONTENT"};if(r.custom_beautifier_name){this._print_custom_beatifier_text(e,t,r)}else if(r.is_unformatted||r.is_content_unformatted){e.add_raw_token(t)}else{e.traverse_whitespace(t);e.print_token(t)}return s};Beautifier.prototype._print_custom_beatifier_text=function(e,t,r){var s=this;if(t.text!==""){var a=t.text,u,l=1,h="",f="";if(r.custom_beautifier_name==="javascript"&&typeof this._js_beautify==="function"){u=this._js_beautify}else if(r.custom_beautifier_name==="css"&&typeof this._css_beautify==="function"){u=this._css_beautify}else if(r.custom_beautifier_name==="html"){u=function(e,t){var r=new Beautifier(e,t,s._js_beautify,s._css_beautify);return r.beautify()}}if(this._options.indent_scripts==="keep"){l=0}else if(this._options.indent_scripts==="separate"){l=-e.indent_level}var d=e.get_full_indent(l);a=a.replace(/\n[ \t]*$/,"");if(r.custom_beautifier_name!=="html"&&a[0]==="<"&&a.match(/^(<!--|<!\[CDATA\[)/)){var _=/^(<!--[^\n]*|<!\[CDATA\[)(\n?)([ \t\n]*)([\s\S]*)(-->|]]>)$/.exec(a);if(!_){e.add_raw_token(t);return}h=d+_[1]+"\n";a=_[4];if(_[5]){f=d+_[5]}a=a.replace(/\n[ \t]*$/,"");if(_[2]||_[3].indexOf("\n")!==-1){_=_[3].match(/[ \t]+$/);if(_){t.whitespace_before=_[0]}}}if(a){if(u){var Child_options=function(){this.eol="\n"};Child_options.prototype=this._options.raw_options;var m=new Child_options;a=u(d+a,m)}else{var g=t.whitespace_before;if(g){a=a.replace(new RegExp("\n("+g+")?","g"),"\n")}a=d+a.replace(/\n/g,"\n"+d)}}if(h){if(!a){a=h+f}else{a=h+a+"\n"+f}}e.print_newline(false);if(a){t.text=a;t.whitespace_before="";t.newlines=0;e.add_raw_token(t);e.print_newline(true)}}};Beautifier.prototype._handle_tag_open=function(e,t,r,s,a){var u=this._get_tag_open_token(t);if((r.is_unformatted||r.is_content_unformatted)&&!r.is_empty_element&&t.type===l.TAG_OPEN&&!u.is_start_tag){e.add_raw_token(t);u.start_tag_token=this._tag_stack.try_pop(u.tag_name)}else{e.traverse_whitespace(t);this._set_tag_position(e,t,u,r,s);if(!u.is_inline_element){e.set_wrap_point()}e.print_token(t)}if(u.is_start_tag&&this._is_wrap_attributes_force){var h=0;var f;do{f=a.peek(h);if(f.type===l.ATTRIBUTE){u.attr_count+=1}h+=1}while(f.type!==l.EOF&&f.type!==l.TAG_CLOSE)}if(this._is_wrap_attributes_force_aligned||this._is_wrap_attributes_aligned_multiple||this._is_wrap_attributes_preserve_aligned){u.alignment_size=t.text.length+1}if(!u.tag_complete&&!u.is_unformatted){e.alignment_size=u.alignment_size}return u};var TagOpenParserToken=function(e,t,r){this.parent=t||null;this.text="";this.type="TK_TAG_OPEN";this.tag_name="";this.is_inline_element=false;this.is_unformatted=false;this.is_content_unformatted=false;this.is_empty_element=false;this.is_start_tag=false;this.is_end_tag=false;this.indent_content=false;this.multiline_content=false;this.custom_beautifier_name=null;this.start_tag_token=null;this.attr_count=0;this.has_wrapped_attrs=false;this.alignment_size=0;this.tag_complete=false;this.tag_start_char="";this.tag_check="";if(!r){this.tag_complete=true}else{var s;this.tag_start_char=r.text[0];this.text=r.text;if(this.tag_start_char==="<"){s=r.text.match(/^<([^\s>]*)/);this.tag_check=s?s[1]:""}else{s=r.text.match(/^{{~?(?:[\^]|#\*?)?([^\s}]+)/);this.tag_check=s?s[1]:"";if((r.text.startsWith("{{#>")||r.text.startsWith("{{~#>"))&&this.tag_check[0]===">"){if(this.tag_check===">"&&r.next!==null){this.tag_check=r.next.text.split(" ")[0]}else{this.tag_check=r.text.split(">")[1]}}}this.tag_check=this.tag_check.toLowerCase();if(r.type===l.COMMENT){this.tag_complete=true}this.is_start_tag=this.tag_check.charAt(0)!=="/";this.tag_name=!this.is_start_tag?this.tag_check.substr(1):this.tag_check;this.is_end_tag=!this.is_start_tag||r.closed&&r.closed.text==="/>";var a=2;if(this.tag_start_char==="{"&&this.text.length>=3){if(this.text.charAt(2)==="~"){a=3}}this.is_end_tag=this.is_end_tag||this.tag_start_char==="{"&&(!e.indent_handlebars||this.text.length<3||/[^#\^]/.test(this.text.charAt(a)))}};Beautifier.prototype._get_tag_open_token=function(e){var t=new TagOpenParserToken(this._options,this._tag_stack.get_parser_token(),e);t.alignment_size=this._options.wrap_attributes_indent_size;t.is_end_tag=t.is_end_tag||in_array(t.tag_check,this._options.void_elements);t.is_empty_element=t.tag_complete||t.is_start_tag&&t.is_end_tag;t.is_unformatted=!t.tag_complete&&in_array(t.tag_check,this._options.unformatted);t.is_content_unformatted=!t.is_empty_element&&in_array(t.tag_check,this._options.content_unformatted);t.is_inline_element=in_array(t.tag_name,this._options.inline)||this._options.inline_custom_elements&&t.tag_name.includes("-")||t.tag_start_char==="{";return t};Beautifier.prototype._set_tag_position=function(e,t,r,s,a){if(!r.is_empty_element){if(r.is_end_tag){r.start_tag_token=this._tag_stack.try_pop(r.tag_name)}else{if(this._do_optional_end_element(r)){if(!r.is_inline_element){e.print_newline(false)}}this._tag_stack.record_tag(r);if((r.tag_name==="script"||r.tag_name==="style")&&!(r.is_unformatted||r.is_content_unformatted)){r.custom_beautifier_name=get_custom_beautifier_name(r.tag_check,t)}}}if(in_array(r.tag_check,this._options.extra_liners)){e.print_newline(false);if(!e._output.just_added_blankline()){e.print_newline(true)}}if(r.is_empty_element){if(r.tag_start_char==="{"&&r.tag_check==="else"){this._tag_stack.indent_to_tag(["if","unless","each"]);r.indent_content=true;var u=e.current_line_has_match(/{{#if/);if(!u){e.print_newline(false)}}if(r.tag_name==="!--"&&a.type===l.TAG_CLOSE&&s.is_end_tag&&r.text.indexOf("\n")===-1){}else{if(!(r.is_inline_element||r.is_unformatted)){e.print_newline(false)}this._calcluate_parent_multiline(e,r)}}else if(r.is_end_tag){var h=false;h=r.start_tag_token&&r.start_tag_token.multiline_content;h=h||!r.is_inline_element&&!(s.is_inline_element||s.is_unformatted)&&!(a.type===l.TAG_CLOSE&&r.start_tag_token===s)&&a.type!=="TK_CONTENT";if(r.is_content_unformatted||r.is_unformatted){h=false}if(h){e.print_newline(false)}}else{r.indent_content=!r.custom_beautifier_name;if(r.tag_start_char==="<"){if(r.tag_name==="html"){r.indent_content=this._options.indent_inner_html}else if(r.tag_name==="head"){r.indent_content=this._options.indent_head_inner_html}else if(r.tag_name==="body"){r.indent_content=this._options.indent_body_inner_html}}if(!(r.is_inline_element||r.is_unformatted)&&(a.type!=="TK_CONTENT"||r.is_content_unformatted)){e.print_newline(false)}this._calcluate_parent_multiline(e,r)}};Beautifier.prototype._calcluate_parent_multiline=function(e,t){if(t.parent&&e._output.just_added_newline()&&!((t.is_inline_element||t.is_unformatted)&&t.parent.is_inline_element)){t.parent.multiline_content=true}};var d=["address","article","aside","blockquote","details","div","dl","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hr","main","menu","nav","ol","p","pre","section","table","ul"];var _=["a","audio","del","ins","map","noscript","video"];Beautifier.prototype._do_optional_end_element=function(e){var t=null;if(e.is_empty_element||!e.is_start_tag||!e.parent){return}if(e.tag_name==="body"){t=t||this._tag_stack.try_pop("head")}else if(e.tag_name==="li"){t=t||this._tag_stack.try_pop("li",["ol","ul","menu"])}else if(e.tag_name==="dd"||e.tag_name==="dt"){t=t||this._tag_stack.try_pop("dt",["dl"]);t=t||this._tag_stack.try_pop("dd",["dl"])}else if(e.parent.tag_name==="p"&&d.indexOf(e.tag_name)!==-1){var r=e.parent.parent;if(!r||_.indexOf(r.tag_name)===-1){t=t||this._tag_stack.try_pop("p")}}else if(e.tag_name==="rp"||e.tag_name==="rt"){t=t||this._tag_stack.try_pop("rt",["ruby","rtc"]);t=t||this._tag_stack.try_pop("rp",["ruby","rtc"])}else if(e.tag_name==="optgroup"){t=t||this._tag_stack.try_pop("optgroup",["select"])}else if(e.tag_name==="option"){t=t||this._tag_stack.try_pop("option",["select","datalist","optgroup"])}else if(e.tag_name==="colgroup"){t=t||this._tag_stack.try_pop("caption",["table"])}else if(e.tag_name==="thead"){t=t||this._tag_stack.try_pop("caption",["table"]);t=t||this._tag_stack.try_pop("colgroup",["table"])}else if(e.tag_name==="tbody"||e.tag_name==="tfoot"){t=t||this._tag_stack.try_pop("caption",["table"]);t=t||this._tag_stack.try_pop("colgroup",["table"]);t=t||this._tag_stack.try_pop("thead",["table"]);t=t||this._tag_stack.try_pop("tbody",["table"])}else if(e.tag_name==="tr"){t=t||this._tag_stack.try_pop("caption",["table"]);t=t||this._tag_stack.try_pop("colgroup",["table"]);t=t||this._tag_stack.try_pop("tr",["table","thead","tbody","tfoot"])}else if(e.tag_name==="th"||e.tag_name==="td"){t=t||this._tag_stack.try_pop("td",["table","thead","tbody","tfoot","tr"]);t=t||this._tag_stack.try_pop("th",["table","thead","tbody","tfoot","tr"])}e.parent=this._tag_stack.get_parser_token();return t};e.exports.P=Beautifier},905:(e,t,r)=>{var s=r(327).P,a=r(83).J;function style_html(e,t,r,a){var u=new s(e,t,r,a);return u.beautify()}e.exports=style_html;e.exports.defaultOptions=function(){return new a}},83:(e,t,r)=>{var s=r(301).JY;function Options(e){s.call(this,e,"html");if(this.templating.length===1&&this.templating[0]==="auto"){this.templating=["django","erb","handlebars","php"]}this.indent_inner_html=this._get_boolean("indent_inner_html");this.indent_body_inner_html=this._get_boolean("indent_body_inner_html",true);this.indent_head_inner_html=this._get_boolean("indent_head_inner_html",true);this.indent_handlebars=this._get_boolean("indent_handlebars",true);this.wrap_attributes=this._get_selection("wrap_attributes",["auto","force","force-aligned","force-expand-multiline","aligned-multiple","preserve","preserve-aligned"]);this.wrap_attributes_min_attrs=this._get_number("wrap_attributes_min_attrs",2);this.wrap_attributes_indent_size=this._get_number("wrap_attributes_indent_size",this.indent_size);this.extra_liners=this._get_array("extra_liners",["head","body","/html"]);this.inline=this._get_array("inline",["a","abbr","area","audio","b","bdi","bdo","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","i","iframe","img","input","ins","kbd","keygen","label","map","mark","math","meter","noscript","object","output","progress","q","ruby","s","samp","select","small","span","strong","sub","sup","svg","template","textarea","time","u","var","video","wbr","text","acronym","big","strike","tt"]);this.inline_custom_elements=this._get_boolean("inline_custom_elements",true);this.void_elements=this._get_array("void_elements",["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr","!doctype","?xml","basefont","isindex"]);this.unformatted=this._get_array("unformatted",[]);this.content_unformatted=this._get_array("content_unformatted",["pre","textarea"]);this.unformatted_content_delimiter=this._get_characters("unformatted_content_delimiter");this.indent_scripts=this._get_selection("indent_scripts",["normal","keep","separate"])}Options.prototype=new s;e.exports.J=Options},772:(e,t,r)=>{var s=r(170)._;var a=r(170).C;var u=r(657).D;var l=r(392).i;var h=r(569).z;var f={TAG_OPEN:"TK_TAG_OPEN",TAG_CLOSE:"TK_TAG_CLOSE",CONTROL_FLOW_OPEN:"TK_CONTROL_FLOW_OPEN",CONTROL_FLOW_CLOSE:"TK_CONTROL_FLOW_CLOSE",ATTRIBUTE:"TK_ATTRIBUTE",EQUALS:"TK_EQUALS",VALUE:"TK_VALUE",COMMENT:"TK_COMMENT",TEXT:"TK_TEXT",UNKNOWN:"TK_UNKNOWN",START:a.START,RAW:a.RAW,EOF:a.EOF};var d=new u(/<\!--/,/-->/);var Tokenizer=function(e,t){s.call(this,e,t);this._current_tag_name="";var r=new l(this._input).read_options(this._options);var a=new h(this._input);this.__patterns={word:r.until(/[\n\r\t <]/),word_control_flow_close_excluded:r.until(/[\n\r\t <}]/),single_quote:r.until_after(/'/),double_quote:r.until_after(/"/),attribute:r.until(/[\n\r\t =>]|\/>/),element_name:r.until(/[\n\r\t >\/]/),angular_control_flow_start:a.matching(/\@[a-zA-Z]+[^({]*[({]/),handlebars_comment:a.starting_with(/{{!--/).until_after(/--}}/),handlebars:a.starting_with(/{{/).until_after(/}}/),handlebars_open:a.until(/[\n\r\t }]/),handlebars_raw_close:a.until(/}}/),comment:a.starting_with(/<!--/).until_after(/-->/),cdata:a.starting_with(/<!\[CDATA\[/).until_after(/]]>/),conditional_comment:a.starting_with(/<!\[/).until_after(/]>/),processing:a.starting_with(/<\?/).until_after(/\?>/)};if(this._options.indent_handlebars){this.__patterns.word=this.__patterns.word.exclude("handlebars");this.__patterns.word_control_flow_close_excluded=this.__patterns.word_control_flow_close_excluded.exclude("handlebars")}this._unformatted_content_delimiter=null;if(this._options.unformatted_content_delimiter){var u=this._input.get_literal_regexp(this._options.unformatted_content_delimiter);this.__patterns.unformatted_content_delimiter=a.matching(u).until_after(u)}};Tokenizer.prototype=new s;Tokenizer.prototype._is_comment=function(e){return false};Tokenizer.prototype._is_opening=function(e){return e.type===f.TAG_OPEN||e.type===f.CONTROL_FLOW_OPEN};Tokenizer.prototype._is_closing=function(e,t){return e.type===f.TAG_CLOSE&&(t&&((e.text===">"||e.text==="/>")&&t.text[0]==="<"||e.text==="}}"&&t.text[0]==="{"&&t.text[1]==="{"))||e.type===f.CONTROL_FLOW_CLOSE&&(e.text==="}"&&t.text.endsWith("{"))};Tokenizer.prototype._reset=function(){this._current_tag_name=""};Tokenizer.prototype._get_next_token=function(e,t){var r=null;this._readWhitespace();var s=this._input.peek();if(s===null){return this._create_token(f.EOF,"")}r=r||this._read_open_handlebars(s,t);r=r||this._read_attribute(s,e,t);r=r||this._read_close(s,t);r=r||this._read_script_and_style(s,e);r=r||this._read_control_flows(s,t);r=r||this._read_raw_content(s,e,t);r=r||this._read_content_word(s,t);r=r||this._read_comment_or_cdata(s);r=r||this._read_processing(s);r=r||this._read_open(s,t);r=r||this._create_token(f.UNKNOWN,this._input.next());return r};Tokenizer.prototype._read_comment_or_cdata=function(e){var t=null;var r=null;var s=null;if(e==="<"){var a=this._input.peek(1);if(a==="!"){r=this.__patterns.comment.read();if(r){s=d.get_directives(r);if(s&&s.ignore==="start"){r+=d.readIgnored(this._input)}}else{r=this.__patterns.cdata.read()}}if(r){t=this._create_token(f.COMMENT,r);t.directives=s}}return t};Tokenizer.prototype._read_processing=function(e){var t=null;var r=null;var s=null;if(e==="<"){var a=this._input.peek(1);if(a==="!"||a==="?"){r=this.__patterns.conditional_comment.read();r=r||this.__patterns.processing.read()}if(r){t=this._create_token(f.COMMENT,r);t.directives=s}}return t};Tokenizer.prototype._read_open=function(e,t){var r=null;var s=null;if(!t||t.type===f.CONTROL_FLOW_OPEN){if(e==="<"){r=this._input.next();if(this._input.peek()==="/"){r+=this._input.next()}r+=this.__patterns.element_name.read();s=this._create_token(f.TAG_OPEN,r)}}return s};Tokenizer.prototype._read_open_handlebars=function(e,t){var r=null;var s=null;if(!t||t.type===f.CONTROL_FLOW_OPEN){if((this._options.templating.includes("angular")||this._options.indent_handlebars)&&e==="{"&&this._input.peek(1)==="{"){if(this._options.indent_handlebars&&this._input.peek(2)==="!"){r=this.__patterns.handlebars_comment.read();r=r||this.__patterns.handlebars.read();s=this._create_token(f.COMMENT,r)}else{r=this.__patterns.handlebars_open.read();s=this._create_token(f.TAG_OPEN,r)}}}return s};Tokenizer.prototype._read_control_flows=function(e,t){var r="";var s=null;if(!this._options.templating.includes("angular")){return s}if(e==="@"){r=this.__patterns.angular_control_flow_start.read();if(r===""){return s}var a=r.endsWith("(")?1:0;var u=0;while(!(r.endsWith("{")&&a===u)){var l=this._input.next();if(l===null){break}else if(l==="("){a++}else if(l===")"){u++}r+=l}s=this._create_token(f.CONTROL_FLOW_OPEN,r)}else if(e==="}"&&t&&t.type===f.CONTROL_FLOW_OPEN){r=this._input.next();s=this._create_token(f.CONTROL_FLOW_CLOSE,r)}return s};Tokenizer.prototype._read_close=function(e,t){var r=null;var s=null;if(t&&t.type===f.TAG_OPEN){if(t.text[0]==="<"&&(e===">"||e==="/"&&this._input.peek(1)===">")){r=this._input.next();if(e==="/"){r+=this._input.next()}s=this._create_token(f.TAG_CLOSE,r)}else if(t.text[0]==="{"&&e==="}"&&this._input.peek(1)==="}"){this._input.next();this._input.next();s=this._create_token(f.TAG_CLOSE,"}}")}}return s};Tokenizer.prototype._read_attribute=function(e,t,r){var s=null;var a="";if(r&&r.text[0]==="<"){if(e==="="){s=this._create_token(f.EQUALS,this._input.next())}else if(e==='"'||e==="'"){var u=this._input.next();if(e==='"'){u+=this.__patterns.double_quote.read()}else{u+=this.__patterns.single_quote.read()}s=this._create_token(f.VALUE,u)}else{a=this.__patterns.attribute.read();if(a){if(t.type===f.EQUALS){s=this._create_token(f.VALUE,a)}else{s=this._create_token(f.ATTRIBUTE,a)}}}}return s};Tokenizer.prototype._is_content_unformatted=function(e){return this._options.void_elements.indexOf(e)===-1&&(this._options.content_unformatted.indexOf(e)!==-1||this._options.unformatted.indexOf(e)!==-1)};Tokenizer.prototype._read_raw_content=function(e,t,r){var s="";if(r&&r.text[0]==="{"){s=this.__patterns.handlebars_raw_close.read()}else if(t.type===f.TAG_CLOSE&&t.opened.text[0]==="<"&&t.text[0]!=="/"){var a=t.opened.text.substr(1).toLowerCase();if(this._is_content_unformatted(a)){s=this._input.readUntil(new RegExp("</"+a+"[\\n\\r\\t ]*?>","ig"))}}if(s){return this._create_token(f.TEXT,s)}return null};Tokenizer.prototype._read_script_and_style=function(e,t){if(t.type===f.TAG_CLOSE&&t.opened.text[0]==="<"&&t.text[0]!=="/"){var r=t.opened.text.substr(1).toLowerCase();if(r==="script"||r==="style"){var s=this._read_comment_or_cdata(e);if(s){s.type=f.TEXT;return s}var a=this._input.readUntil(new RegExp("</"+r+"[\\n\\r\\t ]*?>","ig"));if(a){return this._create_token(f.TEXT,a)}}}return null};Tokenizer.prototype._read_content_word=function(e,t){var r="";if(this._options.unformatted_content_delimiter){if(e===this._options.unformatted_content_delimiter[0]){r=this.__patterns.unformatted_content_delimiter.read()}}if(!r){r=t&&t.type===f.CONTROL_FLOW_OPEN?this.__patterns.word_control_flow_close_excluded.read():this.__patterns.word.read()}if(r){return this._create_token(f.TEXT,r)}return null};e.exports._=Tokenizer;e.exports.C=f},975:(e,t,r)=>{var s=r(611);var a=r(295);var u=r(905);function style_html(e,t,r,l){r=r||s;l=l||a;return u(e,t,r,l)}style_html.defaultOptions=u.defaultOptions;e.exports.js=s;e.exports.css=a;e.exports.html=style_html},434:(e,t)=>{var r="\\x23\\x24\\x40\\x41-\\x5a\\x5f\\x61-\\x7a";var s="\\x24\\x30-\\x39\\x41-\\x5a\\x5f\\x61-\\x7a";var a="\\xaa\\xb5\\xba\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\u02c1\\u02c6-\\u02d1\\u02e0-\\u02e4\\u02ec\\u02ee\\u0370-\\u0374\\u0376\\u0377\\u037a-\\u037d\\u0386\\u0388-\\u038a\\u038c\\u038e-\\u03a1\\u03a3-\\u03f5\\u03f7-\\u0481\\u048a-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05d0-\\u05ea\\u05f0-\\u05f2\\u0620-\\u064a\\u066e\\u066f\\u0671-\\u06d3\\u06d5\\u06e5\\u06e6\\u06ee\\u06ef\\u06fa-\\u06fc\\u06ff\\u0710\\u0712-\\u072f\\u074d-\\u07a5\\u07b1\\u07ca-\\u07ea\\u07f4\\u07f5\\u07fa\\u0800-\\u0815\\u081a\\u0824\\u0828\\u0840-\\u0858\\u08a0\\u08a2-\\u08ac\\u0904-\\u0939\\u093d\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097f\\u0985-\\u098c\\u098f\\u0990\\u0993-\\u09a8\\u09aa-\\u09b0\\u09b2\\u09b6-\\u09b9\\u09bd\\u09ce\\u09dc\\u09dd\\u09df-\\u09e1\\u09f0\\u09f1\\u0a05-\\u0a0a\\u0a0f\\u0a10\\u0a13-\\u0a28\\u0a2a-\\u0a30\\u0a32\\u0a33\\u0a35\\u0a36\\u0a38\\u0a39\\u0a59-\\u0a5c\\u0a5e\\u0a72-\\u0a74\\u0a85-\\u0a8d\\u0a8f-\\u0a91\\u0a93-\\u0aa8\\u0aaa-\\u0ab0\\u0ab2\\u0ab3\\u0ab5-\\u0ab9\\u0abd\\u0ad0\\u0ae0\\u0ae1\\u0b05-\\u0b0c\\u0b0f\\u0b10\\u0b13-\\u0b28\\u0b2a-\\u0b30\\u0b32\\u0b33\\u0b35-\\u0b39\\u0b3d\\u0b5c\\u0b5d\\u0b5f-\\u0b61\\u0b71\\u0b83\\u0b85-\\u0b8a\\u0b8e-\\u0b90\\u0b92-\\u0b95\\u0b99\\u0b9a\\u0b9c\\u0b9e\\u0b9f\\u0ba3\\u0ba4\\u0ba8-\\u0baa\\u0bae-\\u0bb9\\u0bd0\\u0c05-\\u0c0c\\u0c0e-\\u0c10\\u0c12-\\u0c28\\u0c2a-\\u0c33\\u0c35-\\u0c39\\u0c3d\\u0c58\\u0c59\\u0c60\\u0c61\\u0c85-\\u0c8c\\u0c8e-\\u0c90\\u0c92-\\u0ca8\\u0caa-\\u0cb3\\u0cb5-\\u0cb9\\u0cbd\\u0cde\\u0ce0\\u0ce1\\u0cf1\\u0cf2\\u0d05-\\u0d0c\\u0d0e-\\u0d10\\u0d12-\\u0d3a\\u0d3d\\u0d4e\\u0d60\\u0d61\\u0d7a-\\u0d7f\\u0d85-\\u0d96\\u0d9a-\\u0db1\\u0db3-\\u0dbb\\u0dbd\\u0dc0-\\u0dc6\\u0e01-\\u0e30\\u0e32\\u0e33\\u0e40-\\u0e46\\u0e81\\u0e82\\u0e84\\u0e87\\u0e88\\u0e8a\\u0e8d\\u0e94-\\u0e97\\u0e99-\\u0e9f\\u0ea1-\\u0ea3\\u0ea5\\u0ea7\\u0eaa\\u0eab\\u0ead-\\u0eb0\\u0eb2\\u0eb3\\u0ebd\\u0ec0-\\u0ec4\\u0ec6\\u0edc-\\u0edf\\u0f00\\u0f40-\\u0f47\\u0f49-\\u0f6c\\u0f88-\\u0f8c\\u1000-\\u102a\\u103f\\u1050-\\u1055\\u105a-\\u105d\\u1061\\u1065\\u1066\\u106e-\\u1070\\u1075-\\u1081\\u108e\\u10a0-\\u10c5\\u10c7\\u10cd\\u10d0-\\u10fa\\u10fc-\\u1248\\u124a-\\u124d\\u1250-\\u1256\\u1258\\u125a-\\u125d\\u1260-\\u1288\\u128a-\\u128d\\u1290-\\u12b0\\u12b2-\\u12b5\\u12b8-\\u12be\\u12c0\\u12c2-\\u12c5\\u12c8-\\u12d6\\u12d8-\\u1310\\u1312-\\u1315\\u1318-\\u135a\\u1380-\\u138f\\u13a0-\\u13f4\\u1401-\\u166c\\u166f-\\u167f\\u1681-\\u169a\\u16a0-\\u16ea\\u16ee-\\u16f0\\u1700-\\u170c\\u170e-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176c\\u176e-\\u1770\\u1780-\\u17b3\\u17d7\\u17dc\\u1820-\\u1877\\u1880-\\u18a8\\u18aa\\u18b0-\\u18f5\\u1900-\\u191c\\u1950-\\u196d\\u1970-\\u1974\\u1980-\\u19ab\\u19c1-\\u19c7\\u1a00-\\u1a16\\u1a20-\\u1a54\\u1aa7\\u1b05-\\u1b33\\u1b45-\\u1b4b\\u1b83-\\u1ba0\\u1bae\\u1baf\\u1bba-\\u1be5\\u1c00-\\u1c23\\u1c4d-\\u1c4f\\u1c5a-\\u1c7d\\u1ce9-\\u1cec\\u1cee-\\u1cf1\\u1cf5\\u1cf6\\u1d00-\\u1dbf\\u1e00-\\u1f15\\u1f18-\\u1f1d\\u1f20-\\u1f45\\u1f48-\\u1f4d\\u1f50-\\u1f57\\u1f59\\u1f5b\\u1f5d\\u1f5f-\\u1f7d\\u1f80-\\u1fb4\\u1fb6-\\u1fbc\\u1fbe\\u1fc2-\\u1fc4\\u1fc6-\\u1fcc\\u1fd0-\\u1fd3\\u1fd6-\\u1fdb\\u1fe0-\\u1fec\\u1ff2-\\u1ff4\\u1ff6-\\u1ffc\\u2071\\u207f\\u2090-\\u209c\\u2102\\u2107\\u210a-\\u2113\\u2115\\u2119-\\u211d\\u2124\\u2126\\u2128\\u212a-\\u212d\\u212f-\\u2139\\u213c-\\u213f\\u2145-\\u2149\\u214e\\u2160-\\u2188\\u2c00-\\u2c2e\\u2c30-\\u2c5e\\u2c60-\\u2ce4\\u2ceb-\\u2cee\\u2cf2\\u2cf3\\u2d00-\\u2d25\\u2d27\\u2d2d\\u2d30-\\u2d67\\u2d6f\\u2d80-\\u2d96\\u2da0-\\u2da6\\u2da8-\\u2dae\\u2db0-\\u2db6\\u2db8-\\u2dbe\\u2dc0-\\u2dc6\\u2dc8-\\u2dce\\u2dd0-\\u2dd6\\u2dd8-\\u2dde\\u2e2f\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303c\\u3041-\\u3096\\u309d-\\u309f\\u30a1-\\u30fa\\u30fc-\\u30ff\\u3105-\\u312d\\u3131-\\u318e\\u31a0-\\u31ba\\u31f0-\\u31ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\ua000-\\ua48c\\ua4d0-\\ua4fd\\ua500-\\ua60c\\ua610-\\ua61f\\ua62a\\ua62b\\ua640-\\ua66e\\ua67f-\\ua697\\ua6a0-\\ua6ef\\ua717-\\ua71f\\ua722-\\ua788\\ua78b-\\ua78e\\ua790-\\ua793\\ua7a0-\\ua7aa\\ua7f8-\\ua801\\ua803-\\ua805\\ua807-\\ua80a\\ua80c-\\ua822\\ua840-\\ua873\\ua882-\\ua8b3\\ua8f2-\\ua8f7\\ua8fb\\ua90a-\\ua925\\ua930-\\ua946\\ua960-\\ua97c\\ua984-\\ua9b2\\ua9cf\\uaa00-\\uaa28\\uaa40-\\uaa42\\uaa44-\\uaa4b\\uaa60-\\uaa76\\uaa7a\\uaa80-\\uaaaf\\uaab1\\uaab5\\uaab6\\uaab9-\\uaabd\\uaac0\\uaac2\\uaadb-\\uaadd\\uaae0-\\uaaea\\uaaf2-\\uaaf4\\uab01-\\uab06\\uab09-\\uab0e\\uab11-\\uab16\\uab20-\\uab26\\uab28-\\uab2e\\uabc0-\\uabe2\\uac00-\\ud7a3\\ud7b0-\\ud7c6\\ud7cb-\\ud7fb\\uf900-\\ufa6d\\ufa70-\\ufad9\\ufb00-\\ufb06\\ufb13-\\ufb17\\ufb1d\\ufb1f-\\ufb28\\ufb2a-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40\\ufb41\\ufb43\\ufb44\\ufb46-\\ufbb1\\ufbd3-\\ufd3d\\ufd50-\\ufd8f\\ufd92-\\ufdc7\\ufdf0-\\ufdfb\\ufe70-\\ufe74\\ufe76-\\ufefc\\uff21-\\uff3a\\uff41-\\uff5a\\uff66-\\uffbe\\uffc2-\\uffc7\\uffca-\\uffcf\\uffd2-\\uffd7\\uffda-\\uffdc";var u="\\u0300-\\u036f\\u0483-\\u0487\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u0620-\\u0649\\u0672-\\u06d3\\u06e7-\\u06e8\\u06fb-\\u06fc\\u0730-\\u074a\\u0800-\\u0814\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0840-\\u0857\\u08e4-\\u08fe\\u0900-\\u0903\\u093a-\\u093c\\u093e-\\u094f\\u0951-\\u0957\\u0962-\\u0963\\u0966-\\u096f\\u0981-\\u0983\\u09bc\\u09be-\\u09c4\\u09c7\\u09c8\\u09d7\\u09df-\\u09e0\\u0a01-\\u0a03\\u0a3c\\u0a3e-\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a66-\\u0a71\\u0a75\\u0a81-\\u0a83\\u0abc\\u0abe-\\u0ac5\\u0ac7-\\u0ac9\\u0acb-\\u0acd\\u0ae2-\\u0ae3\\u0ae6-\\u0aef\\u0b01-\\u0b03\\u0b3c\\u0b3e-\\u0b44\\u0b47\\u0b48\\u0b4b-\\u0b4d\\u0b56\\u0b57\\u0b5f-\\u0b60\\u0b66-\\u0b6f\\u0b82\\u0bbe-\\u0bc2\\u0bc6-\\u0bc8\\u0bca-\\u0bcd\\u0bd7\\u0be6-\\u0bef\\u0c01-\\u0c03\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62-\\u0c63\\u0c66-\\u0c6f\\u0c82\\u0c83\\u0cbc\\u0cbe-\\u0cc4\\u0cc6-\\u0cc8\\u0cca-\\u0ccd\\u0cd5\\u0cd6\\u0ce2-\\u0ce3\\u0ce6-\\u0cef\\u0d02\\u0d03\\u0d46-\\u0d48\\u0d57\\u0d62-\\u0d63\\u0d66-\\u0d6f\\u0d82\\u0d83\\u0dca\\u0dcf-\\u0dd4\\u0dd6\\u0dd8-\\u0ddf\\u0df2\\u0df3\\u0e34-\\u0e3a\\u0e40-\\u0e45\\u0e50-\\u0e59\\u0eb4-\\u0eb9\\u0ec8-\\u0ecd\\u0ed0-\\u0ed9\\u0f18\\u0f19\\u0f20-\\u0f29\\u0f35\\u0f37\\u0f39\\u0f41-\\u0f47\\u0f71-\\u0f84\\u0f86-\\u0f87\\u0f8d-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u1000-\\u1029\\u1040-\\u1049\\u1067-\\u106d\\u1071-\\u1074\\u1082-\\u108d\\u108f-\\u109d\\u135d-\\u135f\\u170e-\\u1710\\u1720-\\u1730\\u1740-\\u1750\\u1772\\u1773\\u1780-\\u17b2\\u17dd\\u17e0-\\u17e9\\u180b-\\u180d\\u1810-\\u1819\\u1920-\\u192b\\u1930-\\u193b\\u1951-\\u196d\\u19b0-\\u19c0\\u19c8-\\u19c9\\u19d0-\\u19d9\\u1a00-\\u1a15\\u1a20-\\u1a53\\u1a60-\\u1a7c\\u1a7f-\\u1a89\\u1a90-\\u1a99\\u1b46-\\u1b4b\\u1b50-\\u1b59\\u1b6b-\\u1b73\\u1bb0-\\u1bb9\\u1be6-\\u1bf3\\u1c00-\\u1c22\\u1c40-\\u1c49\\u1c5b-\\u1c7d\\u1cd0-\\u1cd2\\u1d00-\\u1dbe\\u1e01-\\u1f15\\u200c\\u200d\\u203f\\u2040\\u2054\\u20d0-\\u20dc\\u20e1\\u20e5-\\u20f0\\u2d81-\\u2d96\\u2de0-\\u2dff\\u3021-\\u3028\\u3099\\u309a\\ua640-\\ua66d\\ua674-\\ua67d\\ua69f\\ua6f0-\\ua6f1\\ua7f8-\\ua800\\ua806\\ua80b\\ua823-\\ua827\\ua880-\\ua881\\ua8b4-\\ua8c4\\ua8d0-\\ua8d9\\ua8f3-\\ua8f7\\ua900-\\ua909\\ua926-\\ua92d\\ua930-\\ua945\\ua980-\\ua983\\ua9b3-\\ua9c0\\uaa00-\\uaa27\\uaa40-\\uaa41\\uaa4c-\\uaa4d\\uaa50-\\uaa59\\uaa7b\\uaae0-\\uaae9\\uaaf2-\\uaaf3\\uabc0-\\uabe1\\uabec\\uabed\\uabf0-\\uabf9\\ufb20-\\ufb28\\ufe00-\\ufe0f\\ufe20-\\ufe26\\ufe33\\ufe34\\ufe4d-\\ufe4f\\uff10-\\uff19\\uff3f";var l="\\\\u[0-9a-fA-F]{4}|\\\\u\\{[0-9a-fA-F]+\\}";var h="(?:"+l+"|["+r+a+"])";var f="(?:"+l+"|["+s+a+u+"])*";t.identifier=new RegExp(h+f,"g");t.identifierStart=new RegExp(h);t.identifierMatch=new RegExp("(?:"+l+"|["+s+a+u+"])+");var d=/[\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff]/;t.newline=/[\n\r\u2028\u2029]/;t.lineBreak=new RegExp("\r\n|"+t.newline.source);t.allLineBreaks=new RegExp(t.lineBreak.source,"g")},877:(e,t,r)=>{var s=r(498).k;var a=r(658).o;var u=r(434);var l=r(833).J;var h=r(982)._F;var f=r(982).O0;var d=r(982).OK;var _=r(982).CV;function in_array(e,t){return t.indexOf(e)!==-1}function ltrim(e){return e.replace(/^\s+/g,"")}function generateMapFromStrings(e){var t={};for(var r=0;r<e.length;r++){t[e[r].replace(/-/g,"_")]=e[r]}return t}function reserved_word(e,t){return e&&e.type===_.RESERVED&&e.text===t}function reserved_array(e,t){return e&&e.type===_.RESERVED&&in_array(e.text,t)}var m=["case","return","do","if","throw","else","await","break","continue","async"];var g=["before-newline","after-newline","preserve-newline"];var y=generateMapFromStrings(g);var b=[y.before_newline,y.preserve_newline];var v={BlockStatement:"BlockStatement",Statement:"Statement",ObjectLiteral:"ObjectLiteral",ArrayLiteral:"ArrayLiteral",ForInitializer:"ForInitializer",Conditional:"Conditional",Expression:"Expression"};function remove_redundant_indentation(e,t){if(t.multiline_frame||t.mode===v.ForInitializer||t.mode===v.Conditional){return}e.remove_indent(t.start_line_index)}function split_linebreaks(e){e=e.replace(u.allLineBreaks,"\n");var t=[],r=e.indexOf("\n");while(r!==-1){t.push(e.substring(0,r));e=e.substring(r+1);r=e.indexOf("\n")}if(e.length){t.push(e)}return t}function is_array(e){return e===v.ArrayLiteral}function is_expression(e){return in_array(e,[v.Expression,v.ForInitializer,v.Conditional])}function all_lines_start_with(e,t){for(var r=0;r<e.length;r++){var s=e[r].trim();if(s.charAt(0)!==t){return false}}return true}function each_line_matches_indent(e,t){var r=0,s=e.length,a;for(;r<s;r++){a=e[r];if(a&&a.indexOf(t)!==0){return false}}return true}function Beautifier(e,t){t=t||{};this._source_text=e||"";this._output=null;this._tokens=null;this._last_last_text=null;this._flags=null;this._previous_flags=null;this._flag_store=null;this._options=new l(t)}Beautifier.prototype.create_flags=function(e,t){var r=0;if(e){r=e.indentation_level;if(!this._output.just_added_newline()&&e.line_indent_level>r){r=e.line_indent_level}}var s={mode:t,parent:e,last_token:e?e.last_token:new a(_.START_BLOCK,""),last_word:e?e.last_word:"",declaration_statement:false,declaration_assignment:false,multiline_frame:false,inline_frame:false,if_block:false,else_block:false,class_start_block:false,do_block:false,do_while:false,import_block:false,in_case_statement:false,in_case:false,case_body:false,case_block:false,indentation_level:r,alignment:0,line_indent_level:e?e.line_indent_level:r,start_line_index:this._output.get_line_number(),ternary_depth:0};return s};Beautifier.prototype._reset=function(e){var t=e.match(/^[\t ]*/)[0];this._last_last_text="";this._output=new s(this._options,t);this._output.raw=this._options.test_output_raw;this._flag_store=[];this.set_mode(v.BlockStatement);var r=new h(e,this._options);this._tokens=r.tokenize();return e};Beautifier.prototype.beautify=function(){if(this._options.disabled){return this._source_text}var e;var t=this._reset(this._source_text);var r=this._options.eol;if(this._options.eol==="auto"){r="\n";if(t&&u.lineBreak.test(t||"")){r=t.match(u.lineBreak)[0]}}var s=this._tokens.next();while(s){this.handle_token(s);this._last_last_text=this._flags.last_token.text;this._flags.last_token=s;s=this._tokens.next()}e=this._output.get_code(r);return e};Beautifier.prototype.handle_token=function(e,t){if(e.type===_.START_EXPR){this.handle_start_expr(e)}else if(e.type===_.END_EXPR){this.handle_end_expr(e)}else if(e.type===_.START_BLOCK){this.handle_start_block(e)}else if(e.type===_.END_BLOCK){this.handle_end_block(e)}else if(e.type===_.WORD){this.handle_word(e)}else if(e.type===_.RESERVED){this.handle_word(e)}else if(e.type===_.SEMICOLON){this.handle_semicolon(e)}else if(e.type===_.STRING){this.handle_string(e)}else if(e.type===_.EQUALS){this.handle_equals(e)}else if(e.type===_.OPERATOR){this.handle_operator(e)}else if(e.type===_.COMMA){this.handle_comma(e)}else if(e.type===_.BLOCK_COMMENT){this.handle_block_comment(e,t)}else if(e.type===_.COMMENT){this.handle_comment(e,t)}else if(e.type===_.DOT){this.handle_dot(e)}else if(e.type===_.EOF){this.handle_eof(e)}else if(e.type===_.UNKNOWN){this.handle_unknown(e,t)}else{this.handle_unknown(e,t)}};Beautifier.prototype.handle_whitespace_and_comments=function(e,t){var r=e.newlines;var s=this._options.keep_array_indentation&&is_array(this._flags.mode);if(e.comments_before){var a=e.comments_before.next();while(a){this.handle_whitespace_and_comments(a,t);this.handle_token(a,t);a=e.comments_before.next()}}if(s){for(var u=0;u<r;u+=1){this.print_newline(u>0,t)}}else{if(this._options.max_preserve_newlines&&r>this._options.max_preserve_newlines){r=this._options.max_preserve_newlines}if(this._options.preserve_newlines){if(r>1){this.print_newline(false,t);for(var l=1;l<r;l+=1){this.print_newline(true,t)}}}}};var E=["async","break","continue","return","throw","yield"];Beautifier.prototype.allow_wrap_or_preserved_newline=function(e,t){t=t===undefined?false:t;if(this._output.just_added_newline()){return}var r=this._options.preserve_newlines&&e.newlines||t;var s=in_array(this._flags.last_token.text,d)||in_array(e.text,d);if(s){var a=in_array(this._flags.last_token.text,d)&&in_array(this._options.operator_position,b)||in_array(e.text,d);r=r&&a}if(r){this.print_newline(false,true)}else if(this._options.wrap_line_length){if(reserved_array(this._flags.last_token,E)){return}this._output.set_wrap_point()}};Beautifier.prototype.print_newline=function(e,t){if(!t){if(this._flags.last_token.text!==";"&&this._flags.last_token.text!==","&&this._flags.last_token.text!=="="&&(this._flags.last_token.type!==_.OPERATOR||this._flags.last_token.text==="--"||this._flags.last_token.text==="++")){var r=this._tokens.peek();while(this._flags.mode===v.Statement&&!(this._flags.if_block&&reserved_word(r,"else"))&&!this._flags.do_block){this.restore_mode()}}}if(this._output.add_new_line(e)){this._flags.multiline_frame=true}};Beautifier.prototype.print_token_line_indentation=function(e){if(this._output.just_added_newline()){if(this._options.keep_array_indentation&&e.newlines&&(e.text==="["||is_array(this._flags.mode))){this._output.current_line.set_indent(-1);this._output.current_line.push(e.whitespace_before);this._output.space_before_token=false}else if(this._output.set_indent(this._flags.indentation_level,this._flags.alignment)){this._flags.line_indent_level=this._flags.indentation_level}}};Beautifier.prototype.print_token=function(e){if(this._output.raw){this._output.add_raw_token(e);return}if(this._options.comma_first&&e.previous&&e.previous.type===_.COMMA&&this._output.just_added_newline()){if(this._output.previous_line.last()===","){var t=this._output.previous_line.pop();if(this._output.previous_line.is_empty()){this._output.previous_line.push(t);this._output.trim(true);this._output.current_line.pop();this._output.trim()}this.print_token_line_indentation(e);this._output.add_token(",");this._output.space_before_token=true}}this.print_token_line_indentation(e);this._output.non_breaking_space=true;this._output.add_token(e.text);if(this._output.previous_token_wrapped){this._flags.multiline_frame=true}};Beautifier.prototype.indent=function(){this._flags.indentation_level+=1;this._output.set_indent(this._flags.indentation_level,this._flags.alignment)};Beautifier.prototype.deindent=function(){if(this._flags.indentation_level>0&&(!this._flags.parent||this._flags.indentation_level>this._flags.parent.indentation_level)){this._flags.indentation_level-=1;this._output.set_indent(this._flags.indentation_level,this._flags.alignment)}};Beautifier.prototype.set_mode=function(e){if(this._flags){this._flag_store.push(this._flags);this._previous_flags=this._flags}else{this._previous_flags=this.create_flags(null,e)}this._flags=this.create_flags(this._previous_flags,e);this._output.set_indent(this._flags.indentation_level,this._flags.alignment)};Beautifier.prototype.restore_mode=function(){if(this._flag_store.length>0){this._previous_flags=this._flags;this._flags=this._flag_store.pop();if(this._previous_flags.mode===v.Statement){remove_redundant_indentation(this._output,this._previous_flags)}this._output.set_indent(this._flags.indentation_level,this._flags.alignment)}};Beautifier.prototype.start_of_object_property=function(){return this._flags.parent.mode===v.ObjectLiteral&&this._flags.mode===v.Statement&&(this._flags.last_token.text===":"&&this._flags.ternary_depth===0||reserved_array(this._flags.last_token,["get","set"]))};Beautifier.prototype.start_of_statement=function(e){var t=false;t=t||reserved_array(this._flags.last_token,["var","let","const"])&&e.type===_.WORD;t=t||reserved_word(this._flags.last_token,"do");t=t||!(this._flags.parent.mode===v.ObjectLiteral&&this._flags.mode===v.Statement)&&reserved_array(this._flags.last_token,E)&&!e.newlines;t=t||reserved_word(this._flags.last_token,"else")&&!(reserved_word(e,"if")&&!e.comments_before);t=t||this._flags.last_token.type===_.END_EXPR&&(this._previous_flags.mode===v.ForInitializer||this._previous_flags.mode===v.Conditional);t=t||this._flags.last_token.type===_.WORD&&this._flags.mode===v.BlockStatement&&!this._flags.in_case&&!(e.text==="--"||e.text==="++")&&this._last_last_text!=="function"&&e.type!==_.WORD&&e.type!==_.RESERVED;t=t||this._flags.mode===v.ObjectLiteral&&(this._flags.last_token.text===":"&&this._flags.ternary_depth===0||reserved_array(this._flags.last_token,["get","set"]));if(t){this.set_mode(v.Statement);this.indent();this.handle_whitespace_and_comments(e,true);if(!this.start_of_object_property()){this.allow_wrap_or_preserved_newline(e,reserved_array(e,["do","for","if","while"]))}return true}return false};Beautifier.prototype.handle_start_expr=function(e){if(!this.start_of_statement(e)){this.handle_whitespace_and_comments(e)}var t=v.Expression;if(e.text==="["){if(this._flags.last_token.type===_.WORD||this._flags.last_token.text===")"){if(reserved_array(this._flags.last_token,f)){this._output.space_before_token=true}this.print_token(e);this.set_mode(t);this.indent();if(this._options.space_in_paren){this._output.space_before_token=true}return}t=v.ArrayLiteral;if(is_array(this._flags.mode)){if(this._flags.last_token.text==="["||this._flags.last_token.text===","&&(this._last_last_text==="]"||this._last_last_text==="}")){if(!this._options.keep_array_indentation){this.print_newline()}}}if(!in_array(this._flags.last_token.type,[_.START_EXPR,_.END_EXPR,_.WORD,_.OPERATOR,_.DOT])){this._output.space_before_token=true}}else{if(this._flags.last_token.type===_.RESERVED){if(this._flags.last_token.text==="for"){this._output.space_before_token=this._options.space_before_conditional;t=v.ForInitializer}else if(in_array(this._flags.last_token.text,["if","while","switch"])){this._output.space_before_token=this._options.space_before_conditional;t=v.Conditional}else if(in_array(this._flags.last_word,["await","async"])){this._output.space_before_token=true}else if(this._flags.last_token.text==="import"&&e.whitespace_before===""){this._output.space_before_token=false}else if(in_array(this._flags.last_token.text,f)||this._flags.last_token.text==="catch"){this._output.space_before_token=true}}else if(this._flags.last_token.type===_.EQUALS||this._flags.last_token.type===_.OPERATOR){if(!this.start_of_object_property()){this.allow_wrap_or_preserved_newline(e)}}else if(this._flags.last_token.type===_.WORD){this._output.space_before_token=false;var r=this._tokens.peek(-3);if(this._options.space_after_named_function&&r){var s=this._tokens.peek(-4);if(reserved_array(r,["async","function"])||r.text==="*"&&reserved_array(s,["async","function"])){this._output.space_before_token=true}else if(this._flags.mode===v.ObjectLiteral){if(r.text==="{"||r.text===","||r.text==="*"&&(s.text==="{"||s.text===",")){this._output.space_before_token=true}}else if(this._flags.parent&&this._flags.parent.class_start_block){this._output.space_before_token=true}}}else{this.allow_wrap_or_preserved_newline(e)}if(this._flags.last_token.type===_.RESERVED&&(this._flags.last_word==="function"||this._flags.last_word==="typeof")||this._flags.last_token.text==="*"&&(in_array(this._last_last_text,["function","yield"])||this._flags.mode===v.ObjectLiteral&&in_array(this._last_last_text,["{",","]))){this._output.space_before_token=this._options.space_after_anon_function}}if(this._flags.last_token.text===";"||this._flags.last_token.type===_.START_BLOCK){this.print_newline()}else if(this._flags.last_token.type===_.END_EXPR||this._flags.last_token.type===_.START_EXPR||this._flags.last_token.type===_.END_BLOCK||this._flags.last_token.text==="."||this._flags.last_token.type===_.COMMA){this.allow_wrap_or_preserved_newline(e,e.newlines)}this.print_token(e);this.set_mode(t);if(this._options.space_in_paren){this._output.space_before_token=true}this.indent()};Beautifier.prototype.handle_end_expr=function(e){while(this._flags.mode===v.Statement){this.restore_mode()}this.handle_whitespace_and_comments(e);if(this._flags.multiline_frame){this.allow_wrap_or_preserved_newline(e,e.text==="]"&&is_array(this._flags.mode)&&!this._options.keep_array_indentation)}if(this._options.space_in_paren){if(this._flags.last_token.type===_.START_EXPR&&!this._options.space_in_empty_paren){this._output.trim();this._output.space_before_token=false}else{this._output.space_before_token=true}}this.deindent();this.print_token(e);this.restore_mode();remove_redundant_indentation(this._output,this._previous_flags);if(this._flags.do_while&&this._previous_flags.mode===v.Conditional){this._previous_flags.mode=v.Expression;this._flags.do_block=false;this._flags.do_while=false}};Beautifier.prototype.handle_start_block=function(e){this.handle_whitespace_and_comments(e);var t=this._tokens.peek();var r=this._tokens.peek(1);if(this._flags.last_word==="switch"&&this._flags.last_token.type===_.END_EXPR){this.set_mode(v.BlockStatement);this._flags.in_case_statement=true}else if(this._flags.case_body){this.set_mode(v.BlockStatement)}else if(r&&(in_array(r.text,[":",","])&&in_array(t.type,[_.STRING,_.WORD,_.RESERVED])||in_array(t.text,["get","set","..."])&&in_array(r.type,[_.WORD,_.RESERVED]))){if(in_array(this._last_last_text,["class","interface"])&&!in_array(r.text,[":",","])){this.set_mode(v.BlockStatement)}else{this.set_mode(v.ObjectLiteral)}}else if(this._flags.last_token.type===_.OPERATOR&&this._flags.last_token.text==="=>"){this.set_mode(v.BlockStatement)}else if(in_array(this._flags.last_token.type,[_.EQUALS,_.START_EXPR,_.COMMA,_.OPERATOR])||reserved_array(this._flags.last_token,["return","throw","import","default"])){this.set_mode(v.ObjectLiteral)}else{this.set_mode(v.BlockStatement)}if(this._flags.last_token){if(reserved_array(this._flags.last_token.previous,["class","extends"])){this._flags.class_start_block=true}}var s=!t.comments_before&&t.text==="}";var a=s&&this._flags.last_word==="function"&&this._flags.last_token.type===_.END_EXPR;if(this._options.brace_preserve_inline){var u=0;var l=null;this._flags.inline_frame=true;do{u+=1;l=this._tokens.peek(u-1);if(l.newlines){this._flags.inline_frame=false;break}}while(l.type!==_.EOF&&!(l.type===_.END_BLOCK&&l.opened===e))}if((this._options.brace_style==="expand"||this._options.brace_style==="none"&&e.newlines)&&!this._flags.inline_frame){if(this._flags.last_token.type!==_.OPERATOR&&(a||this._flags.last_token.type===_.EQUALS||reserved_array(this._flags.last_token,m)&&this._flags.last_token.text!=="else")){this._output.space_before_token=true}else{this.print_newline(false,true)}}else{if(is_array(this._previous_flags.mode)&&(this._flags.last_token.type===_.START_EXPR||this._flags.last_token.type===_.COMMA)){if(this._flags.last_token.type===_.COMMA||this._options.space_in_paren){this._output.space_before_token=true}if(this._flags.last_token.type===_.COMMA||this._flags.last_token.type===_.START_EXPR&&this._flags.inline_frame){this.allow_wrap_or_preserved_newline(e);this._previous_flags.multiline_frame=this._previous_flags.multiline_frame||this._flags.multiline_frame;this._flags.multiline_frame=false}}if(this._flags.last_token.type!==_.OPERATOR&&this._flags.last_token.type!==_.START_EXPR){if(in_array(this._flags.last_token.type,[_.START_BLOCK,_.SEMICOLON])&&!this._flags.inline_frame){this.print_newline()}else{this._output.space_before_token=true}}}this.print_token(e);this.indent();if(!s&&!(this._options.brace_preserve_inline&&this._flags.inline_frame)){this.print_newline()}};Beautifier.prototype.handle_end_block=function(e){this.handle_whitespace_and_comments(e);while(this._flags.mode===v.Statement){this.restore_mode()}var t=this._flags.last_token.type===_.START_BLOCK;if(this._flags.inline_frame&&!t){this._output.space_before_token=true}else if(this._options.brace_style==="expand"){if(!t){this.print_newline()}}else{if(!t){if(is_array(this._flags.mode)&&this._options.keep_array_indentation){this._options.keep_array_indentation=false;this.print_newline();this._options.keep_array_indentation=true}else{this.print_newline()}}}this.restore_mode();this.print_token(e)};Beautifier.prototype.handle_word=function(e){if(e.type===_.RESERVED){if(in_array(e.text,["set","get"])&&this._flags.mode!==v.ObjectLiteral){e.type=_.WORD}else if(e.text==="import"&&in_array(this._tokens.peek().text,["(","."])){e.type=_.WORD}else if(in_array(e.text,["as","from"])&&!this._flags.import_block){e.type=_.WORD}else if(this._flags.mode===v.ObjectLiteral){var t=this._tokens.peek();if(t.text===":"){e.type=_.WORD}}}if(this.start_of_statement(e)){if(reserved_array(this._flags.last_token,["var","let","const"])&&e.type===_.WORD){this._flags.declaration_statement=true}}else if(e.newlines&&!is_expression(this._flags.mode)&&(this._flags.last_token.type!==_.OPERATOR||(this._flags.last_token.text==="--"||this._flags.last_token.text==="++"))&&this._flags.last_token.type!==_.EQUALS&&(this._options.preserve_newlines||!reserved_array(this._flags.last_token,["var","let","const","set","get"]))){this.handle_whitespace_and_comments(e);this.print_newline()}else{this.handle_whitespace_and_comments(e)}if(this._flags.do_block&&!this._flags.do_while){if(reserved_word(e,"while")){this._output.space_before_token=true;this.print_token(e);this._output.space_before_token=true;this._flags.do_while=true;return}else{this.print_newline();this._flags.do_block=false}}if(this._flags.if_block){if(!this._flags.else_block&&reserved_word(e,"else")){this._flags.else_block=true}else{while(this._flags.mode===v.Statement){this.restore_mode()}this._flags.if_block=false;this._flags.else_block=false}}if(this._flags.in_case_statement&&reserved_array(e,["case","default"])){this.print_newline();if(!this._flags.case_block&&(this._flags.case_body||this._options.jslint_happy)){this.deindent()}this._flags.case_body=false;this.print_token(e);this._flags.in_case=true;return}if(this._flags.last_token.type===_.COMMA||this._flags.last_token.type===_.START_EXPR||this._flags.last_token.type===_.EQUALS||this._flags.last_token.type===_.OPERATOR){if(!this.start_of_object_property()&&!(in_array(this._flags.last_token.text,["+","-"])&&this._last_last_text===":"&&this._flags.parent.mode===v.ObjectLiteral)){this.allow_wrap_or_preserved_newline(e)}}if(reserved_word(e,"function")){if(in_array(this._flags.last_token.text,["}",";"])||this._output.just_added_newline()&&!(in_array(this._flags.last_token.text,["(","[","{",":","=",","])||this._flags.last_token.type===_.OPERATOR)){if(!this._output.just_added_blankline()&&!e.comments_before){this.print_newline();this.print_newline(true)}}if(this._flags.last_token.type===_.RESERVED||this._flags.last_token.type===_.WORD){if(reserved_array(this._flags.last_token,["get","set","new","export"])||reserved_array(this._flags.last_token,E)){this._output.space_before_token=true}else if(reserved_word(this._flags.last_token,"default")&&this._last_last_text==="export"){this._output.space_before_token=true}else if(this._flags.last_token.text==="declare"){this._output.space_before_token=true}else{this.print_newline()}}else if(this._flags.last_token.type===_.OPERATOR||this._flags.last_token.text==="="){this._output.space_before_token=true}else if(!this._flags.multiline_frame&&(is_expression(this._flags.mode)||is_array(this._flags.mode))){}else{this.print_newline()}this.print_token(e);this._flags.last_word=e.text;return}var r="NONE";if(this._flags.last_token.type===_.END_BLOCK){if(this._previous_flags.inline_frame){r="SPACE"}else if(!reserved_array(e,["else","catch","finally","from"])){r="NEWLINE"}else{if(this._options.brace_style==="expand"||this._options.brace_style==="end-expand"||this._options.brace_style==="none"&&e.newlines){r="NEWLINE"}else{r="SPACE";this._output.space_before_token=true}}}else if(this._flags.last_token.type===_.SEMICOLON&&this._flags.mode===v.BlockStatement){r="NEWLINE"}else if(this._flags.last_token.type===_.SEMICOLON&&is_expression(this._flags.mode)){r="SPACE"}else if(this._flags.last_token.type===_.STRING){r="NEWLINE"}else if(this._flags.last_token.type===_.RESERVED||this._flags.last_token.type===_.WORD||this._flags.last_token.text==="*"&&(in_array(this._last_last_text,["function","yield"])||this._flags.mode===v.ObjectLiteral&&in_array(this._last_last_text,["{",","]))){r="SPACE"}else if(this._flags.last_token.type===_.START_BLOCK){if(this._flags.inline_frame){r="SPACE"}else{r="NEWLINE"}}else if(this._flags.last_token.type===_.END_EXPR){this._output.space_before_token=true;r="NEWLINE"}if(reserved_array(e,f)&&this._flags.last_token.text!==")"){if(this._flags.inline_frame||this._flags.last_token.text==="else"||this._flags.last_token.text==="export"){r="SPACE"}else{r="NEWLINE"}}if(reserved_array(e,["else","catch","finally"])){if((!(this._flags.last_token.type===_.END_BLOCK&&this._previous_flags.mode===v.BlockStatement)||this._options.brace_style==="expand"||this._options.brace_style==="end-expand"||this._options.brace_style==="none"&&e.newlines)&&!this._flags.inline_frame){this.print_newline()}else{this._output.trim(true);var s=this._output.current_line;if(s.last()!=="}"){this.print_newline()}this._output.space_before_token=true}}else if(r==="NEWLINE"){if(reserved_array(this._flags.last_token,m)){this._output.space_before_token=true}else if(this._flags.last_token.text==="declare"&&reserved_array(e,["var","let","const"])){this._output.space_before_token=true}else if(this._flags.last_token.type!==_.END_EXPR){if((this._flags.last_token.type!==_.START_EXPR||!reserved_array(e,["var","let","const"]))&&this._flags.last_token.text!==":"){if(reserved_word(e,"if")&&reserved_word(e.previous,"else")){this._output.space_before_token=true}else{this.print_newline()}}}else if(reserved_array(e,f)&&this._flags.last_token.text!==")"){this.print_newline()}}else if(this._flags.multiline_frame&&is_array(this._flags.mode)&&this._flags.last_token.text===","&&this._last_last_text==="}"){this.print_newline()}else if(r==="SPACE"){this._output.space_before_token=true}if(e.previous&&(e.previous.type===_.WORD||e.previous.type===_.RESERVED)){this._output.space_before_token=true}this.print_token(e);this._flags.last_word=e.text;if(e.type===_.RESERVED){if(e.text==="do"){this._flags.do_block=true}else if(e.text==="if"){this._flags.if_block=true}else if(e.text==="import"){this._flags.import_block=true}else if(this._flags.import_block&&reserved_word(e,"from")){this._flags.import_block=false}}};Beautifier.prototype.handle_semicolon=function(e){if(this.start_of_statement(e)){this._output.space_before_token=false}else{this.handle_whitespace_and_comments(e)}var t=this._tokens.peek();while(this._flags.mode===v.Statement&&!(this._flags.if_block&&reserved_word(t,"else"))&&!this._flags.do_block){this.restore_mode()}if(this._flags.import_block){this._flags.import_block=false}this.print_token(e)};Beautifier.prototype.handle_string=function(e){if(e.text.startsWith("`")&&e.newlines===0&&e.whitespace_before===""&&(e.previous.text===")"||this._flags.last_token.type===_.WORD)){}else if(this.start_of_statement(e)){this._output.space_before_token=true}else{this.handle_whitespace_and_comments(e);if(this._flags.last_token.type===_.RESERVED||this._flags.last_token.type===_.WORD||this._flags.inline_frame){this._output.space_before_token=true}else if(this._flags.last_token.type===_.COMMA||this._flags.last_token.type===_.START_EXPR||this._flags.last_token.type===_.EQUALS||this._flags.last_token.type===_.OPERATOR){if(!this.start_of_object_property()){this.allow_wrap_or_preserved_newline(e)}}else if(e.text.startsWith("`")&&this._flags.last_token.type===_.END_EXPR&&(e.previous.text==="]"||e.previous.text===")")&&e.newlines===0){this._output.space_before_token=true}else{this.print_newline()}}this.print_token(e)};Beautifier.prototype.handle_equals=function(e){if(this.start_of_statement(e)){}else{this.handle_whitespace_and_comments(e)}if(this._flags.declaration_statement){this._flags.declaration_assignment=true}this._output.space_before_token=true;this.print_token(e);this._output.space_before_token=true};Beautifier.prototype.handle_comma=function(e){this.handle_whitespace_and_comments(e,true);this.print_token(e);this._output.space_before_token=true;if(this._flags.declaration_statement){if(is_expression(this._flags.parent.mode)){this._flags.declaration_assignment=false}if(this._flags.declaration_assignment){this._flags.declaration_assignment=false;this.print_newline(false,true)}else if(this._options.comma_first){this.allow_wrap_or_preserved_newline(e)}}else if(this._flags.mode===v.ObjectLiteral||this._flags.mode===v.Statement&&this._flags.parent.mode===v.ObjectLiteral){if(this._flags.mode===v.Statement){this.restore_mode()}if(!this._flags.inline_frame){this.print_newline()}}else if(this._options.comma_first){this.allow_wrap_or_preserved_newline(e)}};Beautifier.prototype.handle_operator=function(e){var t=e.text==="*"&&(reserved_array(this._flags.last_token,["function","yield"])||in_array(this._flags.last_token.type,[_.START_BLOCK,_.COMMA,_.END_BLOCK,_.SEMICOLON]));var r=in_array(e.text,["-","+"])&&(in_array(this._flags.last_token.type,[_.START_BLOCK,_.START_EXPR,_.EQUALS,_.OPERATOR])||in_array(this._flags.last_token.text,f)||this._flags.last_token.text===",");if(this.start_of_statement(e)){}else{var s=!t;this.handle_whitespace_and_comments(e,s)}if(e.text==="*"&&this._flags.last_token.type===_.DOT){this.print_token(e);return}if(e.text==="::"){this.print_token(e);return}if(in_array(e.text,["-","+"])&&this.start_of_object_property()){this.print_token(e);return}if(this._flags.last_token.type===_.OPERATOR&&in_array(this._options.operator_position,b)){this.allow_wrap_or_preserved_newline(e)}if(e.text===":"&&this._flags.in_case){this.print_token(e);this._flags.in_case=false;this._flags.case_body=true;if(this._tokens.peek().type!==_.START_BLOCK){this.indent();this.print_newline();this._flags.case_block=false}else{this._flags.case_block=true;this._output.space_before_token=true}return}var a=true;var u=true;var l=false;if(e.text===":"){if(this._flags.ternary_depth===0){a=false}else{this._flags.ternary_depth-=1;l=true}}else if(e.text==="?"){this._flags.ternary_depth+=1}if(!r&&!t&&this._options.preserve_newlines&&in_array(e.text,d)){var h=e.text===":";var g=h&&l;var E=h&&!l;switch(this._options.operator_position){case y.before_newline:this._output.space_before_token=!E;this.print_token(e);if(!h||g){this.allow_wrap_or_preserved_newline(e)}this._output.space_before_token=true;return;case y.after_newline:this._output.space_before_token=true;if(!h||g){if(this._tokens.peek().newlines){this.print_newline(false,true)}else{this.allow_wrap_or_preserved_newline(e)}}else{this._output.space_before_token=false}this.print_token(e);this._output.space_before_token=true;return;case y.preserve_newline:if(!E){this.allow_wrap_or_preserved_newline(e)}a=!(this._output.just_added_newline()||E);this._output.space_before_token=a;this.print_token(e);this._output.space_before_token=true;return}}if(t){this.allow_wrap_or_preserved_newline(e);a=false;var T=this._tokens.peek();u=T&&in_array(T.type,[_.WORD,_.RESERVED])}else if(e.text==="..."){this.allow_wrap_or_preserved_newline(e);a=this._flags.last_token.type===_.START_BLOCK;u=false}else if(in_array(e.text,["--","++","!","~"])||r){if(this._flags.last_token.type===_.COMMA||this._flags.last_token.type===_.START_EXPR){this.allow_wrap_or_preserved_newline(e)}a=false;u=false;if(e.newlines&&(e.text==="--"||e.text==="++"||e.text==="~")){var k=reserved_array(this._flags.last_token,m)&&e.newlines;if(k&&(this._previous_flags.if_block||this._previous_flags.else_block)){this.restore_mode()}this.print_newline(k,true)}if(this._flags.last_token.text===";"&&is_expression(this._flags.mode)){a=true}if(this._flags.last_token.type===_.RESERVED){a=true}else if(this._flags.last_token.type===_.END_EXPR){a=!(this._flags.last_token.text==="]"&&(e.text==="--"||e.text==="++"))}else if(this._flags.last_token.type===_.OPERATOR){a=in_array(e.text,["--","-","++","+"])&&in_array(this._flags.last_token.text,["--","-","++","+"]);if(in_array(e.text,["+","-"])&&in_array(this._flags.last_token.text,["--","++"])){u=true}}if((this._flags.mode===v.BlockStatement&&!this._flags.inline_frame||this._flags.mode===v.Statement)&&(this._flags.last_token.text==="{"||this._flags.last_token.text===";")){this.print_newline()}}this._output.space_before_token=this._output.space_before_token||a;this.print_token(e);this._output.space_before_token=u};Beautifier.prototype.handle_block_comment=function(e,t){if(this._output.raw){this._output.add_raw_token(e);if(e.directives&&e.directives.preserve==="end"){this._output.raw=this._options.test_output_raw}return}if(e.directives){this.print_newline(false,t);this.print_token(e);if(e.directives.preserve==="start"){this._output.raw=true}this.print_newline(false,true);return}if(!u.newline.test(e.text)&&!e.newlines){this._output.space_before_token=true;this.print_token(e);this._output.space_before_token=true;return}else{this.print_block_commment(e,t)}};Beautifier.prototype.print_block_commment=function(e,t){var r=split_linebreaks(e.text);var s;var a=false;var u=false;var l=e.whitespace_before;var h=l.length;this.print_newline(false,t);this.print_token_line_indentation(e);this._output.add_token(r[0]);this.print_newline(false,t);if(r.length>1){r=r.slice(1);a=all_lines_start_with(r,"*");u=each_line_matches_indent(r,l);if(a){this._flags.alignment=1}for(s=0;s<r.length;s++){if(a){this.print_token_line_indentation(e);this._output.add_token(ltrim(r[s]))}else if(u&&r[s]){this.print_token_line_indentation(e);this._output.add_token(r[s].substring(h))}else{this._output.current_line.set_indent(-1);this._output.add_token(r[s])}this.print_newline(false,t)}this._flags.alignment=0}};Beautifier.prototype.handle_comment=function(e,t){if(e.newlines){this.print_newline(false,t)}else{this._output.trim(true)}this._output.space_before_token=true;this.print_token(e);this.print_newline(false,t)};Beautifier.prototype.handle_dot=function(e){if(this.start_of_statement(e)){}else{this.handle_whitespace_and_comments(e,true)}if(this._flags.last_token.text.match("^[0-9]+$")){this._output.space_before_token=true}if(reserved_array(this._flags.last_token,m)){this._output.space_before_token=false}else{this.allow_wrap_or_preserved_newline(e,this._flags.last_token.text===")"&&this._options.break_chained_methods)}if(this._options.unindent_chained_methods&&this._output.just_added_newline()){this.deindent()}this.print_token(e)};Beautifier.prototype.handle_unknown=function(e,t){this.print_token(e);if(e.text[e.text.length-1]==="\n"){this.print_newline(false,t)}};Beautifier.prototype.handle_eof=function(e){while(this._flags.mode===v.Statement){this.restore_mode()}this.handle_whitespace_and_comments(e)};e.exports.P=Beautifier},611:(e,t,r)=>{var s=r(877).P,a=r(833).J;function js_beautify(e,t){var r=new s(e,t);return r.beautify()}e.exports=js_beautify;e.exports.defaultOptions=function(){return new a}},833:(e,t,r)=>{var s=r(301).JY;var a=["before-newline","after-newline","preserve-newline"];function Options(e){s.call(this,e,"js");var t=this.raw_options.brace_style||null;if(t==="expand-strict"){this.raw_options.brace_style="expand"}else if(t==="collapse-preserve-inline"){this.raw_options.brace_style="collapse,preserve-inline"}else if(this.raw_options.braces_on_own_line!==undefined){this.raw_options.brace_style=this.raw_options.braces_on_own_line?"expand":"collapse"}var r=this._get_selection_list("brace_style",["collapse","expand","end-expand","none","preserve-inline"]);this.brace_preserve_inline=false;this.brace_style="collapse";for(var u=0;u<r.length;u++){if(r[u]==="preserve-inline"){this.brace_preserve_inline=true}else{this.brace_style=r[u]}}this.unindent_chained_methods=this._get_boolean("unindent_chained_methods");this.break_chained_methods=this._get_boolean("break_chained_methods");this.space_in_paren=this._get_boolean("space_in_paren");this.space_in_empty_paren=this._get_boolean("space_in_empty_paren");this.jslint_happy=this._get_boolean("jslint_happy");this.space_after_anon_function=this._get_boolean("space_after_anon_function");this.space_after_named_function=this._get_boolean("space_after_named_function");this.keep_array_indentation=this._get_boolean("keep_array_indentation");this.space_before_conditional=this._get_boolean("space_before_conditional",true);this.unescape_strings=this._get_boolean("unescape_strings");this.e4x=this._get_boolean("e4x");this.comma_first=this._get_boolean("comma_first");this.operator_position=this._get_selection("operator_position",a);this.test_output_raw=this._get_boolean("test_output_raw");if(this.jslint_happy){this.space_after_anon_function=true}}Options.prototype=new s;e.exports.J=Options},982:(e,t,r)=>{var s=r(713).z;var a=r(170)._;var u=r(170).C;var l=r(657).D;var h=r(434);var f=r(569).z;var d=r(392).i;function in_array(e,t){return t.indexOf(e)!==-1}var _={START_EXPR:"TK_START_EXPR",END_EXPR:"TK_END_EXPR",START_BLOCK:"TK_START_BLOCK",END_BLOCK:"TK_END_BLOCK",WORD:"TK_WORD",RESERVED:"TK_RESERVED",SEMICOLON:"TK_SEMICOLON",STRING:"TK_STRING",EQUALS:"TK_EQUALS",OPERATOR:"TK_OPERATOR",COMMA:"TK_COMMA",BLOCK_COMMENT:"TK_BLOCK_COMMENT",COMMENT:"TK_COMMENT",DOT:"TK_DOT",UNKNOWN:"TK_UNKNOWN",START:u.START,RAW:u.RAW,EOF:u.EOF};var m=new l(/\/\*/,/\*\//);var g=/0[xX][0123456789abcdefABCDEF_]*n?|0[oO][01234567_]*n?|0[bB][01_]*n?|\d[\d_]*n|(?:\.\d[\d_]*|\d[\d_]*\.?[\d_]*)(?:[eE][+-]?[\d_]+)?/;var y=/[0-9]/;var b=/[^\d\.]/;var v=(">>> === !== &&= ??= ||= "+"<< && >= ** != == <= >> || ?? |> "+"< / - + > : & % ? ^ | *").split(" ");var E=">>>= "+"... >>= <<= === >>> !== **= &&= ??= ||= "+"=> ^= :: /= << <= == && -= >= >> != -- += ** || ?? ++ %= &= *= |= |> "+"= ! ? > < : / ^ - + * & % ~ |";E=E.replace(/[-[\]{}()*+?.,\\^$|#]/g,"\\$&");E="\\?\\.(?!\\d) "+E;E=E.replace(/ /g,"|");var T=new RegExp(E);var k="continue,try,throw,return,var,let,const,if,switch,case,default,for,while,break,function,import,export".split(",");var x=k.concat(["do","in","of","else","get","set","new","catch","finally","typeof","yield","async","await","from","as","class","extends"]);var O=new RegExp("^(?:"+x.join("|")+")$");var A;var Tokenizer=function(e,t){a.call(this,e,t);this._patterns.whitespace=this._patterns.whitespace.matching(/\u00A0\u1680\u180e\u2000-\u200a\u202f\u205f\u3000\ufeff/.source,/\u2028\u2029/.source);var r=new f(this._input);var s=new d(this._input).read_options(this._options);this.__patterns={template:s,identifier:s.starting_with(h.identifier).matching(h.identifierMatch),number:r.matching(g),punct:r.matching(T),comment:r.starting_with(/\/\//).until(/[\n\r\u2028\u2029]/),block_comment:r.starting_with(/\/\*/).until_after(/\*\//),html_comment_start:r.matching(/<!--/),html_comment_end:r.matching(/-->/),include:r.starting_with(/#include/).until_after(h.lineBreak),shebang:r.starting_with(/#!/).until_after(h.lineBreak),xml:r.matching(/[\s\S]*?<(\/?)([-a-zA-Z:0-9_.]+|{[^}]+?}|!\[CDATA\[[^\]]*?\]\]|)(\s*{[^}]+?}|\s+[-a-zA-Z:0-9_.]+|\s+[-a-zA-Z:0-9_.]+\s*=\s*('[^']*'|"[^"]*"|{([^{}]|{[^}]+?})+?}))*\s*(\/?)\s*>/),single_quote:s.until(/['\\\n\r\u2028\u2029]/),double_quote:s.until(/["\\\n\r\u2028\u2029]/),template_text:s.until(/[`\\$]/),template_expression:s.until(/[`}\\]/)}};Tokenizer.prototype=new a;Tokenizer.prototype._is_comment=function(e){return e.type===_.COMMENT||e.type===_.BLOCK_COMMENT||e.type===_.UNKNOWN};Tokenizer.prototype._is_opening=function(e){return e.type===_.START_BLOCK||e.type===_.START_EXPR};Tokenizer.prototype._is_closing=function(e,t){return(e.type===_.END_BLOCK||e.type===_.END_EXPR)&&(t&&(e.text==="]"&&t.text==="["||e.text===")"&&t.text==="("||e.text==="}"&&t.text==="{"))};Tokenizer.prototype._reset=function(){A=false};Tokenizer.prototype._get_next_token=function(e,t){var r=null;this._readWhitespace();var s=this._input.peek();if(s===null){return this._create_token(_.EOF,"")}r=r||this._read_non_javascript(s);r=r||this._read_string(s);r=r||this._read_pair(s,this._input.peek(1));r=r||this._read_word(e);r=r||this._read_singles(s);r=r||this._read_comment(s);r=r||this._read_regexp(s,e);r=r||this._read_xml(s,e);r=r||this._read_punctuation();r=r||this._create_token(_.UNKNOWN,this._input.next());return r};Tokenizer.prototype._read_word=function(e){var t;t=this.__patterns.identifier.read();if(t!==""){t=t.replace(h.allLineBreaks,"\n");if(!(e.type===_.DOT||e.type===_.RESERVED&&(e.text==="set"||e.text==="get"))&&O.test(t)){if((t==="in"||t==="of")&&(e.type===_.WORD||e.type===_.STRING)){return this._create_token(_.OPERATOR,t)}return this._create_token(_.RESERVED,t)}return this._create_token(_.WORD,t)}t=this.__patterns.number.read();if(t!==""){return this._create_token(_.WORD,t)}};Tokenizer.prototype._read_singles=function(e){var t=null;if(e==="("||e==="["){t=this._create_token(_.START_EXPR,e)}else if(e===")"||e==="]"){t=this._create_token(_.END_EXPR,e)}else if(e==="{"){t=this._create_token(_.START_BLOCK,e)}else if(e==="}"){t=this._create_token(_.END_BLOCK,e)}else if(e===";"){t=this._create_token(_.SEMICOLON,e)}else if(e==="."&&b.test(this._input.peek(1))){t=this._create_token(_.DOT,e)}else if(e===","){t=this._create_token(_.COMMA,e)}if(t){this._input.next()}return t};Tokenizer.prototype._read_pair=function(e,t){var r=null;if(e==="#"&&t==="{"){r=this._create_token(_.START_BLOCK,e+t)}if(r){this._input.next();this._input.next()}return r};Tokenizer.prototype._read_punctuation=function(){var e=this.__patterns.punct.read();if(e!==""){if(e==="="){return this._create_token(_.EQUALS,e)}else if(e==="?."){return this._create_token(_.DOT,e)}else{return this._create_token(_.OPERATOR,e)}}};Tokenizer.prototype._read_non_javascript=function(e){var t="";if(e==="#"){if(this._is_first_token()){t=this.__patterns.shebang.read();if(t){return this._create_token(_.UNKNOWN,t.trim()+"\n")}}t=this.__patterns.include.read();if(t){return this._create_token(_.UNKNOWN,t.trim()+"\n")}e=this._input.next();var r="#";if(this._input.hasNext()&&this._input.testChar(y)){do{e=this._input.next();r+=e}while(this._input.hasNext()&&e!=="#"&&e!=="=");if(e==="#"){}else if(this._input.peek()==="["&&this._input.peek(1)==="]"){r+="[]";this._input.next();this._input.next()}else if(this._input.peek()==="{"&&this._input.peek(1)==="}"){r+="{}";this._input.next();this._input.next()}return this._create_token(_.WORD,r)}this._input.back()}else if(e==="<"&&this._is_first_token()){t=this.__patterns.html_comment_start.read();if(t){while(this._input.hasNext()&&!this._input.testChar(h.newline)){t+=this._input.next()}A=true;return this._create_token(_.COMMENT,t)}}else if(A&&e==="-"){t=this.__patterns.html_comment_end.read();if(t){A=false;return this._create_token(_.COMMENT,t)}}return null};Tokenizer.prototype._read_comment=function(e){var t=null;if(e==="/"){var r="";if(this._input.peek(1)==="*"){r=this.__patterns.block_comment.read();var s=m.get_directives(r);if(s&&s.ignore==="start"){r+=m.readIgnored(this._input)}r=r.replace(h.allLineBreaks,"\n");t=this._create_token(_.BLOCK_COMMENT,r);t.directives=s}else if(this._input.peek(1)==="/"){r=this.__patterns.comment.read();t=this._create_token(_.COMMENT,r)}}return t};Tokenizer.prototype._read_string=function(e){if(e==="`"||e==="'"||e==='"'){var t=this._input.next();this.has_char_escapes=false;if(e==="`"){t+=this._read_string_recursive("`",true,"${")}else{t+=this._read_string_recursive(e)}if(this.has_char_escapes&&this._options.unescape_strings){t=unescape_string(t)}if(this._input.peek()===e){t+=this._input.next()}t=t.replace(h.allLineBreaks,"\n");return this._create_token(_.STRING,t)}return null};Tokenizer.prototype._allow_regexp_or_xml=function(e){return e.type===_.RESERVED&&in_array(e.text,["return","case","throw","else","do","typeof","yield"])||e.type===_.END_EXPR&&e.text===")"&&e.opened.previous.type===_.RESERVED&&in_array(e.opened.previous.text,["if","while","for"])||in_array(e.type,[_.COMMENT,_.START_EXPR,_.START_BLOCK,_.START,_.END_BLOCK,_.OPERATOR,_.EQUALS,_.EOF,_.SEMICOLON,_.COMMA])};Tokenizer.prototype._read_regexp=function(e,t){if(e==="/"&&this._allow_regexp_or_xml(t)){var r=this._input.next();var s=false;var a=false;while(this._input.hasNext()&&((s||a||this._input.peek()!==e)&&!this._input.testChar(h.newline))){r+=this._input.peek();if(!s){s=this._input.peek()==="\\";if(this._input.peek()==="["){a=true}else if(this._input.peek()==="]"){a=false}}else{s=false}this._input.next()}if(this._input.peek()===e){r+=this._input.next();r+=this._input.read(h.identifier)}return this._create_token(_.STRING,r)}return null};Tokenizer.prototype._read_xml=function(e,t){if(this._options.e4x&&e==="<"&&this._allow_regexp_or_xml(t)){var r="";var s=this.__patterns.xml.read_match();if(s){var a=s[2].replace(/^{\s+/,"{").replace(/\s+}$/,"}");var u=a.indexOf("{")===0;var l=0;while(s){var f=!!s[1];var d=s[2];var m=!!s[s.length-1]||d.slice(0,8)==="![CDATA[";if(!m&&(d===a||u&&d.replace(/^{\s+/,"{").replace(/\s+}$/,"}"))){if(f){--l}else{++l}}r+=s[0];if(l<=0){break}s=this.__patterns.xml.read_match()}if(!s){r+=this._input.match(/[\s\S]*/g)[0]}r=r.replace(h.allLineBreaks,"\n");return this._create_token(_.STRING,r)}}return null};function unescape_string(e){var t="",r=0;var a=new s(e);var u=null;while(a.hasNext()){u=a.match(/([\s]|[^\\]|\\\\)+/g);if(u){t+=u[0]}if(a.peek()==="\\"){a.next();if(a.peek()==="x"){u=a.match(/x([0-9A-Fa-f]{2})/g)}else if(a.peek()==="u"){u=a.match(/u([0-9A-Fa-f]{4})/g);if(!u){u=a.match(/u\{([0-9A-Fa-f]+)\}/g)}}else{t+="\\";if(a.hasNext()){t+=a.next()}continue}if(!u){return e}r=parseInt(u[1],16);if(r>126&&r<=255&&u[0].indexOf("x")===0){return e}else if(r>=0&&r<32){t+="\\"+u[0]}else if(r>1114111){t+="\\"+u[0]}else if(r===34||r===39||r===92){t+="\\"+String.fromCharCode(r)}else{t+=String.fromCharCode(r)}}}return t}Tokenizer.prototype._read_string_recursive=function(e,t,r){var s;var a;if(e==="'"){a=this.__patterns.single_quote}else if(e==='"'){a=this.__patterns.double_quote}else if(e==="`"){a=this.__patterns.template_text}else if(e==="}"){a=this.__patterns.template_expression}var u=a.read();var l="";while(this._input.hasNext()){l=this._input.next();if(l===e||!t&&h.newline.test(l)){this._input.back();break}else if(l==="\\"&&this._input.hasNext()){s=this._input.peek();if(s==="x"||s==="u"){this.has_char_escapes=true}else if(s==="\r"&&this._input.peek(1)==="\n"){this._input.next()}l+=this._input.next()}else if(r){if(r==="${"&&l==="$"&&this._input.peek()==="{"){l+=this._input.next()}if(r===l){if(e==="`"){l+=this._read_string_recursive("}",t,"`")}else{l+=this._read_string_recursive("`",t,"${")}if(this._input.hasNext()){l+=this._input.next()}}}l+=a.read();u+=l}return u};e.exports._F=Tokenizer;e.exports.CV=_;e.exports.OK=v.slice();e.exports.O0=k.slice()},299:function(e,t,r){
/* @license
Papa Parse
v5.5.3
https://github.com/mholt/PapaParse
License: MIT
*/
(function(t,r){if(typeof define==="function"&&define.amd){define([],r)}else if(true){e.exports=r()}else{}})(this,(function moduleFactory(){"use strict";var e=function(){if(typeof self!=="undefined"){return self}if(typeof window!=="undefined"){return window}if(typeof e!=="undefined"){return e}return{}}();function getWorkerBlob(){var t=e.URL||e.webkitURL||null;var r=moduleFactory.toString();return l.BLOB_URL||(l.BLOB_URL=t.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",r,")();"],{type:"text/javascript"})))}var t=!e.document&&!!e.postMessage,s=e.IS_PAPA_WORKER||false;var a={},u=0;var l={};l.parse=CsvToJson;l.unparse=JsonToCsv;l.RECORD_SEP=String.fromCharCode(30);l.UNIT_SEP=String.fromCharCode(31);l.BYTE_ORDER_MARK="\ufeff";l.BAD_DELIMITERS=["\r","\n",'"',l.BYTE_ORDER_MARK];l.WORKERS_SUPPORTED=!t&&!!e.Worker;l.NODE_STREAM_INPUT=1;l.LocalChunkSize=1024*1024*10;l.RemoteChunkSize=1024*1024*5;l.DefaultDelimiter=",";l.Parser=Parser;l.ParserHandle=ParserHandle;l.NetworkStreamer=NetworkStreamer;l.FileStreamer=FileStreamer;l.StringStreamer=StringStreamer;l.ReadableStreamStreamer=ReadableStreamStreamer;if(typeof PAPA_BROWSER_CONTEXT==="undefined"){l.DuplexStreamStreamer=DuplexStreamStreamer}if(e.jQuery){var h=e.jQuery;h.fn.parse=function(t){var r=t.config||{};var s=[];this.each((function(t){var a=h(this).prop("tagName").toUpperCase()==="INPUT"&&h(this).attr("type").toLowerCase()==="file"&&e.FileReader;if(!a||!this.files||this.files.length===0)return true;for(var u=0;u<this.files.length;u++){s.push({file:this.files[u],inputElem:this,instanceConfig:h.extend({},r)})}}));parseNextFile();return this;function parseNextFile(){if(s.length===0){if(isFunction(t.complete))t.complete();return}var e=s[0];if(isFunction(t.before)){var r=t.before(e.file,e.inputElem);if(typeof r==="object"){if(r.action==="abort"){error("AbortError",e.file,e.inputElem,r.reason);return}else if(r.action==="skip"){fileComplete();return}else if(typeof r.config==="object")e.instanceConfig=h.extend(e.instanceConfig,r.config)}else if(r==="skip"){fileComplete();return}}var a=e.instanceConfig.complete;e.instanceConfig.complete=function(t){if(isFunction(a))a(t,e.file,e.inputElem);fileComplete()};l.parse(e.file,e.instanceConfig)}function error(e,r,s,a){if(isFunction(t.error))t.error({name:e},r,s,a)}function fileComplete(){s.splice(0,1);parseNextFile()}}}if(s){e.onmessage=workerThreadReceivedMessage}function CsvToJson(t,r){r=r||{};var s=r.dynamicTyping||false;if(isFunction(s)){r.dynamicTypingFunction=s;s={}}r.dynamicTyping=s;r.transform=isFunction(r.transform)?r.transform:false;if(r.worker&&l.WORKERS_SUPPORTED){var a=newWorker();a.userStep=r.step;a.userChunk=r.chunk;a.userComplete=r.complete;a.userError=r.error;r.step=isFunction(r.step);r.chunk=isFunction(r.chunk);r.complete=isFunction(r.complete);r.error=isFunction(r.error);delete r.worker;a.postMessage({input:t,config:r,workerId:a.id});return}var u=null;if(t===l.NODE_STREAM_INPUT&&typeof PAPA_BROWSER_CONTEXT==="undefined"){u=new DuplexStreamStreamer(r);return u.getStream()}else if(typeof t==="string"){t=stripBom(t);if(r.download)u=new NetworkStreamer(r);else u=new StringStreamer(r)}else if(t.readable===true&&isFunction(t.read)&&isFunction(t.on)){u=new ReadableStreamStreamer(r)}else if(e.File&&t instanceof File||t instanceof Object)u=new FileStreamer(r);return u.stream(t);function stripBom(e){if(e.charCodeAt(0)===65279){return e.slice(1)}return e}}function JsonToCsv(e,t){var r=false;var s=true;var a=",";var u="\r\n";var h='"';var f=h+h;var d=false;var _=null;var m=false;unpackConfig();var g=new RegExp(escapeRegExp(h),"g");if(typeof e==="string")e=JSON.parse(e);if(Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return serialize(null,e,d);else if(typeof e[0]==="object")return serialize(_||Object.keys(e[0]),e,d)}else if(typeof e==="object"){if(typeof e.data==="string")e.data=JSON.parse(e.data);if(Array.isArray(e.data)){if(!e.fields)e.fields=e.meta&&e.meta.fields||_;if(!e.fields)e.fields=Array.isArray(e.data[0])?e.fields:typeof e.data[0]==="object"?Object.keys(e.data[0]):[];if(!Array.isArray(e.data[0])&&typeof e.data[0]!=="object")e.data=[e.data]}return serialize(e.fields||[],e.data||[],d)}throw new Error("Unable to serialize unrecognized input");function unpackConfig(){if(typeof t!=="object")return;if(typeof t.delimiter==="string"&&!l.BAD_DELIMITERS.filter((function(e){return t.delimiter.indexOf(e)!==-1})).length){a=t.delimiter}if(typeof t.quotes==="boolean"||typeof t.quotes==="function"||Array.isArray(t.quotes))r=t.quotes;if(typeof t.skipEmptyLines==="boolean"||typeof t.skipEmptyLines==="string")d=t.skipEmptyLines;if(typeof t.newline==="string")u=t.newline;if(typeof t.quoteChar==="string")h=t.quoteChar;if(typeof t.header==="boolean")s=t.header;if(Array.isArray(t.columns)){if(t.columns.length===0)throw new Error("Option columns is empty");_=t.columns}if(t.escapeChar!==undefined){f=t.escapeChar+h}if(t.escapeFormulae instanceof RegExp){m=t.escapeFormulae}else if(typeof t.escapeFormulae==="boolean"&&t.escapeFormulae){m=/^[=+\-@\t\r].*$/}}function serialize(e,t,r){var l="";if(typeof e==="string")e=JSON.parse(e);if(typeof t==="string")t=JSON.parse(t);var h=Array.isArray(e)&&e.length>0;var f=!Array.isArray(t[0]);if(h&&s){for(var d=0;d<e.length;d++){if(d>0)l+=a;l+=safe(e[d],d)}if(t.length>0)l+=u}for(var _=0;_<t.length;_++){var m=h?e.length:t[_].length;var g=false;var y=h?Object.keys(t[_]).length===0:t[_].length===0;if(r&&!h){g=r==="greedy"?t[_].join("").trim()==="":t[_].length===1&&t[_][0].length===0}if(r==="greedy"&&h){var b=[];for(var v=0;v<m;v++){var E=f?e[v]:v;b.push(t[_][E])}g=b.join("").trim()===""}if(!g){for(var T=0;T<m;T++){if(T>0&&!y)l+=a;var k=h&&f?e[T]:T;l+=safe(t[_][k],T)}if(_<t.length-1&&(!r||m>0&&!y)){l+=u}}}return l}function safe(e,t){if(typeof e==="undefined"||e===null)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);var s=false;if(m&&typeof e==="string"&&m.test(e)){e="'"+e;s=true}var u=e.toString().replace(g,f);s=s||r===true||typeof r==="function"&&r(e,t)||Array.isArray(r)&&r[t]||hasAny(u,l.BAD_DELIMITERS)||u.indexOf(a)>-1||u.charAt(0)===" "||u.charAt(u.length-1)===" ";return s?h+u+h:u}function hasAny(e,t){for(var r=0;r<t.length;r++)if(e.indexOf(t[r])>-1)return true;return false}}function ChunkStreamer(t){this._handle=null;this._finished=false;this._completed=false;this._halted=false;this._input=null;this._baseIndex=0;this._partialLine="";this._rowCount=0;this._start=0;this._nextChunk=null;this.isFirstChunk=true;this._completeResults={data:[],errors:[],meta:{}};replaceConfig.call(this,t);this.parseChunk=function(t,r){const a=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&a>0){let e=this._config.newline;if(!e){const r=this._config.quoteChar||'"';e=this._handle.guessLineEndings(t,r)}const r=t.split(e);t=[...r.slice(a)].join(e)}if(this.isFirstChunk&&isFunction(this._config.beforeFirstChunk)){var u=this._config.beforeFirstChunk(t);if(u!==undefined)t=u}this.isFirstChunk=false;this._halted=false;var h=this._partialLine+t;this._partialLine="";var f=this._handle.parse(h,this._baseIndex,!this._finished);if(this._handle.paused()||this._handle.aborted()){this._halted=true;return}var d=f.meta.cursor;if(!this._finished){this._partialLine=h.substring(d-this._baseIndex);this._baseIndex=d}if(f&&f.data)this._rowCount+=f.data.length;var _=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(s){e.postMessage({results:f,workerId:l.WORKER_ID,finished:_})}else if(isFunction(this._config.chunk)&&!r){this._config.chunk(f,this._handle);if(this._handle.paused()||this._handle.aborted()){this._halted=true;return}f=undefined;this._completeResults=undefined}if(!this._config.step&&!this._config.chunk){this._completeResults.data=this._completeResults.data.concat(f.data);this._completeResults.errors=this._completeResults.errors.concat(f.errors);this._completeResults.meta=f.meta}if(!this._completed&&_&&isFunction(this._config.complete)&&(!f||!f.meta.aborted)){this._config.complete(this._completeResults,this._input);this._completed=true}if(!_&&(!f||!f.meta.paused))this._nextChunk();return f};this._sendError=function(t){if(isFunction(this._config.error))this._config.error(t);else if(s&&this._config.error){e.postMessage({workerId:l.WORKER_ID,error:t,finished:false})}};function replaceConfig(e){var t=copy(e);t.chunkSize=parseInt(t.chunkSize);if(!e.step&&!e.chunk)t.chunkSize=null;this._handle=new ParserHandle(t);this._handle.streamer=this;this._config=t}}function NetworkStreamer(e){e=e||{};if(!e.chunkSize)e.chunkSize=l.RemoteChunkSize;ChunkStreamer.call(this,e);var r;if(t){this._nextChunk=function(){this._readChunk();this._chunkLoaded()}}else{this._nextChunk=function(){this._readChunk()}}this.stream=function(e){this._input=e;this._nextChunk()};this._readChunk=function(){if(this._finished){this._chunkLoaded();return}r=new XMLHttpRequest;if(this._config.withCredentials){r.withCredentials=this._config.withCredentials}if(!t){r.onload=bindFunction(this._chunkLoaded,this);r.onerror=bindFunction(this._chunkError,this)}r.open(this._config.downloadRequestBody?"POST":"GET",this._input,!t);if(this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var s in e){r.setRequestHeader(s,e[s])}}if(this._config.chunkSize){var a=this._start+this._config.chunkSize-1;r.setRequestHeader("Range","bytes="+this._start+"-"+a)}try{r.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}if(t&&r.status===0)this._chunkError()};this._chunkLoaded=function(){if(r.readyState!==4)return;if(r.status<200||r.status>=400){this._chunkError();return}this._start+=this._config.chunkSize?this._config.chunkSize:r.responseText.length;this._finished=!this._config.chunkSize||this._start>=getFileSize(r);this.parseChunk(r.responseText)};this._chunkError=function(e){var t=r.statusText||e;this._sendError(new Error(t))};function getFileSize(e){var t=e.getResponseHeader("Content-Range");if(t===null){return-1}return parseInt(t.substring(t.lastIndexOf("/")+1))}}NetworkStreamer.prototype=Object.create(ChunkStreamer.prototype);NetworkStreamer.prototype.constructor=NetworkStreamer;function FileStreamer(e){e=e||{};if(!e.chunkSize)e.chunkSize=l.LocalChunkSize;ChunkStreamer.call(this,e);var t,r;var s=typeof FileReader!=="undefined";this.stream=function(e){this._input=e;r=e.slice||e.webkitSlice||e.mozSlice;if(s){t=new FileReader;t.onload=bindFunction(this._chunkLoaded,this);t.onerror=bindFunction(this._chunkError,this)}else t=new FileReaderSync;this._nextChunk()};this._nextChunk=function(){if(!this._finished&&(!this._config.preview||this._rowCount<this._config.preview))this._readChunk()};this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var a=Math.min(this._start+this._config.chunkSize,this._input.size);e=r.call(e,this._start,a)}var u=t.readAsText(e,this._config.encoding);if(!s)this._chunkLoaded({target:{result:u}})};this._chunkLoaded=function(e){this._start+=this._config.chunkSize;this._finished=!this._config.chunkSize||this._start>=this._input.size;this.parseChunk(e.target.result)};this._chunkError=function(){this._sendError(t.error)}}FileStreamer.prototype=Object.create(ChunkStreamer.prototype);FileStreamer.prototype.constructor=FileStreamer;function StringStreamer(e){e=e||{};ChunkStreamer.call(this,e);var t;this.stream=function(e){t=e;return this._nextChunk()};this._nextChunk=function(){if(this._finished)return;var e=this._config.chunkSize;var r;if(e){r=t.substring(0,e);t=t.substring(e)}else{r=t;t=""}this._finished=!t;return this.parseChunk(r)}}StringStreamer.prototype=Object.create(StringStreamer.prototype);StringStreamer.prototype.constructor=StringStreamer;function ReadableStreamStreamer(e){e=e||{};ChunkStreamer.call(this,e);var t=[];var r=true;var s=false;this.pause=function(){ChunkStreamer.prototype.pause.apply(this,arguments);this._input.pause()};this.resume=function(){ChunkStreamer.prototype.resume.apply(this,arguments);this._input.resume()};this.stream=function(e){this._input=e;this._input.on("data",this._streamData);this._input.on("end",this._streamEnd);this._input.on("error",this._streamError)};this._checkIsFinished=function(){if(s&&t.length===1){this._finished=true}};this._nextChunk=function(){this._checkIsFinished();if(t.length){this.parseChunk(t.shift())}else{r=true}};this._streamData=bindFunction((function(e){try{t.push(typeof e==="string"?e:e.toString(this._config.encoding));if(r){r=false;this._checkIsFinished();this.parseChunk(t.shift())}}catch(e){this._streamError(e)}}),this);this._streamError=bindFunction((function(e){this._streamCleanUp();this._sendError(e)}),this);this._streamEnd=bindFunction((function(){this._streamCleanUp();s=true;this._streamData("")}),this);this._streamCleanUp=bindFunction((function(){this._input.removeListener("data",this._streamData);this._input.removeListener("end",this._streamEnd);this._input.removeListener("error",this._streamError)}),this)}ReadableStreamStreamer.prototype=Object.create(ChunkStreamer.prototype);ReadableStreamStreamer.prototype.constructor=ReadableStreamStreamer;function DuplexStreamStreamer(e){var t=r(203).Duplex;var s=copy(e);var a=true;var u=false;var l=[];var h=null;this._onCsvData=function(e){var t=e.data;if(!h.push(t)&&!this._handle.paused()){this._handle.pause()}};this._onCsvComplete=function(){h.push(null)};s.step=bindFunction(this._onCsvData,this);s.complete=bindFunction(this._onCsvComplete,this);ChunkStreamer.call(this,s);this._nextChunk=function(){if(u&&l.length===1){this._finished=true}if(l.length){l.shift()()}else{a=true}};this._addToParseQueue=function(e,t){l.push(bindFunction((function(){this.parseChunk(typeof e==="string"?e:e.toString(s.encoding));if(isFunction(t)){return t()}}),this));if(a){a=false;this._nextChunk()}};this._onRead=function(){if(this._handle.paused()){this._handle.resume()}};this._onWrite=function(e,t,r){this._addToParseQueue(e,r)};this._onWriteComplete=function(){u=true;this._addToParseQueue("")};this.getStream=function(){return h};h=new t({readableObjectMode:true,decodeStrings:false,read:bindFunction(this._onRead,this),write:bindFunction(this._onWrite,this)});h.once("finish",bindFunction(this._onWriteComplete,this))}if(typeof PAPA_BROWSER_CONTEXT==="undefined"){DuplexStreamStreamer.prototype=Object.create(ChunkStreamer.prototype);DuplexStreamStreamer.prototype.constructor=DuplexStreamStreamer}function ParserHandle(e){var t=Math.pow(2,53);var r=-t;var s=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/;var a=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/;var u=this;var h=0;var f=0;var d;var _;var m=false;var g=false;var y;var b=[];var v={data:[],errors:[],meta:{}};if(isFunction(e.step)){var E=e.step;e.step=function(t){v=t;if(needsHeaderRow())processResults();else{processResults();if(v.data.length===0)return;h+=t.data.length;if(e.preview&&h>e.preview)_.abort();else{v.data=v.data[0];E(v,u)}}}}this.parse=function(t,r,s){var a=e.quoteChar||'"';if(!e.newline)e.newline=this.guessLineEndings(t,a);y=false;if(!e.delimiter){var u=guessDelimiter(t,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess);if(u.successful)e.delimiter=u.bestDelimiter;else{y=true;e.delimiter=l.DefaultDelimiter}v.meta.delimiter=e.delimiter}else if(isFunction(e.delimiter)){e.delimiter=e.delimiter(t);v.meta.delimiter=e.delimiter}var h=copy(e);if(e.preview&&e.header)h.preview++;d=t;_=new Parser(h);v=_.parse(d,r,s);processResults();return m?{meta:{paused:true}}:v||{meta:{paused:false}}};this.paused=function(){return m};this.pause=function(){m=true;_.abort();d=isFunction(e.chunk)?"":d.substring(_.getCharIndex())};this.resume=function(){if(u.streamer._halted){m=false;u.streamer.parseChunk(d,true)}else{setTimeout(u.resume,3)}};this.aborted=function(){return g};this.abort=function(){g=true;_.abort();v.meta.aborted=true;if(isFunction(e.complete))e.complete(v);d=""};this.guessLineEndings=function(e,t){e=e.substring(0,1024*1024);var r=new RegExp(escapeRegExp(t)+"([^]*?)"+escapeRegExp(t),"gm");e=e.replace(r,"");var s=e.split("\r");var a=e.split("\n");var u=a.length>1&&a[0].length<s[0].length;if(s.length===1||u)return"\n";var l=0;for(var h=0;h<s.length;h++){if(s[h][0]==="\n")l++}return l>=s.length/2?"\r\n":"\r"};function testEmptyLine(t){return e.skipEmptyLines==="greedy"?t.join("").trim()==="":t.length===1&&t[0].length===0}function testFloat(e){if(s.test(e)){var a=parseFloat(e);if(a>r&&a<t){return true}}return false}function processResults(){if(v&&y){addError("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+l.DefaultDelimiter+"'");y=false}if(e.skipEmptyLines){v.data=v.data.filter((function(e){return!testEmptyLine(e)}))}if(needsHeaderRow())fillHeaderFields();return applyHeaderAndDynamicTypingAndTransformation()}function needsHeaderRow(){return e.header&&b.length===0}function fillHeaderFields(){if(!v)return;function addHeader(t,r){if(isFunction(e.transformHeader))t=e.transformHeader(t,r);b.push(t)}if(Array.isArray(v.data[0])){for(var t=0;needsHeaderRow()&&t<v.data.length;t++)v.data[t].forEach(addHeader);v.data.splice(0,1)}else v.data.forEach(addHeader)}function shouldApplyDynamicTyping(t){if(e.dynamicTypingFunction&&e.dynamicTyping[t]===undefined){e.dynamicTyping[t]=e.dynamicTypingFunction(t)}return(e.dynamicTyping[t]||e.dynamicTyping)===true}function parseDynamic(e,t){if(shouldApplyDynamicTyping(e)){if(t==="true"||t==="TRUE")return true;else if(t==="false"||t==="FALSE")return false;else if(testFloat(t))return parseFloat(t);else if(a.test(t))return new Date(t);else return t===""?null:t}return t}function applyHeaderAndDynamicTypingAndTransformation(){if(!v||!e.header&&!e.dynamicTyping&&!e.transform)return v;function processRow(t,r){var s=e.header?{}:[];var a;for(a=0;a<t.length;a++){var u=a;var l=t[a];if(e.header)u=a>=b.length?"__parsed_extra":b[a];if(e.transform)l=e.transform(l,u);l=parseDynamic(u,l);if(u==="__parsed_extra"){s[u]=s[u]||[];s[u].push(l)}else s[u]=l}if(e.header){if(a>b.length)addError("FieldMismatch","TooManyFields","Too many fields: expected "+b.length+" fields but parsed "+a,f+r);else if(a<b.length)addError("FieldMismatch","TooFewFields","Too few fields: expected "+b.length+" fields but parsed "+a,f+r)}return s}var t=1;if(!v.data.length||Array.isArray(v.data[0])){v.data=v.data.map(processRow);t=v.data.length}else v.data=processRow(v.data,0);if(e.header&&v.meta)v.meta.fields=b;f+=t;return v}function guessDelimiter(t,r,s,a,u){var h,f,d,_;u=u||[",","\t","|",";",l.RECORD_SEP,l.UNIT_SEP];for(var m=0;m<u.length;m++){var g=u[m];var y=0,b=0,v=0;d=undefined;var E=new Parser({comments:a,delimiter:g,newline:r,preview:10}).parse(t);for(var T=0;T<E.data.length;T++){if(s&&testEmptyLine(E.data[T])){v++;continue}var k=E.data[T].length;b+=k;if(typeof d==="undefined"){d=k;continue}else if(k>0){y+=Math.abs(k-d);d=k}}if(E.data.length>0)b/=E.data.length-v;if((typeof f==="undefined"||y<=f)&&(typeof _==="undefined"||b>_)&&b>1.99){f=y;h=g;_=b}}e.delimiter=h;return{successful:!!h,bestDelimiter:h}}function addError(e,t,r,s){var a={type:e,code:t,message:r};if(s!==undefined){a.row=s}v.errors.push(a)}}function escapeRegExp(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Parser(e){e=e||{};var t=e.delimiter;var r=e.newline;var s=e.comments;var a=e.step;var u=e.preview;var h=e.fastMode;var f;var d=null;var _=false;if(e.quoteChar===undefined||e.quoteChar===null){f='"'}else{f=e.quoteChar}var m=f;if(e.escapeChar!==undefined){m=e.escapeChar}if(typeof t!=="string"||l.BAD_DELIMITERS.indexOf(t)>-1)t=",";if(s===t)throw new Error("Comment character same as delimiter");else if(s===true)s="#";else if(typeof s!=="string"||l.BAD_DELIMITERS.indexOf(s)>-1)s=false;if(r!=="\n"&&r!=="\r"&&r!=="\r\n")r="\n";var g=0;var y=false;this.parse=function(l,b,v){if(typeof l!=="string")throw new Error("Input must be a string");var E=l.length,T=t.length,k=r.length,x=s.length;var O=isFunction(a);g=0;var A=[],w=[],S=[],R=0;if(!l)return returnable();if(h||h!==false&&l.indexOf(f)===-1){var C=l.split(r);for(var I=0;I<C.length;I++){S=C[I];g+=S.length;if(I!==C.length-1)g+=r.length;else if(v)return returnable();if(s&&S.substring(0,x)===s)continue;if(O){A=[];pushRow(S.split(t));doStep();if(y)return returnable()}else pushRow(S.split(t));if(u&&I>=u){A=A.slice(0,u);return returnable(true)}}return returnable()}var L=l.indexOf(t,g);var P=l.indexOf(r,g);var M=new RegExp(escapeRegExp(m)+escapeRegExp(f),"g");var F=l.indexOf(f,g);for(;;){if(l[g]===f){F=g;g++;for(;;){F=l.indexOf(f,F+1);if(F===-1){if(!v){w.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:A.length,index:g})}return finish()}if(F===E-1){var D=l.substring(g,F).replace(M,f);return finish(D)}if(f===m&&l[F+1]===m){F++;continue}if(f!==m&&F!==0&&l[F-1]===m){continue}if(L!==-1&&L<F+1){L=l.indexOf(t,F+1)}if(P!==-1&&P<F+1){P=l.indexOf(r,F+1)}var U=P===-1?L:Math.min(L,P);var $=extraSpaces(U);if(l.substr(F+1+$,T)===t){S.push(l.substring(g,F).replace(M,f));g=F+1+$+T;if(l[F+1+$+T]!==f){F=l.indexOf(f,g)}L=l.indexOf(t,g);P=l.indexOf(r,g);break}var j=extraSpaces(P);if(l.substring(F+1+j,F+1+j+k)===r){S.push(l.substring(g,F).replace(M,f));saveRow(F+1+j+k);L=l.indexOf(t,g);F=l.indexOf(f,g);if(O){doStep();if(y)return returnable()}if(u&&A.length>=u)return returnable(true);break}w.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:A.length,index:g});F++;continue}continue}if(s&&S.length===0&&l.substring(g,g+x)===s){if(P===-1)return returnable();g=P+k;P=l.indexOf(r,g);L=l.indexOf(t,g);continue}if(L!==-1&&(L<P||P===-1)){S.push(l.substring(g,L));g=L+T;L=l.indexOf(t,g);continue}if(P!==-1){S.push(l.substring(g,P));saveRow(P+k);if(O){doStep();if(y)return returnable()}if(u&&A.length>=u)return returnable(true);continue}break}return finish();function pushRow(e){A.push(e);R=g}function extraSpaces(e){var t=0;if(e!==-1){var r=l.substring(F+1,e);if(r&&r.trim()===""){t=r.length}}return t}function finish(e){if(v)return returnable();if(typeof e==="undefined")e=l.substring(g);S.push(e);g=E;pushRow(S);if(O)doStep();return returnable()}function saveRow(e){g=e;pushRow(S);S=[];P=l.indexOf(r,g)}function returnable(s){if(e.header&&!b&&A.length&&!_){const t=A[0];const r=Object.create(null);const s=new Set(t);let a=false;for(let u=0;u<t.length;u++){let l=t[u];if(isFunction(e.transformHeader))l=e.transformHeader(l,u);if(!r[l]){r[l]=1;t[u]=l}else{let e;let h=r[l];do{e=`${l}_${h}`;h++}while(s.has(e));s.add(e);t[u]=e;r[l]++;a=true;if(d===null){d={}}d[e]=l}s.add(l)}if(a){console.warn("Duplicate headers found and renamed.")}_=true}return{data:A,errors:w,meta:{delimiter:t,linebreak:r,aborted:y,truncated:!!s,cursor:R+(b||0),renamedHeaders:d}}}function doStep(){a(returnable());A=[];w=[]}};this.abort=function(){y=true};this.getCharIndex=function(){return g}}function newWorker(){if(!l.WORKERS_SUPPORTED)return false;var t=getWorkerBlob();var r=new e.Worker(t);r.onmessage=mainThreadReceivedMessage;r.id=u++;a[r.id]=r;return r}function mainThreadReceivedMessage(e){var t=e.data;var r=a[t.workerId];var s=false;if(t.error)r.userError(t.error,t.file);else if(t.results&&t.results.data){var abort=function(){s=true;completeWorker(t.workerId,{data:[],errors:[],meta:{aborted:true}})};var u={abort:abort,pause:notImplemented,resume:notImplemented};if(isFunction(r.userStep)){for(var l=0;l<t.results.data.length;l++){r.userStep({data:t.results.data[l],errors:t.results.errors,meta:t.results.meta},u);if(s)break}delete t.results}else if(isFunction(r.userChunk)){r.userChunk(t.results,u,t.file);delete t.results}}if(t.finished&&!s)completeWorker(t.workerId,t.results)}function completeWorker(e,t){var r=a[e];if(isFunction(r.userComplete))r.userComplete(t);r.terminate();delete a[e]}function notImplemented(){throw new Error("Not implemented.")}function workerThreadReceivedMessage(t){var r=t.data;if(typeof l.WORKER_ID==="undefined"&&r)l.WORKER_ID=r.workerId;if(typeof r.input==="string"){e.postMessage({workerId:l.WORKER_ID,results:l.parse(r.input,r.config),finished:true})}else if(e.File&&r.input instanceof File||r.input instanceof Object){var s=l.parse(r.input,r.config);if(s)e.postMessage({workerId:l.WORKER_ID,results:s,finished:true})}}function copy(e){if(typeof e!=="object"||e===null)return e;var t=Array.isArray(e)?[]:{};for(var r in e)t[r]=copy(e[r]);return t}function bindFunction(e,t){return function(){e.apply(t,arguments)}}function isFunction(e){return typeof e==="function"}return l}))},421:t=>{t.exports=e(import.meta.url)("node:child_process")},474:t=>{t.exports=e(import.meta.url)("node:events")},24:t=>{t.exports=e(import.meta.url)("node:fs")},760:t=>{t.exports=e(import.meta.url)("node:path")},708:t=>{t.exports=e(import.meta.url)("node:process")},203:t=>{t.exports=e(import.meta.url)("stream")},534:(e,t,r)=>{const{Argument:s}=r(343);const{Command:a}=r(623);const{CommanderError:u,InvalidArgumentError:l}=r(568);const{Help:h}=r(727);const{Option:f}=r(177);t.DM=new a;t.gu=e=>new a(e);t.Ww=(e,t)=>new f(e,t);t.er=(e,t)=>new s(e,t);t.uB=a;t.c$=f;t.ef=s;t._V=h;t.b7=u;t.Di=l;t.a2=l},343:(e,t,r)=>{const{InvalidArgumentError:s}=r(568);class Argument{constructor(e,t){this.description=t||"";this.variadic=false;this.parseArg=undefined;this.defaultValue=undefined;this.defaultValueDescription=undefined;this.argChoices=undefined;switch(e[0]){case"<":this.required=true;this._name=e.slice(1,-1);break;case"[":this.required=false;this._name=e.slice(1,-1);break;default:this.required=true;this._name=e;break}if(this._name.endsWith("...")){this.variadic=true;this._name=this._name.slice(0,-3)}}name(){return this._name}_collectValue(e,t){if(t===this.defaultValue||!Array.isArray(t)){return[e]}t.push(e);return t}default(e,t){this.defaultValue=e;this.defaultValueDescription=t;return this}argParser(e){this.parseArg=e;return this}choices(e){this.argChoices=e.slice();this.parseArg=(e,t)=>{if(!this.argChoices.includes(e)){throw new s(`Allowed choices are ${this.argChoices.join(", ")}.`)}if(this.variadic){return this._collectValue(e,t)}return e};return this}argRequired(){this.required=true;return this}argOptional(){this.required=false;return this}}function humanReadableArgName(e){const t=e.name()+(e.variadic===true?"...":"");return e.required?"<"+t+">":"["+t+"]"}t.Argument=Argument;t.humanReadableArgName=humanReadableArgName},623:(e,t,r)=>{const s=r(474).EventEmitter;const a=r(421);const u=r(760);const l=r(24);const h=r(708);const{Argument:f,humanReadableArgName:d}=r(343);const{CommanderError:_}=r(568);const{Help:m,stripColor:g}=r(727);const{Option:y,DualOptions:b}=r(177);const{suggestSimilar:v}=r(779);class Command extends s{constructor(e){super();this.commands=[];this.options=[];this.parent=null;this._allowUnknownOption=false;this._allowExcessArguments=false;this.registeredArguments=[];this._args=this.registeredArguments;this.args=[];this.rawArgs=[];this.processedArgs=[];this._scriptPath=null;this._name=e||"";this._optionValues={};this._optionValueSources={};this._storeOptionsAsProperties=false;this._actionHandler=null;this._executableHandler=false;this._executableFile=null;this._executableDir=null;this._defaultCommandName=null;this._exitCallback=null;this._aliases=[];this._combineFlagAndOptionalValue=true;this._description="";this._summary="";this._argsDescription=undefined;this._enablePositionalOptions=false;this._passThroughOptions=false;this._lifeCycleHooks={};this._showHelpAfterError=false;this._showSuggestionAfterError=true;this._savedState=null;this._outputConfiguration={writeOut:e=>h.stdout.write(e),writeErr:e=>h.stderr.write(e),outputError:(e,t)=>t(e),getOutHelpWidth:()=>h.stdout.isTTY?h.stdout.columns:undefined,getErrHelpWidth:()=>h.stderr.isTTY?h.stderr.columns:undefined,getOutHasColors:()=>useColor()??(h.stdout.isTTY&&h.stdout.hasColors?.()),getErrHasColors:()=>useColor()??(h.stderr.isTTY&&h.stderr.hasColors?.()),stripColor:e=>g(e)};this._hidden=false;this._helpOption=undefined;this._addImplicitHelpCommand=undefined;this._helpCommand=undefined;this._helpConfiguration={};this._helpGroupHeading=undefined;this._defaultCommandGroup=undefined;this._defaultOptionGroup=undefined}copyInheritedSettings(e){this._outputConfiguration=e._outputConfiguration;this._helpOption=e._helpOption;this._helpCommand=e._helpCommand;this._helpConfiguration=e._helpConfiguration;this._exitCallback=e._exitCallback;this._storeOptionsAsProperties=e._storeOptionsAsProperties;this._combineFlagAndOptionalValue=e._combineFlagAndOptionalValue;this._allowExcessArguments=e._allowExcessArguments;this._enablePositionalOptions=e._enablePositionalOptions;this._showHelpAfterError=e._showHelpAfterError;this._showSuggestionAfterError=e._showSuggestionAfterError;return this}_getCommandAndAncestors(){const e=[];for(let t=this;t;t=t.parent){e.push(t)}return e}command(e,t,r){let s=t;let a=r;if(typeof s==="object"&&s!==null){a=s;s=null}a=a||{};const[,u,l]=e.match(/([^ ]+) *(.*)/);const h=this.createCommand(u);if(s){h.description(s);h._executableHandler=true}if(a.isDefault)this._defaultCommandName=h._name;h._hidden=!!(a.noHelp||a.hidden);h._executableFile=a.executableFile||null;if(l)h.arguments(l);this._registerCommand(h);h.parent=this;h.copyInheritedSettings(this);if(s)return this;return h}createCommand(e){return new Command(e)}createHelp(){return Object.assign(new m,this.configureHelp())}configureHelp(e){if(e===undefined)return this._helpConfiguration;this._helpConfiguration=e;return this}configureOutput(e){if(e===undefined)return this._outputConfiguration;this._outputConfiguration={...this._outputConfiguration,...e};return this}showHelpAfterError(e=true){if(typeof e!=="string")e=!!e;this._showHelpAfterError=e;return this}showSuggestionAfterError(e=true){this._showSuggestionAfterError=!!e;return this}addCommand(e,t){if(!e._name){throw new Error(`Command passed to .addCommand() must have a name\n- specify the name in Command constructor or using .name()`)}t=t||{};if(t.isDefault)this._defaultCommandName=e._name;if(t.noHelp||t.hidden)e._hidden=true;this._registerCommand(e);e.parent=this;e._checkForBrokenPassThrough();return this}createArgument(e,t){return new f(e,t)}argument(e,t,r,s){const a=this.createArgument(e,t);if(typeof r==="function"){a.default(s).argParser(r)}else{a.default(r)}this.addArgument(a);return this}arguments(e){e.trim().split(/ +/).forEach((e=>{this.argument(e)}));return this}addArgument(e){const t=this.registeredArguments.slice(-1)[0];if(t?.variadic){throw new Error(`only the last argument can be variadic '${t.name()}'`)}if(e.required&&e.defaultValue!==undefined&&e.parseArg===undefined){throw new Error(`a default value for a required argument is never used: '${e.name()}'`)}this.registeredArguments.push(e);return this}helpCommand(e,t){if(typeof e==="boolean"){this._addImplicitHelpCommand=e;if(e&&this._defaultCommandGroup){this._initCommandGroup(this._getHelpCommand())}return this}const r=e??"help [command]";const[,s,a]=r.match(/([^ ]+) *(.*)/);const u=t??"display help for command";const l=this.createCommand(s);l.helpOption(false);if(a)l.arguments(a);if(u)l.description(u);this._addImplicitHelpCommand=true;this._helpCommand=l;if(e||t)this._initCommandGroup(l);return this}addHelpCommand(e,t){if(typeof e!=="object"){this.helpCommand(e,t);return this}this._addImplicitHelpCommand=true;this._helpCommand=e;this._initCommandGroup(e);return this}_getHelpCommand(){const e=this._addImplicitHelpCommand??(this.commands.length&&!this._actionHandler&&!this._findCommand("help"));if(e){if(this._helpCommand===undefined){this.helpCommand(undefined,undefined)}return this._helpCommand}return null}hook(e,t){const r=["preSubcommand","preAction","postAction"];if(!r.includes(e)){throw new Error(`Unexpected value for event passed to hook : '${e}'.\nExpecting one of '${r.join("', '")}'`)}if(this._lifeCycleHooks[e]){this._lifeCycleHooks[e].push(t)}else{this._lifeCycleHooks[e]=[t]}return this}exitOverride(e){if(e){this._exitCallback=e}else{this._exitCallback=e=>{if(e.code!=="commander.executeSubCommandAsync"){throw e}else{}}}return this}_exit(e,t,r){if(this._exitCallback){this._exitCallback(new _(e,t,r))}h.exit(e)}action(e){const listener=t=>{const r=this.registeredArguments.length;const s=t.slice(0,r);if(this._storeOptionsAsProperties){s[r]=this}else{s[r]=this.opts()}s.push(this);return e.apply(this,s)};this._actionHandler=listener;return this}createOption(e,t){return new y(e,t)}_callParseArg(e,t,r,s){try{return e.parseArg(t,r)}catch(e){if(e.code==="commander.invalidArgument"){const t=`${s} ${e.message}`;this.error(t,{exitCode:e.exitCode,code:e.code})}throw e}}_registerOption(e){const t=e.short&&this._findOption(e.short)||e.long&&this._findOption(e.long);if(t){const r=e.long&&this._findOption(e.long)?e.long:e.short;throw new Error(`Cannot add option '${e.flags}'${this._name&&` to command '${this._name}'`} due to conflicting flag '${r}'\n-  already used by option '${t.flags}'`)}this._initOptionGroup(e);this.options.push(e)}_registerCommand(e){const knownBy=e=>[e.name()].concat(e.aliases());const t=knownBy(e).find((e=>this._findCommand(e)));if(t){const r=knownBy(this._findCommand(t)).join("|");const s=knownBy(e).join("|");throw new Error(`cannot add command '${s}' as already have command '${r}'`)}this._initCommandGroup(e);this.commands.push(e)}addOption(e){this._registerOption(e);const t=e.name();const r=e.attributeName();if(e.negate){const t=e.long.replace(/^--no-/,"--");if(!this._findOption(t)){this.setOptionValueWithSource(r,e.defaultValue===undefined?true:e.defaultValue,"default")}}else if(e.defaultValue!==undefined){this.setOptionValueWithSource(r,e.defaultValue,"default")}const handleOptionValue=(t,s,a)=>{if(t==null&&e.presetArg!==undefined){t=e.presetArg}const u=this.getOptionValue(r);if(t!==null&&e.parseArg){t=this._callParseArg(e,t,u,s)}else if(t!==null&&e.variadic){t=e._collectValue(t,u)}if(t==null){if(e.negate){t=false}else if(e.isBoolean()||e.optional){t=true}else{t=""}}this.setOptionValueWithSource(r,t,a)};this.on("option:"+t,(t=>{const r=`error: option '${e.flags}' argument '${t}' is invalid.`;handleOptionValue(t,r,"cli")}));if(e.envVar){this.on("optionEnv:"+t,(t=>{const r=`error: option '${e.flags}' value '${t}' from env '${e.envVar}' is invalid.`;handleOptionValue(t,r,"env")}))}return this}_optionEx(e,t,r,s,a){if(typeof t==="object"&&t instanceof y){throw new Error("To add an Option object use addOption() instead of option() or requiredOption()")}const u=this.createOption(t,r);u.makeOptionMandatory(!!e.mandatory);if(typeof s==="function"){u.default(a).argParser(s)}else if(s instanceof RegExp){const e=s;s=(t,r)=>{const s=e.exec(t);return s?s[0]:r};u.default(a).argParser(s)}else{u.default(s)}return this.addOption(u)}option(e,t,r,s){return this._optionEx({},e,t,r,s)}requiredOption(e,t,r,s){return this._optionEx({mandatory:true},e,t,r,s)}combineFlagAndOptionalValue(e=true){this._combineFlagAndOptionalValue=!!e;return this}allowUnknownOption(e=true){this._allowUnknownOption=!!e;return this}allowExcessArguments(e=true){this._allowExcessArguments=!!e;return this}enablePositionalOptions(e=true){this._enablePositionalOptions=!!e;return this}passThroughOptions(e=true){this._passThroughOptions=!!e;this._checkForBrokenPassThrough();return this}_checkForBrokenPassThrough(){if(this.parent&&this._passThroughOptions&&!this.parent._enablePositionalOptions){throw new Error(`passThroughOptions cannot be used for '${this._name}' without turning on enablePositionalOptions for parent command(s)`)}}storeOptionsAsProperties(e=true){if(this.options.length){throw new Error("call .storeOptionsAsProperties() before adding options")}if(Object.keys(this._optionValues).length){throw new Error("call .storeOptionsAsProperties() before setting option values")}this._storeOptionsAsProperties=!!e;return this}getOptionValue(e){if(this._storeOptionsAsProperties){return this[e]}return this._optionValues[e]}setOptionValue(e,t){return this.setOptionValueWithSource(e,t,undefined)}setOptionValueWithSource(e,t,r){if(this._storeOptionsAsProperties){this[e]=t}else{this._optionValues[e]=t}this._optionValueSources[e]=r;return this}getOptionValueSource(e){return this._optionValueSources[e]}getOptionValueSourceWithGlobals(e){let t;this._getCommandAndAncestors().forEach((r=>{if(r.getOptionValueSource(e)!==undefined){t=r.getOptionValueSource(e)}}));return t}_prepareUserArgs(e,t){if(e!==undefined&&!Array.isArray(e)){throw new Error("first parameter to parse must be array or undefined")}t=t||{};if(e===undefined&&t.from===undefined){if(h.versions?.electron){t.from="electron"}const e=h.execArgv??[];if(e.includes("-e")||e.includes("--eval")||e.includes("-p")||e.includes("--print")){t.from="eval"}}if(e===undefined){e=h.argv}this.rawArgs=e.slice();let r;switch(t.from){case undefined:case"node":this._scriptPath=e[1];r=e.slice(2);break;case"electron":if(h.defaultApp){this._scriptPath=e[1];r=e.slice(2)}else{r=e.slice(1)}break;case"user":r=e.slice(0);break;case"eval":r=e.slice(1);break;default:throw new Error(`unexpected parse option { from: '${t.from}' }`)}if(!this._name&&this._scriptPath)this.nameFromFilename(this._scriptPath);this._name=this._name||"program";return r}parse(e,t){this._prepareForParse();const r=this._prepareUserArgs(e,t);this._parseCommand([],r);return this}async parseAsync(e,t){this._prepareForParse();const r=this._prepareUserArgs(e,t);await this._parseCommand([],r);return this}_prepareForParse(){if(this._savedState===null){this.saveStateBeforeParse()}else{this.restoreStateBeforeParse()}}saveStateBeforeParse(){this._savedState={_name:this._name,_optionValues:{...this._optionValues},_optionValueSources:{...this._optionValueSources}}}restoreStateBeforeParse(){if(this._storeOptionsAsProperties)throw new Error(`Can not call parse again when storeOptionsAsProperties is true.\n- either make a new Command for each call to parse, or stop storing options as properties`);this._name=this._savedState._name;this._scriptPath=null;this.rawArgs=[];this._optionValues={...this._savedState._optionValues};this._optionValueSources={...this._savedState._optionValueSources};this.args=[];this.processedArgs=[]}_checkForMissingExecutable(e,t,r){if(l.existsSync(e))return;const s=t?`searched for local subcommand relative to directory '${t}'`:"no directory for search for local subcommand, use .executableDir() to supply a custom directory";const a=`'${e}' does not exist\n - if '${r}' is not meant to be an executable command, remove description parameter from '.command()' and use '.description()' instead\n - if the default executable name is not suitable, use the executableFile option to supply a custom name or path\n - ${s}`;throw new Error(a)}_executeSubCommand(e,t){t=t.slice();let r=false;const s=[".js",".ts",".tsx",".mjs",".cjs"];function findFile(e,t){const r=u.resolve(e,t);if(l.existsSync(r))return r;if(s.includes(u.extname(t)))return undefined;const a=s.find((e=>l.existsSync(`${r}${e}`)));if(a)return`${r}${a}`;return undefined}this._checkForMissingMandatoryOptions();this._checkForConflictingOptions();let f=e._executableFile||`${this._name}-${e._name}`;let d=this._executableDir||"";if(this._scriptPath){let e;try{e=l.realpathSync(this._scriptPath)}catch{e=this._scriptPath}d=u.resolve(u.dirname(e),d)}if(d){let t=findFile(d,f);if(!t&&!e._executableFile&&this._scriptPath){const r=u.basename(this._scriptPath,u.extname(this._scriptPath));if(r!==this._name){t=findFile(d,`${r}-${e._name}`)}}f=t||f}r=s.includes(u.extname(f));let m;if(h.platform!=="win32"){if(r){t.unshift(f);t=incrementNodeInspectorPort(h.execArgv).concat(t);m=a.spawn(h.argv[0],t,{stdio:"inherit"})}else{m=a.spawn(f,t,{stdio:"inherit"})}}else{this._checkForMissingExecutable(f,d,e._name);t.unshift(f);t=incrementNodeInspectorPort(h.execArgv).concat(t);m=a.spawn(h.execPath,t,{stdio:"inherit"})}if(!m.killed){const e=["SIGUSR1","SIGUSR2","SIGTERM","SIGINT","SIGHUP"];e.forEach((e=>{h.on(e,(()=>{if(m.killed===false&&m.exitCode===null){m.kill(e)}}))}))}const g=this._exitCallback;m.on("close",(e=>{e=e??1;if(!g){h.exit(e)}else{g(new _(e,"commander.executeSubCommandAsync","(close)"))}}));m.on("error",(t=>{if(t.code==="ENOENT"){this._checkForMissingExecutable(f,d,e._name)}else if(t.code==="EACCES"){throw new Error(`'${f}' not executable`)}if(!g){h.exit(1)}else{const e=new _(1,"commander.executeSubCommandAsync","(error)");e.nestedError=t;g(e)}}));this.runningCommand=m}_dispatchSubcommand(e,t,r){const s=this._findCommand(e);if(!s)this.help({error:true});s._prepareForParse();let a;a=this._chainOrCallSubCommandHook(a,s,"preSubcommand");a=this._chainOrCall(a,(()=>{if(s._executableHandler){this._executeSubCommand(s,t.concat(r))}else{return s._parseCommand(t,r)}}));return a}_dispatchHelpCommand(e){if(!e){this.help()}const t=this._findCommand(e);if(t&&!t._executableHandler){t.help()}return this._dispatchSubcommand(e,[],[this._getHelpOption()?.long??this._getHelpOption()?.short??"--help"])}_checkNumberOfArguments(){this.registeredArguments.forEach(((e,t)=>{if(e.required&&this.args[t]==null){this.missingArgument(e.name())}}));if(this.registeredArguments.length>0&&this.registeredArguments[this.registeredArguments.length-1].variadic){return}if(this.args.length>this.registeredArguments.length){this._excessArguments(this.args)}}_processArguments(){const myParseArg=(e,t,r)=>{let s=t;if(t!==null&&e.parseArg){const a=`error: command-argument value '${t}' is invalid for argument '${e.name()}'.`;s=this._callParseArg(e,t,r,a)}return s};this._checkNumberOfArguments();const e=[];this.registeredArguments.forEach(((t,r)=>{let s=t.defaultValue;if(t.variadic){if(r<this.args.length){s=this.args.slice(r);if(t.parseArg){s=s.reduce(((e,r)=>myParseArg(t,r,e)),t.defaultValue)}}else if(s===undefined){s=[]}}else if(r<this.args.length){s=this.args[r];if(t.parseArg){s=myParseArg(t,s,t.defaultValue)}}e[r]=s}));this.processedArgs=e}_chainOrCall(e,t){if(e?.then&&typeof e.then==="function"){return e.then((()=>t()))}return t()}_chainOrCallHooks(e,t){let r=e;const s=[];this._getCommandAndAncestors().reverse().filter((e=>e._lifeCycleHooks[t]!==undefined)).forEach((e=>{e._lifeCycleHooks[t].forEach((t=>{s.push({hookedCommand:e,callback:t})}))}));if(t==="postAction"){s.reverse()}s.forEach((e=>{r=this._chainOrCall(r,(()=>e.callback(e.hookedCommand,this)))}));return r}_chainOrCallSubCommandHook(e,t,r){let s=e;if(this._lifeCycleHooks[r]!==undefined){this._lifeCycleHooks[r].forEach((e=>{s=this._chainOrCall(s,(()=>e(this,t)))}))}return s}_parseCommand(e,t){const r=this.parseOptions(t);this._parseOptionsEnv();this._parseOptionsImplied();e=e.concat(r.operands);t=r.unknown;this.args=e.concat(t);if(e&&this._findCommand(e[0])){return this._dispatchSubcommand(e[0],e.slice(1),t)}if(this._getHelpCommand()&&e[0]===this._getHelpCommand().name()){return this._dispatchHelpCommand(e[1])}if(this._defaultCommandName){this._outputHelpIfRequested(t);return this._dispatchSubcommand(this._defaultCommandName,e,t)}if(this.commands.length&&this.args.length===0&&!this._actionHandler&&!this._defaultCommandName){this.help({error:true})}this._outputHelpIfRequested(r.unknown);this._checkForMissingMandatoryOptions();this._checkForConflictingOptions();const checkForUnknownOptions=()=>{if(r.unknown.length>0){this.unknownOption(r.unknown[0])}};const s=`command:${this.name()}`;if(this._actionHandler){checkForUnknownOptions();this._processArguments();let r;r=this._chainOrCallHooks(r,"preAction");r=this._chainOrCall(r,(()=>this._actionHandler(this.processedArgs)));if(this.parent){r=this._chainOrCall(r,(()=>{this.parent.emit(s,e,t)}))}r=this._chainOrCallHooks(r,"postAction");return r}if(this.parent?.listenerCount(s)){checkForUnknownOptions();this._processArguments();this.parent.emit(s,e,t)}else if(e.length){if(this._findCommand("*")){return this._dispatchSubcommand("*",e,t)}if(this.listenerCount("command:*")){this.emit("command:*",e,t)}else if(this.commands.length){this.unknownCommand()}else{checkForUnknownOptions();this._processArguments()}}else if(this.commands.length){checkForUnknownOptions();this.help({error:true})}else{checkForUnknownOptions();this._processArguments()}}_findCommand(e){if(!e)return undefined;return this.commands.find((t=>t._name===e||t._aliases.includes(e)))}_findOption(e){return this.options.find((t=>t.is(e)))}_checkForMissingMandatoryOptions(){this._getCommandAndAncestors().forEach((e=>{e.options.forEach((t=>{if(t.mandatory&&e.getOptionValue(t.attributeName())===undefined){e.missingMandatoryOptionValue(t)}}))}))}_checkForConflictingLocalOptions(){const e=this.options.filter((e=>{const t=e.attributeName();if(this.getOptionValue(t)===undefined){return false}return this.getOptionValueSource(t)!=="default"}));const t=e.filter((e=>e.conflictsWith.length>0));t.forEach((t=>{const r=e.find((e=>t.conflictsWith.includes(e.attributeName())));if(r){this._conflictingOption(t,r)}}))}_checkForConflictingOptions(){this._getCommandAndAncestors().forEach((e=>{e._checkForConflictingLocalOptions()}))}parseOptions(e){const t=[];const r=[];let s=t;function maybeOption(e){return e.length>1&&e[0]==="-"}const negativeNumberArg=e=>{if(!/^-(\d+|\d*\.\d+)(e[+-]?\d+)?$/.test(e))return false;return!this._getCommandAndAncestors().some((e=>e.options.map((e=>e.short)).some((e=>/^-\d$/.test(e)))))};let a=null;let u=null;let l=0;while(l<e.length||u){const h=u??e[l++];u=null;if(h==="--"){if(s===r)s.push(h);s.push(...e.slice(l));break}if(a&&(!maybeOption(h)||negativeNumberArg(h))){this.emit(`option:${a.name()}`,h);continue}a=null;if(maybeOption(h)){const t=this._findOption(h);if(t){if(t.required){const r=e[l++];if(r===undefined)this.optionMissingArgument(t);this.emit(`option:${t.name()}`,r)}else if(t.optional){let r=null;if(l<e.length&&(!maybeOption(e[l])||negativeNumberArg(e[l]))){r=e[l++]}this.emit(`option:${t.name()}`,r)}else{this.emit(`option:${t.name()}`)}a=t.variadic?t:null;continue}}if(h.length>2&&h[0]==="-"&&h[1]!=="-"){const e=this._findOption(`-${h[1]}`);if(e){if(e.required||e.optional&&this._combineFlagAndOptionalValue){this.emit(`option:${e.name()}`,h.slice(2))}else{this.emit(`option:${e.name()}`);u=`-${h.slice(2)}`}continue}}if(/^--[^=]+=/.test(h)){const e=h.indexOf("=");const t=this._findOption(h.slice(0,e));if(t&&(t.required||t.optional)){this.emit(`option:${t.name()}`,h.slice(e+1));continue}}if(s===t&&maybeOption(h)&&!(this.commands.length===0&&negativeNumberArg(h))){s=r}if((this._enablePositionalOptions||this._passThroughOptions)&&t.length===0&&r.length===0){if(this._findCommand(h)){t.push(h);r.push(...e.slice(l));break}else if(this._getHelpCommand()&&h===this._getHelpCommand().name()){t.push(h,...e.slice(l));break}else if(this._defaultCommandName){r.push(h,...e.slice(l));break}}if(this._passThroughOptions){s.push(h,...e.slice(l));break}s.push(h)}return{operands:t,unknown:r}}opts(){if(this._storeOptionsAsProperties){const e={};const t=this.options.length;for(let r=0;r<t;r++){const t=this.options[r].attributeName();e[t]=t===this._versionOptionName?this._version:this[t]}return e}return this._optionValues}optsWithGlobals(){return this._getCommandAndAncestors().reduce(((e,t)=>Object.assign(e,t.opts())),{})}error(e,t){this._outputConfiguration.outputError(`${e}\n`,this._outputConfiguration.writeErr);if(typeof this._showHelpAfterError==="string"){this._outputConfiguration.writeErr(`${this._showHelpAfterError}\n`)}else if(this._showHelpAfterError){this._outputConfiguration.writeErr("\n");this.outputHelp({error:true})}const r=t||{};const s=r.exitCode||1;const a=r.code||"commander.error";this._exit(s,a,e)}_parseOptionsEnv(){this.options.forEach((e=>{if(e.envVar&&e.envVar in h.env){const t=e.attributeName();if(this.getOptionValue(t)===undefined||["default","config","env"].includes(this.getOptionValueSource(t))){if(e.required||e.optional){this.emit(`optionEnv:${e.name()}`,h.env[e.envVar])}else{this.emit(`optionEnv:${e.name()}`)}}}}))}_parseOptionsImplied(){const e=new b(this.options);const hasCustomOptionValue=e=>this.getOptionValue(e)!==undefined&&!["default","implied"].includes(this.getOptionValueSource(e));this.options.filter((t=>t.implied!==undefined&&hasCustomOptionValue(t.attributeName())&&e.valueFromOption(this.getOptionValue(t.attributeName()),t))).forEach((e=>{Object.keys(e.implied).filter((e=>!hasCustomOptionValue(e))).forEach((t=>{this.setOptionValueWithSource(t,e.implied[t],"implied")}))}))}missingArgument(e){const t=`error: missing required argument '${e}'`;this.error(t,{code:"commander.missingArgument"})}optionMissingArgument(e){const t=`error: option '${e.flags}' argument missing`;this.error(t,{code:"commander.optionMissingArgument"})}missingMandatoryOptionValue(e){const t=`error: required option '${e.flags}' not specified`;this.error(t,{code:"commander.missingMandatoryOptionValue"})}_conflictingOption(e,t){const findBestOptionFromValue=e=>{const t=e.attributeName();const r=this.getOptionValue(t);const s=this.options.find((e=>e.negate&&t===e.attributeName()));const a=this.options.find((e=>!e.negate&&t===e.attributeName()));if(s&&(s.presetArg===undefined&&r===false||s.presetArg!==undefined&&r===s.presetArg)){return s}return a||e};const getErrorMessage=e=>{const t=findBestOptionFromValue(e);const r=t.attributeName();const s=this.getOptionValueSource(r);if(s==="env"){return`environment variable '${t.envVar}'`}return`option '${t.flags}'`};const r=`error: ${getErrorMessage(e)} cannot be used with ${getErrorMessage(t)}`;this.error(r,{code:"commander.conflictingOption"})}unknownOption(e){if(this._allowUnknownOption)return;let t="";if(e.startsWith("--")&&this._showSuggestionAfterError){let r=[];let s=this;do{const e=s.createHelp().visibleOptions(s).filter((e=>e.long)).map((e=>e.long));r=r.concat(e);s=s.parent}while(s&&!s._enablePositionalOptions);t=v(e,r)}const r=`error: unknown option '${e}'${t}`;this.error(r,{code:"commander.unknownOption"})}_excessArguments(e){if(this._allowExcessArguments)return;const t=this.registeredArguments.length;const r=t===1?"":"s";const s=this.parent?` for '${this.name()}'`:"";const a=`error: too many arguments${s}. Expected ${t} argument${r} but got ${e.length}.`;this.error(a,{code:"commander.excessArguments"})}unknownCommand(){const e=this.args[0];let t="";if(this._showSuggestionAfterError){const r=[];this.createHelp().visibleCommands(this).forEach((e=>{r.push(e.name());if(e.alias())r.push(e.alias())}));t=v(e,r)}const r=`error: unknown command '${e}'${t}`;this.error(r,{code:"commander.unknownCommand"})}version(e,t,r){if(e===undefined)return this._version;this._version=e;t=t||"-V, --version";r=r||"output the version number";const s=this.createOption(t,r);this._versionOptionName=s.attributeName();this._registerOption(s);this.on("option:"+s.name(),(()=>{this._outputConfiguration.writeOut(`${e}\n`);this._exit(0,"commander.version",e)}));return this}description(e,t){if(e===undefined&&t===undefined)return this._description;this._description=e;if(t){this._argsDescription=t}return this}summary(e){if(e===undefined)return this._summary;this._summary=e;return this}alias(e){if(e===undefined)return this._aliases[0];let t=this;if(this.commands.length!==0&&this.commands[this.commands.length-1]._executableHandler){t=this.commands[this.commands.length-1]}if(e===t._name)throw new Error("Command alias can't be the same as its name");const r=this.parent?._findCommand(e);if(r){const t=[r.name()].concat(r.aliases()).join("|");throw new Error(`cannot add alias '${e}' to command '${this.name()}' as already have command '${t}'`)}t._aliases.push(e);return this}aliases(e){if(e===undefined)return this._aliases;e.forEach((e=>this.alias(e)));return this}usage(e){if(e===undefined){if(this._usage)return this._usage;const e=this.registeredArguments.map((e=>d(e)));return[].concat(this.options.length||this._helpOption!==null?"[options]":[],this.commands.length?"[command]":[],this.registeredArguments.length?e:[]).join(" ")}this._usage=e;return this}name(e){if(e===undefined)return this._name;this._name=e;return this}helpGroup(e){if(e===undefined)return this._helpGroupHeading??"";this._helpGroupHeading=e;return this}commandsGroup(e){if(e===undefined)return this._defaultCommandGroup??"";this._defaultCommandGroup=e;return this}optionsGroup(e){if(e===undefined)return this._defaultOptionGroup??"";this._defaultOptionGroup=e;return this}_initOptionGroup(e){if(this._defaultOptionGroup&&!e.helpGroupHeading)e.helpGroup(this._defaultOptionGroup)}_initCommandGroup(e){if(this._defaultCommandGroup&&!e.helpGroup())e.helpGroup(this._defaultCommandGroup)}nameFromFilename(e){this._name=u.basename(e,u.extname(e));return this}executableDir(e){if(e===undefined)return this._executableDir;this._executableDir=e;return this}helpInformation(e){const t=this.createHelp();const r=this._getOutputContext(e);t.prepareContext({error:r.error,helpWidth:r.helpWidth,outputHasColors:r.hasColors});const s=t.formatHelp(this,t);if(r.hasColors)return s;return this._outputConfiguration.stripColor(s)}_getOutputContext(e){e=e||{};const t=!!e.error;let r;let s;let a;if(t){r=e=>this._outputConfiguration.writeErr(e);s=this._outputConfiguration.getErrHasColors();a=this._outputConfiguration.getErrHelpWidth()}else{r=e=>this._outputConfiguration.writeOut(e);s=this._outputConfiguration.getOutHasColors();a=this._outputConfiguration.getOutHelpWidth()}const write=e=>{if(!s)e=this._outputConfiguration.stripColor(e);return r(e)};return{error:t,write:write,hasColors:s,helpWidth:a}}outputHelp(e){let t;if(typeof e==="function"){t=e;e=undefined}const r=this._getOutputContext(e);const s={error:r.error,write:r.write,command:this};this._getCommandAndAncestors().reverse().forEach((e=>e.emit("beforeAllHelp",s)));this.emit("beforeHelp",s);let a=this.helpInformation({error:r.error});if(t){a=t(a);if(typeof a!=="string"&&!Buffer.isBuffer(a)){throw new Error("outputHelp callback must return a string or a Buffer")}}r.write(a);if(this._getHelpOption()?.long){this.emit(this._getHelpOption().long)}this.emit("afterHelp",s);this._getCommandAndAncestors().forEach((e=>e.emit("afterAllHelp",s)))}helpOption(e,t){if(typeof e==="boolean"){if(e){if(this._helpOption===null)this._helpOption=undefined;if(this._defaultOptionGroup){this._initOptionGroup(this._getHelpOption())}}else{this._helpOption=null}return this}this._helpOption=this.createOption(e??"-h, --help",t??"display help for command");if(e||t)this._initOptionGroup(this._helpOption);return this}_getHelpOption(){if(this._helpOption===undefined){this.helpOption(undefined,undefined)}return this._helpOption}addHelpOption(e){this._helpOption=e;this._initOptionGroup(e);return this}help(e){this.outputHelp(e);let t=Number(h.exitCode??0);if(t===0&&e&&typeof e!=="function"&&e.error){t=1}this._exit(t,"commander.help","(outputHelp)")}addHelpText(e,t){const r=["beforeAll","before","after","afterAll"];if(!r.includes(e)){throw new Error(`Unexpected value for position to addHelpText.\nExpecting one of '${r.join("', '")}'`)}const s=`${e}Help`;this.on(s,(e=>{let r;if(typeof t==="function"){r=t({error:e.error,command:e.command})}else{r=t}if(r){e.write(`${r}\n`)}}));return this}_outputHelpIfRequested(e){const t=this._getHelpOption();const r=t&&e.find((e=>t.is(e)));if(r){this.outputHelp();this._exit(0,"commander.helpDisplayed","(outputHelp)")}}}function incrementNodeInspectorPort(e){return e.map((e=>{if(!e.startsWith("--inspect")){return e}let t;let r="127.0.0.1";let s="9229";let a;if((a=e.match(/^(--inspect(-brk)?)$/))!==null){t=a[1]}else if((a=e.match(/^(--inspect(-brk|-port)?)=([^:]+)$/))!==null){t=a[1];if(/^\d+$/.test(a[3])){s=a[3]}else{r=a[3]}}else if((a=e.match(/^(--inspect(-brk|-port)?)=([^:]+):(\d+)$/))!==null){t=a[1];r=a[3];s=a[4]}if(t&&s!=="0"){return`${t}=${r}:${parseInt(s)+1}`}return e}))}function useColor(){if(h.env.NO_COLOR||h.env.FORCE_COLOR==="0"||h.env.FORCE_COLOR==="false")return false;if(h.env.FORCE_COLOR||h.env.CLICOLOR_FORCE!==undefined)return true;return undefined}t.Command=Command;t.useColor=useColor},568:(e,t)=>{class CommanderError extends Error{constructor(e,t,r){super(r);Error.captureStackTrace(this,this.constructor);this.name=this.constructor.name;this.code=t;this.exitCode=e;this.nestedError=undefined}}class InvalidArgumentError extends CommanderError{constructor(e){super(1,"commander.invalidArgument",e);Error.captureStackTrace(this,this.constructor);this.name=this.constructor.name}}t.CommanderError=CommanderError;t.InvalidArgumentError=InvalidArgumentError},727:(e,t,r)=>{const{humanReadableArgName:s}=r(343);class Help{constructor(){this.helpWidth=undefined;this.minWidthToWrap=40;this.sortSubcommands=false;this.sortOptions=false;this.showGlobalOptions=false}prepareContext(e){this.helpWidth=this.helpWidth??e.helpWidth??80}visibleCommands(e){const t=e.commands.filter((e=>!e._hidden));const r=e._getHelpCommand();if(r&&!r._hidden){t.push(r)}if(this.sortSubcommands){t.sort(((e,t)=>e.name().localeCompare(t.name())))}return t}compareOptions(e,t){const getSortKey=e=>e.short?e.short.replace(/^-/,""):e.long.replace(/^--/,"");return getSortKey(e).localeCompare(getSortKey(t))}visibleOptions(e){const t=e.options.filter((e=>!e.hidden));const r=e._getHelpOption();if(r&&!r.hidden){const s=r.short&&e._findOption(r.short);const a=r.long&&e._findOption(r.long);if(!s&&!a){t.push(r)}else if(r.long&&!a){t.push(e.createOption(r.long,r.description))}else if(r.short&&!s){t.push(e.createOption(r.short,r.description))}}if(this.sortOptions){t.sort(this.compareOptions)}return t}visibleGlobalOptions(e){if(!this.showGlobalOptions)return[];const t=[];for(let r=e.parent;r;r=r.parent){const e=r.options.filter((e=>!e.hidden));t.push(...e)}if(this.sortOptions){t.sort(this.compareOptions)}return t}visibleArguments(e){if(e._argsDescription){e.registeredArguments.forEach((t=>{t.description=t.description||e._argsDescription[t.name()]||""}))}if(e.registeredArguments.find((e=>e.description))){return e.registeredArguments}return[]}subcommandTerm(e){const t=e.registeredArguments.map((e=>s(e))).join(" ");return e._name+(e._aliases[0]?"|"+e._aliases[0]:"")+(e.options.length?" [options]":"")+(t?" "+t:"")}optionTerm(e){return e.flags}argumentTerm(e){return e.name()}longestSubcommandTermLength(e,t){return t.visibleCommands(e).reduce(((e,r)=>Math.max(e,this.displayWidth(t.styleSubcommandTerm(t.subcommandTerm(r))))),0)}longestOptionTermLength(e,t){return t.visibleOptions(e).reduce(((e,r)=>Math.max(e,this.displayWidth(t.styleOptionTerm(t.optionTerm(r))))),0)}longestGlobalOptionTermLength(e,t){return t.visibleGlobalOptions(e).reduce(((e,r)=>Math.max(e,this.displayWidth(t.styleOptionTerm(t.optionTerm(r))))),0)}longestArgumentTermLength(e,t){return t.visibleArguments(e).reduce(((e,r)=>Math.max(e,this.displayWidth(t.styleArgumentTerm(t.argumentTerm(r))))),0)}commandUsage(e){let t=e._name;if(e._aliases[0]){t=t+"|"+e._aliases[0]}let r="";for(let t=e.parent;t;t=t.parent){r=t.name()+" "+r}return r+t+" "+e.usage()}commandDescription(e){return e.description()}subcommandDescription(e){return e.summary()||e.description()}optionDescription(e){const t=[];if(e.argChoices){t.push(`choices: ${e.argChoices.map((e=>JSON.stringify(e))).join(", ")}`)}if(e.defaultValue!==undefined){const r=e.required||e.optional||e.isBoolean()&&typeof e.defaultValue==="boolean";if(r){t.push(`default: ${e.defaultValueDescription||JSON.stringify(e.defaultValue)}`)}}if(e.presetArg!==undefined&&e.optional){t.push(`preset: ${JSON.stringify(e.presetArg)}`)}if(e.envVar!==undefined){t.push(`env: ${e.envVar}`)}if(t.length>0){const r=`(${t.join(", ")})`;if(e.description){return`${e.description} ${r}`}return r}return e.description}argumentDescription(e){const t=[];if(e.argChoices){t.push(`choices: ${e.argChoices.map((e=>JSON.stringify(e))).join(", ")}`)}if(e.defaultValue!==undefined){t.push(`default: ${e.defaultValueDescription||JSON.stringify(e.defaultValue)}`)}if(t.length>0){const r=`(${t.join(", ")})`;if(e.description){return`${e.description} ${r}`}return r}return e.description}formatItemList(e,t,r){if(t.length===0)return[];return[r.styleTitle(e),...t,""]}groupItems(e,t,r){const s=new Map;e.forEach((e=>{const t=r(e);if(!s.has(t))s.set(t,[])}));t.forEach((e=>{const t=r(e);if(!s.has(t)){s.set(t,[])}s.get(t).push(e)}));return s}formatHelp(e,t){const r=t.padWidth(e,t);const s=t.helpWidth??80;function callFormatItem(e,s){return t.formatItem(e,r,s,t)}let a=[`${t.styleTitle("Usage:")} ${t.styleUsage(t.commandUsage(e))}`,""];const u=t.commandDescription(e);if(u.length>0){a=a.concat([t.boxWrap(t.styleCommandDescription(u),s),""])}const l=t.visibleArguments(e).map((e=>callFormatItem(t.styleArgumentTerm(t.argumentTerm(e)),t.styleArgumentDescription(t.argumentDescription(e)))));a=a.concat(this.formatItemList("Arguments:",l,t));const h=this.groupItems(e.options,t.visibleOptions(e),(e=>e.helpGroupHeading??"Options:"));h.forEach(((e,r)=>{const s=e.map((e=>callFormatItem(t.styleOptionTerm(t.optionTerm(e)),t.styleOptionDescription(t.optionDescription(e)))));a=a.concat(this.formatItemList(r,s,t))}));if(t.showGlobalOptions){const r=t.visibleGlobalOptions(e).map((e=>callFormatItem(t.styleOptionTerm(t.optionTerm(e)),t.styleOptionDescription(t.optionDescription(e)))));a=a.concat(this.formatItemList("Global Options:",r,t))}const f=this.groupItems(e.commands,t.visibleCommands(e),(e=>e.helpGroup()||"Commands:"));f.forEach(((e,r)=>{const s=e.map((e=>callFormatItem(t.styleSubcommandTerm(t.subcommandTerm(e)),t.styleSubcommandDescription(t.subcommandDescription(e)))));a=a.concat(this.formatItemList(r,s,t))}));return a.join("\n")}displayWidth(e){return stripColor(e).length}styleTitle(e){return e}styleUsage(e){return e.split(" ").map((e=>{if(e==="[options]")return this.styleOptionText(e);if(e==="[command]")return this.styleSubcommandText(e);if(e[0]==="["||e[0]==="<")return this.styleArgumentText(e);return this.styleCommandText(e)})).join(" ")}styleCommandDescription(e){return this.styleDescriptionText(e)}styleOptionDescription(e){return this.styleDescriptionText(e)}styleSubcommandDescription(e){return this.styleDescriptionText(e)}styleArgumentDescription(e){return this.styleDescriptionText(e)}styleDescriptionText(e){return e}styleOptionTerm(e){return this.styleOptionText(e)}styleSubcommandTerm(e){return e.split(" ").map((e=>{if(e==="[options]")return this.styleOptionText(e);if(e[0]==="["||e[0]==="<")return this.styleArgumentText(e);return this.styleSubcommandText(e)})).join(" ")}styleArgumentTerm(e){return this.styleArgumentText(e)}styleOptionText(e){return e}styleArgumentText(e){return e}styleSubcommandText(e){return e}styleCommandText(e){return e}padWidth(e,t){return Math.max(t.longestOptionTermLength(e,t),t.longestGlobalOptionTermLength(e,t),t.longestSubcommandTermLength(e,t),t.longestArgumentTermLength(e,t))}preformatted(e){return/\n[^\S\r\n]/.test(e)}formatItem(e,t,r,s){const a=2;const u=" ".repeat(a);if(!r)return u+e;const l=e.padEnd(t+e.length-s.displayWidth(e));const h=2;const f=this.helpWidth??80;const d=f-t-h-a;let _;if(d<this.minWidthToWrap||s.preformatted(r)){_=r}else{const e=s.boxWrap(r,d);_=e.replace(/\n/g,"\n"+" ".repeat(t+h))}return u+l+" ".repeat(h)+_.replace(/\n/g,`\n${u}`)}boxWrap(e,t){if(t<this.minWidthToWrap)return e;const r=e.split(/\r\n|\n/);const s=/[\s]*[^\s]+/g;const a=[];r.forEach((e=>{const r=e.match(s);if(r===null){a.push("");return}let u=[r.shift()];let l=this.displayWidth(u[0]);r.forEach((e=>{const r=this.displayWidth(e);if(l+r<=t){u.push(e);l+=r;return}a.push(u.join(""));const s=e.trimStart();u=[s];l=this.displayWidth(s)}));a.push(u.join(""))}));return a.join("\n")}}function stripColor(e){const t=/\x1b\[\d*(;\d*)*m/g;return e.replace(t,"")}t.Help=Help;t.stripColor=stripColor},177:(e,t,r)=>{const{InvalidArgumentError:s}=r(568);class Option{constructor(e,t){this.flags=e;this.description=t||"";this.required=e.includes("<");this.optional=e.includes("[");this.variadic=/\w\.\.\.[>\]]$/.test(e);this.mandatory=false;const r=splitOptionFlags(e);this.short=r.shortFlag;this.long=r.longFlag;this.negate=false;if(this.long){this.negate=this.long.startsWith("--no-")}this.defaultValue=undefined;this.defaultValueDescription=undefined;this.presetArg=undefined;this.envVar=undefined;this.parseArg=undefined;this.hidden=false;this.argChoices=undefined;this.conflictsWith=[];this.implied=undefined;this.helpGroupHeading=undefined}default(e,t){this.defaultValue=e;this.defaultValueDescription=t;return this}preset(e){this.presetArg=e;return this}conflicts(e){this.conflictsWith=this.conflictsWith.concat(e);return this}implies(e){let t=e;if(typeof e==="string"){t={[e]:true}}this.implied=Object.assign(this.implied||{},t);return this}env(e){this.envVar=e;return this}argParser(e){this.parseArg=e;return this}makeOptionMandatory(e=true){this.mandatory=!!e;return this}hideHelp(e=true){this.hidden=!!e;return this}_collectValue(e,t){if(t===this.defaultValue||!Array.isArray(t)){return[e]}t.push(e);return t}choices(e){this.argChoices=e.slice();this.parseArg=(e,t)=>{if(!this.argChoices.includes(e)){throw new s(`Allowed choices are ${this.argChoices.join(", ")}.`)}if(this.variadic){return this._collectValue(e,t)}return e};return this}name(){if(this.long){return this.long.replace(/^--/,"")}return this.short.replace(/^-/,"")}attributeName(){if(this.negate){return camelcase(this.name().replace(/^no-/,""))}return camelcase(this.name())}helpGroup(e){this.helpGroupHeading=e;return this}is(e){return this.short===e||this.long===e}isBoolean(){return!this.required&&!this.optional&&!this.negate}}class DualOptions{constructor(e){this.positiveOptions=new Map;this.negativeOptions=new Map;this.dualOptions=new Set;e.forEach((e=>{if(e.negate){this.negativeOptions.set(e.attributeName(),e)}else{this.positiveOptions.set(e.attributeName(),e)}}));this.negativeOptions.forEach(((e,t)=>{if(this.positiveOptions.has(t)){this.dualOptions.add(t)}}))}valueFromOption(e,t){const r=t.attributeName();if(!this.dualOptions.has(r))return true;const s=this.negativeOptions.get(r).presetArg;const a=s!==undefined?s:false;return t.negate===(a===e)}}function camelcase(e){return e.split("-").reduce(((e,t)=>e+t[0].toUpperCase()+t.slice(1)))}function splitOptionFlags(e){let t;let r;const s=/^-[^-]$/;const a=/^--[^-]/;const u=e.split(/[ |,]+/).concat("guard");if(s.test(u[0]))t=u.shift();if(a.test(u[0]))r=u.shift();if(!t&&s.test(u[0]))t=u.shift();if(!t&&a.test(u[0])){t=r;r=u.shift()}if(u[0].startsWith("-")){const t=u[0];const r=`option creation failed due to '${t}' in option flags '${e}'`;if(/^-[^-][^-]/.test(t))throw new Error(`${r}\n- a short flag is a single dash and a single character\n  - either use a single dash and a single character (for a short flag)\n  - or use a double dash for a long option (and can have two, like '--ws, --workspace')`);if(s.test(t))throw new Error(`${r}\n- too many short flags`);if(a.test(t))throw new Error(`${r}\n- too many long flags`);throw new Error(`${r}\n- unrecognised flag format`)}if(t===undefined&&r===undefined)throw new Error(`option creation failed due to no flags found in '${e}'.`);return{shortFlag:t,longFlag:r}}t.Option=Option;t.DualOptions=DualOptions},779:(e,t)=>{const r=3;function editDistance(e,t){if(Math.abs(e.length-t.length)>r)return Math.max(e.length,t.length);const s=[];for(let t=0;t<=e.length;t++){s[t]=[t]}for(let e=0;e<=t.length;e++){s[0][e]=e}for(let r=1;r<=t.length;r++){for(let a=1;a<=e.length;a++){let u=1;if(e[a-1]===t[r-1]){u=0}else{u=1}s[a][r]=Math.min(s[a-1][r]+1,s[a][r-1]+1,s[a-1][r-1]+u);if(a>1&&r>1&&e[a-1]===t[r-2]&&e[a-2]===t[r-1]){s[a][r]=Math.min(s[a][r],s[a-2][r-2]+1)}}}return s[e.length][t.length]}function suggestSimilar(e,t){if(!t||t.length===0)return"";t=Array.from(new Set(t));const s=e.startsWith("--");if(s){e=e.slice(2);t=t.map((e=>e.slice(2)))}let a=[];let u=r;const l=.4;t.forEach((t=>{if(t.length<=1)return;const r=editDistance(e,t);const s=Math.max(e.length,t.length);const h=(s-r)/s;if(h>l){if(r<u){u=r;a=[t]}else if(r===u){a.push(t)}}}));a.sort(((e,t)=>e.localeCompare(t)));if(s){a=a.map((e=>`--${e}`))}if(a.length>1){return`\n(Did you mean one of ${a.join(", ")}?)`}if(a.length===1){return`\n(Did you mean ${a[0]}?)`}return""}t.suggestSimilar=suggestSimilar}};var r={};function __nccwpck_require__(e){var s=r[e];if(s!==undefined){return s.exports}var a=r[e]={id:e,loaded:false,exports:{}};var u=true;try{t[e].call(a.exports,a,a.exports,__nccwpck_require__);u=false}finally{if(u)delete r[e]}a.loaded=true;return a.exports}(()=>{__nccwpck_require__.nmd=e=>{e.paths=[];if(!e.children)e.children=[];return e}})();if(typeof __nccwpck_require__!=="undefined")__nccwpck_require__.ab=new URL(".",import.meta.url).pathname.slice(import.meta.url.match(/^file:\/\/\/\w:/)?1:0,-1)+"/";var s={};function arrayEach(e,t){var r=-1,s=e==null?0:e.length;while(++r<s){if(t(e[r],r,e)===false){break}}return e}const a=arrayEach;function createBaseFor(e){return function(t,r,s){var a=-1,u=Object(t),l=s(t),h=l.length;while(h--){var f=l[e?h:++a];if(r(u[f],f,u)===false){break}}return t}}const u=createBaseFor;var l=u();const h=l;function baseTimes(e,t){var r=-1,s=Array(e);while(++r<e){s[r]=t(r)}return s}const f=baseTimes;var d=typeof global=="object"&&global&&global.Object===Object&&global;const _=d;var m=typeof self=="object"&&self&&self.Object===Object&&self;var g=_||m||Function("return this")();const y=g;var b=y.Symbol;const v=b;var E=Object.prototype;var T=E.hasOwnProperty;var k=E.toString;var x=v?v.toStringTag:undefined;function getRawTag(e){var t=T.call(e,x),r=e[x];try{e[x]=undefined;var s=true}catch(e){}var a=k.call(e);if(s){if(t){e[x]=r}else{delete e[x]}}return a}const O=getRawTag;var A=Object.prototype;var w=A.toString;function objectToString(e){return w.call(e)}const S=objectToString;var R="[object Null]",C="[object Undefined]";var I=v?v.toStringTag:undefined;function baseGetTag(e){if(e==null){return e===undefined?C:R}return I&&I in Object(e)?O(e):S(e)}const L=baseGetTag;function isObjectLike(e){return e!=null&&typeof e=="object"}const P=isObjectLike;var M="[object Arguments]";function baseIsArguments(e){return P(e)&&L(e)==M}const F=baseIsArguments;var D=Object.prototype;var U=D.hasOwnProperty;var $=D.propertyIsEnumerable;var j=F(function(){return arguments}())?F:function(e){return P(e)&&U.call(e,"callee")&&!$.call(e,"callee")};const B=j;var W=Array.isArray;const V=W;function stubFalse(){return false}const z=stubFalse;var G=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var H=G&&typeof module=="object"&&module&&!module.nodeType&&module;var K=H&&H.exports===G;var q=K?y.Buffer:undefined;var X=q?q.isBuffer:undefined;var Y=X||z;const Q=Y;var J=9007199254740991;var Z=/^(?:0|[1-9]\d*)$/;function isIndex(e,t){var r=typeof e;t=t==null?J:t;return!!t&&(r=="number"||r!="symbol"&&Z.test(e))&&(e>-1&&e%1==0&&e<t)}const ee=isIndex;var te=9007199254740991;function isLength(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=te}const ne=isLength;var ie="[object Arguments]",re="[object Array]",se="[object Boolean]",ae="[object Date]",oe="[object Error]",ue="[object Function]",le="[object Map]",ce="[object Number]",he="[object Object]",fe="[object RegExp]",pe="[object Set]",_e="[object String]",me="[object WeakMap]";var ge="[object ArrayBuffer]",ye="[object DataView]",be="[object Float32Array]",ve="[object Float64Array]",Ee="[object Int8Array]",Te="[object Int16Array]",ke="[object Int32Array]",xe="[object Uint8Array]",Oe="[object Uint8ClampedArray]",Ae="[object Uint16Array]",we="[object Uint32Array]";var Se={};Se[be]=Se[ve]=Se[Ee]=Se[Te]=Se[ke]=Se[xe]=Se[Oe]=Se[Ae]=Se[we]=true;Se[ie]=Se[re]=Se[ge]=Se[se]=Se[ye]=Se[ae]=Se[oe]=Se[ue]=Se[le]=Se[ce]=Se[he]=Se[fe]=Se[pe]=Se[_e]=Se[me]=false;function baseIsTypedArray(e){return P(e)&&ne(e.length)&&!!Se[L(e)]}const Re=baseIsTypedArray;function baseUnary(e){return function(t){return e(t)}}const Ce=baseUnary;var Ie=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var Le=Ie&&typeof module=="object"&&module&&!module.nodeType&&module;var Pe=Le&&Le.exports===Ie;var Fe=Pe&&_.process;var De=function(){try{var e=Le&&Le.require&&Le.require("util").types;if(e){return e}return Fe&&Fe.binding&&Fe.binding("util")}catch(e){}}();const Ue=De;var $e=Ue&&Ue.isTypedArray;var je=$e?Ce($e):Re;const Be=je;var We=Object.prototype;var Ve=We.hasOwnProperty;function arrayLikeKeys(e,t){var r=V(e),s=!r&&B(e),a=!r&&!s&&Q(e),u=!r&&!s&&!a&&Be(e),l=r||s||a||u,h=l?f(e.length,String):[],d=h.length;for(var _ in e){if((t||Ve.call(e,_))&&!(l&&(_=="length"||a&&(_=="offset"||_=="parent")||u&&(_=="buffer"||_=="byteLength"||_=="byteOffset")||ee(_,d)))){h.push(_)}}return h}const ze=arrayLikeKeys;var Ge=Object.prototype;function isPrototype(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||Ge;return e===r}const He=isPrototype;function overArg(e,t){return function(r){return e(t(r))}}const Ke=overArg;var qe=Ke(Object.keys,Object);const Xe=qe;var Ye=Object.prototype;var Qe=Ye.hasOwnProperty;function baseKeys(e){if(!He(e)){return Xe(e)}var t=[];for(var r in Object(e)){if(Qe.call(e,r)&&r!="constructor"){t.push(r)}}return t}const Je=baseKeys;function isObject(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}const Ze=isObject;var et="[object AsyncFunction]",tt="[object Function]",nt="[object GeneratorFunction]",it="[object Proxy]";function isFunction(e){if(!Ze(e)){return false}var t=L(e);return t==tt||t==nt||t==et||t==it}const rt=isFunction;function isArrayLike(e){return e!=null&&ne(e.length)&&!rt(e)}const st=isArrayLike;function keys(e){return st(e)?ze(e):Je(e)}const ut=keys;function baseForOwn(e,t){return e&&h(e,t,ut)}const lt=baseForOwn;function createBaseEach(e,t){return function(r,s){if(r==null){return r}if(!st(r)){return e(r,s)}var a=r.length,u=t?a:-1,l=Object(r);while(t?u--:++u<a){if(s(l[u],u,l)===false){break}}return r}}const ht=createBaseEach;var ft=ht(lt);const pt=ft;function identity(e){return e}const dt=identity;function castFunction(e){return typeof e=="function"?e:dt}const _t=castFunction;function forEach(e,t){var r=V(e)?a:pt;return r(e,_t(t))}const mt=forEach;function arrayMap(e,t){var r=-1,s=e==null?0:e.length,a=Array(s);while(++r<s){a[r]=t(e[r],r,e)}return a}const gt=arrayMap;function baseValues(e,t){return gt(t,(function(t){return e[t]}))}const yt=baseValues;function values_values(e){return e==null?[]:yt(e,ut(e))}const bt=values_values;var vt=y["__core-js_shared__"];const Et=vt;var Tt=function(){var e=/[^.]+$/.exec(Et&&Et.keys&&Et.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function isMasked(e){return!!Tt&&Tt in e}const kt=isMasked;var xt=Function.prototype;var Ot=xt.toString;function toSource(e){if(e!=null){try{return Ot.call(e)}catch(e){}try{return e+""}catch(e){}}return""}const At=toSource;var wt=/[\\^$.*+?()[\]{}|]/g;var St=/^\[object .+?Constructor\]$/;var Nt=Function.prototype,Rt=Object.prototype;var Ct=Nt.toString;var It=Rt.hasOwnProperty;var Lt=RegExp("^"+Ct.call(It).replace(wt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(e){if(!Ze(e)||kt(e)){return false}var t=rt(e)?Lt:St;return t.test(At(e))}const Pt=baseIsNative;function getValue(e,t){return e==null?undefined:e[t]}const Mt=getValue;function getNative(e,t){var r=Mt(e,t);return Pt(r)?r:undefined}const Ft=getNative;var Dt=Ft(y,"DataView");const Ut=Dt;var $t=Ft(y,"Map");const jt=$t;var Bt=Ft(y,"Promise");const Wt=Bt;var Vt=Ft(y,"Set");const zt=Vt;var Gt=Ft(y,"WeakMap");const Ht=Gt;var Kt="[object Map]",qt="[object Object]",Xt="[object Promise]",Yt="[object Set]",Qt="[object WeakMap]";var Jt="[object DataView]";var Zt=At(Ut),en=At(jt),tn=At(Wt),nn=At(zt),rn=At(Ht);var sn=L;if(Ut&&sn(new Ut(new ArrayBuffer(1)))!=Jt||jt&&sn(new jt)!=Kt||Wt&&sn(Wt.resolve())!=Xt||zt&&sn(new zt)!=Yt||Ht&&sn(new Ht)!=Qt){sn=function(e){var t=L(e),r=t==qt?e.constructor:undefined,s=r?At(r):"";if(s){switch(s){case Zt:return Jt;case en:return Kt;case tn:return Xt;case nn:return Yt;case rn:return Qt}}return t}}const an=sn;var on="[object Map]",un="[object Set]";var ln=Object.prototype;var cn=ln.hasOwnProperty;function isEmpty(e){if(e==null){return true}if(st(e)&&(V(e)||typeof e=="string"||typeof e.splice=="function"||Q(e)||Be(e)||B(e))){return!e.length}var t=an(e);if(t==on||t==un){return!e.size}if(He(e)){return!Je(e).length}for(var r in e){if(cn.call(e,r)){return false}}return true}const hn=isEmpty;function listCacheClear(){this.__data__=[];this.size=0}const fn=listCacheClear;function eq(e,t){return e===t||e!==e&&t!==t}const pn=eq;function assocIndexOf(e,t){var r=e.length;while(r--){if(pn(e[r][0],t)){return r}}return-1}const dn=assocIndexOf;var _n=Array.prototype;var mn=_n.splice;function listCacheDelete(e){var t=this.__data__,r=dn(t,e);if(r<0){return false}var s=t.length-1;if(r==s){t.pop()}else{mn.call(t,r,1)}--this.size;return true}const gn=listCacheDelete;function listCacheGet(e){var t=this.__data__,r=dn(t,e);return r<0?undefined:t[r][1]}const yn=listCacheGet;function listCacheHas(e){return dn(this.__data__,e)>-1}const bn=listCacheHas;function listCacheSet(e,t){var r=this.__data__,s=dn(r,e);if(s<0){++this.size;r.push([e,t])}else{r[s][1]=t}return this}const vn=listCacheSet;function ListCache(e){var t=-1,r=e==null?0:e.length;this.clear();while(++t<r){var s=e[t];this.set(s[0],s[1])}}ListCache.prototype.clear=fn;ListCache.prototype["delete"]=gn;ListCache.prototype.get=yn;ListCache.prototype.has=bn;ListCache.prototype.set=vn;const En=ListCache;function stackClear(){this.__data__=new En;this.size=0}const Tn=stackClear;function stackDelete(e){var t=this.__data__,r=t["delete"](e);this.size=t.size;return r}const kn=stackDelete;function stackGet(e){return this.__data__.get(e)}const xn=stackGet;function stackHas(e){return this.__data__.has(e)}const On=stackHas;var An=Ft(Object,"create");const wn=An;function hashClear(){this.__data__=wn?wn(null):{};this.size=0}const Sn=hashClear;function hashDelete(e){var t=this.has(e)&&delete this.__data__[e];this.size-=t?1:0;return t}const Nn=hashDelete;var Rn="__lodash_hash_undefined__";var Cn=Object.prototype;var In=Cn.hasOwnProperty;function hashGet(e){var t=this.__data__;if(wn){var r=t[e];return r===Rn?undefined:r}return In.call(t,e)?t[e]:undefined}const Ln=hashGet;var Pn=Object.prototype;var Mn=Pn.hasOwnProperty;function hashHas(e){var t=this.__data__;return wn?t[e]!==undefined:Mn.call(t,e)}const Fn=hashHas;var Dn="__lodash_hash_undefined__";function hashSet(e,t){var r=this.__data__;this.size+=this.has(e)?0:1;r[e]=wn&&t===undefined?Dn:t;return this}const Un=hashSet;function Hash(e){var t=-1,r=e==null?0:e.length;this.clear();while(++t<r){var s=e[t];this.set(s[0],s[1])}}Hash.prototype.clear=Sn;Hash.prototype["delete"]=Nn;Hash.prototype.get=Ln;Hash.prototype.has=Fn;Hash.prototype.set=Un;const $n=Hash;function mapCacheClear(){this.size=0;this.__data__={hash:new $n,map:new(jt||En),string:new $n}}const jn=mapCacheClear;function isKeyable(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}const Bn=isKeyable;function getMapData(e,t){var r=e.__data__;return Bn(t)?r[typeof t=="string"?"string":"hash"]:r.map}const Wn=getMapData;function mapCacheDelete(e){var t=Wn(this,e)["delete"](e);this.size-=t?1:0;return t}const Vn=mapCacheDelete;function mapCacheGet(e){return Wn(this,e).get(e)}const zn=mapCacheGet;function mapCacheHas(e){return Wn(this,e).has(e)}const Gn=mapCacheHas;function mapCacheSet(e,t){var r=Wn(this,e),s=r.size;r.set(e,t);this.size+=r.size==s?0:1;return this}const Hn=mapCacheSet;function MapCache(e){var t=-1,r=e==null?0:e.length;this.clear();while(++t<r){var s=e[t];this.set(s[0],s[1])}}MapCache.prototype.clear=jn;MapCache.prototype["delete"]=Vn;MapCache.prototype.get=zn;MapCache.prototype.has=Gn;MapCache.prototype.set=Hn;const Kn=MapCache;var qn=200;function stackSet(e,t){var r=this.__data__;if(r instanceof En){var s=r.__data__;if(!jt||s.length<qn-1){s.push([e,t]);this.size=++r.size;return this}r=this.__data__=new Kn(s)}r.set(e,t);this.size=r.size;return this}const Xn=stackSet;function Stack(e){var t=this.__data__=new En(e);this.size=t.size}Stack.prototype.clear=Tn;Stack.prototype["delete"]=kn;Stack.prototype.get=xn;Stack.prototype.has=On;Stack.prototype.set=Xn;const Yn=Stack;var Qn="__lodash_hash_undefined__";function setCacheAdd(e){this.__data__.set(e,Qn);return this}const Jn=setCacheAdd;function setCacheHas(e){return this.__data__.has(e)}const Zn=setCacheHas;function SetCache(e){var t=-1,r=e==null?0:e.length;this.__data__=new Kn;while(++t<r){this.add(e[t])}}SetCache.prototype.add=SetCache.prototype.push=Jn;SetCache.prototype.has=Zn;const ei=SetCache;function arraySome(e,t){var r=-1,s=e==null?0:e.length;while(++r<s){if(t(e[r],r,e)){return true}}return false}const ti=arraySome;function cacheHas(e,t){return e.has(t)}const ni=cacheHas;var ii=1,ri=2;function equalArrays(e,t,r,s,a,u){var l=r&ii,h=e.length,f=t.length;if(h!=f&&!(l&&f>h)){return false}var d=u.get(e);var _=u.get(t);if(d&&_){return d==t&&_==e}var m=-1,g=true,y=r&ri?new ei:undefined;u.set(e,t);u.set(t,e);while(++m<h){var b=e[m],v=t[m];if(s){var E=l?s(v,b,m,t,e,u):s(b,v,m,e,t,u)}if(E!==undefined){if(E){continue}g=false;break}if(y){if(!ti(t,(function(e,t){if(!ni(y,t)&&(b===e||a(b,e,r,s,u))){return y.push(t)}}))){g=false;break}}else if(!(b===v||a(b,v,r,s,u))){g=false;break}}u["delete"](e);u["delete"](t);return g}const si=equalArrays;var ai=y.Uint8Array;const oi=ai;function mapToArray(e){var t=-1,r=Array(e.size);e.forEach((function(e,s){r[++t]=[s,e]}));return r}const ui=mapToArray;function setToArray(e){var t=-1,r=Array(e.size);e.forEach((function(e){r[++t]=e}));return r}const li=setToArray;var ci=1,hi=2;var fi="[object Boolean]",pi="[object Date]",di="[object Error]",_i="[object Map]",mi="[object Number]",gi="[object RegExp]",yi="[object Set]",bi="[object String]",vi="[object Symbol]";var Ei="[object ArrayBuffer]",Ti="[object DataView]";var ki=v?v.prototype:undefined,xi=ki?ki.valueOf:undefined;function equalByTag(e,t,r,s,a,u,l){switch(r){case Ti:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset){return false}e=e.buffer;t=t.buffer;case Ei:if(e.byteLength!=t.byteLength||!u(new oi(e),new oi(t))){return false}return true;case fi:case pi:case mi:return pn(+e,+t);case di:return e.name==t.name&&e.message==t.message;case gi:case bi:return e==t+"";case _i:var h=ui;case yi:var f=s&ci;h||(h=li);if(e.size!=t.size&&!f){return false}var d=l.get(e);if(d){return d==t}s|=hi;l.set(e,t);var _=si(h(e),h(t),s,a,u,l);l["delete"](e);return _;case vi:if(xi){return xi.call(e)==xi.call(t)}}return false}const Oi=equalByTag;function arrayPush(e,t){var r=-1,s=t.length,a=e.length;while(++r<s){e[a+r]=t[r]}return e}const Ai=arrayPush;function baseGetAllKeys(e,t,r){var s=t(e);return V(e)?s:Ai(s,r(e))}const wi=baseGetAllKeys;function arrayFilter(e,t){var r=-1,s=e==null?0:e.length,a=0,u=[];while(++r<s){var l=e[r];if(t(l,r,e)){u[a++]=l}}return u}const Si=arrayFilter;function stubArray(){return[]}const Ni=stubArray;var Ri=Object.prototype;var Ci=Ri.propertyIsEnumerable;var Ii=Object.getOwnPropertySymbols;var Li=!Ii?Ni:function(e){if(e==null){return[]}e=Object(e);return Si(Ii(e),(function(t){return Ci.call(e,t)}))};const Pi=Li;function getAllKeys(e){return wi(e,ut,Pi)}const Mi=getAllKeys;var Fi=1;var Di=Object.prototype;var Ui=Di.hasOwnProperty;function equalObjects(e,t,r,s,a,u){var l=r&Fi,h=Mi(e),f=h.length,d=Mi(t),_=d.length;if(f!=_&&!l){return false}var m=f;while(m--){var g=h[m];if(!(l?g in t:Ui.call(t,g))){return false}}var y=u.get(e);var b=u.get(t);if(y&&b){return y==t&&b==e}var v=true;u.set(e,t);u.set(t,e);var E=l;while(++m<f){g=h[m];var T=e[g],k=t[g];if(s){var x=l?s(k,T,g,t,e,u):s(T,k,g,e,t,u)}if(!(x===undefined?T===k||a(T,k,r,s,u):x)){v=false;break}E||(E=g=="constructor")}if(v&&!E){var O=e.constructor,A=t.constructor;if(O!=A&&("constructor"in e&&"constructor"in t)&&!(typeof O=="function"&&O instanceof O&&typeof A=="function"&&A instanceof A)){v=false}}u["delete"](e);u["delete"](t);return v}const $i=equalObjects;var ji=1;var Bi="[object Arguments]",Wi="[object Array]",Vi="[object Object]";var zi=Object.prototype;var Gi=zi.hasOwnProperty;function baseIsEqualDeep(e,t,r,s,a,u){var l=V(e),h=V(t),f=l?Wi:an(e),d=h?Wi:an(t);f=f==Bi?Vi:f;d=d==Bi?Vi:d;var _=f==Vi,m=d==Vi,g=f==d;if(g&&Q(e)){if(!Q(t)){return false}l=true;_=false}if(g&&!_){u||(u=new Yn);return l||Be(e)?si(e,t,r,s,a,u):Oi(e,t,f,r,s,a,u)}if(!(r&ji)){var y=_&&Gi.call(e,"__wrapped__"),b=m&&Gi.call(t,"__wrapped__");if(y||b){var v=y?e.value():e,E=b?t.value():t;u||(u=new Yn);return a(v,E,r,s,u)}}if(!g){return false}u||(u=new Yn);return $i(e,t,r,s,a,u)}const Hi=baseIsEqualDeep;function baseIsEqual(e,t,r,s,a){if(e===t){return true}if(e==null||t==null||!P(e)&&!P(t)){return e!==e&&t!==t}return Hi(e,t,r,s,baseIsEqual,a)}const Ki=baseIsEqual;var qi=1,Xi=2;function baseIsMatch(e,t,r,s){var a=r.length,u=a,l=!s;if(e==null){return!u}e=Object(e);while(a--){var h=r[a];if(l&&h[2]?h[1]!==e[h[0]]:!(h[0]in e)){return false}}while(++a<u){h=r[a];var f=h[0],d=e[f],_=h[1];if(l&&h[2]){if(d===undefined&&!(f in e)){return false}}else{var m=new Yn;if(s){var g=s(d,_,f,e,t,m)}if(!(g===undefined?Ki(_,d,qi|Xi,s,m):g)){return false}}}return true}const Yi=baseIsMatch;function isStrictComparable(e){return e===e&&!Ze(e)}const Qi=isStrictComparable;function getMatchData(e){var t=ut(e),r=t.length;while(r--){var s=t[r],a=e[s];t[r]=[s,a,Qi(a)]}return t}const Ji=getMatchData;function matchesStrictComparable(e,t){return function(r){if(r==null){return false}return r[e]===t&&(t!==undefined||e in Object(r))}}const Zi=matchesStrictComparable;function baseMatches(e){var t=Ji(e);if(t.length==1&&t[0][2]){return Zi(t[0][0],t[0][1])}return function(r){return r===e||Yi(r,e,t)}}const er=baseMatches;var tr="[object Symbol]";function isSymbol(e){return typeof e=="symbol"||P(e)&&L(e)==tr}const nr=isSymbol;var ir=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,rr=/^\w*$/;function isKey(e,t){if(V(e)){return false}var r=typeof e;if(r=="number"||r=="symbol"||r=="boolean"||e==null||nr(e)){return true}return rr.test(e)||!ir.test(e)||t!=null&&e in Object(t)}const sr=isKey;var ar="Expected a function";function memoize(e,t){if(typeof e!="function"||t!=null&&typeof t!="function"){throw new TypeError(ar)}var memoized=function(){var r=arguments,s=t?t.apply(this,r):r[0],a=memoized.cache;if(a.has(s)){return a.get(s)}var u=e.apply(this,r);memoized.cache=a.set(s,u)||a;return u};memoized.cache=new(memoize.Cache||Kn);return memoized}memoize.Cache=Kn;const or=memoize;var ur=500;function memoizeCapped(e){var t=or(e,(function(e){if(r.size===ur){r.clear()}return e}));var r=t.cache;return t}const lr=memoizeCapped;var cr=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g;var hr=/\\(\\)?/g;var fr=lr((function(e){var t=[];if(e.charCodeAt(0)===46){t.push("")}e.replace(cr,(function(e,r,s,a){t.push(s?a.replace(hr,"$1"):r||e)}));return t}));const pr=fr;var dr=1/0;var _r=v?v.prototype:undefined,mr=_r?_r.toString:undefined;function baseToString(e){if(typeof e=="string"){return e}if(V(e)){return gt(e,baseToString)+""}if(nr(e)){return mr?mr.call(e):""}var t=e+"";return t=="0"&&1/e==-dr?"-0":t}const gr=baseToString;function toString_toString(e){return e==null?"":gr(e)}const yr=toString_toString;function castPath(e,t){if(V(e)){return e}return sr(e,t)?[e]:pr(yr(e))}const br=castPath;var vr=1/0;function toKey(e){if(typeof e=="string"||nr(e)){return e}var t=e+"";return t=="0"&&1/e==-vr?"-0":t}const Er=toKey;function baseGet(e,t){t=br(t,e);var r=0,s=t.length;while(e!=null&&r<s){e=e[Er(t[r++])]}return r&&r==s?e:undefined}const Tr=baseGet;function get(e,t,r){var s=e==null?undefined:Tr(e,t);return s===undefined?r:s}const kr=get;function baseHasIn(e,t){return e!=null&&t in Object(e)}const xr=baseHasIn;function hasPath(e,t,r){t=br(t,e);var s=-1,a=t.length,u=false;while(++s<a){var l=Er(t[s]);if(!(u=e!=null&&r(e,l))){break}e=e[l]}if(u||++s!=a){return u}a=e==null?0:e.length;return!!a&&ne(a)&&ee(l,a)&&(V(e)||B(e))}const Or=hasPath;function hasIn(e,t){return e!=null&&Or(e,t,xr)}const Ar=hasIn;var wr=1,Sr=2;function baseMatchesProperty(e,t){if(sr(e)&&Qi(t)){return Zi(Er(e),t)}return function(r){var s=kr(r,e);return s===undefined&&s===t?Ar(r,e):Ki(t,s,wr|Sr)}}const Nr=baseMatchesProperty;function baseProperty(e){return function(t){return t==null?undefined:t[e]}}const Rr=baseProperty;function basePropertyDeep(e){return function(t){return Tr(t,e)}}const Cr=basePropertyDeep;function property(e){return sr(e)?Rr(Er(e)):Cr(e)}const Ir=property;function baseIteratee(e){if(typeof e=="function"){return e}if(e==null){return dt}if(typeof e=="object"){return V(e)?Nr(e[0],e[1]):er(e)}return Ir(e)}const Lr=baseIteratee;function baseMap(e,t){var r=-1,s=st(e)?Array(e.length):[];pt(e,(function(e,a,u){s[++r]=t(e,a,u)}));return s}const Pr=baseMap;function map_map(e,t){var r=V(e)?gt:Pr;return r(e,Lr(t,3))}const Mr=map_map;var Fr=Object.prototype;var Dr=Fr.hasOwnProperty;function baseHas(e,t){return e!=null&&Dr.call(e,t)}const Ur=baseHas;function has(e,t){return e!=null&&Or(e,t,Ur)}const $r=has;var jr=function(){try{var e=Ft(Object,"defineProperty");e({},"",{});return e}catch(e){}}();const Br=jr;function baseAssignValue(e,t,r){if(t=="__proto__"&&Br){Br(e,t,{configurable:true,enumerable:true,value:r,writable:true})}else{e[t]=r}}const Wr=baseAssignValue;var Vr=Object.prototype;var zr=Vr.hasOwnProperty;function assignValue(e,t,r){var s=e[t];if(!(zr.call(e,t)&&pn(s,r))||r===undefined&&!(t in e)){Wr(e,t,r)}}const Gr=assignValue;function copyObject(e,t,r,s){var a=!r;r||(r={});var u=-1,l=t.length;while(++u<l){var h=t[u];var f=s?s(r[h],e[h],h,r,e):undefined;if(f===undefined){f=e[h]}if(a){Wr(r,h,f)}else{Gr(r,h,f)}}return r}const Hr=copyObject;function baseAssign(e,t){return e&&Hr(t,ut(t),e)}const Kr=baseAssign;function nativeKeysIn(e){var t=[];if(e!=null){for(var r in Object(e)){t.push(r)}}return t}const qr=nativeKeysIn;var Xr=Object.prototype;var Yr=Xr.hasOwnProperty;function baseKeysIn(e){if(!Ze(e)){return qr(e)}var t=He(e),r=[];for(var s in e){if(!(s=="constructor"&&(t||!Yr.call(e,s)))){r.push(s)}}return r}const Qr=baseKeysIn;function keysIn(e){return st(e)?ze(e,true):Qr(e)}const Jr=keysIn;function baseAssignIn(e,t){return e&&Hr(t,Jr(t),e)}const Zr=baseAssignIn;var es=typeof exports=="object"&&exports&&!exports.nodeType&&exports;var ts=es&&typeof module=="object"&&module&&!module.nodeType&&module;var ns=ts&&ts.exports===es;var is=ns?y.Buffer:undefined,rs=is?is.allocUnsafe:undefined;function cloneBuffer(e,t){if(t){return e.slice()}var r=e.length,s=rs?rs(r):new e.constructor(r);e.copy(s);return s}const ss=cloneBuffer;function copyArray(e,t){var r=-1,s=e.length;t||(t=Array(s));while(++r<s){t[r]=e[r]}return t}const as=copyArray;function copySymbols(e,t){return Hr(e,Pi(e),t)}const os=copySymbols;var us=Ke(Object.getPrototypeOf,Object);const ls=us;var cs=Object.getOwnPropertySymbols;var hs=!cs?Ni:function(e){var t=[];while(e){Ai(t,Pi(e));e=ls(e)}return t};const fs=hs;function copySymbolsIn(e,t){return Hr(e,fs(e),t)}const ps=copySymbolsIn;function getAllKeysIn(e){return wi(e,Jr,fs)}const ds=getAllKeysIn;var _s=Object.prototype;var ms=_s.hasOwnProperty;function initCloneArray(e){var t=e.length,r=new e.constructor(t);if(t&&typeof e[0]=="string"&&ms.call(e,"index")){r.index=e.index;r.input=e.input}return r}const gs=initCloneArray;function cloneArrayBuffer(e){var t=new e.constructor(e.byteLength);new oi(t).set(new oi(e));return t}const ys=cloneArrayBuffer;function cloneDataView(e,t){var r=t?ys(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}const bs=cloneDataView;var vs=/\w*$/;function cloneRegExp(e){var t=new e.constructor(e.source,vs.exec(e));t.lastIndex=e.lastIndex;return t}const Es=cloneRegExp;var Ts=v?v.prototype:undefined,ks=Ts?Ts.valueOf:undefined;function cloneSymbol(e){return ks?Object(ks.call(e)):{}}const xs=cloneSymbol;function cloneTypedArray(e,t){var r=t?ys(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}const Os=cloneTypedArray;var As="[object Boolean]",ws="[object Date]",Ss="[object Map]",Ns="[object Number]",Rs="[object RegExp]",Cs="[object Set]",Is="[object String]",Ls="[object Symbol]";var Ps="[object ArrayBuffer]",Ms="[object DataView]",Fs="[object Float32Array]",Ds="[object Float64Array]",Us="[object Int8Array]",$s="[object Int16Array]",js="[object Int32Array]",Bs="[object Uint8Array]",Ws="[object Uint8ClampedArray]",Vs="[object Uint16Array]",zs="[object Uint32Array]";function initCloneByTag(e,t,r){var s=e.constructor;switch(t){case Ps:return ys(e);case As:case ws:return new s(+e);case Ms:return bs(e,r);case Fs:case Ds:case Us:case $s:case js:case Bs:case Ws:case Vs:case zs:return Os(e,r);case Ss:return new s;case Ns:case Is:return new s(e);case Rs:return Es(e);case Cs:return new s;case Ls:return xs(e)}}const Gs=initCloneByTag;var Hs=Object.create;var Ks=function(){function object(){}return function(e){if(!Ze(e)){return{}}if(Hs){return Hs(e)}object.prototype=e;var t=new object;object.prototype=undefined;return t}}();const qs=Ks;function initCloneObject(e){return typeof e.constructor=="function"&&!He(e)?qs(ls(e)):{}}const Xs=initCloneObject;var Ys="[object Map]";function baseIsMap(e){return P(e)&&an(e)==Ys}const Qs=baseIsMap;var Js=Ue&&Ue.isMap;var Zs=Js?Ce(Js):Qs;const ea=Zs;var ta="[object Set]";function baseIsSet(e){return P(e)&&an(e)==ta}const na=baseIsSet;var ia=Ue&&Ue.isSet;var ra=ia?Ce(ia):na;const sa=ra;var aa=1,oa=2,ua=4;var la="[object Arguments]",ca="[object Array]",ha="[object Boolean]",fa="[object Date]",pa="[object Error]",da="[object Function]",_a="[object GeneratorFunction]",ma="[object Map]",ga="[object Number]",ya="[object Object]",ba="[object RegExp]",va="[object Set]",Ea="[object String]",Ta="[object Symbol]",ka="[object WeakMap]";var xa="[object ArrayBuffer]",Oa="[object DataView]",Aa="[object Float32Array]",wa="[object Float64Array]",Sa="[object Int8Array]",Na="[object Int16Array]",Ra="[object Int32Array]",Ca="[object Uint8Array]",Ia="[object Uint8ClampedArray]",La="[object Uint16Array]",Pa="[object Uint32Array]";var Ma={};Ma[la]=Ma[ca]=Ma[xa]=Ma[Oa]=Ma[ha]=Ma[fa]=Ma[Aa]=Ma[wa]=Ma[Sa]=Ma[Na]=Ma[Ra]=Ma[ma]=Ma[ga]=Ma[ya]=Ma[ba]=Ma[va]=Ma[Ea]=Ma[Ta]=Ma[Ca]=Ma[Ia]=Ma[La]=Ma[Pa]=true;Ma[pa]=Ma[da]=Ma[ka]=false;function baseClone(e,t,r,s,u,l){var h,f=t&aa,d=t&oa,_=t&ua;if(r){h=u?r(e,s,u,l):r(e)}if(h!==undefined){return h}if(!Ze(e)){return e}var m=V(e);if(m){h=gs(e);if(!f){return as(e,h)}}else{var g=an(e),y=g==da||g==_a;if(Q(e)){return ss(e,f)}if(g==ya||g==la||y&&!u){h=d||y?{}:Xs(e);if(!f){return d?ps(e,Zr(h,e)):os(e,Kr(h,e))}}else{if(!Ma[g]){return u?e:{}}h=Gs(e,g,f)}}l||(l=new Yn);var b=l.get(e);if(b){return b}l.set(e,h);if(sa(e)){e.forEach((function(s){h.add(baseClone(s,t,r,s,e,l))}))}else if(ea(e)){e.forEach((function(s,a){h.set(a,baseClone(s,t,r,a,e,l))}))}var v=_?d?ds:Mi:d?Jr:ut;var E=m?undefined:v(e);a(E||e,(function(s,a){if(E){a=s;s=e[a]}Gr(h,a,baseClone(s,t,r,a,e,l))}));return h}const Fa=baseClone;var Da=4;function clone(e){return Fa(e,Da)}const Ua=clone;function toFastProperties(e){function FakeConstructor(){}FakeConstructor.prototype=e;const t=new FakeConstructor;function fakeAccess(){return typeof t.bar}fakeAccess();fakeAccess();if(true)return e;(0,eval)(e)}function baseSlice(e,t,r){var s=-1,a=e.length;if(t<0){t=-t>a?0:a+t}r=r>a?a:r;if(r<0){r+=a}a=t>r?0:r-t>>>0;t>>>=0;var u=Array(a);while(++s<a){u[s]=e[s+t]}return u}const $a=baseSlice;var ja=/\s/;function trimmedEndIndex(e){var t=e.length;while(t--&&ja.test(e.charAt(t))){}return t}const Ba=trimmedEndIndex;var Wa=/^\s+/;function baseTrim(e){return e?e.slice(0,Ba(e)+1).replace(Wa,""):e}const Va=baseTrim;var za=0/0;var Ga=/^[-+]0x[0-9a-f]+$/i;var Ha=/^0b[01]+$/i;var Ka=/^0o[0-7]+$/i;var qa=parseInt;function toNumber(e){if(typeof e=="number"){return e}if(nr(e)){return za}if(Ze(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Ze(t)?t+"":t}if(typeof e!="string"){return e===0?e:+e}e=Va(e);var r=Ha.test(e);return r||Ka.test(e)?qa(e.slice(2),r?2:8):Ga.test(e)?za:+e}const Xa=toNumber;var Ya=1/0,Qa=17976931348623157e292;function toFinite(e){if(!e){return e===0?e:0}e=Xa(e);if(e===Ya||e===-Ya){var t=e<0?-1:1;return t*Qa}return e===e?e:0}const Ja=toFinite;function toInteger(e){var t=Ja(e),r=t%1;return t===t?r?t-r:t:0}const Za=toInteger;function drop(e,t,r){var s=e==null?0:e.length;if(!s){return[]}t=r||t===undefined?1:Za(t);return $a(e,t<0?0:t,s)}const eo=drop;var to="[object String]";function isString(e){return typeof e=="string"||!V(e)&&P(e)&&L(e)==to}const no=isString;function apply(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}const io=apply;var ro=Math.max;function overRest(e,t,r){t=ro(t===undefined?e.length-1:t,0);return function(){var s=arguments,a=-1,u=ro(s.length-t,0),l=Array(u);while(++a<u){l[a]=s[t+a]}a=-1;var h=Array(t+1);while(++a<t){h[a]=s[a]}h[t]=r(l);return io(e,this,h)}}const so=overRest;function constant(e){return function(){return e}}const ao=constant;var oo=!Br?dt:function(e,t){return Br(e,"toString",{configurable:true,enumerable:false,value:ao(t),writable:true})};const uo=oo;var lo=800,co=16;var ho=Date.now;function shortOut(e){var t=0,r=0;return function(){var s=ho(),a=co-(s-r);r=s;if(a>0){if(++t>=lo){return arguments[0]}}else{t=0}return e.apply(undefined,arguments)}}const fo=shortOut;var po=fo(uo);const _o=po;function baseRest(e,t){return _o(so(e,t,dt),e+"")}const mo=baseRest;function isIterateeCall(e,t,r){if(!Ze(r)){return false}var s=typeof t;if(s=="number"?st(r)&&ee(t,r.length):s=="string"&&t in r){return pn(r[t],e)}return false}const go=isIterateeCall;function createAssigner(e){return mo((function(t,r){var s=-1,a=r.length,u=a>1?r[a-1]:undefined,l=a>2?r[2]:undefined;u=e.length>3&&typeof u=="function"?(a--,u):undefined;if(l&&go(r[0],r[1],l)){u=a<3?undefined:u;a=1}t=Object(t);while(++s<a){var h=r[s];if(h){e(t,h,s,u)}}return t}))}const yo=createAssigner;var bo=Object.prototype;var vo=bo.hasOwnProperty;var Eo=yo((function(e,t){if(He(t)||st(t)){Hr(t,ut(t),e);return}for(var r in t){if(vo.call(t,r)){Gr(e,r,t[r])}}}));const To=Eo;function baseSet(e,t,r,s){if(!Ze(e)){return e}t=br(t,e);var a=-1,u=t.length,l=u-1,h=e;while(h!=null&&++a<u){var f=Er(t[a]),d=r;if(f==="__proto__"||f==="constructor"||f==="prototype"){return e}if(a!=l){var _=h[f];d=s?s(_,f,h):undefined;if(d===undefined){d=Ze(_)?_:ee(t[a+1])?[]:{}}}Gr(h,f,d);h=h[f]}return e}const ko=baseSet;function basePickBy(e,t,r){var s=-1,a=t.length,u={};while(++s<a){var l=t[s],h=Tr(e,l);if(r(h,l)){ko(u,br(l,e),h)}}return u}const xo=basePickBy;function pickBy(e,t){if(e==null){return{}}var r=gt(ds(e),(function(e){return[e]}));t=Lr(t);return xo(e,r,(function(e,r){return t(e,r[0])}))}const Oo=pickBy;var Ao="[object RegExp]";function baseIsRegExp(e){return P(e)&&L(e)==Ao}const wo=baseIsRegExp;var So=Ue&&Ue.isRegExp;var No=So?Ce(So):wo;const Ro=No;function tokenLabel(e){if(hasTokenLabel(e)){return e.LABEL}else{return e.name}}function hasTokenLabel(e){return no(e.LABEL)&&e.LABEL!==""}class AbstractProduction{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){this._definition=e}accept(e){e.visit(this);mt(this.definition,(t=>{t.accept(e)}))}}class model_NonTerminal extends AbstractProduction{constructor(e){super([]);this.idx=1;To(this,Oo(e,(e=>e!==undefined)))}set definition(e){}get definition(){if(this.referencedRule!==undefined){return this.referencedRule.definition}return[]}accept(e){e.visit(this)}}class Rule extends AbstractProduction{constructor(e){super(e.definition);this.orgText="";To(this,Oo(e,(e=>e!==undefined)))}}class Alternative extends AbstractProduction{constructor(e){super(e.definition);this.ignoreAmbiguities=false;To(this,Oo(e,(e=>e!==undefined)))}}class Option extends AbstractProduction{constructor(e){super(e.definition);this.idx=1;To(this,Oo(e,(e=>e!==undefined)))}}class RepetitionMandatory extends AbstractProduction{constructor(e){super(e.definition);this.idx=1;To(this,Oo(e,(e=>e!==undefined)))}}class RepetitionMandatoryWithSeparator extends AbstractProduction{constructor(e){super(e.definition);this.idx=1;To(this,Oo(e,(e=>e!==undefined)))}}class Repetition extends AbstractProduction{constructor(e){super(e.definition);this.idx=1;To(this,Oo(e,(e=>e!==undefined)))}}class RepetitionWithSeparator extends AbstractProduction{constructor(e){super(e.definition);this.idx=1;To(this,Oo(e,(e=>e!==undefined)))}}class Alternation extends AbstractProduction{get definition(){return this._definition}set definition(e){this._definition=e}constructor(e){super(e.definition);this.idx=1;this.ignoreAmbiguities=false;this.hasPredicates=false;To(this,Oo(e,(e=>e!==undefined)))}}class Terminal{constructor(e){this.idx=1;To(this,Oo(e,(e=>e!==undefined)))}accept(e){e.visit(this)}}function serializeGrammar(e){return Mr(e,serializeProduction)}function serializeProduction(e){function convertDefinition(e){return Mr(e,serializeProduction)}if(e instanceof model_NonTerminal){const t={type:"NonTerminal",name:e.nonTerminalName,idx:e.idx};if(no(e.label)){t.label=e.label}return t}else if(e instanceof Alternative){return{type:"Alternative",definition:convertDefinition(e.definition)}}else if(e instanceof Option){return{type:"Option",idx:e.idx,definition:convertDefinition(e.definition)}}else if(e instanceof RepetitionMandatory){return{type:"RepetitionMandatory",idx:e.idx,definition:convertDefinition(e.definition)}}else if(e instanceof RepetitionMandatoryWithSeparator){return{type:"RepetitionMandatoryWithSeparator",idx:e.idx,separator:serializeProduction(new Terminal({terminalType:e.separator})),definition:convertDefinition(e.definition)}}else if(e instanceof RepetitionWithSeparator){return{type:"RepetitionWithSeparator",idx:e.idx,separator:serializeProduction(new Terminal({terminalType:e.separator})),definition:convertDefinition(e.definition)}}else if(e instanceof Repetition){return{type:"Repetition",idx:e.idx,definition:convertDefinition(e.definition)}}else if(e instanceof Alternation){return{type:"Alternation",idx:e.idx,definition:convertDefinition(e.definition)}}else if(e instanceof Terminal){const t={type:"Terminal",name:e.terminalType.name,label:tokenLabel(e.terminalType),idx:e.idx};if(no(e.label)){t.terminalLabel=e.label}const r=e.terminalType.PATTERN;if(e.terminalType.PATTERN){t.pattern=Ro(r)?r.source:r}return t}else if(e instanceof Rule){return{type:"Rule",name:e.name,orgText:e.orgText,definition:convertDefinition(e.definition)}}else{throw Error("non exhaustive match")}}class visitor_GAstVisitor{visit(e){const t=e;switch(t.constructor){case model_NonTerminal:return this.visitNonTerminal(t);case Alternative:return this.visitAlternative(t);case Option:return this.visitOption(t);case RepetitionMandatory:return this.visitRepetitionMandatory(t);case RepetitionMandatoryWithSeparator:return this.visitRepetitionMandatoryWithSeparator(t);case RepetitionWithSeparator:return this.visitRepetitionWithSeparator(t);case Repetition:return this.visitRepetition(t);case Alternation:return this.visitAlternation(t);case Terminal:return this.visitTerminal(t);case Rule:return this.visitRule(t);default:throw Error("non exhaustive match")}}visitNonTerminal(e){}visitAlternative(e){}visitOption(e){}visitRepetition(e){}visitRepetitionMandatory(e){}visitRepetitionMandatoryWithSeparator(e){}visitRepetitionWithSeparator(e){}visitAlternation(e){}visitTerminal(e){}visitRule(e){}}function baseSome(e,t){var r;pt(e,(function(e,s,a){r=t(e,s,a);return!r}));return!!r}const Co=baseSome;function some_some(e,t,r){var s=V(e)?ti:Co;if(r&&go(e,t,r)){t=undefined}return s(e,Lr(t,3))}const Io=some_some;function baseFindIndex(e,t,r,s){var a=e.length,u=r+(s?1:-1);while(s?u--:++u<a){if(t(e[u],u,e)){return u}}return-1}const Lo=baseFindIndex;function baseIsNaN(e){return e!==e}const Po=baseIsNaN;function strictIndexOf(e,t,r){var s=r-1,a=e.length;while(++s<a){if(e[s]===t){return s}}return-1}const Mo=strictIndexOf;function baseIndexOf(e,t,r){return t===t?Mo(e,t,r):Lo(e,Po,r)}const Fo=baseIndexOf;var Do=Math.max;function includes(e,t,r,s){e=st(e)?e:bt(e);r=r&&!s?Za(r):0;var a=e.length;if(r<0){r=Do(a+r,0)}return no(e)?r<=a&&e.indexOf(t,r)>-1:!!a&&Fo(e,t,r)>-1}const Uo=includes;function arrayEvery(e,t){var r=-1,s=e==null?0:e.length;while(++r<s){if(!t(e[r],r,e)){return false}}return true}const $o=arrayEvery;function baseEvery(e,t){var r=true;pt(e,(function(e,s,a){r=!!t(e,s,a);return r}));return r}const jo=baseEvery;function every(e,t,r){var s=V(e)?$o:jo;if(r&&go(e,t,r)){t=undefined}return s(e,Lr(t,3))}const Bo=every;function isSequenceProd(e){return e instanceof Alternative||e instanceof Option||e instanceof Repetition||e instanceof RepetitionMandatory||e instanceof RepetitionMandatoryWithSeparator||e instanceof RepetitionWithSeparator||e instanceof Terminal||e instanceof Rule}function isOptionalProd(e,t=[]){const r=e instanceof Option||e instanceof Repetition||e instanceof RepetitionWithSeparator;if(r){return true}if(e instanceof Alternation){return Io(e.definition,(e=>isOptionalProd(e,t)))}else if(e instanceof model_NonTerminal&&Uo(t,e)){return false}else if(e instanceof AbstractProduction){if(e instanceof model_NonTerminal){t.push(e)}return Bo(e.definition,(e=>isOptionalProd(e,t)))}else{return false}}function isBranchingProd(e){return e instanceof Alternation}function getProductionDslName(e){if(e instanceof model_NonTerminal){return"SUBRULE"}else if(e instanceof Option){return"OPTION"}else if(e instanceof Alternation){return"OR"}else if(e instanceof RepetitionMandatory){return"AT_LEAST_ONE"}else if(e instanceof RepetitionMandatoryWithSeparator){return"AT_LEAST_ONE_SEP"}else if(e instanceof RepetitionWithSeparator){return"MANY_SEP"}else if(e instanceof Repetition){return"MANY"}else if(e instanceof Terminal){return"CONSUME"}else{throw Error("non exhaustive match")}}class RestWalker{walk(e,t=[]){mt(e.definition,((r,s)=>{const a=eo(e.definition,s+1);if(r instanceof model_NonTerminal){this.walkProdRef(r,a,t)}else if(r instanceof Terminal){this.walkTerminal(r,a,t)}else if(r instanceof Alternative){this.walkFlat(r,a,t)}else if(r instanceof Option){this.walkOption(r,a,t)}else if(r instanceof RepetitionMandatory){this.walkAtLeastOne(r,a,t)}else if(r instanceof RepetitionMandatoryWithSeparator){this.walkAtLeastOneSep(r,a,t)}else if(r instanceof RepetitionWithSeparator){this.walkManySep(r,a,t)}else if(r instanceof Repetition){this.walkMany(r,a,t)}else if(r instanceof Alternation){this.walkOr(r,a,t)}else{throw Error("non exhaustive match")}}))}walkTerminal(e,t,r){}walkProdRef(e,t,r){}walkFlat(e,t,r){const s=t.concat(r);this.walk(e,s)}walkOption(e,t,r){const s=t.concat(r);this.walk(e,s)}walkAtLeastOne(e,t,r){const s=[new Option({definition:e.definition})].concat(t,r);this.walk(e,s)}walkAtLeastOneSep(e,t,r){const s=restForRepetitionWithSeparator(e,t,r);this.walk(e,s)}walkMany(e,t,r){const s=[new Option({definition:e.definition})].concat(t,r);this.walk(e,s)}walkManySep(e,t,r){const s=restForRepetitionWithSeparator(e,t,r);this.walk(e,s)}walkOr(e,t,r){const s=t.concat(r);mt(e.definition,(e=>{const t=new Alternative({definition:[e]});this.walk(t,s)}))}}function restForRepetitionWithSeparator(e,t,r){const s=[new Option({definition:[new Terminal({terminalType:e.separator})].concat(e.definition)})];const a=s.concat(t,r);return a}function arrayIncludes(e,t){var r=e==null?0:e.length;return!!r&&Fo(e,t,0)>-1}const Wo=arrayIncludes;function arrayIncludesWith(e,t,r){var s=-1,a=e==null?0:e.length;while(++s<a){if(r(t,e[s])){return true}}return false}const Vo=arrayIncludesWith;function noop(){}const zo=noop;var Go=1/0;var Ho=!(zt&&1/li(new zt([,-0]))[1]==Go)?zo:function(e){return new zt(e)};const Ko=Ho;var qo=200;function baseUniq(e,t,r){var s=-1,a=Wo,u=e.length,l=true,h=[],f=h;if(r){l=false;a=Vo}else if(u>=qo){var d=t?null:Ko(e);if(d){return li(d)}l=false;a=ni;f=new ei}else{f=t?[]:h}e:while(++s<u){var _=e[s],m=t?t(_):_;_=r||_!==0?_:0;if(l&&m===m){var g=f.length;while(g--){if(f[g]===m){continue e}}if(t){f.push(m)}h.push(_)}else if(!a(f,m,r)){if(f!==h){f.push(m)}h.push(_)}}return h}const Xo=baseUniq;function uniq(e){return e&&e.length?Xo(e):[]}const Yo=uniq;var Qo=v?v.isConcatSpreadable:undefined;function isFlattenable(e){return V(e)||B(e)||!!(Qo&&e&&e[Qo])}const Jo=isFlattenable;function baseFlatten(e,t,r,s,a){var u=-1,l=e.length;r||(r=Jo);a||(a=[]);while(++u<l){var h=e[u];if(t>0&&r(h)){if(t>1){baseFlatten(h,t-1,r,s,a)}else{Ai(a,h)}}else if(!s){a[a.length]=h}}return a}const Zo=baseFlatten;function flatten_flatten(e){var t=e==null?0:e.length;return t?Zo(e,1):[]}const eu=flatten_flatten;function first(e){if(e instanceof model_NonTerminal){return first(e.referencedRule)}else if(e instanceof Terminal){return firstForTerminal(e)}else if(isSequenceProd(e)){return firstForSequence(e)}else if(isBranchingProd(e)){return firstForBranching(e)}else{throw Error("non exhaustive match")}}function firstForSequence(e){let t=[];const r=e.definition;let s=0;let a=r.length>s;let u;let l=true;while(a&&l){u=r[s];l=isOptionalProd(u);t=t.concat(first(u));s=s+1;a=r.length>s}return Yo(t)}function firstForBranching(e){const t=Mr(e.definition,(e=>first(e)));return Yo(eu(t))}function firstForTerminal(e){return[e.terminalType]}const tu="_~IN~_";class ResyncFollowsWalker extends RestWalker{constructor(e){super();this.topProd=e;this.follows={}}startWalking(){this.walk(this.topProd);return this.follows}walkTerminal(e,t,r){}walkProdRef(e,t,r){const s=buildBetweenProdsFollowPrefix(e.referencedRule,e.idx)+this.topProd.name;const a=t.concat(r);const u=new Alternative({definition:a});const l=first(u);this.follows[s]=l}}function computeAllProdsFollows(e){const t={};mt(e,(e=>{const r=new ResyncFollowsWalker(e).startWalking();To(t,r)}));return t}function buildBetweenProdsFollowPrefix(e,t){return e.name+t+tu}function buildInProdFollowPrefix(e){const t=e.terminalType.name;return t+e.idx+IN}function isUndefined(e){return e===undefined}const nu=isUndefined;function cc(e){return e.charCodeAt(0)}function insertToSet(e,t){if(Array.isArray(e)){e.forEach((function(e){t.push(e)}))}else{t.push(e)}}function addFlag(e,t){if(e[t]===true){throw"duplicate flag "+t}const r=e[t];e[t]=true}function ASSERT_EXISTS(e){if(e===undefined){throw Error("Internal Error - Should never get here!")}return true}function ASSERT_NEVER_REACH_HERE(){throw Error("Internal Error - Should never get here!")}function isCharacter(e){return e["type"]==="Character"}const iu=[];for(let e=cc("0");e<=cc("9");e++){iu.push(e)}const ru=[cc("_")].concat(iu);for(let e=cc("a");e<=cc("z");e++){ru.push(e)}for(let e=cc("A");e<=cc("Z");e++){ru.push(e)}const su=[cc(" "),cc("\f"),cc("\n"),cc("\r"),cc("\t"),cc("\v"),cc("\t"),cc(""),cc(""),cc(""),cc(""),cc(""),cc(""),cc(""),cc(""),cc(""),cc(""),cc(""),cc(""),cc(""),cc("\u2028"),cc("\u2029"),cc(""),cc(""),cc(""),cc("\ufeff")];const au=/[0-9a-fA-F]/;const ou=/[0-9]/;const uu=/[1-9]/;class RegExpParser{constructor(){this.idx=0;this.input="";this.groupIdx=0}saveState(){return{idx:this.idx,input:this.input,groupIdx:this.groupIdx}}restoreState(e){this.idx=e.idx;this.input=e.input;this.groupIdx=e.groupIdx}pattern(e){this.idx=0;this.input=e;this.groupIdx=0;this.consumeChar("/");const t=this.disjunction();this.consumeChar("/");const r={type:"Flags",loc:{begin:this.idx,end:e.length},global:false,ignoreCase:false,multiLine:false,unicode:false,sticky:false};while(this.isRegExpFlag()){switch(this.popChar()){case"g":addFlag(r,"global");break;case"i":addFlag(r,"ignoreCase");break;case"m":addFlag(r,"multiLine");break;case"u":addFlag(r,"unicode");break;case"y":addFlag(r,"sticky");break}}if(this.idx!==this.input.length){throw Error("Redundant input: "+this.input.substring(this.idx))}return{type:"Pattern",flags:r,value:t,loc:this.loc(0)}}disjunction(){const e=[];const t=this.idx;e.push(this.alternative());while(this.peekChar()==="|"){this.consumeChar("|");e.push(this.alternative())}return{type:"Disjunction",value:e,loc:this.loc(t)}}alternative(){const e=[];const t=this.idx;while(this.isTerm()){e.push(this.term())}return{type:"Alternative",value:e,loc:this.loc(t)}}term(){if(this.isAssertion()){return this.assertion()}else{return this.atom()}}assertion(){const e=this.idx;switch(this.popChar()){case"^":return{type:"StartAnchor",loc:this.loc(e)};case"$":return{type:"EndAnchor",loc:this.loc(e)};case"\\":switch(this.popChar()){case"b":return{type:"WordBoundary",loc:this.loc(e)};case"B":return{type:"NonWordBoundary",loc:this.loc(e)}}throw Error("Invalid Assertion Escape");case"(":this.consumeChar("?");let t;switch(this.popChar()){case"=":t="Lookahead";break;case"!":t="NegativeLookahead";break;case"<":{switch(this.popChar()){case"=":t="Lookbehind";break;case"!":t="NegativeLookbehind"}break}}ASSERT_EXISTS(t);const r=this.disjunction();this.consumeChar(")");return{type:t,value:r,loc:this.loc(e)}}return ASSERT_NEVER_REACH_HERE()}quantifier(e=false){let t=undefined;const r=this.idx;switch(this.popChar()){case"*":t={atLeast:0,atMost:Infinity};break;case"+":t={atLeast:1,atMost:Infinity};break;case"?":t={atLeast:0,atMost:1};break;case"{":const r=this.integerIncludingZero();switch(this.popChar()){case"}":t={atLeast:r,atMost:r};break;case",":let e;if(this.isDigit()){e=this.integerIncludingZero();t={atLeast:r,atMost:e}}else{t={atLeast:r,atMost:Infinity}}this.consumeChar("}");break}if(e===true&&t===undefined){return undefined}ASSERT_EXISTS(t);break}if(e===true&&t===undefined){return undefined}if(ASSERT_EXISTS(t)){if(this.peekChar(0)==="?"){this.consumeChar("?");t.greedy=false}else{t.greedy=true}t.type="Quantifier";t.loc=this.loc(r);return t}}atom(){let e;const t=this.idx;switch(this.peekChar()){case".":e=this.dotAll();break;case"\\":e=this.atomEscape();break;case"[":e=this.characterClass();break;case"(":e=this.group();break}if(e===undefined&&this.isPatternCharacter()){e=this.patternCharacter()}if(ASSERT_EXISTS(e)){e.loc=this.loc(t);if(this.isQuantifier()){e.quantifier=this.quantifier()}return e}return ASSERT_NEVER_REACH_HERE()}dotAll(){this.consumeChar(".");return{type:"Set",complement:true,value:[cc("\n"),cc("\r"),cc("\u2028"),cc("\u2029")]}}atomEscape(){this.consumeChar("\\");switch(this.peekChar()){case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":return this.decimalEscapeAtom();case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}decimalEscapeAtom(){const e=this.positiveInteger();return{type:"GroupBackReference",value:e}}characterClassEscape(){let e;let t=false;switch(this.popChar()){case"d":e=iu;break;case"D":e=iu;t=true;break;case"s":e=su;break;case"S":e=su;t=true;break;case"w":e=ru;break;case"W":e=ru;t=true;break}if(ASSERT_EXISTS(e)){return{type:"Set",value:e,complement:t}}return ASSERT_NEVER_REACH_HERE()}controlEscapeAtom(){let e;switch(this.popChar()){case"f":e=cc("\f");break;case"n":e=cc("\n");break;case"r":e=cc("\r");break;case"t":e=cc("\t");break;case"v":e=cc("\v");break}if(ASSERT_EXISTS(e)){return{type:"Character",value:e}}return ASSERT_NEVER_REACH_HERE()}controlLetterEscapeAtom(){this.consumeChar("c");const e=this.popChar();if(/[a-zA-Z]/.test(e)===false){throw Error("Invalid ")}const t=e.toUpperCase().charCodeAt(0)-64;return{type:"Character",value:t}}nulCharacterAtom(){this.consumeChar("0");return{type:"Character",value:cc("\0")}}hexEscapeSequenceAtom(){this.consumeChar("x");return this.parseHexDigits(2)}regExpUnicodeEscapeSequenceAtom(){this.consumeChar("u");return this.parseHexDigits(4)}identityEscapeAtom(){const e=this.popChar();return{type:"Character",value:cc(e)}}classPatternCharacterAtom(){switch(this.peekChar()){case"\n":case"\r":case"\u2028":case"\u2029":case"\\":case"]":throw Error("TBD");default:const e=this.popChar();return{type:"Character",value:cc(e)}}}characterClass(){const e=[];let t=false;this.consumeChar("[");if(this.peekChar(0)==="^"){this.consumeChar("^");t=true}while(this.isClassAtom()){const t=this.classAtom();const r=t.type==="Character";if(isCharacter(t)&&this.isRangeDash()){this.consumeChar("-");const r=this.classAtom();const s=r.type==="Character";if(isCharacter(r)){if(r.value<t.value){throw Error("Range out of order in character class")}e.push({from:t.value,to:r.value})}else{insertToSet(t.value,e);e.push(cc("-"));insertToSet(r.value,e)}}else{insertToSet(t.value,e)}}this.consumeChar("]");return{type:"Set",complement:t,value:e}}classAtom(){switch(this.peekChar()){case"]":case"\n":case"\r":case"\u2028":case"\u2029":throw Error("TBD");case"\\":return this.classEscape();default:return this.classPatternCharacterAtom()}}classEscape(){this.consumeChar("\\");switch(this.peekChar()){case"b":this.consumeChar("b");return{type:"Character",value:cc("\b")};case"d":case"D":case"s":case"S":case"w":case"W":return this.characterClassEscape();case"f":case"n":case"r":case"t":case"v":return this.controlEscapeAtom();case"c":return this.controlLetterEscapeAtom();case"0":return this.nulCharacterAtom();case"x":return this.hexEscapeSequenceAtom();case"u":return this.regExpUnicodeEscapeSequenceAtom();default:return this.identityEscapeAtom()}}group(){let e=true;this.consumeChar("(");switch(this.peekChar(0)){case"?":this.consumeChar("?");this.consumeChar(":");e=false;break;default:this.groupIdx++;break}const t=this.disjunction();this.consumeChar(")");const r={type:"Group",capturing:e,value:t};if(e){r["idx"]=this.groupIdx}return r}positiveInteger(){let e=this.popChar();if(uu.test(e)===false){throw Error("Expecting a positive integer")}while(ou.test(this.peekChar(0))){e+=this.popChar()}return parseInt(e,10)}integerIncludingZero(){let e=this.popChar();if(ou.test(e)===false){throw Error("Expecting an integer")}while(ou.test(this.peekChar(0))){e+=this.popChar()}return parseInt(e,10)}patternCharacter(){const e=this.popChar();switch(e){case"\n":case"\r":case"\u2028":case"\u2029":case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":throw Error("TBD");default:return{type:"Character",value:cc(e)}}}isRegExpFlag(){switch(this.peekChar(0)){case"g":case"i":case"m":case"u":case"y":return true;default:return false}}isRangeDash(){return this.peekChar()==="-"&&this.isClassAtom(1)}isDigit(){return ou.test(this.peekChar(0))}isClassAtom(e=0){switch(this.peekChar(e)){case"]":case"\n":case"\r":case"\u2028":case"\u2029":return false;default:return true}}isTerm(){return this.isAtom()||this.isAssertion()}isAtom(){if(this.isPatternCharacter()){return true}switch(this.peekChar(0)){case".":case"\\":case"[":case"(":return true;default:return false}}isAssertion(){switch(this.peekChar(0)){case"^":case"$":return true;case"\\":switch(this.peekChar(1)){case"b":case"B":return true;default:return false}case"(":return this.peekChar(1)==="?"&&(this.peekChar(2)==="="||this.peekChar(2)==="!"||this.peekChar(2)==="<"&&(this.peekChar(3)==="="||this.peekChar(3)==="!"));default:return false}}isQuantifier(){const e=this.saveState();try{return this.quantifier(true)!==undefined}catch(e){return false}finally{this.restoreState(e)}}isPatternCharacter(){switch(this.peekChar()){case"^":case"$":case"\\":case".":case"*":case"+":case"?":case"(":case")":case"[":case"|":case"/":case"\n":case"\r":case"\u2028":case"\u2029":return false;default:return true}}parseHexDigits(e){let t="";for(let r=0;r<e;r++){const e=this.popChar();if(au.test(e)===false){throw Error("Expecting a HexDecimal digits")}t+=e}const r=parseInt(t,16);return{type:"Character",value:r}}peekChar(e=0){return this.input[this.idx+e]}popChar(){const e=this.peekChar(0);this.consumeChar(undefined);return e}consumeChar(e){if(e!==undefined&&this.input[this.idx]!==e){throw Error("Expected: '"+e+"' but found: '"+this.input[this.idx]+"' at offset: "+this.idx)}if(this.idx>=this.input.length){throw Error("Unexpected end of input")}this.idx++}loc(e){return{begin:e,end:this.idx}}}class BaseRegExpVisitor{visitChildren(e){for(const t in e){const r=e[t];if(e.hasOwnProperty(t)){if(r.type!==undefined){this.visit(r)}else if(Array.isArray(r)){r.forEach((e=>{this.visit(e)}),this)}}}}visit(e){switch(e.type){case"Pattern":this.visitPattern(e);break;case"Flags":this.visitFlags(e);break;case"Disjunction":this.visitDisjunction(e);break;case"Alternative":this.visitAlternative(e);break;case"StartAnchor":this.visitStartAnchor(e);break;case"EndAnchor":this.visitEndAnchor(e);break;case"WordBoundary":this.visitWordBoundary(e);break;case"NonWordBoundary":this.visitNonWordBoundary(e);break;case"Lookahead":this.visitLookahead(e);break;case"NegativeLookahead":this.visitNegativeLookahead(e);break;case"Lookbehind":this.visitLookbehind(e);break;case"NegativeLookbehind":this.visitNegativeLookbehind(e);break;case"Character":this.visitCharacter(e);break;case"Set":this.visitSet(e);break;case"Group":this.visitGroup(e);break;case"GroupBackReference":this.visitGroupBackReference(e);break;case"Quantifier":this.visitQuantifier(e);break}this.visitChildren(e)}visitPattern(e){}visitFlags(e){}visitDisjunction(e){}visitAlternative(e){}visitStartAnchor(e){}visitEndAnchor(e){}visitWordBoundary(e){}visitNonWordBoundary(e){}visitLookahead(e){}visitNegativeLookahead(e){}visitLookbehind(e){}visitNegativeLookbehind(e){}visitCharacter(e){}visitSet(e){}visitGroup(e){}visitGroupBackReference(e){}visitQuantifier(e){}}var lu=Object.prototype;var cu=lu.hasOwnProperty;var hu=mo((function(e,t){e=Object(e);var r=-1;var s=t.length;var a=s>2?t[2]:undefined;if(a&&go(t[0],t[1],a)){s=1}while(++r<s){var u=t[r];var l=Jr(u);var h=-1;var f=l.length;while(++h<f){var d=l[h];var _=e[d];if(_===undefined||pn(_,lu[d])&&!cu.call(e,d)){e[d]=u[d]}}}return e}));const fu=hu;function baseFilter(e,t){var r=[];pt(e,(function(e,s,a){if(t(e,s,a)){r.push(e)}}));return r}const pu=baseFilter;var du="Expected a function";function negate(e){if(typeof e!="function"){throw new TypeError(du)}return function(){var t=arguments;switch(t.length){case 0:return!e.call(this);case 1:return!e.call(this,t[0]);case 2:return!e.call(this,t[0],t[1]);case 3:return!e.call(this,t[0],t[1],t[2])}return!e.apply(this,t)}}const _u=negate;function reject(e,t){var r=V(e)?Si:pu;return r(e,_u(Lr(t,3)))}const mu=reject;var gu=Math.max;function indexOf(e,t,r){var s=e==null?0:e.length;if(!s){return-1}var a=r==null?0:Za(r);if(a<0){a=gu(s+a,0)}return Fo(e,t,a)}const yu=indexOf;function arrayReduce(e,t,r,s){var a=-1,u=e==null?0:e.length;if(s&&u){r=e[++a]}while(++a<u){r=t(r,e[a],a,e)}return r}const bu=arrayReduce;function baseReduce(e,t,r,s,a){a(e,(function(e,a,u){r=s?(s=false,e):t(r,e,a,u)}));return r}const vu=baseReduce;function reduce(e,t,r){var s=V(e)?bu:vu,a=arguments.length<3;return s(e,Lr(t,4),r,a,pt)}const Eu=reduce;function filter(e,t){var r=V(e)?Si:pu;return r(e,Lr(t,3))}const Tu=filter;var ku=200;function baseDifference(e,t,r,s){var a=-1,u=Wo,l=true,h=e.length,f=[],d=t.length;if(!h){return f}if(r){t=gt(t,Ce(r))}if(s){u=Vo;l=false}else if(t.length>=ku){u=ni;l=false;t=new ei(t)}e:while(++a<h){var _=e[a],m=r==null?_:r(_);_=s||_!==0?_:0;if(l&&m===m){var g=d;while(g--){if(t[g]===m){continue e}}f.push(_)}else if(!u(t,m,s)){f.push(_)}}return f}const xu=baseDifference;function isArrayLikeObject(e){return P(e)&&st(e)}const Ou=isArrayLikeObject;var Au=mo((function(e,t){return Ou(e)?xu(e,Zo(t,1,Ou,true)):[]}));const wu=Au;function compact(e){var t=-1,r=e==null?0:e.length,s=0,a=[];while(++t<r){var u=e[t];if(u){a[s++]=u}}return a}const Su=compact;function head(e){return e&&e.length?e[0]:undefined}const Nu=head;function createFind(e){return function(t,r,s){var a=Object(t);if(!st(t)){var u=Lr(r,3);t=ut(t);r=function(e){return u(a[e],e,a)}}var l=e(t,r,s);return l>-1?a[u?t[l]:l]:undefined}}const Ru=createFind;var Cu=Math.max;function findIndex(e,t,r){var s=e==null?0:e.length;if(!s){return-1}var a=r==null?0:Za(r);if(a<0){a=Cu(s+a,0)}return Lo(e,Lr(t,3),a)}const Iu=findIndex;var Lu=Ru(Iu);const Pu=Lu;function PRINT_ERROR(e){if(console&&console.error){console.error(`Error: ${e}`)}}function PRINT_WARNING(e){if(console&&console.warn){console.warn(`Warning: ${e}`)}}let Mu={};const Fu=new RegExpParser;function getRegExpAst(e){const t=e.toString();if(Mu.hasOwnProperty(t)){return Mu[t]}else{const e=Fu.pattern(t);Mu[t]=e;return e}}function clearRegExpParserCache(){Mu={}}const Du="Complement Sets are not supported for first char optimization";const Uu='Unable to use "first char" lexer optimizations:\n';function getOptimizedStartCodesIndices(e,t=false){try{const t=getRegExpAst(e);const r=firstCharOptimizedIndices(t.value,{},t.flags.ignoreCase);return r}catch(r){if(r.message===Du){if(t){PRINT_WARNING(`${Uu}`+`\tUnable to optimize: < ${e.toString()} >\n`+"\tComplement Sets cannot be automatically optimized.\n"+"\tThis will disable the lexer's first char optimizations.\n"+"\tSee: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#COMPLEMENT for details.")}}else{let r="";if(t){r="\n\tThis will disable the lexer's first char optimizations.\n"+"\tSee: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#REGEXP_PARSING for details."}PRINT_ERROR(`${Uu}\n`+`\tFailed parsing: < ${e.toString()} >\n`+`\tUsing the @chevrotain/regexp-to-ast library\n`+"\tPlease open an issue at: https://github.com/chevrotain/chevrotain/issues"+r)}}return[]}function firstCharOptimizedIndices(e,t,r){switch(e.type){case"Disjunction":for(let s=0;s<e.value.length;s++){firstCharOptimizedIndices(e.value[s],t,r)}break;case"Alternative":const s=e.value;for(let e=0;e<s.length;e++){const a=s[e];switch(a.type){case"EndAnchor":case"GroupBackReference":case"Lookahead":case"NegativeLookahead":case"Lookbehind":case"NegativeLookbehind":case"StartAnchor":case"WordBoundary":case"NonWordBoundary":continue}const u=a;switch(u.type){case"Character":addOptimizedIdxToResult(u.value,t,r);break;case"Set":if(u.complement===true){throw Error(Du)}mt(u.value,(e=>{if(typeof e==="number"){addOptimizedIdxToResult(e,t,r)}else{const s=e;if(r===true){for(let e=s.from;e<=s.to;e++){addOptimizedIdxToResult(e,t,r)}}else{for(let e=s.from;e<=s.to&&e<Hu;e++){addOptimizedIdxToResult(e,t,r)}if(s.to>=Hu){const e=s.from>=Hu?s.from:Hu;const r=s.to;const a=charCodeToOptimizedIndex(e);const u=charCodeToOptimizedIndex(r);for(let e=a;e<=u;e++){t[e]=e}}}}}));break;case"Group":firstCharOptimizedIndices(u.value,t,r);break;default:throw Error("Non Exhaustive Match")}const l=u.quantifier!==undefined&&u.quantifier.atLeast===0;if(u.type==="Group"&&isWholeOptional(u)===false||u.type!=="Group"&&l===false){break}}break;default:throw Error("non exhaustive match!")}return bt(t)}function addOptimizedIdxToResult(e,t,r){const s=charCodeToOptimizedIndex(e);t[s]=s;if(r===true){handleIgnoreCase(e,t)}}function handleIgnoreCase(e,t){const r=String.fromCharCode(e);const s=r.toUpperCase();if(s!==r){const e=charCodeToOptimizedIndex(s.charCodeAt(0));t[e]=e}else{const e=r.toLowerCase();if(e!==r){const r=charCodeToOptimizedIndex(e.charCodeAt(0));t[r]=r}}}function findCode(e,t){return Pu(e.value,(e=>{if(typeof e==="number"){return Uo(t,e)}else{const r=e;return Pu(t,(e=>r.from<=e&&e<=r.to))!==undefined}}))}function isWholeOptional(e){const t=e.quantifier;if(t&&t.atLeast===0){return true}if(!e.value){return false}return V(e.value)?Bo(e.value,isWholeOptional):isWholeOptional(e.value)}class CharCodeFinder extends BaseRegExpVisitor{constructor(e){super();this.targetCharCodes=e;this.found=false}visitChildren(e){if(this.found===true){return}switch(e.type){case"Lookahead":this.visitLookahead(e);return;case"NegativeLookahead":this.visitNegativeLookahead(e);return;case"Lookbehind":this.visitLookbehind(e);return;case"NegativeLookbehind":this.visitNegativeLookbehind(e);return}super.visitChildren(e)}visitCharacter(e){if(Uo(this.targetCharCodes,e.value)){this.found=true}}visitSet(e){if(e.complement){if(findCode(e,this.targetCharCodes)===undefined){this.found=true}}else{if(findCode(e,this.targetCharCodes)!==undefined){this.found=true}}}}function canMatchCharCode(e,t){if(t instanceof RegExp){const r=getRegExpAst(t);const s=new CharCodeFinder(e);s.visit(r);return s.found}else{return Pu(t,(t=>Uo(e,t.charCodeAt(0))))!==undefined}}const $u="PATTERN";const ju="defaultMode";const Bu="modes";let Wu=typeof new RegExp("(?:)").sticky==="boolean";function disableSticky(){Wu=false}function enableSticky(){Wu=true}function analyzeTokenTypes(e,t){t=fu(t,{useSticky:Wu,debug:false,safeMode:false,positionTracking:"full",lineTerminatorCharacters:["\r","\n"],tracer:(e,t)=>t()});const r=t.tracer;r("initCharCodeToOptimizedIndexMap",(()=>{initCharCodeToOptimizedIndexMap()}));let s;r("Reject Lexer.NA",(()=>{s=mu(e,(e=>e[$u]===Lexer.NA))}));let a=false;let u;r("Transform Patterns",(()=>{a=false;u=Mr(s,(e=>{const r=e[$u];if(Ro(r)){const e=r.source;if(e.length===1&&e!=="^"&&e!=="$"&&e!=="."&&!r.ignoreCase){return e}else if(e.length===2&&e[0]==="\\"&&!Uo(["d","D","s","S","t","r","n","t","0","c","b","B","f","v","w","W"],e[1])){return e[1]}else{return t.useSticky?addStickyFlag(r):addStartOfInput(r)}}else if(rt(r)){a=true;return{exec:r}}else if(typeof r==="object"){a=true;return r}else if(typeof r==="string"){if(r.length===1){return r}else{const e=r.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&");const s=new RegExp(e);return t.useSticky?addStickyFlag(s):addStartOfInput(s)}}else{throw Error("non exhaustive match")}}))}));let l;let h;let f;let d;let _;r("misc mapping",(()=>{l=Mr(s,(e=>e.tokenTypeIdx));h=Mr(s,(e=>{const t=e.GROUP;if(t===Lexer.SKIPPED){return undefined}else if(no(t)){return t}else if(nu(t)){return false}else{throw Error("non exhaustive match")}}));f=Mr(s,(e=>{const t=e.LONGER_ALT;if(t){const e=V(t)?Mr(t,(e=>yu(s,e))):[yu(s,t)];return e}}));d=Mr(s,(e=>e.PUSH_MODE));_=Mr(s,(e=>$r(e,"POP_MODE")))}));let m;r("Line Terminator Handling",(()=>{const e=getCharCodes(t.lineTerminatorCharacters);m=Mr(s,(e=>false));if(t.positionTracking!=="onlyOffset"){m=Mr(s,(t=>{if($r(t,"LINE_BREAKS")){return!!t.LINE_BREAKS}else{return checkLineBreaksIssues(t,e)===false&&canMatchCharCode(e,t.PATTERN)}}))}}));let g;let y;let b;let v;r("Misc Mapping #2",(()=>{g=Mr(s,isCustomPattern);y=Mr(u,isShortPattern);b=Eu(s,((e,t)=>{const r=t.GROUP;if(no(r)&&!(r===Lexer.SKIPPED)){e[r]=[]}return e}),{});v=Mr(u,((e,t)=>({pattern:u[t],longerAlt:f[t],canLineTerminator:m[t],isCustom:g[t],short:y[t],group:h[t],push:d[t],pop:_[t],tokenTypeIdx:l[t],tokenType:s[t]})))}));let E=true;let T=[];if(!t.safeMode){r("First Char Optimization",(()=>{T=Eu(s,((e,r,s)=>{if(typeof r.PATTERN==="string"){const t=r.PATTERN.charCodeAt(0);const a=charCodeToOptimizedIndex(t);addToMapOfArrays(e,a,v[s])}else if(V(r.START_CHARS_HINT)){let t;mt(r.START_CHARS_HINT,(r=>{const a=typeof r==="string"?r.charCodeAt(0):r;const u=charCodeToOptimizedIndex(a);if(t!==u){t=u;addToMapOfArrays(e,u,v[s])}}))}else if(Ro(r.PATTERN)){if(r.PATTERN.unicode){E=false;if(t.ensureOptimizations){PRINT_ERROR(`${Uu}`+`\tUnable to analyze < ${r.PATTERN.toString()} > pattern.\n`+"\tThe regexp unicode flag is not currently supported by the regexp-to-ast library.\n"+"\tThis will disable the lexer's first char optimizations.\n"+"\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNICODE_OPTIMIZE")}}else{const a=getOptimizedStartCodesIndices(r.PATTERN,t.ensureOptimizations);if(hn(a)){E=false}mt(a,(t=>{addToMapOfArrays(e,t,v[s])}))}}else{if(t.ensureOptimizations){PRINT_ERROR(`${Uu}`+`\tTokenType: <${r.name}> is using a custom token pattern without providing <start_chars_hint> parameter.\n`+"\tThis will disable the lexer's first char optimizations.\n"+"\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_OPTIMIZE")}E=false}return e}),[])}))}return{emptyGroups:b,patternIdxToConfig:v,charCodeToPatternIdxToConfig:T,hasCustom:a,canBeOptimized:E}}function validatePatterns(e,t){let r=[];const s=findMissingPatterns(e);r=r.concat(s.errors);const a=findInvalidPatterns(s.valid);const u=a.valid;r=r.concat(a.errors);r=r.concat(validateRegExpPattern(u));r=r.concat(findInvalidGroupType(u));r=r.concat(findModesThatDoNotExist(u,t));r=r.concat(findUnreachablePatterns(u));return r}function validateRegExpPattern(e){let t=[];const r=Tu(e,(e=>Ro(e[$u])));t=t.concat(findEndOfInputAnchor(r));t=t.concat(findStartOfInputAnchor(r));t=t.concat(findUnsupportedFlags(r));t=t.concat(findDuplicatePatterns(r));t=t.concat(findEmptyMatchRegExps(r));return t}function findMissingPatterns(e){const t=Tu(e,(e=>!$r(e,$u)));const r=Mr(t,(e=>({message:"Token Type: ->"+e.name+"<- missing static 'PATTERN' property",type:Ju.MISSING_PATTERN,tokenTypes:[e]})));const s=wu(e,t);return{errors:r,valid:s}}function findInvalidPatterns(e){const t=Tu(e,(e=>{const t=e[$u];return!Ro(t)&&!rt(t)&&!$r(t,"exec")&&!no(t)}));const r=Mr(t,(e=>({message:"Token Type: ->"+e.name+"<- static 'PATTERN' can only be a RegExp, a"+" Function matching the {CustomPatternMatcherFunc} type or an Object matching the {ICustomPattern} interface.",type:Ju.INVALID_PATTERN,tokenTypes:[e]})));const s=wu(e,t);return{errors:r,valid:s}}const Vu=/[^\\][$]/;function findEndOfInputAnchor(e){class EndAnchorFinder extends BaseRegExpVisitor{constructor(){super(...arguments);this.found=false}visitEndAnchor(e){this.found=true}}const t=Tu(e,(e=>{const t=e.PATTERN;try{const e=getRegExpAst(t);const r=new EndAnchorFinder;r.visit(e);return r.found}catch(e){return Vu.test(t.source)}}));const r=Mr(t,(e=>({message:"Unexpected RegExp Anchor Error:\n"+"\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain end of input anchor '$'\n"+"\tSee chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS"+"\tfor details.",type:Ju.EOI_ANCHOR_FOUND,tokenTypes:[e]})));return r}function findEmptyMatchRegExps(e){const t=Tu(e,(e=>{const t=e.PATTERN;return t.test("")}));const r=Mr(t,(e=>({message:"Token Type: ->"+e.name+"<- static 'PATTERN' must not match an empty string",type:Ju.EMPTY_MATCH_PATTERN,tokenTypes:[e]})));return r}const zu=/[^\\[][\^]|^\^/;function findStartOfInputAnchor(e){class StartAnchorFinder extends BaseRegExpVisitor{constructor(){super(...arguments);this.found=false}visitStartAnchor(e){this.found=true}}const t=Tu(e,(e=>{const t=e.PATTERN;try{const e=getRegExpAst(t);const r=new StartAnchorFinder;r.visit(e);return r.found}catch(e){return zu.test(t.source)}}));const r=Mr(t,(e=>({message:"Unexpected RegExp Anchor Error:\n"+"\tToken Type: ->"+e.name+"<- static 'PATTERN' cannot contain start of input anchor '^'\n"+"\tSee https://chevrotain.io/docs/guide/resolving_lexer_errors.html#ANCHORS"+"\tfor details.",type:Ju.SOI_ANCHOR_FOUND,tokenTypes:[e]})));return r}function findUnsupportedFlags(e){const t=Tu(e,(e=>{const t=e[$u];return t instanceof RegExp&&(t.multiline||t.global)}));const r=Mr(t,(e=>({message:"Token Type: ->"+e.name+"<- static 'PATTERN' may NOT contain global('g') or multiline('m')",type:Ju.UNSUPPORTED_FLAGS_FOUND,tokenTypes:[e]})));return r}function findDuplicatePatterns(e){const t=[];let r=Mr(e,(r=>Eu(e,((e,s)=>{if(r.PATTERN.source===s.PATTERN.source&&!Uo(t,s)&&s.PATTERN!==Lexer.NA){t.push(s);e.push(s);return e}return e}),[])));r=Su(r);const s=Tu(r,(e=>e.length>1));const a=Mr(s,(e=>{const t=Mr(e,(e=>e.name));const r=Nu(e).PATTERN;return{message:`The same RegExp pattern ->${r}<-`+`has been used in all of the following Token Types: ${t.join(", ")} <-`,type:Ju.DUPLICATE_PATTERNS_FOUND,tokenTypes:e}}));return a}function findInvalidGroupType(e){const t=Tu(e,(e=>{if(!$r(e,"GROUP")){return false}const t=e.GROUP;return t!==Lexer.SKIPPED&&t!==Lexer.NA&&!no(t)}));const r=Mr(t,(e=>({message:"Token Type: ->"+e.name+"<- static 'GROUP' can only be Lexer.SKIPPED/Lexer.NA/A String",type:Ju.INVALID_GROUP_TYPE_FOUND,tokenTypes:[e]})));return r}function findModesThatDoNotExist(e,t){const r=Tu(e,(e=>e.PUSH_MODE!==undefined&&!Uo(t,e.PUSH_MODE)));const s=Mr(r,(e=>{const t=`Token Type: ->${e.name}<- static 'PUSH_MODE' value cannot refer to a Lexer Mode ->${e.PUSH_MODE}<-`+`which does not exist`;return{message:t,type:Ju.PUSH_MODE_DOES_NOT_EXIST,tokenTypes:[e]}}));return s}function findUnreachablePatterns(e){const t=[];const r=Eu(e,((e,t,r)=>{const s=t.PATTERN;if(s===Lexer.NA){return e}if(no(s)){e.push({str:s,idx:r,tokenType:t})}else if(Ro(s)&&noMetaChar(s)){e.push({str:s.source,idx:r,tokenType:t})}return e}),[]);mt(e,((e,s)=>{mt(r,(({str:r,idx:a,tokenType:u})=>{if(s<a&&tryToMatchStrToPattern(r,e.PATTERN)){const r=`Token: ->${u.name}<- can never be matched.\n`+`Because it appears AFTER the Token Type ->${e.name}<-`+`in the lexer's definition.\n`+`See https://chevrotain.io/docs/guide/resolving_lexer_errors.html#UNREACHABLE`;t.push({message:r,type:Ju.UNREACHABLE_PATTERN,tokenTypes:[e,u]})}}))}));return t}function tryToMatchStrToPattern(e,t){if(Ro(t)){if(usesLookAheadOrBehind(t)){return false}const r=t.exec(e);return r!==null&&r.index===0}else if(rt(t)){return t(e,0,[],{})}else if($r(t,"exec")){return t.exec(e,0,[],{})}else if(typeof t==="string"){return t===e}else{throw Error("non exhaustive match")}}function noMetaChar(e){const t=[".","\\","[","]","|","^","$","(",")","?","*","+","{"];return Pu(t,(t=>e.source.indexOf(t)!==-1))===undefined}function usesLookAheadOrBehind(e){return/(\(\?=)|(\(\?!)|(\(\?<=)|(\(\?<!)/.test(e.source)}function addStartOfInput(e){const t=e.ignoreCase?"i":"";return new RegExp(`^(?:${e.source})`,t)}function addStickyFlag(e){const t=e.ignoreCase?"iy":"y";return new RegExp(`${e.source}`,t)}function performRuntimeChecks(e,t,r){const s=[];if(!$r(e,ju)){s.push({message:"A MultiMode Lexer cannot be initialized without a <"+ju+"> property in its definition\n",type:Ju.MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE})}if(!$r(e,Bu)){s.push({message:"A MultiMode Lexer cannot be initialized without a <"+Bu+"> property in its definition\n",type:Ju.MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY})}if($r(e,Bu)&&$r(e,ju)&&!$r(e.modes,e.defaultMode)){s.push({message:`A MultiMode Lexer cannot be initialized with a ${ju}: <${e.defaultMode}>`+`which does not exist\n`,type:Ju.MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST})}if($r(e,Bu)){mt(e.modes,((e,t)=>{mt(e,((r,a)=>{if(nu(r)){s.push({message:`A Lexer cannot be initialized using an undefined Token Type. Mode:`+`<${t}> at index: <${a}>\n`,type:Ju.LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED})}else if($r(r,"LONGER_ALT")){const a=V(r.LONGER_ALT)?r.LONGER_ALT:[r.LONGER_ALT];mt(a,(a=>{if(!nu(a)&&!Uo(e,a)){s.push({message:`A MultiMode Lexer cannot be initialized with a longer_alt <${a.name}> on token <${r.name}> outside of mode <${t}>\n`,type:Ju.MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE})}}))}}))}))}return s}function performWarningRuntimeChecks(e,t,r){const s=[];let a=false;const u=Su(eu(bt(e.modes)));const l=mu(u,(e=>e[$u]===Lexer.NA));const h=getCharCodes(r);if(t){mt(l,(e=>{const t=checkLineBreaksIssues(e,h);if(t!==false){const r=buildLineBreakIssueMessage(e,t);const a={message:r,type:t.issue,tokenType:e};s.push(a)}else{if($r(e,"LINE_BREAKS")){if(e.LINE_BREAKS===true){a=true}}else{if(canMatchCharCode(h,e.PATTERN)){a=true}}}}))}if(t&&!a){s.push({message:"Warning: No LINE_BREAKS Found.\n"+"\tThis Lexer has been defined to track line and column information,\n"+"\tBut none of the Token Types can be identified as matching a line terminator.\n"+"\tSee https://chevrotain.io/docs/guide/resolving_lexer_errors.html#LINE_BREAKS \n"+"\tfor details.",type:Ju.NO_LINE_BREAKS_FLAGS})}return s}function cloneEmptyGroups(e){const t={};const r=ut(e);mt(r,(r=>{const s=e[r];if(V(s)){t[r]=[]}else{throw Error("non exhaustive match")}}));return t}function isCustomPattern(e){const t=e.PATTERN;if(Ro(t)){return false}else if(rt(t)){return true}else if($r(t,"exec")){return true}else if(no(t)){return false}else{throw Error("non exhaustive match")}}function isShortPattern(e){if(no(e)&&e.length===1){return e.charCodeAt(0)}else{return false}}const Gu={test:function(e){const t=e.length;for(let r=this.lastIndex;r<t;r++){const t=e.charCodeAt(r);if(t===10){this.lastIndex=r+1;return true}else if(t===13){if(e.charCodeAt(r+1)===10){this.lastIndex=r+2}else{this.lastIndex=r+1}return true}}return false},lastIndex:0};function checkLineBreaksIssues(e,t){if($r(e,"LINE_BREAKS")){return false}else{if(Ro(e.PATTERN)){try{canMatchCharCode(t,e.PATTERN)}catch(e){return{issue:Ju.IDENTIFY_TERMINATOR,errMsg:e.message}}return false}else if(no(e.PATTERN)){return false}else if(isCustomPattern(e)){return{issue:Ju.CUSTOM_LINE_BREAK}}else{throw Error("non exhaustive match")}}}function buildLineBreakIssueMessage(e,t){if(t.issue===Ju.IDENTIFY_TERMINATOR){return"Warning: unable to identify line terminator usage in pattern.\n"+`\tThe problem is in the <${e.name}> Token Type\n`+`\t Root cause: ${t.errMsg}.\n`+"\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#IDENTIFY_TERMINATOR"}else if(t.issue===Ju.CUSTOM_LINE_BREAK){return"Warning: A Custom Token Pattern should specify the <line_breaks> option.\n"+`\tThe problem is in the <${e.name}> Token Type\n`+"\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#CUSTOM_LINE_BREAK"}else{throw Error("non exhaustive match")}}function getCharCodes(e){const t=Mr(e,(e=>{if(no(e)){return e.charCodeAt(0)}else{return e}}));return t}function addToMapOfArrays(e,t,r){if(e[t]===undefined){e[t]=[r]}else{e[t].push(r)}}const Hu=256;let Ku=[];function charCodeToOptimizedIndex(e){return e<Hu?e:Ku[e]}function initCharCodeToOptimizedIndexMap(){if(hn(Ku)){Ku=new Array(65536);for(let e=0;e<65536;e++){Ku[e]=e>255?255+~~(e/255):e}}}function last(e){var t=e==null?0:e.length;return t?e[t-1]:undefined}const qu=last;function timer(e){const t=(new Date).getTime();const r=e();const s=(new Date).getTime();const a=s-t;return{time:a,value:r}}function tokenStructuredMatcher(e,t){const r=e.tokenTypeIdx;if(r===t.tokenTypeIdx){return true}else{return t.isParent===true&&t.categoryMatchesMap[r]===true}}function tokenStructuredMatcherNoCategories(e,t){return e.tokenTypeIdx===t.tokenTypeIdx}let Xu=1;const Yu={};function augmentTokenTypes(e){const t=expandCategories(e);assignTokenDefaultProps(t);assignCategoriesMapProp(t);assignCategoriesTokensProp(t);mt(t,(e=>{e.isParent=e.categoryMatches.length>0}))}function expandCategories(e){let t=Ua(e);let r=e;let s=true;while(s){r=Su(eu(Mr(r,(e=>e.CATEGORIES))));const e=wu(r,t);t=t.concat(e);if(hn(e)){s=false}else{r=e}}return t}function assignTokenDefaultProps(e){mt(e,(e=>{if(!hasShortKeyProperty(e)){Yu[Xu]=e;e.tokenTypeIdx=Xu++}if(hasCategoriesProperty(e)&&!V(e.CATEGORIES)){e.CATEGORIES=[e.CATEGORIES]}if(!hasCategoriesProperty(e)){e.CATEGORIES=[]}if(!hasExtendingTokensTypesProperty(e)){e.categoryMatches=[]}if(!hasExtendingTokensTypesMapProperty(e)){e.categoryMatchesMap={}}}))}function assignCategoriesTokensProp(e){mt(e,(e=>{e.categoryMatches=[];mt(e.categoryMatchesMap,((t,r)=>{e.categoryMatches.push(Yu[r].tokenTypeIdx)}))}))}function assignCategoriesMapProp(e){mt(e,(e=>{singleAssignCategoriesToksMap([],e)}))}function singleAssignCategoriesToksMap(e,t){mt(e,(e=>{t.categoryMatchesMap[e.tokenTypeIdx]=true}));mt(t.CATEGORIES,(r=>{const s=e.concat(t);if(!Uo(s,r)){singleAssignCategoriesToksMap(s,r)}}))}function hasShortKeyProperty(e){return $r(e,"tokenTypeIdx")}function hasCategoriesProperty(e){return $r(e,"CATEGORIES")}function hasExtendingTokensTypesProperty(e){return $r(e,"categoryMatches")}function hasExtendingTokensTypesMapProperty(e){return $r(e,"categoryMatchesMap")}function isTokenType(e){return $r(e,"tokenTypeIdx")}const Qu={buildUnableToPopLexerModeMessage(e){return`Unable to pop Lexer Mode after encountering Token ->${e.image}<- The Mode Stack is empty`},buildUnexpectedCharactersMessage(e,t,r,s,a,u){return`unexpected character: ->${e.charAt(t)}<- at offset: ${t},`+` skipped ${r} characters.`}};var Ju;(function(e){e[e["MISSING_PATTERN"]=0]="MISSING_PATTERN";e[e["INVALID_PATTERN"]=1]="INVALID_PATTERN";e[e["EOI_ANCHOR_FOUND"]=2]="EOI_ANCHOR_FOUND";e[e["UNSUPPORTED_FLAGS_FOUND"]=3]="UNSUPPORTED_FLAGS_FOUND";e[e["DUPLICATE_PATTERNS_FOUND"]=4]="DUPLICATE_PATTERNS_FOUND";e[e["INVALID_GROUP_TYPE_FOUND"]=5]="INVALID_GROUP_TYPE_FOUND";e[e["PUSH_MODE_DOES_NOT_EXIST"]=6]="PUSH_MODE_DOES_NOT_EXIST";e[e["MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE"]=7]="MULTI_MODE_LEXER_WITHOUT_DEFAULT_MODE";e[e["MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY"]=8]="MULTI_MODE_LEXER_WITHOUT_MODES_PROPERTY";e[e["MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST"]=9]="MULTI_MODE_LEXER_DEFAULT_MODE_VALUE_DOES_NOT_EXIST";e[e["LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED"]=10]="LEXER_DEFINITION_CANNOT_CONTAIN_UNDEFINED";e[e["SOI_ANCHOR_FOUND"]=11]="SOI_ANCHOR_FOUND";e[e["EMPTY_MATCH_PATTERN"]=12]="EMPTY_MATCH_PATTERN";e[e["NO_LINE_BREAKS_FLAGS"]=13]="NO_LINE_BREAKS_FLAGS";e[e["UNREACHABLE_PATTERN"]=14]="UNREACHABLE_PATTERN";e[e["IDENTIFY_TERMINATOR"]=15]="IDENTIFY_TERMINATOR";e[e["CUSTOM_LINE_BREAK"]=16]="CUSTOM_LINE_BREAK";e[e["MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE"]=17]="MULTI_MODE_LEXER_LONGER_ALT_NOT_IN_CURRENT_MODE"})(Ju||(Ju={}));const Zu={deferDefinitionErrorsHandling:false,positionTracking:"full",lineTerminatorsPattern:/\n|\r\n?/g,lineTerminatorCharacters:["\n","\r"],ensureOptimizations:false,safeMode:false,errorMessageProvider:Qu,traceInitPerf:false,skipValidations:false,recoveryEnabled:true};Object.freeze(Zu);class Lexer{constructor(e,t=Zu){this.lexerDefinition=e;this.lexerDefinitionErrors=[];this.lexerDefinitionWarning=[];this.patternIdxToConfig={};this.charCodeToPatternIdxToConfig={};this.modes=[];this.emptyGroups={};this.trackStartLines=true;this.trackEndLines=true;this.hasCustom=false;this.canModeBeOptimized={};this.TRACE_INIT=(e,t)=>{if(this.traceInitPerf===true){this.traceInitIndent++;const r=new Array(this.traceInitIndent+1).join("\t");if(this.traceInitIndent<this.traceInitMaxIdent){console.log(`${r}--\x3e <${e}>`)}const{time:s,value:a}=timer(t);const u=s>10?console.warn:console.log;if(this.traceInitIndent<this.traceInitMaxIdent){u(`${r}<-- <${e}> time: ${s}ms`)}this.traceInitIndent--;return a}else{return t()}};if(typeof t==="boolean"){throw Error("The second argument to the Lexer constructor is now an ILexerConfig Object.\n"+"a boolean 2nd argument is no longer supported")}this.config=To({},Zu,t);const r=this.config.traceInitPerf;if(r===true){this.traceInitMaxIdent=Infinity;this.traceInitPerf=true}else if(typeof r==="number"){this.traceInitMaxIdent=r;this.traceInitPerf=true}this.traceInitIndent=-1;this.TRACE_INIT("Lexer Constructor",(()=>{let r;let s=true;this.TRACE_INIT("Lexer Config handling",(()=>{if(this.config.lineTerminatorsPattern===Zu.lineTerminatorsPattern){this.config.lineTerminatorsPattern=Gu}else{if(this.config.lineTerminatorCharacters===Zu.lineTerminatorCharacters){throw Error("Error: Missing <lineTerminatorCharacters> property on the Lexer config.\n"+"\tFor details See: https://chevrotain.io/docs/guide/resolving_lexer_errors.html#MISSING_LINE_TERM_CHARS")}}if(t.safeMode&&t.ensureOptimizations){throw Error('"safeMode" and "ensureOptimizations" flags are mutually exclusive.')}this.trackStartLines=/full|onlyStart/i.test(this.config.positionTracking);this.trackEndLines=/full/i.test(this.config.positionTracking);if(V(e)){r={modes:{defaultMode:Ua(e)},defaultMode:ju}}else{s=false;r=Ua(e)}}));if(this.config.skipValidations===false){this.TRACE_INIT("performRuntimeChecks",(()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(performRuntimeChecks(r,this.trackStartLines,this.config.lineTerminatorCharacters))}));this.TRACE_INIT("performWarningRuntimeChecks",(()=>{this.lexerDefinitionWarning=this.lexerDefinitionWarning.concat(performWarningRuntimeChecks(r,this.trackStartLines,this.config.lineTerminatorCharacters))}))}r.modes=r.modes?r.modes:{};mt(r.modes,((e,t)=>{r.modes[t]=mu(e,(e=>nu(e)))}));const a=ut(r.modes);mt(r.modes,((e,r)=>{this.TRACE_INIT(`Mode: <${r}> processing`,(()=>{this.modes.push(r);if(this.config.skipValidations===false){this.TRACE_INIT(`validatePatterns`,(()=>{this.lexerDefinitionErrors=this.lexerDefinitionErrors.concat(validatePatterns(e,a))}))}if(hn(this.lexerDefinitionErrors)){augmentTokenTypes(e);let s;this.TRACE_INIT(`analyzeTokenTypes`,(()=>{s=analyzeTokenTypes(e,{lineTerminatorCharacters:this.config.lineTerminatorCharacters,positionTracking:t.positionTracking,ensureOptimizations:t.ensureOptimizations,safeMode:t.safeMode,tracer:this.TRACE_INIT})}));this.patternIdxToConfig[r]=s.patternIdxToConfig;this.charCodeToPatternIdxToConfig[r]=s.charCodeToPatternIdxToConfig;this.emptyGroups=To({},this.emptyGroups,s.emptyGroups);this.hasCustom=s.hasCustom||this.hasCustom;this.canModeBeOptimized[r]=s.canBeOptimized}}))}));this.defaultMode=r.defaultMode;if(!hn(this.lexerDefinitionErrors)&&!this.config.deferDefinitionErrorsHandling){const e=Mr(this.lexerDefinitionErrors,(e=>e.message));const t=e.join("-----------------------\n");throw new Error("Errors detected in definition of Lexer:\n"+t)}mt(this.lexerDefinitionWarning,(e=>{PRINT_WARNING(e.message)}));this.TRACE_INIT("Choosing sub-methods implementations",(()=>{if(Wu){this.chopInput=dt;this.match=this.matchWithTest}else{this.updateLastIndex=zo;this.match=this.matchWithExec}if(s){this.handleModes=zo}if(this.trackStartLines===false){this.computeNewColumn=dt}if(this.trackEndLines===false){this.updateTokenEndLineColumnLocation=zo}if(/full/i.test(this.config.positionTracking)){this.createTokenInstance=this.createFullToken}else if(/onlyStart/i.test(this.config.positionTracking)){this.createTokenInstance=this.createStartOnlyToken}else if(/onlyOffset/i.test(this.config.positionTracking)){this.createTokenInstance=this.createOffsetOnlyToken}else{throw Error(`Invalid <positionTracking> config option: "${this.config.positionTracking}"`)}if(this.hasCustom){this.addToken=this.addTokenUsingPush;this.handlePayload=this.handlePayloadWithCustom}else{this.addToken=this.addTokenUsingMemberAccess;this.handlePayload=this.handlePayloadNoCustom}}));this.TRACE_INIT("Failed Optimization Warnings",(()=>{const e=Eu(this.canModeBeOptimized,((e,t,r)=>{if(t===false){e.push(r)}return e}),[]);if(t.ensureOptimizations&&!hn(e)){throw Error(`Lexer Modes: < ${e.join(", ")} > cannot be optimized.\n`+'\t Disable the "ensureOptimizations" lexer config flag to silently ignore this and run the lexer in an un-optimized mode.\n'+"\t Or inspect the console log for details on how to resolve these issues.")}}));this.TRACE_INIT("clearRegExpParserCache",(()=>{clearRegExpParserCache()}));this.TRACE_INIT("toFastProperties",(()=>{toFastProperties(this)}))}))}tokenize(e,t=this.defaultMode){if(!hn(this.lexerDefinitionErrors)){const e=Mr(this.lexerDefinitionErrors,(e=>e.message));const t=e.join("-----------------------\n");throw new Error("Unable to Tokenize because Errors detected in definition of Lexer:\n"+t)}return this.tokenizeInternal(e,t)}tokenizeInternal(e,t){let r,s,a,u,l,h,f,d,_,m,g,y,b,v,E,T;const k=e;const x=k.length;let O=0;let A=0;const w=this.hasCustom?0:Math.floor(e.length/10);const S=new Array(w);const R=[];let C=this.trackStartLines?1:undefined;let I=this.trackStartLines?1:undefined;const L=cloneEmptyGroups(this.emptyGroups);const P=this.trackStartLines;const M=this.config.lineTerminatorsPattern;let F=0;let D=[];let U=[];const $=[];const j=[];Object.freeze(j);let B;function getPossiblePatternsSlow(){return D}function getPossiblePatternsOptimized(e){const t=charCodeToOptimizedIndex(e);const r=U[t];if(r===undefined){return j}else{return r}}const pop_mode=e=>{if($.length===1&&e.tokenType.PUSH_MODE===undefined){const t=this.config.errorMessageProvider.buildUnableToPopLexerModeMessage(e);R.push({offset:e.startOffset,line:e.startLine,column:e.startColumn,length:e.image.length,message:t})}else{$.pop();const e=qu($);D=this.patternIdxToConfig[e];U=this.charCodeToPatternIdxToConfig[e];F=D.length;const t=this.canModeBeOptimized[e]&&this.config.safeMode===false;if(U&&t){B=getPossiblePatternsOptimized}else{B=getPossiblePatternsSlow}}};function push_mode(e){$.push(e);U=this.charCodeToPatternIdxToConfig[e];D=this.patternIdxToConfig[e];F=D.length;F=D.length;const t=this.canModeBeOptimized[e]&&this.config.safeMode===false;if(U&&t){B=getPossiblePatternsOptimized}else{B=getPossiblePatternsSlow}}push_mode.call(this,t);let W;const V=this.config.recoveryEnabled;while(O<x){h=null;const t=k.charCodeAt(O);const v=B(t);const w=v.length;for(r=0;r<w;r++){W=v[r];const s=W.pattern;f=null;const _=W.short;if(_!==false){if(t===_){h=s}}else if(W.isCustom===true){T=s.exec(k,O,S,L);if(T!==null){h=T[0];if(T.payload!==undefined){f=T.payload}}else{h=null}}else{this.updateLastIndex(s,O);h=this.match(s,e,O)}if(h!==null){l=W.longerAlt;if(l!==undefined){const t=l.length;for(a=0;a<t;a++){const t=D[l[a]];const r=t.pattern;d=null;if(t.isCustom===true){T=r.exec(k,O,S,L);if(T!==null){u=T[0];if(T.payload!==undefined){d=T.payload}}else{u=null}}else{this.updateLastIndex(r,O);u=this.match(r,e,O)}if(u&&u.length>h.length){h=u;f=d;W=t;break}}}break}}if(h!==null){_=h.length;m=W.group;if(m!==undefined){g=W.tokenTypeIdx;y=this.createTokenInstance(h,O,g,W.tokenType,C,I,_);this.handlePayload(y,f);if(m===false){A=this.addToken(S,A,y)}else{L[m].push(y)}}e=this.chopInput(e,_);O=O+_;I=this.computeNewColumn(I,_);if(P===true&&W.canLineTerminator===true){let e=0;let t;let r;M.lastIndex=0;do{t=M.test(h);if(t===true){r=M.lastIndex-1;e++}}while(t===true);if(e!==0){C=C+e;I=_-r;this.updateTokenEndLineColumnLocation(y,m,r,e,C,I,_)}}this.handleModes(W,pop_mode,push_mode,y)}else{const t=O;const r=C;const a=I;let u=V===false;while(u===false&&O<x){e=this.chopInput(e,1);O++;for(s=0;s<F;s++){const t=D[s];const r=t.pattern;const a=t.short;if(a!==false){if(k.charCodeAt(O)===a){u=true}}else if(t.isCustom===true){u=r.exec(k,O,S,L)!==null}else{this.updateLastIndex(r,O);u=r.exec(e)!==null}if(u===true){break}}}b=O-t;I=this.computeNewColumn(I,b);E=this.config.errorMessageProvider.buildUnexpectedCharactersMessage(k,t,b,r,a,qu($));R.push({offset:t,line:r,column:a,length:b,message:E});if(V===false){break}}}if(!this.hasCustom){S.length=A}return{tokens:S,groups:L,errors:R}}handleModes(e,t,r,s){if(e.pop===true){const a=e.push;t(s);if(a!==undefined){r.call(this,a)}}else if(e.push!==undefined){r.call(this,e.push)}}chopInput(e,t){return e.substring(t)}updateLastIndex(e,t){e.lastIndex=t}updateTokenEndLineColumnLocation(e,t,r,s,a,u,l){let h,f;if(t!==undefined){h=r===l-1;f=h?-1:0;if(!(s===1&&h===true)){e.endLine=a+f;e.endColumn=u-1+-f}}}computeNewColumn(e,t){return e+t}createOffsetOnlyToken(e,t,r,s){return{image:e,startOffset:t,tokenTypeIdx:r,tokenType:s}}createStartOnlyToken(e,t,r,s,a,u){return{image:e,startOffset:t,startLine:a,startColumn:u,tokenTypeIdx:r,tokenType:s}}createFullToken(e,t,r,s,a,u,l){return{image:e,startOffset:t,endOffset:t+l-1,startLine:a,endLine:a,startColumn:u,endColumn:u+l-1,tokenTypeIdx:r,tokenType:s}}addTokenUsingPush(e,t,r){e.push(r);return t}addTokenUsingMemberAccess(e,t,r){e[t]=r;t++;return t}handlePayloadNoCustom(e,t){}handlePayloadWithCustom(e,t){if(t!==null){e.payload=t}}matchWithTest(e,t,r){const s=e.test(t);if(s===true){return t.substring(r,e.lastIndex)}return null}matchWithExec(e,t){const r=e.exec(t);return r!==null?r[0]:null}}Lexer.SKIPPED="This marks a skipped Token pattern, this means each token identified by it will "+"be consumed and then thrown into oblivion, this can be used to for example to completely ignore whitespace.";Lexer.NA=/NOT_APPLICABLE/;function tokens_public_tokenLabel(e){if(tokens_public_hasTokenLabel(e)){return e.LABEL}else{return e.name}}function tokenName(e){return e.name}function tokens_public_hasTokenLabel(e){return no(e.LABEL)&&e.LABEL!==""}const el="parent";const tl="categories";const nl="label";const il="group";const rl="push_mode";const sl="pop_mode";const al="longer_alt";const ol="line_breaks";const ul="start_chars_hint";function createToken(e){return createTokenInternal(e)}function createTokenInternal(e){const t=e.pattern;const r={};r.name=e.name;if(!nu(t)){r.PATTERN=t}if($r(e,el)){throw"The parent property is no longer supported.\n"+"See: https://github.com/chevrotain/chevrotain/issues/564#issuecomment-349062346 for details."}if($r(e,tl)){r.CATEGORIES=e[tl]}augmentTokenTypes([r]);if($r(e,nl)){r.LABEL=e[nl]}if($r(e,il)){r.GROUP=e[il]}if($r(e,sl)){r.POP_MODE=e[sl]}if($r(e,rl)){r.PUSH_MODE=e[rl]}if($r(e,al)){r.LONGER_ALT=e[al]}if($r(e,ol)){r.LINE_BREAKS=e[ol]}if($r(e,ul)){r.START_CHARS_HINT=e[ul]}return r}const ll=createToken({name:"EOF",pattern:Lexer.NA});augmentTokenTypes([ll]);function createTokenInstance(e,t,r,s,a,u,l,h){return{image:t,startOffset:r,endOffset:s,startLine:a,endLine:u,startColumn:l,endColumn:h,tokenTypeIdx:e.tokenTypeIdx,tokenType:e}}function tokenMatcher(e,t){return tokenStructuredMatcher(e,t)}const cl={buildMismatchTokenMessage({expected:e,actual:t,previous:r,ruleName:s}){const a=tokens_public_hasTokenLabel(e);const u=a?`--\x3e ${tokens_public_tokenLabel(e)} <--`:`token of type --\x3e ${e.name} <--`;const l=`Expecting ${u} but found --\x3e '${t.image}' <--`;return l},buildNotAllInputParsedMessage({firstRedundant:e,ruleName:t}){return"Redundant input, expecting EOF but found: "+e.image},buildNoViableAltMessage({expectedPathsPerAlt:e,actual:t,previous:r,customUserDescription:s,ruleName:a}){const u="Expecting: ";const l=Nu(t).image;const h="\nbut found: '"+l+"'";if(s){return u+s+h}else{const t=Eu(e,((e,t)=>e.concat(t)),[]);const r=Mr(t,(e=>`[${Mr(e,(e=>tokens_public_tokenLabel(e))).join(", ")}]`));const s=Mr(r,((e,t)=>`  ${t+1}. ${e}`));const a=`one of these possible Token sequences:\n${s.join("\n")}`;return u+a+h}},buildEarlyExitMessage({expectedIterationPaths:e,actual:t,customUserDescription:r,ruleName:s}){const a="Expecting: ";const u=Nu(t).image;const l="\nbut found: '"+u+"'";if(r){return a+r+l}else{const t=Mr(e,(e=>`[${Mr(e,(e=>tokens_public_tokenLabel(e))).join(",")}]`));const r=`expecting at least one iteration which starts with one of these possible Token sequences::\n  `+`<${t.join(" ,")}>`;return a+r+l}}};Object.freeze(cl);const hl={buildRuleNotFoundError(e,t){const r="Invalid grammar, reference to a rule which is not defined: ->"+t.nonTerminalName+"<-\n"+"inside top level rule: ->"+e.name+"<-";return r}};const fl={buildDuplicateFoundError(e,t){function getExtraProductionArgument(e){if(e instanceof Terminal){return e.terminalType.name}else if(e instanceof model_NonTerminal){return e.nonTerminalName}else{return""}}const r=e.name;const s=Nu(t);const a=s.idx;const u=getProductionDslName(s);const l=getExtraProductionArgument(s);const h=a>0;let f=`->${u}${h?a:""}<- ${l?`with argument: ->${l}<-`:""}\n                  appears more than once (${t.length} times) in the top level rule: ->${r}<-.                  \n                  For further details see: https://chevrotain.io/docs/FAQ.html#NUMERICAL_SUFFIXES \n                  `;f=f.replace(/[ \t]+/g," ");f=f.replace(/\s\s+/g,"\n");return f},buildNamespaceConflictError(e){const t=`Namespace conflict found in grammar.\n`+`The grammar has both a Terminal(Token) and a Non-Terminal(Rule) named: <${e.name}>.\n`+`To resolve this make sure each Terminal and Non-Terminal names are unique\n`+`This is easy to accomplish by using the convention that Terminal names start with an uppercase letter\n`+`and Non-Terminal names start with a lower case letter.`;return t},buildAlternationPrefixAmbiguityError(e){const t=Mr(e.prefixPath,(e=>tokens_public_tokenLabel(e))).join(", ");const r=e.alternation.idx===0?"":e.alternation.idx;const s=`Ambiguous alternatives: <${e.ambiguityIndices.join(" ,")}> due to common lookahead prefix\n`+`in <OR${r}> inside <${e.topLevelRule.name}> Rule,\n`+`<${t}> may appears as a prefix path in all these alternatives.\n`+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#COMMON_PREFIX\n`+`For Further details.`;return s},buildAlternationAmbiguityError(e){const t=Mr(e.prefixPath,(e=>tokens_public_tokenLabel(e))).join(", ");const r=e.alternation.idx===0?"":e.alternation.idx;let s=`Ambiguous Alternatives Detected: <${e.ambiguityIndices.join(" ,")}> in <OR${r}>`+` inside <${e.topLevelRule.name}> Rule,\n`+`<${t}> may appears as a prefix path in all these alternatives.\n`;s=s+`See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#AMBIGUOUS_ALTERNATIVES\n`+`For Further details.`;return s},buildEmptyRepetitionError(e){let t=getProductionDslName(e.repetition);if(e.repetition.idx!==0){t+=e.repetition.idx}const r=`The repetition <${t}> within Rule <${e.topLevelRule.name}> can never consume any tokens.\n`+`This could lead to an infinite loop.`;return r},buildTokenNameError(e){return"deprecated"},buildEmptyAlternationError(e){const t=`Ambiguous empty alternative: <${e.emptyChoiceIdx+1}>`+` in <OR${e.alternation.idx}> inside <${e.topLevelRule.name}> Rule.\n`+`Only the last alternative may be an empty alternative.`;return t},buildTooManyAlternativesError(e){const t=`An Alternation cannot have more than 256 alternatives:\n`+`<OR${e.alternation.idx}> inside <${e.topLevelRule.name}> Rule.\n has ${e.alternation.definition.length+1} alternatives.`;return t},buildLeftRecursionError(e){const t=e.topLevelRule.name;const r=Mr(e.leftRecursionPath,(e=>e.name));const s=`${t} --\x3e ${r.concat([t]).join(" --\x3e ")}`;const a=`Left Recursion found in grammar.\n`+`rule: <${t}> can be invoked from itself (directly or indirectly)\n`+`without consuming any Tokens. The grammar path that causes this is: \n ${s}\n`+` To fix this refactor your grammar to remove the left recursion.\n`+`see: https://en.wikipedia.org/wiki/LL_parser#Left_factoring.`;return a},buildInvalidRuleNameError(e){return"deprecated"},buildDuplicateRuleNameError(e){let t;if(e.topLevelRule instanceof Rule){t=e.topLevelRule.name}else{t=e.topLevelRule}const r=`Duplicate definition, rule: ->${t}<- is already defined in the grammar: ->${e.grammarName}<-`;return r}};function resolveGrammar(e,t){const r=new GastRefResolverVisitor(e,t);r.resolveRefs();return r.errors}class GastRefResolverVisitor extends visitor_GAstVisitor{constructor(e,t){super();this.nameToTopRule=e;this.errMsgProvider=t;this.errors=[]}resolveRefs(){mt(bt(this.nameToTopRule),(e=>{this.currTopLevel=e;e.accept(this)}))}visitNonTerminal(e){const t=this.nameToTopRule[e.nonTerminalName];if(!t){const t=this.errMsgProvider.buildRuleNotFoundError(this.currTopLevel,e);this.errors.push({message:t,type:Zl.UNRESOLVED_SUBRULE_REF,ruleName:this.currTopLevel.name,unresolvedRefName:e.nonTerminalName})}else{e.referencedRule=t}}}function flatMap(e,t){return Zo(Mr(e,t),1)}const pl=flatMap;function arrayAggregator(e,t,r,s){var a=-1,u=e==null?0:e.length;while(++a<u){var l=e[a];t(s,l,r(l),e)}return s}const dl=arrayAggregator;function baseAggregator(e,t,r,s){pt(e,(function(e,a,u){t(s,e,r(e),u)}));return s}const _l=baseAggregator;function createAggregator(e,t){return function(r,s){var a=V(r)?dl:_l,u=t?t():{};return a(r,e,Lr(s,2),u)}}const ml=createAggregator;var gl=Object.prototype;var yl=gl.hasOwnProperty;var bl=ml((function(e,t,r){if(yl.call(e,r)){e[r].push(t)}else{Wr(e,r,[t])}}));const vl=bl;function dropRight(e,t,r){var s=e==null?0:e.length;if(!s){return[]}t=r||t===undefined?1:Za(t);t=s-t;return $a(e,0,t<0?0:t)}const El=dropRight;class AbstractNextPossibleTokensWalker extends RestWalker{constructor(e,t){super();this.topProd=e;this.path=t;this.possibleTokTypes=[];this.nextProductionName="";this.nextProductionOccurrence=0;this.found=false;this.isAtEndOfPath=false}startWalking(){this.found=false;if(this.path.ruleStack[0]!==this.topProd.name){throw Error("The path does not start with the walker's top Rule!")}this.ruleStack=Ua(this.path.ruleStack).reverse();this.occurrenceStack=Ua(this.path.occurrenceStack).reverse();this.ruleStack.pop();this.occurrenceStack.pop();this.updateExpectedNext();this.walk(this.topProd);return this.possibleTokTypes}walk(e,t=[]){if(!this.found){super.walk(e,t)}}walkProdRef(e,t,r){if(e.referencedRule.name===this.nextProductionName&&e.idx===this.nextProductionOccurrence){const s=t.concat(r);this.updateExpectedNext();this.walk(e.referencedRule,s)}}updateExpectedNext(){if(hn(this.ruleStack)){this.nextProductionName="";this.nextProductionOccurrence=0;this.isAtEndOfPath=true}else{this.nextProductionName=this.ruleStack.pop();this.nextProductionOccurrence=this.occurrenceStack.pop()}}}class NextAfterTokenWalker extends AbstractNextPossibleTokensWalker{constructor(e,t){super(e,t);this.path=t;this.nextTerminalName="";this.nextTerminalOccurrence=0;this.nextTerminalName=this.path.lastTok.name;this.nextTerminalOccurrence=this.path.lastTokOccurrence}walkTerminal(e,t,r){if(this.isAtEndOfPath&&e.terminalType.name===this.nextTerminalName&&e.idx===this.nextTerminalOccurrence&&!this.found){const e=t.concat(r);const s=new Alternative({definition:e});this.possibleTokTypes=first(s);this.found=true}}}class AbstractNextTerminalAfterProductionWalker extends RestWalker{constructor(e,t){super();this.topRule=e;this.occurrence=t;this.result={token:undefined,occurrence:undefined,isEndOfRule:undefined}}startWalking(){this.walk(this.topRule);return this.result}}class NextTerminalAfterManyWalker extends AbstractNextTerminalAfterProductionWalker{walkMany(e,t,r){if(e.idx===this.occurrence){const e=Nu(t.concat(r));this.result.isEndOfRule=e===undefined;if(e instanceof Terminal){this.result.token=e.terminalType;this.result.occurrence=e.idx}}else{super.walkMany(e,t,r)}}}class NextTerminalAfterManySepWalker extends AbstractNextTerminalAfterProductionWalker{walkManySep(e,t,r){if(e.idx===this.occurrence){const e=Nu(t.concat(r));this.result.isEndOfRule=e===undefined;if(e instanceof Terminal){this.result.token=e.terminalType;this.result.occurrence=e.idx}}else{super.walkManySep(e,t,r)}}}class NextTerminalAfterAtLeastOneWalker extends AbstractNextTerminalAfterProductionWalker{walkAtLeastOne(e,t,r){if(e.idx===this.occurrence){const e=Nu(t.concat(r));this.result.isEndOfRule=e===undefined;if(e instanceof Terminal){this.result.token=e.terminalType;this.result.occurrence=e.idx}}else{super.walkAtLeastOne(e,t,r)}}}class NextTerminalAfterAtLeastOneSepWalker extends AbstractNextTerminalAfterProductionWalker{walkAtLeastOneSep(e,t,r){if(e.idx===this.occurrence){const e=Nu(t.concat(r));this.result.isEndOfRule=e===undefined;if(e instanceof Terminal){this.result.token=e.terminalType;this.result.occurrence=e.idx}}else{super.walkAtLeastOneSep(e,t,r)}}}function possiblePathsFrom(e,t,r=[]){r=Ua(r);let s=[];let a=0;function remainingPathWith(t){return t.concat(eo(e,a+1))}function getAlternativesForProd(e){const a=possiblePathsFrom(remainingPathWith(e),t,r);return s.concat(a)}while(r.length<t&&a<e.length){const t=e[a];if(t instanceof Alternative){return getAlternativesForProd(t.definition)}else if(t instanceof model_NonTerminal){return getAlternativesForProd(t.definition)}else if(t instanceof Option){s=getAlternativesForProd(t.definition)}else if(t instanceof RepetitionMandatory){const e=t.definition.concat([new Repetition({definition:t.definition})]);return getAlternativesForProd(e)}else if(t instanceof RepetitionMandatoryWithSeparator){const e=[new Alternative({definition:t.definition}),new Repetition({definition:[new Terminal({terminalType:t.separator})].concat(t.definition)})];return getAlternativesForProd(e)}else if(t instanceof RepetitionWithSeparator){const e=t.definition.concat([new Repetition({definition:[new Terminal({terminalType:t.separator})].concat(t.definition)})]);s=getAlternativesForProd(e)}else if(t instanceof Repetition){const e=t.definition.concat([new Repetition({definition:t.definition})]);s=getAlternativesForProd(e)}else if(t instanceof Alternation){mt(t.definition,(e=>{if(hn(e.definition)===false){s=getAlternativesForProd(e.definition)}}));return s}else if(t instanceof Terminal){r.push(t.terminalType)}else{throw Error("non exhaustive match")}a++}s.push({partialPath:r,suffixDef:eo(e,a)});return s}function nextPossibleTokensAfter(e,t,r,s){const a="EXIT_NONE_TERMINAL";const u=[a];const l="EXIT_ALTERNATIVE";let h=false;const f=t.length;const d=f-s-1;const _=[];const m=[];m.push({idx:-1,def:e,ruleStack:[],occurrenceStack:[]});while(!hn(m)){const e=m.pop();if(e===l){if(h&&qu(m).idx<=d){m.pop()}continue}const s=e.def;const g=e.idx;const y=e.ruleStack;const b=e.occurrenceStack;if(hn(s)){continue}const v=s[0];if(v===a){const e={idx:g,def:eo(s),ruleStack:El(y),occurrenceStack:El(b)};m.push(e)}else if(v instanceof Terminal){if(g<f-1){const e=g+1;const a=t[e];if(r(a,v.terminalType)){const t={idx:e,def:eo(s),ruleStack:y,occurrenceStack:b};m.push(t)}}else if(g===f-1){_.push({nextTokenType:v.terminalType,nextTokenOccurrence:v.idx,ruleStack:y,occurrenceStack:b});h=true}else{throw Error("non exhaustive match")}}else if(v instanceof model_NonTerminal){const e=Ua(y);e.push(v.nonTerminalName);const t=Ua(b);t.push(v.idx);const r={idx:g,def:v.definition.concat(u,eo(s)),ruleStack:e,occurrenceStack:t};m.push(r)}else if(v instanceof Option){const e={idx:g,def:eo(s),ruleStack:y,occurrenceStack:b};m.push(e);m.push(l);const t={idx:g,def:v.definition.concat(eo(s)),ruleStack:y,occurrenceStack:b};m.push(t)}else if(v instanceof RepetitionMandatory){const e=new Repetition({definition:v.definition,idx:v.idx});const t=v.definition.concat([e],eo(s));const r={idx:g,def:t,ruleStack:y,occurrenceStack:b};m.push(r)}else if(v instanceof RepetitionMandatoryWithSeparator){const e=new Terminal({terminalType:v.separator});const t=new Repetition({definition:[e].concat(v.definition),idx:v.idx});const r=v.definition.concat([t],eo(s));const a={idx:g,def:r,ruleStack:y,occurrenceStack:b};m.push(a)}else if(v instanceof RepetitionWithSeparator){const e={idx:g,def:eo(s),ruleStack:y,occurrenceStack:b};m.push(e);m.push(l);const t=new Terminal({terminalType:v.separator});const r=new Repetition({definition:[t].concat(v.definition),idx:v.idx});const a=v.definition.concat([r],eo(s));const u={idx:g,def:a,ruleStack:y,occurrenceStack:b};m.push(u)}else if(v instanceof Repetition){const e={idx:g,def:eo(s),ruleStack:y,occurrenceStack:b};m.push(e);m.push(l);const t=new Repetition({definition:v.definition,idx:v.idx});const r=v.definition.concat([t],eo(s));const a={idx:g,def:r,ruleStack:y,occurrenceStack:b};m.push(a)}else if(v instanceof Alternation){for(let e=v.definition.length-1;e>=0;e--){const t=v.definition[e];const r={idx:g,def:t.definition.concat(eo(s)),ruleStack:y,occurrenceStack:b};m.push(r);m.push(l)}}else if(v instanceof Alternative){m.push({idx:g,def:v.definition.concat(eo(s)),ruleStack:y,occurrenceStack:b})}else if(v instanceof Rule){m.push(expandTopLevelRule(v,g,y,b))}else{throw Error("non exhaustive match")}}return _}function expandTopLevelRule(e,t,r,s){const a=Ua(r);a.push(e.name);const u=Ua(s);u.push(1);return{idx:t,def:e.definition,ruleStack:a,occurrenceStack:u}}var Tl;(function(e){e[e["OPTION"]=0]="OPTION";e[e["REPETITION"]=1]="REPETITION";e[e["REPETITION_MANDATORY"]=2]="REPETITION_MANDATORY";e[e["REPETITION_MANDATORY_WITH_SEPARATOR"]=3]="REPETITION_MANDATORY_WITH_SEPARATOR";e[e["REPETITION_WITH_SEPARATOR"]=4]="REPETITION_WITH_SEPARATOR";e[e["ALTERNATION"]=5]="ALTERNATION"})(Tl||(Tl={}));function getProdType(e){if(e instanceof Option||e==="Option"){return Tl.OPTION}else if(e instanceof Repetition||e==="Repetition"){return Tl.REPETITION}else if(e instanceof RepetitionMandatory||e==="RepetitionMandatory"){return Tl.REPETITION_MANDATORY}else if(e instanceof RepetitionMandatoryWithSeparator||e==="RepetitionMandatoryWithSeparator"){return Tl.REPETITION_MANDATORY_WITH_SEPARATOR}else if(e instanceof RepetitionWithSeparator||e==="RepetitionWithSeparator"){return Tl.REPETITION_WITH_SEPARATOR}else if(e instanceof Alternation||e==="Alternation"){return Tl.ALTERNATION}else{throw Error("non exhaustive match")}}function getLookaheadPaths(e){const{occurrence:t,rule:r,prodType:s,maxLookahead:a}=e;const u=getProdType(s);if(u===Tl.ALTERNATION){return getLookaheadPathsForOr(t,r,a)}else{return getLookaheadPathsForOptionalProd(t,r,u,a)}}function buildLookaheadFuncForOr(e,t,r,s,a,u){const l=getLookaheadPathsForOr(e,t,r);const h=areTokenCategoriesNotUsed(l)?tokenStructuredMatcherNoCategories:tokenStructuredMatcher;return u(l,s,h,a)}function buildLookaheadFuncForOptionalProd(e,t,r,s,a,u){const l=getLookaheadPathsForOptionalProd(e,t,a,r);const h=areTokenCategoriesNotUsed(l)?tokenStructuredMatcherNoCategories:tokenStructuredMatcher;return u(l[0],h,s)}function buildAlternativesLookAheadFunc(e,t,r,s){const a=e.length;const u=Bo(e,(e=>Bo(e,(e=>e.length===1))));if(t){return function(t){const s=Mr(t,(e=>e.GATE));for(let t=0;t<a;t++){const a=e[t];const u=a.length;const l=s[t];if(l!==undefined&&l.call(this)===false){continue}e:for(let e=0;e<u;e++){const s=a[e];const u=s.length;for(let e=0;e<u;e++){const t=this.LA(e+1);if(r(t,s[e])===false){continue e}}return t}}return undefined}}else if(u&&!s){const t=Mr(e,(e=>eu(e)));const r=Eu(t,((e,t,r)=>{mt(t,(t=>{if(!$r(e,t.tokenTypeIdx)){e[t.tokenTypeIdx]=r}mt(t.categoryMatches,(t=>{if(!$r(e,t)){e[t]=r}}))}));return e}),{});return function(){const e=this.LA(1);return r[e.tokenTypeIdx]}}else{return function(){for(let t=0;t<a;t++){const s=e[t];const a=s.length;e:for(let e=0;e<a;e++){const a=s[e];const u=a.length;for(let e=0;e<u;e++){const t=this.LA(e+1);if(r(t,a[e])===false){continue e}}return t}}return undefined}}}function buildSingleAlternativeLookaheadFunction(e,t,r){const s=Bo(e,(e=>e.length===1));const a=e.length;if(s&&!r){const t=eu(e);if(t.length===1&&hn(t[0].categoryMatches)){const e=t[0];const r=e.tokenTypeIdx;return function(){return this.LA(1).tokenTypeIdx===r}}else{const e=Eu(t,((e,t,r)=>{e[t.tokenTypeIdx]=true;mt(t.categoryMatches,(t=>{e[t]=true}));return e}),[]);return function(){const t=this.LA(1);return e[t.tokenTypeIdx]===true}}}else{return function(){e:for(let r=0;r<a;r++){const s=e[r];const a=s.length;for(let e=0;e<a;e++){const r=this.LA(e+1);if(t(r,s[e])===false){continue e}}return true}return false}}}class RestDefinitionFinderWalker extends RestWalker{constructor(e,t,r){super();this.topProd=e;this.targetOccurrence=t;this.targetProdType=r}startWalking(){this.walk(this.topProd);return this.restDef}checkIsTarget(e,t,r,s){if(e.idx===this.targetOccurrence&&this.targetProdType===t){this.restDef=r.concat(s);return true}return false}walkOption(e,t,r){if(!this.checkIsTarget(e,Tl.OPTION,t,r)){super.walkOption(e,t,r)}}walkAtLeastOne(e,t,r){if(!this.checkIsTarget(e,Tl.REPETITION_MANDATORY,t,r)){super.walkOption(e,t,r)}}walkAtLeastOneSep(e,t,r){if(!this.checkIsTarget(e,Tl.REPETITION_MANDATORY_WITH_SEPARATOR,t,r)){super.walkOption(e,t,r)}}walkMany(e,t,r){if(!this.checkIsTarget(e,Tl.REPETITION,t,r)){super.walkOption(e,t,r)}}walkManySep(e,t,r){if(!this.checkIsTarget(e,Tl.REPETITION_WITH_SEPARATOR,t,r)){super.walkOption(e,t,r)}}}class InsideDefinitionFinderVisitor extends visitor_GAstVisitor{constructor(e,t,r){super();this.targetOccurrence=e;this.targetProdType=t;this.targetRef=r;this.result=[]}checkIsTarget(e,t){if(e.idx===this.targetOccurrence&&this.targetProdType===t&&(this.targetRef===undefined||e===this.targetRef)){this.result=e.definition}}visitOption(e){this.checkIsTarget(e,Tl.OPTION)}visitRepetition(e){this.checkIsTarget(e,Tl.REPETITION)}visitRepetitionMandatory(e){this.checkIsTarget(e,Tl.REPETITION_MANDATORY)}visitRepetitionMandatoryWithSeparator(e){this.checkIsTarget(e,Tl.REPETITION_MANDATORY_WITH_SEPARATOR)}visitRepetitionWithSeparator(e){this.checkIsTarget(e,Tl.REPETITION_WITH_SEPARATOR)}visitAlternation(e){this.checkIsTarget(e,Tl.ALTERNATION)}}function initializeArrayOfArrays(e){const t=new Array(e);for(let r=0;r<e;r++){t[r]=[]}return t}function pathToHashKeys(e){let t=[""];for(let r=0;r<e.length;r++){const s=e[r];const a=[];for(let e=0;e<t.length;e++){const r=t[e];a.push(r+"_"+s.tokenTypeIdx);for(let e=0;e<s.categoryMatches.length;e++){const t="_"+s.categoryMatches[e];a.push(r+t)}}t=a}return t}function isUniquePrefixHash(e,t,r){for(let s=0;s<e.length;s++){if(s===r){continue}const a=e[s];for(let e=0;e<t.length;e++){const r=t[e];if(a[r]===true){return false}}}return true}function lookAheadSequenceFromAlternatives(e,t){const r=Mr(e,(e=>possiblePathsFrom([e],1)));const s=initializeArrayOfArrays(r.length);const a=Mr(r,(e=>{const t={};mt(e,(e=>{const r=pathToHashKeys(e.partialPath);mt(r,(e=>{t[e]=true}))}));return t}));let u=r;for(let e=1;e<=t;e++){const r=u;u=initializeArrayOfArrays(r.length);for(let l=0;l<r.length;l++){const h=r[l];for(let r=0;r<h.length;r++){const f=h[r].partialPath;const d=h[r].suffixDef;const _=pathToHashKeys(f);const m=isUniquePrefixHash(a,_,l);if(m||hn(d)||f.length===t){const e=s[l];if(containsPath(e,f)===false){e.push(f);for(let e=0;e<_.length;e++){const t=_[e];a[l][t]=true}}}else{const t=possiblePathsFrom(d,e+1,f);u[l]=u[l].concat(t);mt(t,(e=>{const t=pathToHashKeys(e.partialPath);mt(t,(e=>{a[l][e]=true}))}))}}}}return s}function getLookaheadPathsForOr(e,t,r,s){const a=new InsideDefinitionFinderVisitor(e,Tl.ALTERNATION,s);t.accept(a);return lookAheadSequenceFromAlternatives(a.result,r)}function getLookaheadPathsForOptionalProd(e,t,r,s){const a=new InsideDefinitionFinderVisitor(e,r);t.accept(a);const u=a.result;const l=new RestDefinitionFinderWalker(t,e,r);const h=l.startWalking();const f=new Alternative({definition:u});const d=new Alternative({definition:h});return lookAheadSequenceFromAlternatives([f,d],s)}function containsPath(e,t){e:for(let r=0;r<e.length;r++){const s=e[r];if(s.length!==t.length){continue}for(let e=0;e<s.length;e++){const r=t[e];const a=s[e];const u=r===a||a.categoryMatchesMap[r.tokenTypeIdx]!==undefined;if(u===false){continue e}}return true}return false}function isStrictPrefixOfPath(e,t){return e.length<t.length&&Bo(e,((e,r)=>{const s=t[r];return e===s||s.categoryMatchesMap[e.tokenTypeIdx]}))}function areTokenCategoriesNotUsed(e){return Bo(e,(e=>Bo(e,(e=>Bo(e,(e=>hn(e.categoryMatches)))))))}function validateLookahead(e){const t=e.lookaheadStrategy.validate({rules:e.rules,tokenTypes:e.tokenTypes,grammarName:e.grammarName});return Mr(t,(e=>Object.assign({type:Zl.CUSTOM_LOOKAHEAD_VALIDATION},e)))}function validateGrammar(e,t,r,s){const a=pl(e,(e=>validateDuplicateProductions(e,r)));const u=checkTerminalAndNoneTerminalsNameSpace(e,t,r);const l=pl(e,(e=>validateTooManyAlts(e,r)));const h=pl(e,(t=>validateRuleDoesNotAlreadyExist(t,e,s,r)));return a.concat(u,l,h)}function validateDuplicateProductions(e,t){const r=new OccurrenceValidationCollector;e.accept(r);const s=r.allProductions;const a=vl(s,identifyProductionForDuplicates);const u=Oo(a,(e=>e.length>1));const l=Mr(bt(u),(r=>{const s=Nu(r);const a=t.buildDuplicateFoundError(e,r);const u=getProductionDslName(s);const l={message:a,type:Zl.DUPLICATE_PRODUCTIONS,ruleName:e.name,dslName:u,occurrence:s.idx};const h=getExtraProductionArgument(s);if(h){l.parameter=h}return l}));return l}function identifyProductionForDuplicates(e){return`${getProductionDslName(e)}_#_${e.idx}_#_${getExtraProductionArgument(e)}`}function getExtraProductionArgument(e){if(e instanceof Terminal){return e.terminalType.name}else if(e instanceof model_NonTerminal){return e.nonTerminalName}else{return""}}class OccurrenceValidationCollector extends visitor_GAstVisitor{constructor(){super(...arguments);this.allProductions=[]}visitNonTerminal(e){this.allProductions.push(e)}visitOption(e){this.allProductions.push(e)}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}visitAlternation(e){this.allProductions.push(e)}visitTerminal(e){this.allProductions.push(e)}}function validateRuleDoesNotAlreadyExist(e,t,r,s){const a=[];const u=Eu(t,((t,r)=>{if(r.name===e.name){return t+1}return t}),0);if(u>1){const t=s.buildDuplicateRuleNameError({topLevelRule:e,grammarName:r});a.push({message:t,type:Zl.DUPLICATE_RULE_NAME,ruleName:e.name})}return a}function validateRuleIsOverridden(e,t,r){const s=[];let a;if(!Uo(t,e)){a=`Invalid rule override, rule: ->${e}<- cannot be overridden in the grammar: ->${r}<-`+`as it is not defined in any of the super grammars `;s.push({message:a,type:Zl.INVALID_RULE_OVERRIDE,ruleName:e})}return s}function validateNoLeftRecursion(e,t,r,s=[]){const a=[];const u=getFirstNoneTerminal(t.definition);if(hn(u)){return[]}else{const t=e.name;const l=Uo(u,e);if(l){a.push({message:r.buildLeftRecursionError({topLevelRule:e,leftRecursionPath:s}),type:Zl.LEFT_RECURSION,ruleName:t})}const h=wu(u,s.concat([e]));const f=pl(h,(t=>{const a=Ua(s);a.push(t);return validateNoLeftRecursion(e,t,r,a)}));return a.concat(f)}}function getFirstNoneTerminal(e){let t=[];if(hn(e)){return t}const r=Nu(e);if(r instanceof model_NonTerminal){t.push(r.referencedRule)}else if(r instanceof Alternative||r instanceof Option||r instanceof RepetitionMandatory||r instanceof RepetitionMandatoryWithSeparator||r instanceof RepetitionWithSeparator||r instanceof Repetition){t=t.concat(getFirstNoneTerminal(r.definition))}else if(r instanceof Alternation){t=eu(Mr(r.definition,(e=>getFirstNoneTerminal(e.definition))))}else if(r instanceof Terminal){}else{throw Error("non exhaustive match")}const s=isOptionalProd(r);const a=e.length>1;if(s&&a){const r=eo(e);return t.concat(getFirstNoneTerminal(r))}else{return t}}class OrCollector extends visitor_GAstVisitor{constructor(){super(...arguments);this.alternations=[]}visitAlternation(e){this.alternations.push(e)}}function validateEmptyOrAlternative(e,t){const r=new OrCollector;e.accept(r);const s=r.alternations;const a=pl(s,(r=>{const s=El(r.definition);return pl(s,((s,a)=>{const u=nextPossibleTokensAfter([s],[],tokenStructuredMatcher,1);if(hn(u)){return[{message:t.buildEmptyAlternationError({topLevelRule:e,alternation:r,emptyChoiceIdx:a}),type:Zl.NONE_LAST_EMPTY_ALT,ruleName:e.name,occurrence:r.idx,alternative:a+1}]}else{return[]}}))}));return a}function validateAmbiguousAlternationAlternatives(e,t,r){const s=new OrCollector;e.accept(s);let a=s.alternations;a=mu(a,(e=>e.ignoreAmbiguities===true));const u=pl(a,(s=>{const a=s.idx;const u=s.maxLookahead||t;const l=getLookaheadPathsForOr(a,e,u,s);const h=checkAlternativesAmbiguities(l,s,e,r);const f=checkPrefixAlternativesAmbiguities(l,s,e,r);return h.concat(f)}));return u}class RepetitionCollector extends visitor_GAstVisitor{constructor(){super(...arguments);this.allProductions=[]}visitRepetitionWithSeparator(e){this.allProductions.push(e)}visitRepetitionMandatory(e){this.allProductions.push(e)}visitRepetitionMandatoryWithSeparator(e){this.allProductions.push(e)}visitRepetition(e){this.allProductions.push(e)}}function validateTooManyAlts(e,t){const r=new OrCollector;e.accept(r);const s=r.alternations;const a=pl(s,(r=>{if(r.definition.length>255){return[{message:t.buildTooManyAlternativesError({topLevelRule:e,alternation:r}),type:Zl.TOO_MANY_ALTS,ruleName:e.name,occurrence:r.idx}]}else{return[]}}));return a}function validateSomeNonEmptyLookaheadPath(e,t,r){const s=[];mt(e,(e=>{const a=new RepetitionCollector;e.accept(a);const u=a.allProductions;mt(u,(a=>{const u=getProdType(a);const l=a.maxLookahead||t;const h=a.idx;const f=getLookaheadPathsForOptionalProd(h,e,u,l);const d=f[0];if(hn(eu(d))){const t=r.buildEmptyRepetitionError({topLevelRule:e,repetition:a});s.push({message:t,type:Zl.NO_NON_EMPTY_LOOKAHEAD,ruleName:e.name})}}))}));return s}function checkAlternativesAmbiguities(e,t,r,s){const a=[];const u=Eu(e,((r,s,u)=>{if(t.definition[u].ignoreAmbiguities===true){return r}mt(s,(s=>{const l=[u];mt(e,((e,r)=>{if(u!==r&&containsPath(e,s)&&t.definition[r].ignoreAmbiguities!==true){l.push(r)}}));if(l.length>1&&!containsPath(a,s)){a.push(s);r.push({alts:l,path:s})}}));return r}),[]);const l=Mr(u,(e=>{const a=Mr(e.alts,(e=>e+1));const u=s.buildAlternationAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:a,prefixPath:e.path});return{message:u,type:Zl.AMBIGUOUS_ALTS,ruleName:r.name,occurrence:t.idx,alternatives:e.alts}}));return l}function checkPrefixAlternativesAmbiguities(e,t,r,s){const a=Eu(e,((e,t,r)=>{const s=Mr(t,(e=>({idx:r,path:e})));return e.concat(s)}),[]);const u=Su(pl(a,(e=>{const u=t.definition[e.idx];if(u.ignoreAmbiguities===true){return[]}const l=e.idx;const h=e.path;const f=Tu(a,(e=>t.definition[e.idx].ignoreAmbiguities!==true&&e.idx<l&&isStrictPrefixOfPath(e.path,h)));const d=Mr(f,(e=>{const a=[e.idx+1,l+1];const u=t.idx===0?"":t.idx;const h=s.buildAlternationPrefixAmbiguityError({topLevelRule:r,alternation:t,ambiguityIndices:a,prefixPath:e.path});return{message:h,type:Zl.AMBIGUOUS_PREFIX_ALTS,ruleName:r.name,occurrence:u,alternatives:a}}));return d})));return u}function checkTerminalAndNoneTerminalsNameSpace(e,t,r){const s=[];const a=Mr(t,(e=>e.name));mt(e,(e=>{const t=e.name;if(Uo(a,t)){const a=r.buildNamespaceConflictError(e);s.push({message:a,type:Zl.CONFLICT_TOKENS_RULES_NAMESPACE,ruleName:t})}}));return s}function gast_resolver_public_resolveGrammar(e){const t=fu(e,{errMsgProvider:hl});const r={};mt(e.rules,(e=>{r[e.name]=e}));return resolveGrammar(r,t.errMsgProvider)}function gast_resolver_public_validateGrammar(e){e=fu(e,{errMsgProvider:fl});return validateGrammar(e.rules,e.tokenTypes,e.errMsgProvider,e.grammarName)}const kl="MismatchedTokenException";const xl="NoViableAltException";const Ol="EarlyExitException";const Al="NotAllInputParsedException";const wl=[kl,xl,Ol,Al];Object.freeze(wl);function isRecognitionException(e){return Uo(wl,e.name)}class RecognitionException extends Error{constructor(e,t){super(e);this.token=t;this.resyncedTokens=[];Object.setPrototypeOf(this,new.target.prototype);if(Error.captureStackTrace){Error.captureStackTrace(this,this.constructor)}}}class MismatchedTokenException extends RecognitionException{constructor(e,t,r){super(e,t);this.previousToken=r;this.name=kl}}class NoViableAltException extends RecognitionException{constructor(e,t,r){super(e,t);this.previousToken=r;this.name=xl}}class NotAllInputParsedException extends RecognitionException{constructor(e,t){super(e,t);this.name=Al}}class EarlyExitException extends RecognitionException{constructor(e,t,r){super(e,t);this.previousToken=r;this.name=Ol}}const Sl={};const Nl="InRuleRecoveryException";class InRuleRecoveryException extends Error{constructor(e){super(e);this.name=Nl}}class Recoverable{initRecoverable(e){this.firstAfterRepMap={};this.resyncFollows={};this.recoveryEnabled=$r(e,"recoveryEnabled")?e.recoveryEnabled:Ql.recoveryEnabled;if(this.recoveryEnabled){this.attemptInRepetitionRecovery=attemptInRepetitionRecovery}}getTokenToInsert(e){const t=createTokenInstance(e,"",NaN,NaN,NaN,NaN,NaN,NaN);t.isInsertedInRecovery=true;return t}canTokenTypeBeInsertedInRecovery(e){return true}canTokenTypeBeDeletedInRecovery(e){return true}tryInRepetitionRecovery(e,t,r,s){const a=this.findReSyncTokenType();const u=this.exportLexerState();const l=[];let h=false;const f=this.LA(1);let d=this.LA(1);const generateErrorMessage=()=>{const e=this.LA(0);const t=this.errorMessageProvider.buildMismatchTokenMessage({expected:s,actual:f,previous:e,ruleName:this.getCurrRuleFullName()});const r=new MismatchedTokenException(t,f,this.LA(0));r.resyncedTokens=El(l);this.SAVE_ERROR(r)};while(!h){if(this.tokenMatcher(d,s)){generateErrorMessage();return}else if(r.call(this)){generateErrorMessage();e.apply(this,t);return}else if(this.tokenMatcher(d,a)){h=true}else{d=this.SKIP_TOKEN();this.addToResyncTokens(d,l)}}this.importLexerState(u)}shouldInRepetitionRecoveryBeTried(e,t,r){if(r===false){return false}if(this.tokenMatcher(this.LA(1),e)){return false}if(this.isBackTracking()){return false}if(this.canPerformInRuleRecovery(e,this.getFollowsForInRuleRecovery(e,t))){return false}return true}getFollowsForInRuleRecovery(e,t){const r=this.getCurrentGrammarPath(e,t);const s=this.getNextPossibleTokenTypes(r);return s}tryInRuleRecovery(e,t){if(this.canRecoverWithSingleTokenInsertion(e,t)){const t=this.getTokenToInsert(e);return t}if(this.canRecoverWithSingleTokenDeletion(e)){const e=this.SKIP_TOKEN();this.consumeToken();return e}throw new InRuleRecoveryException("sad sad panda")}canPerformInRuleRecovery(e,t){return this.canRecoverWithSingleTokenInsertion(e,t)||this.canRecoverWithSingleTokenDeletion(e)}canRecoverWithSingleTokenInsertion(e,t){if(!this.canTokenTypeBeInsertedInRecovery(e)){return false}if(hn(t)){return false}const r=this.LA(1);const s=Pu(t,(e=>this.tokenMatcher(r,e)))!==undefined;return s}canRecoverWithSingleTokenDeletion(e){if(!this.canTokenTypeBeDeletedInRecovery(e)){return false}const t=this.tokenMatcher(this.LA(2),e);return t}isInCurrentRuleReSyncSet(e){const t=this.getCurrFollowKey();const r=this.getFollowSetFromFollowKey(t);return Uo(r,e)}findReSyncTokenType(){const e=this.flattenFollowSet();let t=this.LA(1);let r=2;while(true){const s=Pu(e,(e=>{const r=tokenMatcher(t,e);return r}));if(s!==undefined){return s}t=this.LA(r);r++}}getCurrFollowKey(){if(this.RULE_STACK.length===1){return Sl}const e=this.getLastExplicitRuleShortName();const t=this.getLastExplicitRuleOccurrenceIndex();const r=this.getPreviousExplicitRuleShortName();return{ruleName:this.shortRuleNameToFullName(e),idxInCallingRule:t,inRule:this.shortRuleNameToFullName(r)}}buildFullFollowKeyStack(){const e=this.RULE_STACK;const t=this.RULE_OCCURRENCE_STACK;return Mr(e,((r,s)=>{if(s===0){return Sl}return{ruleName:this.shortRuleNameToFullName(r),idxInCallingRule:t[s],inRule:this.shortRuleNameToFullName(e[s-1])}}))}flattenFollowSet(){const e=Mr(this.buildFullFollowKeyStack(),(e=>this.getFollowSetFromFollowKey(e)));return eu(e)}getFollowSetFromFollowKey(e){if(e===Sl){return[ll]}const t=e.ruleName+e.idxInCallingRule+tu+e.inRule;return this.resyncFollows[t]}addToResyncTokens(e,t){if(!this.tokenMatcher(e,ll)){t.push(e)}return t}reSyncTo(e){const t=[];let r=this.LA(1);while(this.tokenMatcher(r,e)===false){r=this.SKIP_TOKEN();this.addToResyncTokens(r,t)}return El(t)}attemptInRepetitionRecovery(e,t,r,s,a,u,l){}getCurrentGrammarPath(e,t){const r=this.getHumanReadableRuleStack();const s=Ua(this.RULE_OCCURRENCE_STACK);const a={ruleStack:r,occurrenceStack:s,lastTok:e,lastTokOccurrence:t};return a}getHumanReadableRuleStack(){return Mr(this.RULE_STACK,(e=>this.shortRuleNameToFullName(e)))}}function attemptInRepetitionRecovery(e,t,r,s,a,u,l){const h=this.getKeyForAutomaticLookahead(s,a);let f=this.firstAfterRepMap[h];if(f===undefined){const e=this.getCurrRuleFullName();const t=this.getGAstProductions()[e];const r=new u(t,a);f=r.startWalking();this.firstAfterRepMap[h]=f}let d=f.token;let _=f.occurrence;const m=f.isEndOfRule;if(this.RULE_STACK.length===1&&m&&d===undefined){d=ll;_=1}if(d===undefined||_===undefined){return}if(this.shouldInRepetitionRecoveryBeTried(d,_,l)){this.tryInRepetitionRecovery(e,t,r,d)}}const Rl=4;const Cl=8;const Il=12;const Ll=8;const Pl=1<<Cl;const Ml=2<<Cl;const Fl=3<<Cl;const Dl=4<<Cl;const Ul=5<<Cl;const $l=6<<Cl;function getKeyForAutomaticLookahead(e,t,r){return r|t|e}const jl=32-Ll;class LLkLookaheadStrategy{constructor(e){var t;this.maxLookahead=(t=e===null||e===void 0?void 0:e.maxLookahead)!==null&&t!==void 0?t:Ql.maxLookahead}validate(e){const t=this.validateNoLeftRecursion(e.rules);if(hn(t)){const r=this.validateEmptyOrAlternatives(e.rules);const s=this.validateAmbiguousAlternationAlternatives(e.rules,this.maxLookahead);const a=this.validateSomeNonEmptyLookaheadPath(e.rules,this.maxLookahead);const u=[...t,...r,...s,...a];return u}return t}validateNoLeftRecursion(e){return pl(e,(e=>validateNoLeftRecursion(e,e,fl)))}validateEmptyOrAlternatives(e){return pl(e,(e=>validateEmptyOrAlternative(e,fl)))}validateAmbiguousAlternationAlternatives(e,t){return pl(e,(e=>validateAmbiguousAlternationAlternatives(e,t,fl)))}validateSomeNonEmptyLookaheadPath(e,t){return validateSomeNonEmptyLookaheadPath(e,t,fl)}buildLookaheadForAlternation(e){return buildLookaheadFuncForOr(e.prodOccurrence,e.rule,e.maxLookahead,e.hasPredicates,e.dynamicTokensEnabled,buildAlternativesLookAheadFunc)}buildLookaheadForOptional(e){return buildLookaheadFuncForOptionalProd(e.prodOccurrence,e.rule,e.maxLookahead,e.dynamicTokensEnabled,getProdType(e.prodType),buildSingleAlternativeLookaheadFunction)}}class LooksAhead{initLooksAhead(e){this.dynamicTokensEnabled=$r(e,"dynamicTokensEnabled")?e.dynamicTokensEnabled:Ql.dynamicTokensEnabled;this.maxLookahead=$r(e,"maxLookahead")?e.maxLookahead:Ql.maxLookahead;this.lookaheadStrategy=$r(e,"lookaheadStrategy")?e.lookaheadStrategy:new LLkLookaheadStrategy({maxLookahead:this.maxLookahead});this.lookAheadFuncsCache=new Map}preComputeLookaheadFunctions(e){mt(e,(e=>{this.TRACE_INIT(`${e.name} Rule Lookahead`,(()=>{const{alternation:t,repetition:r,option:s,repetitionMandatory:a,repetitionMandatoryWithSeparator:u,repetitionWithSeparator:l}=collectMethods(e);mt(t,(t=>{const r=t.idx===0?"":t.idx;this.TRACE_INIT(`${getProductionDslName(t)}${r}`,(()=>{const r=this.lookaheadStrategy.buildLookaheadForAlternation({prodOccurrence:t.idx,rule:e,maxLookahead:t.maxLookahead||this.maxLookahead,hasPredicates:t.hasPredicates,dynamicTokensEnabled:this.dynamicTokensEnabled});const s=getKeyForAutomaticLookahead(this.fullRuleNameToShort[e.name],Pl,t.idx);this.setLaFuncCache(s,r)}))}));mt(r,(t=>{this.computeLookaheadFunc(e,t.idx,Fl,"Repetition",t.maxLookahead,getProductionDslName(t))}));mt(s,(t=>{this.computeLookaheadFunc(e,t.idx,Ml,"Option",t.maxLookahead,getProductionDslName(t))}));mt(a,(t=>{this.computeLookaheadFunc(e,t.idx,Dl,"RepetitionMandatory",t.maxLookahead,getProductionDslName(t))}));mt(u,(t=>{this.computeLookaheadFunc(e,t.idx,$l,"RepetitionMandatoryWithSeparator",t.maxLookahead,getProductionDslName(t))}));mt(l,(t=>{this.computeLookaheadFunc(e,t.idx,Ul,"RepetitionWithSeparator",t.maxLookahead,getProductionDslName(t))}))}))}))}computeLookaheadFunc(e,t,r,s,a,u){this.TRACE_INIT(`${u}${t===0?"":t}`,(()=>{const u=this.lookaheadStrategy.buildLookaheadForOptional({prodOccurrence:t,rule:e,maxLookahead:a||this.maxLookahead,dynamicTokensEnabled:this.dynamicTokensEnabled,prodType:s});const l=getKeyForAutomaticLookahead(this.fullRuleNameToShort[e.name],r,t);this.setLaFuncCache(l,u)}))}getKeyForAutomaticLookahead(e,t){const r=this.getLastExplicitRuleShortName();return getKeyForAutomaticLookahead(r,e,t)}getLaFuncFromCache(e){return this.lookAheadFuncsCache.get(e)}setLaFuncCache(e,t){this.lookAheadFuncsCache.set(e,t)}}class DslMethodsCollectorVisitor extends visitor_GAstVisitor{constructor(){super(...arguments);this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}reset(){this.dslMethods={option:[],alternation:[],repetition:[],repetitionWithSeparator:[],repetitionMandatory:[],repetitionMandatoryWithSeparator:[]}}visitOption(e){this.dslMethods.option.push(e)}visitRepetitionWithSeparator(e){this.dslMethods.repetitionWithSeparator.push(e)}visitRepetitionMandatory(e){this.dslMethods.repetitionMandatory.push(e)}visitRepetitionMandatoryWithSeparator(e){this.dslMethods.repetitionMandatoryWithSeparator.push(e)}visitRepetition(e){this.dslMethods.repetition.push(e)}visitAlternation(e){this.dslMethods.alternation.push(e)}}const Bl=new DslMethodsCollectorVisitor;function collectMethods(e){Bl.reset();e.accept(Bl);const t=Bl.dslMethods;Bl.reset();return t}function setNodeLocationOnlyOffset(e,t){if(isNaN(e.startOffset)===true){e.startOffset=t.startOffset;e.endOffset=t.endOffset}else if(e.endOffset<t.endOffset===true){e.endOffset=t.endOffset}}function setNodeLocationFull(e,t){if(isNaN(e.startOffset)===true){e.startOffset=t.startOffset;e.startColumn=t.startColumn;e.startLine=t.startLine;e.endOffset=t.endOffset;e.endColumn=t.endColumn;e.endLine=t.endLine}else if(e.endOffset<t.endOffset===true){e.endOffset=t.endOffset;e.endColumn=t.endColumn;e.endLine=t.endLine}}function addTerminalToCst(e,t,r){if(e.children[r]===undefined){e.children[r]=[t]}else{e.children[r].push(t)}}function addNoneTerminalToCst(e,t,r){if(e.children[t]===undefined){e.children[t]=[r]}else{e.children[t].push(r)}}const Wl="name";function defineNameProp(e,t){Object.defineProperty(e,Wl,{enumerable:false,configurable:true,writable:false,value:t})}function defaultVisit(e,t){const r=ut(e);const s=r.length;for(let a=0;a<s;a++){const s=r[a];const u=e[s];const l=u.length;for(let e=0;e<l;e++){const r=u[e];if(r.tokenTypeIdx===undefined){this[r.name](r.children,t)}}}}function createBaseSemanticVisitorConstructor(e,t){const derivedConstructor=function(){};defineNameProp(derivedConstructor,e+"BaseSemantics");const r={visit:function(e,t){if(V(e)){e=e[0]}if(nu(e)){return undefined}return this[e.name](e.children,t)},validateVisitor:function(){const e=validateVisitor(this,t);if(!hn(e)){const t=Mr(e,(e=>e.msg));throw Error(`Errors Detected in CST Visitor <${this.constructor.name}>:\n\t`+`${t.join("\n\n").replace(/\n/g,"\n\t")}`)}}};derivedConstructor.prototype=r;derivedConstructor.prototype.constructor=derivedConstructor;derivedConstructor._RULE_NAMES=t;return derivedConstructor}function createBaseVisitorConstructorWithDefaults(e,t,r){const derivedConstructor=function(){};defineNameProp(derivedConstructor,e+"BaseSemanticsWithDefaults");const s=Object.create(r.prototype);mt(t,(e=>{s[e]=defaultVisit}));derivedConstructor.prototype=s;derivedConstructor.prototype.constructor=derivedConstructor;return derivedConstructor}var Vl;(function(e){e[e["REDUNDANT_METHOD"]=0]="REDUNDANT_METHOD";e[e["MISSING_METHOD"]=1]="MISSING_METHOD"})(Vl||(Vl={}));function validateVisitor(e,t){const r=validateMissingCstMethods(e,t);return r}function validateMissingCstMethods(e,t){const r=Tu(t,(t=>rt(e[t])===false));const s=Mr(r,(t=>({msg:`Missing visitor method: <${t}> on ${e.constructor.name} CST Visitor.`,type:Vl.MISSING_METHOD,methodName:t})));return Su(s)}class TreeBuilder{initTreeBuilder(e){this.CST_STACK=[];this.outputCst=e.outputCst;this.nodeLocationTracking=$r(e,"nodeLocationTracking")?e.nodeLocationTracking:Ql.nodeLocationTracking;if(!this.outputCst){this.cstInvocationStateUpdate=zo;this.cstFinallyStateUpdate=zo;this.cstPostTerminal=zo;this.cstPostNonTerminal=zo;this.cstPostRule=zo}else{if(/full/i.test(this.nodeLocationTracking)){if(this.recoveryEnabled){this.setNodeLocationFromToken=setNodeLocationFull;this.setNodeLocationFromNode=setNodeLocationFull;this.cstPostRule=zo;this.setInitialNodeLocation=this.setInitialNodeLocationFullRecovery}else{this.setNodeLocationFromToken=zo;this.setNodeLocationFromNode=zo;this.cstPostRule=this.cstPostRuleFull;this.setInitialNodeLocation=this.setInitialNodeLocationFullRegular}}else if(/onlyOffset/i.test(this.nodeLocationTracking)){if(this.recoveryEnabled){this.setNodeLocationFromToken=setNodeLocationOnlyOffset;this.setNodeLocationFromNode=setNodeLocationOnlyOffset;this.cstPostRule=zo;this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRecovery}else{this.setNodeLocationFromToken=zo;this.setNodeLocationFromNode=zo;this.cstPostRule=this.cstPostRuleOnlyOffset;this.setInitialNodeLocation=this.setInitialNodeLocationOnlyOffsetRegular}}else if(/none/i.test(this.nodeLocationTracking)){this.setNodeLocationFromToken=zo;this.setNodeLocationFromNode=zo;this.cstPostRule=zo;this.setInitialNodeLocation=zo}else{throw Error(`Invalid <nodeLocationTracking> config option: "${e.nodeLocationTracking}"`)}}}setInitialNodeLocationOnlyOffsetRecovery(e){e.location={startOffset:NaN,endOffset:NaN}}setInitialNodeLocationOnlyOffsetRegular(e){e.location={startOffset:this.LA(1).startOffset,endOffset:NaN}}setInitialNodeLocationFullRecovery(e){e.location={startOffset:NaN,startLine:NaN,startColumn:NaN,endOffset:NaN,endLine:NaN,endColumn:NaN}}setInitialNodeLocationFullRegular(e){const t=this.LA(1);e.location={startOffset:t.startOffset,startLine:t.startLine,startColumn:t.startColumn,endOffset:NaN,endLine:NaN,endColumn:NaN}}cstInvocationStateUpdate(e){const t={name:e,children:Object.create(null)};this.setInitialNodeLocation(t);this.CST_STACK.push(t)}cstFinallyStateUpdate(){this.CST_STACK.pop()}cstPostRuleFull(e){const t=this.LA(0);const r=e.location;if(r.startOffset<=t.startOffset===true){r.endOffset=t.endOffset;r.endLine=t.endLine;r.endColumn=t.endColumn}else{r.startOffset=NaN;r.startLine=NaN;r.startColumn=NaN}}cstPostRuleOnlyOffset(e){const t=this.LA(0);const r=e.location;if(r.startOffset<=t.startOffset===true){r.endOffset=t.endOffset}else{r.startOffset=NaN}}cstPostTerminal(e,t){const r=this.CST_STACK[this.CST_STACK.length-1];addTerminalToCst(r,t,e);this.setNodeLocationFromToken(r.location,t)}cstPostNonTerminal(e,t){const r=this.CST_STACK[this.CST_STACK.length-1];addNoneTerminalToCst(r,t,e);this.setNodeLocationFromNode(r.location,e.location)}getBaseCstVisitorConstructor(){if(nu(this.baseCstVisitorConstructor)){const e=createBaseSemanticVisitorConstructor(this.className,ut(this.gastProductionsCache));this.baseCstVisitorConstructor=e;return e}return this.baseCstVisitorConstructor}getBaseCstVisitorConstructorWithDefaults(){if(nu(this.baseCstVisitorWithDefaultsConstructor)){const e=createBaseVisitorConstructorWithDefaults(this.className,ut(this.gastProductionsCache),this.getBaseCstVisitorConstructor());this.baseCstVisitorWithDefaultsConstructor=e;return e}return this.baseCstVisitorWithDefaultsConstructor}getLastExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-1]}getPreviousExplicitRuleShortName(){const e=this.RULE_STACK;return e[e.length-2]}getLastExplicitRuleOccurrenceIndex(){const e=this.RULE_OCCURRENCE_STACK;return e[e.length-1]}}class LexerAdapter{initLexerAdapter(){this.tokVector=[];this.tokVectorLength=0;this.currIdx=-1}set input(e){if(this.selfAnalysisDone!==true){throw Error(`Missing <performSelfAnalysis> invocation at the end of the Parser's constructor.`)}this.reset();this.tokVector=e;this.tokVectorLength=e.length}get input(){return this.tokVector}SKIP_TOKEN(){if(this.currIdx<=this.tokVector.length-2){this.consumeToken();return this.LA(1)}else{return Yl}}LA(e){const t=this.currIdx+e;if(t<0||this.tokVectorLength<=t){return Yl}else{return this.tokVector[t]}}consumeToken(){this.currIdx++}exportLexerState(){return this.currIdx}importLexerState(e){this.currIdx=e}resetLexerState(){this.currIdx=-1}moveToTerminatedState(){this.currIdx=this.tokVector.length-1}getLexerPosition(){return this.exportLexerState()}}class RecognizerApi{ACTION(e){return e.call(this)}consume(e,t,r){return this.consumeInternal(t,e,r)}subrule(e,t,r){return this.subruleInternal(t,e,r)}option(e,t){return this.optionInternal(t,e)}or(e,t){return this.orInternal(t,e)}many(e,t){return this.manyInternal(e,t)}atLeastOne(e,t){return this.atLeastOneInternal(e,t)}CONSUME(e,t){return this.consumeInternal(e,0,t)}CONSUME1(e,t){return this.consumeInternal(e,1,t)}CONSUME2(e,t){return this.consumeInternal(e,2,t)}CONSUME3(e,t){return this.consumeInternal(e,3,t)}CONSUME4(e,t){return this.consumeInternal(e,4,t)}CONSUME5(e,t){return this.consumeInternal(e,5,t)}CONSUME6(e,t){return this.consumeInternal(e,6,t)}CONSUME7(e,t){return this.consumeInternal(e,7,t)}CONSUME8(e,t){return this.consumeInternal(e,8,t)}CONSUME9(e,t){return this.consumeInternal(e,9,t)}SUBRULE(e,t){return this.subruleInternal(e,0,t)}SUBRULE1(e,t){return this.subruleInternal(e,1,t)}SUBRULE2(e,t){return this.subruleInternal(e,2,t)}SUBRULE3(e,t){return this.subruleInternal(e,3,t)}SUBRULE4(e,t){return this.subruleInternal(e,4,t)}SUBRULE5(e,t){return this.subruleInternal(e,5,t)}SUBRULE6(e,t){return this.subruleInternal(e,6,t)}SUBRULE7(e,t){return this.subruleInternal(e,7,t)}SUBRULE8(e,t){return this.subruleInternal(e,8,t)}SUBRULE9(e,t){return this.subruleInternal(e,9,t)}OPTION(e){return this.optionInternal(e,0)}OPTION1(e){return this.optionInternal(e,1)}OPTION2(e){return this.optionInternal(e,2)}OPTION3(e){return this.optionInternal(e,3)}OPTION4(e){return this.optionInternal(e,4)}OPTION5(e){return this.optionInternal(e,5)}OPTION6(e){return this.optionInternal(e,6)}OPTION7(e){return this.optionInternal(e,7)}OPTION8(e){return this.optionInternal(e,8)}OPTION9(e){return this.optionInternal(e,9)}OR(e){return this.orInternal(e,0)}OR1(e){return this.orInternal(e,1)}OR2(e){return this.orInternal(e,2)}OR3(e){return this.orInternal(e,3)}OR4(e){return this.orInternal(e,4)}OR5(e){return this.orInternal(e,5)}OR6(e){return this.orInternal(e,6)}OR7(e){return this.orInternal(e,7)}OR8(e){return this.orInternal(e,8)}OR9(e){return this.orInternal(e,9)}MANY(e){this.manyInternal(0,e)}MANY1(e){this.manyInternal(1,e)}MANY2(e){this.manyInternal(2,e)}MANY3(e){this.manyInternal(3,e)}MANY4(e){this.manyInternal(4,e)}MANY5(e){this.manyInternal(5,e)}MANY6(e){this.manyInternal(6,e)}MANY7(e){this.manyInternal(7,e)}MANY8(e){this.manyInternal(8,e)}MANY9(e){this.manyInternal(9,e)}MANY_SEP(e){this.manySepFirstInternal(0,e)}MANY_SEP1(e){this.manySepFirstInternal(1,e)}MANY_SEP2(e){this.manySepFirstInternal(2,e)}MANY_SEP3(e){this.manySepFirstInternal(3,e)}MANY_SEP4(e){this.manySepFirstInternal(4,e)}MANY_SEP5(e){this.manySepFirstInternal(5,e)}MANY_SEP6(e){this.manySepFirstInternal(6,e)}MANY_SEP7(e){this.manySepFirstInternal(7,e)}MANY_SEP8(e){this.manySepFirstInternal(8,e)}MANY_SEP9(e){this.manySepFirstInternal(9,e)}AT_LEAST_ONE(e){this.atLeastOneInternal(0,e)}AT_LEAST_ONE1(e){return this.atLeastOneInternal(1,e)}AT_LEAST_ONE2(e){this.atLeastOneInternal(2,e)}AT_LEAST_ONE3(e){this.atLeastOneInternal(3,e)}AT_LEAST_ONE4(e){this.atLeastOneInternal(4,e)}AT_LEAST_ONE5(e){this.atLeastOneInternal(5,e)}AT_LEAST_ONE6(e){this.atLeastOneInternal(6,e)}AT_LEAST_ONE7(e){this.atLeastOneInternal(7,e)}AT_LEAST_ONE8(e){this.atLeastOneInternal(8,e)}AT_LEAST_ONE9(e){this.atLeastOneInternal(9,e)}AT_LEAST_ONE_SEP(e){this.atLeastOneSepFirstInternal(0,e)}AT_LEAST_ONE_SEP1(e){this.atLeastOneSepFirstInternal(1,e)}AT_LEAST_ONE_SEP2(e){this.atLeastOneSepFirstInternal(2,e)}AT_LEAST_ONE_SEP3(e){this.atLeastOneSepFirstInternal(3,e)}AT_LEAST_ONE_SEP4(e){this.atLeastOneSepFirstInternal(4,e)}AT_LEAST_ONE_SEP5(e){this.atLeastOneSepFirstInternal(5,e)}AT_LEAST_ONE_SEP6(e){this.atLeastOneSepFirstInternal(6,e)}AT_LEAST_ONE_SEP7(e){this.atLeastOneSepFirstInternal(7,e)}AT_LEAST_ONE_SEP8(e){this.atLeastOneSepFirstInternal(8,e)}AT_LEAST_ONE_SEP9(e){this.atLeastOneSepFirstInternal(9,e)}RULE(e,t,r=Jl){if(Uo(this.definedRulesNames,e)){const t=fl.buildDuplicateRuleNameError({topLevelRule:e,grammarName:this.className});const r={message:t,type:Zl.DUPLICATE_RULE_NAME,ruleName:e};this.definitionErrors.push(r)}this.definedRulesNames.push(e);const s=this.defineRule(e,t,r);this[e]=s;return s}OVERRIDE_RULE(e,t,r=Jl){const s=validateRuleIsOverridden(e,this.definedRulesNames,this.className);this.definitionErrors=this.definitionErrors.concat(s);const a=this.defineRule(e,t,r);this[e]=a;return a}BACKTRACK(e,t){return function(){this.isBackTrackingStack.push(1);const r=this.saveRecogState();try{e.apply(this,t);return true}catch(e){if(isRecognitionException(e)){return false}else{throw e}}finally{this.reloadRecogState(r);this.isBackTrackingStack.pop()}}}getGAstProductions(){return this.gastProductionsCache}getSerializedGastProductions(){return serializeGrammar(bt(this.gastProductionsCache))}}class RecognizerEngine{initRecognizerEngine(e,t){this.className=this.constructor.name;this.shortRuleNameToFull={};this.fullRuleNameToShort={};this.ruleShortNameIdx=256;this.tokenMatcher=tokenStructuredMatcherNoCategories;this.subruleIdx=0;this.definedRulesNames=[];this.tokensMap={};this.isBackTrackingStack=[];this.RULE_STACK=[];this.RULE_OCCURRENCE_STACK=[];this.gastProductionsCache={};if($r(t,"serializedGrammar")){throw Error("The Parser's configuration can no longer contain a <serializedGrammar> property.\n"+"\tSee: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_6-0-0\n"+"\tFor Further details.")}if(V(e)){if(hn(e)){throw Error("A Token Vocabulary cannot be empty.\n"+"\tNote that the first argument for the parser constructor\n"+"\tis no longer a Token vector (since v4.0).")}if(typeof e[0].startOffset==="number"){throw Error("The Parser constructor no longer accepts a token vector as the first argument.\n"+"\tSee: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_4-0-0\n"+"\tFor Further details.")}}if(V(e)){this.tokensMap=Eu(e,((e,t)=>{e[t.name]=t;return e}),{})}else if($r(e,"modes")&&Bo(eu(bt(e.modes)),isTokenType)){const t=eu(bt(e.modes));const r=Yo(t);this.tokensMap=Eu(r,((e,t)=>{e[t.name]=t;return e}),{})}else if(Ze(e)){this.tokensMap=Ua(e)}else{throw new Error("<tokensDictionary> argument must be An Array of Token constructors,"+" A dictionary of Token constructors or an IMultiModeLexerDefinition")}this.tokensMap["EOF"]=ll;const r=$r(e,"modes")?eu(bt(e.modes)):bt(e);const s=Bo(r,(e=>hn(e.categoryMatches)));this.tokenMatcher=s?tokenStructuredMatcherNoCategories:tokenStructuredMatcher;augmentTokenTypes(bt(this.tokensMap))}defineRule(e,t,r){if(this.selfAnalysisDone){throw Error(`Grammar rule <${e}> may not be defined after the 'performSelfAnalysis' method has been called'\n`+`Make sure that all grammar rule definitions are done before 'performSelfAnalysis' is called.`)}const s=$r(r,"resyncEnabled")?r.resyncEnabled:Jl.resyncEnabled;const a=$r(r,"recoveryValueFunc")?r.recoveryValueFunc:Jl.recoveryValueFunc;const u=this.ruleShortNameIdx<<Rl+Cl;this.ruleShortNameIdx++;this.shortRuleNameToFull[u]=e;this.fullRuleNameToShort[e]=u;let l;if(this.outputCst===true){l=function invokeRuleWithTry(...r){try{this.ruleInvocationStateUpdate(u,e,this.subruleIdx);t.apply(this,r);const s=this.CST_STACK[this.CST_STACK.length-1];this.cstPostRule(s);return s}catch(e){return this.invokeRuleCatch(e,s,a)}finally{this.ruleFinallyStateUpdate()}}}else{l=function invokeRuleWithTryCst(...r){try{this.ruleInvocationStateUpdate(u,e,this.subruleIdx);return t.apply(this,r)}catch(e){return this.invokeRuleCatch(e,s,a)}finally{this.ruleFinallyStateUpdate()}}}const h=Object.assign(l,{ruleName:e,originalGrammarAction:t});return h}invokeRuleCatch(e,t,r){const s=this.RULE_STACK.length===1;const a=t&&!this.isBackTracking()&&this.recoveryEnabled;if(isRecognitionException(e)){const t=e;if(a){const s=this.findReSyncTokenType();if(this.isInCurrentRuleReSyncSet(s)){t.resyncedTokens=this.reSyncTo(s);if(this.outputCst){const e=this.CST_STACK[this.CST_STACK.length-1];e.recoveredNode=true;return e}else{return r(e)}}else{if(this.outputCst){const e=this.CST_STACK[this.CST_STACK.length-1];e.recoveredNode=true;t.partialCstResult=e}throw t}}else if(s){this.moveToTerminatedState();return r(e)}else{throw t}}else{throw e}}optionInternal(e,t){const r=this.getKeyForAutomaticLookahead(Ml,t);return this.optionInternalLogic(e,t,r)}optionInternalLogic(e,t,r){let s=this.getLaFuncFromCache(r);let a;if(typeof e!=="function"){a=e.DEF;const t=e.GATE;if(t!==undefined){const e=s;s=()=>t.call(this)&&e.call(this)}}else{a=e}if(s.call(this)===true){return a.call(this)}return undefined}atLeastOneInternal(e,t){const r=this.getKeyForAutomaticLookahead(Dl,e);return this.atLeastOneInternalLogic(e,t,r)}atLeastOneInternalLogic(e,t,r){let s=this.getLaFuncFromCache(r);let a;if(typeof t!=="function"){a=t.DEF;const e=t.GATE;if(e!==undefined){const t=s;s=()=>e.call(this)&&t.call(this)}}else{a=t}if(s.call(this)===true){let e=this.doSingleRepetition(a);while(s.call(this)===true&&e===true){e=this.doSingleRepetition(a)}}else{throw this.raiseEarlyExitException(e,Tl.REPETITION_MANDATORY,t.ERR_MSG)}this.attemptInRepetitionRecovery(this.atLeastOneInternal,[e,t],s,Dl,e,NextTerminalAfterAtLeastOneWalker)}atLeastOneSepFirstInternal(e,t){const r=this.getKeyForAutomaticLookahead($l,e);this.atLeastOneSepFirstInternalLogic(e,t,r)}atLeastOneSepFirstInternalLogic(e,t,r){const s=t.DEF;const a=t.SEP;const u=this.getLaFuncFromCache(r);if(u.call(this)===true){s.call(this);const separatorLookAheadFunc=()=>this.tokenMatcher(this.LA(1),a);while(this.tokenMatcher(this.LA(1),a)===true){this.CONSUME(a);s.call(this)}this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,a,separatorLookAheadFunc,s,NextTerminalAfterAtLeastOneSepWalker],separatorLookAheadFunc,$l,e,NextTerminalAfterAtLeastOneSepWalker)}else{throw this.raiseEarlyExitException(e,Tl.REPETITION_MANDATORY_WITH_SEPARATOR,t.ERR_MSG)}}manyInternal(e,t){const r=this.getKeyForAutomaticLookahead(Fl,e);return this.manyInternalLogic(e,t,r)}manyInternalLogic(e,t,r){let s=this.getLaFuncFromCache(r);let a;if(typeof t!=="function"){a=t.DEF;const e=t.GATE;if(e!==undefined){const t=s;s=()=>e.call(this)&&t.call(this)}}else{a=t}let u=true;while(s.call(this)===true&&u===true){u=this.doSingleRepetition(a)}this.attemptInRepetitionRecovery(this.manyInternal,[e,t],s,Fl,e,NextTerminalAfterManyWalker,u)}manySepFirstInternal(e,t){const r=this.getKeyForAutomaticLookahead(Ul,e);this.manySepFirstInternalLogic(e,t,r)}manySepFirstInternalLogic(e,t,r){const s=t.DEF;const a=t.SEP;const u=this.getLaFuncFromCache(r);if(u.call(this)===true){s.call(this);const separatorLookAheadFunc=()=>this.tokenMatcher(this.LA(1),a);while(this.tokenMatcher(this.LA(1),a)===true){this.CONSUME(a);s.call(this)}this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,a,separatorLookAheadFunc,s,NextTerminalAfterManySepWalker],separatorLookAheadFunc,Ul,e,NextTerminalAfterManySepWalker)}}repetitionSepSecondInternal(e,t,r,s,a){while(r()){this.CONSUME(t);s.call(this)}this.attemptInRepetitionRecovery(this.repetitionSepSecondInternal,[e,t,r,s,a],r,$l,e,a)}doSingleRepetition(e){const t=this.getLexerPosition();e.call(this);const r=this.getLexerPosition();return r>t}orInternal(e,t){const r=this.getKeyForAutomaticLookahead(Pl,t);const s=V(e)?e:e.DEF;const a=this.getLaFuncFromCache(r);const u=a.call(this,s);if(u!==undefined){const e=s[u];return e.ALT.call(this)}this.raiseNoAltException(t,e.ERR_MSG)}ruleFinallyStateUpdate(){this.RULE_STACK.pop();this.RULE_OCCURRENCE_STACK.pop();this.cstFinallyStateUpdate();if(this.RULE_STACK.length===0&&this.isAtEndOfInput()===false){const e=this.LA(1);const t=this.errorMessageProvider.buildNotAllInputParsedMessage({firstRedundant:e,ruleName:this.getCurrRuleFullName()});this.SAVE_ERROR(new NotAllInputParsedException(t,e))}}subruleInternal(e,t,r){let s;try{const a=r!==undefined?r.ARGS:undefined;this.subruleIdx=t;s=e.apply(this,a);this.cstPostNonTerminal(s,r!==undefined&&r.LABEL!==undefined?r.LABEL:e.ruleName);return s}catch(t){throw this.subruleInternalError(t,r,e.ruleName)}}subruleInternalError(e,t,r){if(isRecognitionException(e)&&e.partialCstResult!==undefined){this.cstPostNonTerminal(e.partialCstResult,t!==undefined&&t.LABEL!==undefined?t.LABEL:r);delete e.partialCstResult}throw e}consumeInternal(e,t,r){let s;try{const t=this.LA(1);if(this.tokenMatcher(t,e)===true){this.consumeToken();s=t}else{this.consumeInternalError(e,t,r)}}catch(r){s=this.consumeInternalRecovery(e,t,r)}this.cstPostTerminal(r!==undefined&&r.LABEL!==undefined?r.LABEL:e.name,s);return s}consumeInternalError(e,t,r){let s;const a=this.LA(0);if(r!==undefined&&r.ERR_MSG){s=r.ERR_MSG}else{s=this.errorMessageProvider.buildMismatchTokenMessage({expected:e,actual:t,previous:a,ruleName:this.getCurrRuleFullName()})}throw this.SAVE_ERROR(new MismatchedTokenException(s,t,a))}consumeInternalRecovery(e,t,r){if(this.recoveryEnabled&&r.name==="MismatchedTokenException"&&!this.isBackTracking()){const s=this.getFollowsForInRuleRecovery(e,t);try{return this.tryInRuleRecovery(e,s)}catch(e){if(e.name===Nl){throw r}else{throw e}}}else{throw r}}saveRecogState(){const e=this.errors;const t=Ua(this.RULE_STACK);return{errors:e,lexerState:this.exportLexerState(),RULE_STACK:t,CST_STACK:this.CST_STACK}}reloadRecogState(e){this.errors=e.errors;this.importLexerState(e.lexerState);this.RULE_STACK=e.RULE_STACK}ruleInvocationStateUpdate(e,t,r){this.RULE_OCCURRENCE_STACK.push(r);this.RULE_STACK.push(e);this.cstInvocationStateUpdate(t)}isBackTracking(){return this.isBackTrackingStack.length!==0}getCurrRuleFullName(){const e=this.getLastExplicitRuleShortName();return this.shortRuleNameToFull[e]}shortRuleNameToFullName(e){return this.shortRuleNameToFull[e]}isAtEndOfInput(){return this.tokenMatcher(this.LA(1),ll)}reset(){this.resetLexerState();this.subruleIdx=0;this.isBackTrackingStack=[];this.errors=[];this.RULE_STACK=[];this.CST_STACK=[];this.RULE_OCCURRENCE_STACK=[]}}class ErrorHandler{initErrorHandler(e){this._errors=[];this.errorMessageProvider=$r(e,"errorMessageProvider")?e.errorMessageProvider:Ql.errorMessageProvider}SAVE_ERROR(e){if(isRecognitionException(e)){e.context={ruleStack:this.getHumanReadableRuleStack(),ruleOccurrenceStack:Ua(this.RULE_OCCURRENCE_STACK)};this._errors.push(e);return e}else{throw Error("Trying to save an Error which is not a RecognitionException")}}get errors(){return Ua(this._errors)}set errors(e){this._errors=e}raiseEarlyExitException(e,t,r){const s=this.getCurrRuleFullName();const a=this.getGAstProductions()[s];const u=getLookaheadPathsForOptionalProd(e,a,t,this.maxLookahead);const l=u[0];const h=[];for(let e=1;e<=this.maxLookahead;e++){h.push(this.LA(e))}const f=this.errorMessageProvider.buildEarlyExitMessage({expectedIterationPaths:l,actual:h,previous:this.LA(0),customUserDescription:r,ruleName:s});throw this.SAVE_ERROR(new EarlyExitException(f,this.LA(1),this.LA(0)))}raiseNoAltException(e,t){const r=this.getCurrRuleFullName();const s=this.getGAstProductions()[r];const a=getLookaheadPathsForOr(e,s,this.maxLookahead);const u=[];for(let e=1;e<=this.maxLookahead;e++){u.push(this.LA(e))}const l=this.LA(0);const h=this.errorMessageProvider.buildNoViableAltMessage({expectedPathsPerAlt:a,actual:u,previous:l,customUserDescription:t,ruleName:this.getCurrRuleFullName()});throw this.SAVE_ERROR(new NoViableAltException(h,this.LA(1),l))}}class ContentAssist{initContentAssist(){}computeContentAssist(e,t){const r=this.gastProductionsCache[e];if(nu(r)){throw Error(`Rule ->${e}<- does not exist in this grammar.`)}return nextPossibleTokensAfter([r],t,this.tokenMatcher,this.maxLookahead)}getNextPossibleTokenTypes(e){const t=Nu(e.ruleStack);const r=this.getGAstProductions();const s=r[t];const a=new NextAfterTokenWalker(s,e).startWalking();return a}}const zl={description:"This Object indicates the Parser is during Recording Phase"};Object.freeze(zl);const Gl=true;const Hl=Math.pow(2,Cl)-1;const Kl=createToken({name:"RECORDING_PHASE_TOKEN",pattern:Lexer.NA});augmentTokenTypes([Kl]);const ql=createTokenInstance(Kl,"This IToken indicates the Parser is in Recording Phase\n\t"+""+"See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details",-1,-1,-1,-1,-1,-1);Object.freeze(ql);const Xl={name:"This CSTNode indicates the Parser is in Recording Phase\n\t"+"See: https://chevrotain.io/docs/guide/internals.html#grammar-recording for details",children:{}};class GastRecorder{initGastRecorder(e){this.recordingProdStack=[];this.RECORDING_PHASE=false}enableRecording(){this.RECORDING_PHASE=true;this.TRACE_INIT("Enable Recording",(()=>{for(let e=0;e<10;e++){const t=e>0?e:"";this[`CONSUME${t}`]=function(t,r){return this.consumeInternalRecord(t,e,r)};this[`SUBRULE${t}`]=function(t,r){return this.subruleInternalRecord(t,e,r)};this[`OPTION${t}`]=function(t){return this.optionInternalRecord(t,e)};this[`OR${t}`]=function(t){return this.orInternalRecord(t,e)};this[`MANY${t}`]=function(t){this.manyInternalRecord(e,t)};this[`MANY_SEP${t}`]=function(t){this.manySepFirstInternalRecord(e,t)};this[`AT_LEAST_ONE${t}`]=function(t){this.atLeastOneInternalRecord(e,t)};this[`AT_LEAST_ONE_SEP${t}`]=function(t){this.atLeastOneSepFirstInternalRecord(e,t)}}this[`consume`]=function(e,t,r){return this.consumeInternalRecord(t,e,r)};this[`subrule`]=function(e,t,r){return this.subruleInternalRecord(t,e,r)};this[`option`]=function(e,t){return this.optionInternalRecord(t,e)};this[`or`]=function(e,t){return this.orInternalRecord(t,e)};this[`many`]=function(e,t){this.manyInternalRecord(e,t)};this[`atLeastOne`]=function(e,t){this.atLeastOneInternalRecord(e,t)};this.ACTION=this.ACTION_RECORD;this.BACKTRACK=this.BACKTRACK_RECORD;this.LA=this.LA_RECORD}))}disableRecording(){this.RECORDING_PHASE=false;this.TRACE_INIT("Deleting Recording methods",(()=>{const e=this;for(let t=0;t<10;t++){const r=t>0?t:"";delete e[`CONSUME${r}`];delete e[`SUBRULE${r}`];delete e[`OPTION${r}`];delete e[`OR${r}`];delete e[`MANY${r}`];delete e[`MANY_SEP${r}`];delete e[`AT_LEAST_ONE${r}`];delete e[`AT_LEAST_ONE_SEP${r}`]}delete e[`consume`];delete e[`subrule`];delete e[`option`];delete e[`or`];delete e[`many`];delete e[`atLeastOne`];delete e.ACTION;delete e.BACKTRACK;delete e.LA}))}ACTION_RECORD(e){}BACKTRACK_RECORD(e,t){return()=>true}LA_RECORD(e){return Yl}topLevelRuleRecord(e,t){try{const r=new Rule({definition:[],name:e});r.name=e;this.recordingProdStack.push(r);t.call(this);this.recordingProdStack.pop();return r}catch(e){if(e.KNOWN_RECORDER_ERROR!==true){try{e.message=e.message+'\n\t This error was thrown during the "grammar recording phase" For more info see:\n\t'+"https://chevrotain.io/docs/guide/internals.html#grammar-recording"}catch(t){throw e}}throw e}}optionInternalRecord(e,t){return recordProd.call(this,Option,e,t)}atLeastOneInternalRecord(e,t){recordProd.call(this,RepetitionMandatory,t,e)}atLeastOneSepFirstInternalRecord(e,t){recordProd.call(this,RepetitionMandatoryWithSeparator,t,e,Gl)}manyInternalRecord(e,t){recordProd.call(this,Repetition,t,e)}manySepFirstInternalRecord(e,t){recordProd.call(this,RepetitionWithSeparator,t,e,Gl)}orInternalRecord(e,t){return recordOrProd.call(this,e,t)}subruleInternalRecord(e,t,r){assertMethodIdxIsValid(t);if(!e||$r(e,"ruleName")===false){const r=new Error(`<SUBRULE${getIdxSuffix(t)}> argument is invalid`+` expecting a Parser method reference but got: <${JSON.stringify(e)}>`+`\n inside top level rule: <${this.recordingProdStack[0].name}>`);r.KNOWN_RECORDER_ERROR=true;throw r}const s=qu(this.recordingProdStack);const a=e.ruleName;const u=new model_NonTerminal({idx:t,nonTerminalName:a,label:r===null||r===void 0?void 0:r.LABEL,referencedRule:undefined});s.definition.push(u);return this.outputCst?Xl:zl}consumeInternalRecord(e,t,r){assertMethodIdxIsValid(t);if(!hasShortKeyProperty(e)){const r=new Error(`<CONSUME${getIdxSuffix(t)}> argument is invalid`+` expecting a TokenType reference but got: <${JSON.stringify(e)}>`+`\n inside top level rule: <${this.recordingProdStack[0].name}>`);r.KNOWN_RECORDER_ERROR=true;throw r}const s=qu(this.recordingProdStack);const a=new Terminal({idx:t,terminalType:e,label:r===null||r===void 0?void 0:r.LABEL});s.definition.push(a);return ql}}function recordProd(e,t,r,s=false){assertMethodIdxIsValid(r);const a=qu(this.recordingProdStack);const u=rt(t)?t:t.DEF;const l=new e({definition:[],idx:r});if(s){l.separator=t.SEP}if($r(t,"MAX_LOOKAHEAD")){l.maxLookahead=t.MAX_LOOKAHEAD}this.recordingProdStack.push(l);u.call(this);a.definition.push(l);this.recordingProdStack.pop();return zl}function recordOrProd(e,t){assertMethodIdxIsValid(t);const r=qu(this.recordingProdStack);const s=V(e)===false;const a=s===false?e:e.DEF;const u=new Alternation({definition:[],idx:t,ignoreAmbiguities:s&&e.IGNORE_AMBIGUITIES===true});if($r(e,"MAX_LOOKAHEAD")){u.maxLookahead=e.MAX_LOOKAHEAD}const l=Io(a,(e=>rt(e.GATE)));u.hasPredicates=l;r.definition.push(u);mt(a,(e=>{const t=new Alternative({definition:[]});u.definition.push(t);if($r(e,"IGNORE_AMBIGUITIES")){t.ignoreAmbiguities=e.IGNORE_AMBIGUITIES}else if($r(e,"GATE")){t.ignoreAmbiguities=true}this.recordingProdStack.push(t);e.ALT.call(this);this.recordingProdStack.pop()}));return zl}function getIdxSuffix(e){return e===0?"":`${e}`}function assertMethodIdxIsValid(e){if(e<0||e>Hl){const t=new Error(`Invalid DSL Method idx value: <${e}>\n\t`+`Idx value must be a none negative value smaller than ${Hl+1}`);t.KNOWN_RECORDER_ERROR=true;throw t}}class PerformanceTracer{initPerformanceTracer(e){if($r(e,"traceInitPerf")){const t=e.traceInitPerf;const r=typeof t==="number";this.traceInitMaxIdent=r?t:Infinity;this.traceInitPerf=r?t>0:t}else{this.traceInitMaxIdent=0;this.traceInitPerf=Ql.traceInitPerf}this.traceInitIndent=-1}TRACE_INIT(e,t){if(this.traceInitPerf===true){this.traceInitIndent++;const r=new Array(this.traceInitIndent+1).join("\t");if(this.traceInitIndent<this.traceInitMaxIdent){console.log(`${r}--\x3e <${e}>`)}const{time:s,value:a}=timer(t);const u=s>10?console.warn:console.log;if(this.traceInitIndent<this.traceInitMaxIdent){u(`${r}<-- <${e}> time: ${s}ms`)}this.traceInitIndent--;return a}else{return t()}}}function applyMixins(e,t){t.forEach((t=>{const r=t.prototype;Object.getOwnPropertyNames(r).forEach((s=>{if(s==="constructor"){return}const a=Object.getOwnPropertyDescriptor(r,s);if(a&&(a.get||a.set)){Object.defineProperty(e.prototype,s,a)}else{e.prototype[s]=t.prototype[s]}}))}))}const Yl=createTokenInstance(ll,"",NaN,NaN,NaN,NaN,NaN,NaN);Object.freeze(Yl);const Ql=Object.freeze({recoveryEnabled:false,maxLookahead:3,dynamicTokensEnabled:false,outputCst:true,errorMessageProvider:cl,nodeLocationTracking:"none",traceInitPerf:false,skipValidations:false});const Jl=Object.freeze({recoveryValueFunc:()=>undefined,resyncEnabled:true});var Zl;(function(e){e[e["INVALID_RULE_NAME"]=0]="INVALID_RULE_NAME";e[e["DUPLICATE_RULE_NAME"]=1]="DUPLICATE_RULE_NAME";e[e["INVALID_RULE_OVERRIDE"]=2]="INVALID_RULE_OVERRIDE";e[e["DUPLICATE_PRODUCTIONS"]=3]="DUPLICATE_PRODUCTIONS";e[e["UNRESOLVED_SUBRULE_REF"]=4]="UNRESOLVED_SUBRULE_REF";e[e["LEFT_RECURSION"]=5]="LEFT_RECURSION";e[e["NONE_LAST_EMPTY_ALT"]=6]="NONE_LAST_EMPTY_ALT";e[e["AMBIGUOUS_ALTS"]=7]="AMBIGUOUS_ALTS";e[e["CONFLICT_TOKENS_RULES_NAMESPACE"]=8]="CONFLICT_TOKENS_RULES_NAMESPACE";e[e["INVALID_TOKEN_NAME"]=9]="INVALID_TOKEN_NAME";e[e["NO_NON_EMPTY_LOOKAHEAD"]=10]="NO_NON_EMPTY_LOOKAHEAD";e[e["AMBIGUOUS_PREFIX_ALTS"]=11]="AMBIGUOUS_PREFIX_ALTS";e[e["TOO_MANY_ALTS"]=12]="TOO_MANY_ALTS";e[e["CUSTOM_LOOKAHEAD_VALIDATION"]=13]="CUSTOM_LOOKAHEAD_VALIDATION"})(Zl||(Zl={}));function EMPTY_ALT(e=undefined){return function(){return e}}class Parser{static performSelfAnalysis(e){throw Error("The **static** `performSelfAnalysis` method has been deprecated."+"\t\nUse the **instance** method with the same name instead.")}performSelfAnalysis(){this.TRACE_INIT("performSelfAnalysis",(()=>{let e;this.selfAnalysisDone=true;const t=this.className;this.TRACE_INIT("toFastProps",(()=>{toFastProperties(this)}));this.TRACE_INIT("Grammar Recording",(()=>{try{this.enableRecording();mt(this.definedRulesNames,(e=>{const t=this[e];const r=t["originalGrammarAction"];let s;this.TRACE_INIT(`${e} Rule`,(()=>{s=this.topLevelRuleRecord(e,r)}));this.gastProductionsCache[e]=s}))}finally{this.disableRecording()}}));let r=[];this.TRACE_INIT("Grammar Resolving",(()=>{r=gast_resolver_public_resolveGrammar({rules:bt(this.gastProductionsCache)});this.definitionErrors=this.definitionErrors.concat(r)}));this.TRACE_INIT("Grammar Validations",(()=>{if(hn(r)&&this.skipValidations===false){const e=gast_resolver_public_validateGrammar({rules:bt(this.gastProductionsCache),tokenTypes:bt(this.tokensMap),errMsgProvider:fl,grammarName:t});const r=validateLookahead({lookaheadStrategy:this.lookaheadStrategy,rules:bt(this.gastProductionsCache),tokenTypes:bt(this.tokensMap),grammarName:t});this.definitionErrors=this.definitionErrors.concat(e,r)}}));if(hn(this.definitionErrors)){if(this.recoveryEnabled){this.TRACE_INIT("computeAllProdsFollows",(()=>{const e=computeAllProdsFollows(bt(this.gastProductionsCache));this.resyncFollows=e}))}this.TRACE_INIT("ComputeLookaheadFunctions",(()=>{var e,t;(t=(e=this.lookaheadStrategy).initialize)===null||t===void 0?void 0:t.call(e,{rules:bt(this.gastProductionsCache)});this.preComputeLookaheadFunctions(bt(this.gastProductionsCache))}))}if(!Parser.DEFER_DEFINITION_ERRORS_HANDLING&&!hn(this.definitionErrors)){e=Mr(this.definitionErrors,(e=>e.message));throw new Error(`Parser Definition Errors detected:\n ${e.join("\n-------------------------------\n")}`)}}))}constructor(e,t){this.definitionErrors=[];this.selfAnalysisDone=false;const r=this;r.initErrorHandler(t);r.initLexerAdapter();r.initLooksAhead(t);r.initRecognizerEngine(e,t);r.initRecoverable(t);r.initTreeBuilder(t);r.initContentAssist();r.initGastRecorder(t);r.initPerformanceTracer(t);if($r(t,"ignoredIssues")){throw new Error("The <ignoredIssues> IParserConfig property has been deprecated.\n\t"+"Please use the <IGNORE_AMBIGUITIES> flag on the relevant DSL method instead.\n\t"+"See: https://chevrotain.io/docs/guide/resolving_grammar_errors.html#IGNORING_AMBIGUITIES\n\t"+"For further details.")}this.skipValidations=$r(t,"skipValidations")?t.skipValidations:Ql.skipValidations}}Parser.DEFER_DEFINITION_ERRORS_HANDLING=false;applyMixins(Parser,[Recoverable,LooksAhead,TreeBuilder,LexerAdapter,RecognizerEngine,RecognizerApi,ErrorHandler,ContentAssist,GastRecorder,PerformanceTracer]);class CstParser extends Parser{constructor(e,t=Ql){const r=Ua(t);r.outputCst=true;super(e,r)}}class EmbeddedActionsParser extends Parser{constructor(e,t=Ql){const r=Ua(t);r.outputCst=false;super(e,r)}}function model_buildModel(e){const t=new CstNodeDefinitionGenerator;const r=values(e);return map(r,(e=>t.visitRule(e)))}class CstNodeDefinitionGenerator extends(null&&GAstVisitor){visitRule(e){const t=this.visitEach(e.definition);const r=groupBy(t,(e=>e.propertyName));const s=map(r,((e,t)=>{const r=!some(e,(e=>!e.canBeNull));let s=e[0].type;if(e.length>1){s=map(e,(e=>e.type))}return{name:t,type:s,optional:r}}));return{name:e.name,properties:s}}visitAlternative(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:true})}visitOption(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:true})}visitRepetition(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:true})}visitRepetitionMandatory(e){return this.visitEach(e.definition)}visitRepetitionMandatoryWithSeparator(e){return this.visitEach(e.definition).concat({propertyName:e.separator.name,canBeNull:true,type:getType(e.separator)})}visitRepetitionWithSeparator(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:true}).concat({propertyName:e.separator.name,canBeNull:true,type:getType(e.separator)})}visitAlternation(e){return this.visitEachAndOverrideWith(e.definition,{canBeNull:true})}visitTerminal(e){return[{propertyName:e.label||e.terminalType.name,canBeNull:false,type:getType(e)}]}visitNonTerminal(e){return[{propertyName:e.label||e.nonTerminalName,canBeNull:false,type:getType(e)}]}visitEachAndOverrideWith(e,t){return map(this.visitEach(e),(e=>assign({},e,t)))}visitEach(e){return flatten(map(e,(e=>this.visit(e))))}}function getType(e){if(e instanceof NonTerminal){return{kind:"rule",name:e.referencedRule.name}}return{kind:"token"}}const ec={includeVisitorInterface:true,visitorInterfaceName:"ICstNodeVisitor"};function generateCstDts(e,t){const r=Object.assign(Object.assign({},ec),t);const s=buildModel(e);return genDts(s,r)}function clearCache(){console.warn("The clearCache function was 'soft' removed from the Chevrotain API."+"\n\t It performs no action other than printing this message."+"\n\t Please avoid using it as it will be completely removed in the future")}class api_Parser{constructor(){throw new Error("The Parser class has been deprecated, use CstParser or EmbeddedActionsParser instead.\t\n"+"See: https://chevrotain.io/docs/changes/BREAKING_CHANGES.html#_7-0-0")}}const tc="\n";function toXml(e,t){let r="";if(t.format&&t.indentBy.length>0){r=tc}return arrToStr(e,t,"",r)}function arrToStr(e,t,r,s){let a="";let u=false;for(let l=0;l<e.length;l++){const h=e[l];const f=propName(h);if(f===undefined)continue;let d="";if(r.length===0)d=f;else d=`${r}.${f}`;if(f===t.textNodeName){let e=h[f];if(!isStopNode(d,t)){e=t.tagValueProcessor(f,e);e=replaceEntitiesValue(e,t)}if(u){a+=s}a+=e;u=false;continue}else if(f===t.cdataPropName){if(u){a+=s}a+=`<![CDATA[${h[f][0][t.textNodeName]}]]>`;u=false;continue}else if(f===t.commentPropName){a+=s+`\x3c!--${h[f][0][t.textNodeName]}--\x3e`;u=true;continue}else if(f[0]==="?"){const e=attr_to_str(h[":@"],t);const r=f==="?xml"?"":s;let l=h[f][0][t.textNodeName];l=l.length!==0?" "+l:"";a+=r+`<${f}${l}${e}?>`;u=true;continue}let _=s;if(_!==""){_+=t.indentBy}const m=attr_to_str(h[":@"],t);const g=s+`<${f}${m}`;const y=arrToStr(h[f],t,d,_);if(t.unpairedTags.indexOf(f)!==-1){if(t.suppressUnpairedNode)a+=g+">";else a+=g+"/>"}else if((!y||y.length===0)&&t.suppressEmptyNode){a+=g+"/>"}else if(y&&y.endsWith(">")){a+=g+`>${y}${s}</${f}>`}else{a+=g+">";if(y&&s!==""&&(y.includes("/>")||y.includes("</"))){a+=s+t.indentBy+y+s}else{a+=y}a+=`</${f}>`}u=true}return a}function propName(e){const t=Object.keys(e);for(let r=0;r<t.length;r++){const s=t[r];if(!e.hasOwnProperty(s))continue;if(s!==":@")return s}}function attr_to_str(e,t){let r="";if(e&&!t.ignoreAttributes){for(let s in e){if(!e.hasOwnProperty(s))continue;let a=t.attributeValueProcessor(s,e[s]);a=replaceEntitiesValue(a,t);if(a===true&&t.suppressBooleanAttributes){r+=` ${s.substr(t.attributeNamePrefix.length)}`}else{r+=` ${s.substr(t.attributeNamePrefix.length)}="${a}"`}}}return r}function isStopNode(e,t){e=e.substr(0,e.length-t.textNodeName.length-1);let r=e.substr(e.lastIndexOf(".")+1);for(let s in t.stopNodes){if(t.stopNodes[s]===e||t.stopNodes[s]==="*."+r)return true}return false}function replaceEntitiesValue(e,t){if(e&&e.length>0&&t.processEntities){for(let r=0;r<t.entities.length;r++){const s=t.entities[r];e=e.replace(s.regex,s.val)}}return e}function getIgnoreAttributesFn(e){if(typeof e==="function"){return e}if(Array.isArray(e)){return t=>{for(const r of e){if(typeof r==="string"&&t===r){return true}if(r instanceof RegExp&&r.test(t)){return true}}}}return()=>false}const nc={attributeNamePrefix:"@_",attributesGroupName:false,textNodeName:"#text",ignoreAttributes:true,cdataPropName:false,format:false,indentBy:"  ",suppressEmptyNode:false,suppressUnpairedNode:true,suppressBooleanAttributes:true,tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},preserveOrder:false,commentPropName:false,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:true,stopNodes:[],oneListGroup:false};function Builder(e){this.options=Object.assign({},nc,e);if(this.options.ignoreAttributes===true||this.options.attributesGroupName){this.isAttribute=function(){return false}}else{this.ignoreAttributesFn=getIgnoreAttributesFn(this.options.ignoreAttributes);this.attrPrefixLen=this.options.attributeNamePrefix.length;this.isAttribute=isAttribute}this.processTextOrObjNode=processTextOrObjNode;if(this.options.format){this.indentate=indentate;this.tagEndChar=">\n";this.newLine="\n"}else{this.indentate=function(){return""};this.tagEndChar=">";this.newLine=""}}Builder.prototype.build=function(e){if(this.options.preserveOrder){return toXml(e,this.options)}else{if(Array.isArray(e)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1){e={[this.options.arrayNodeName]:e}}return this.j2x(e,0,[]).val}};Builder.prototype.j2x=function(e,t,r){let s="";let a="";const u=r.join(".");for(let l in e){if(!Object.prototype.hasOwnProperty.call(e,l))continue;if(typeof e[l]==="undefined"){if(this.isAttribute(l)){a+=""}}else if(e[l]===null){if(this.isAttribute(l)){a+=""}else if(l===this.options.cdataPropName){a+=""}else if(l[0]==="?"){a+=this.indentate(t)+"<"+l+"?"+this.tagEndChar}else{a+=this.indentate(t)+"<"+l+"/"+this.tagEndChar}}else if(e[l]instanceof Date){a+=this.buildTextValNode(e[l],l,"",t)}else if(typeof e[l]!=="object"){const r=this.isAttribute(l);if(r&&!this.ignoreAttributesFn(r,u)){s+=this.buildAttrPairStr(r,""+e[l])}else if(!r){if(l===this.options.textNodeName){let t=this.options.tagValueProcessor(l,""+e[l]);a+=this.replaceEntitiesValue(t)}else{a+=this.buildTextValNode(e[l],l,"",t)}}}else if(Array.isArray(e[l])){const s=e[l].length;let u="";let h="";for(let f=0;f<s;f++){const s=e[l][f];if(typeof s==="undefined"){}else if(s===null){if(l[0]==="?")a+=this.indentate(t)+"<"+l+"?"+this.tagEndChar;else a+=this.indentate(t)+"<"+l+"/"+this.tagEndChar}else if(typeof s==="object"){if(this.options.oneListGroup){const e=this.j2x(s,t+1,r.concat(l));u+=e.val;if(this.options.attributesGroupName&&s.hasOwnProperty(this.options.attributesGroupName)){h+=e.attrStr}}else{u+=this.processTextOrObjNode(s,l,t,r)}}else{if(this.options.oneListGroup){let e=this.options.tagValueProcessor(l,s);e=this.replaceEntitiesValue(e);u+=e}else{u+=this.buildTextValNode(s,l,"",t)}}}if(this.options.oneListGroup){u=this.buildObjectNode(u,l,h,t)}a+=u}else{if(this.options.attributesGroupName&&l===this.options.attributesGroupName){const t=Object.keys(e[l]);const r=t.length;for(let a=0;a<r;a++){s+=this.buildAttrPairStr(t[a],""+e[l][t[a]])}}else{a+=this.processTextOrObjNode(e[l],l,t,r)}}}return{attrStr:s,val:a}};Builder.prototype.buildAttrPairStr=function(e,t){t=this.options.attributeValueProcessor(e,""+t);t=this.replaceEntitiesValue(t);if(this.options.suppressBooleanAttributes&&t==="true"){return" "+e}else return" "+e+'="'+t+'"'};function processTextOrObjNode(e,t,r,s){const a=this.j2x(e,r+1,s.concat(t));if(e[this.options.textNodeName]!==undefined&&Object.keys(e).length===1){return this.buildTextValNode(e[this.options.textNodeName],t,a.attrStr,r)}else{return this.buildObjectNode(a.val,t,a.attrStr,r)}}Builder.prototype.buildObjectNode=function(e,t,r,s){if(e===""){if(t[0]==="?")return this.indentate(s)+"<"+t+r+"?"+this.tagEndChar;else{return this.indentate(s)+"<"+t+r+this.closeTag(t)+this.tagEndChar}}else{let a="</"+t+this.tagEndChar;let u="";if(t[0]==="?"){u="?";a=""}if((r||r==="")&&e.indexOf("<")===-1){return this.indentate(s)+"<"+t+r+u+">"+e+a}else if(this.options.commentPropName!==false&&t===this.options.commentPropName&&u.length===0){return this.indentate(s)+`\x3c!--${e}--\x3e`+this.newLine}else{return this.indentate(s)+"<"+t+r+u+this.tagEndChar+e+this.indentate(s)+a}}};Builder.prototype.closeTag=function(e){let t="";if(this.options.unpairedTags.indexOf(e)!==-1){if(!this.options.suppressUnpairedNode)t="/"}else if(this.options.suppressEmptyNode){t="/"}else{t=`></${e}`}return t};function buildEmptyObjNode(e,t,r,s){if(e!==""){return this.buildObjectNode(e,t,r,s)}else{if(t[0]==="?")return this.indentate(s)+"<"+t+r+"?"+this.tagEndChar;else{return this.indentate(s)+"<"+t+r+"/"+this.tagEndChar}}}Builder.prototype.buildTextValNode=function(e,t,r,s){if(this.options.cdataPropName!==false&&t===this.options.cdataPropName){return this.indentate(s)+`<![CDATA[${e}]]>`+this.newLine}else if(this.options.commentPropName!==false&&t===this.options.commentPropName){return this.indentate(s)+`\x3c!--${e}--\x3e`+this.newLine}else if(t[0]==="?"){return this.indentate(s)+"<"+t+r+"?"+this.tagEndChar}else{let a=this.options.tagValueProcessor(t,e);a=this.replaceEntitiesValue(a);if(a===""){return this.indentate(s)+"<"+t+r+this.closeTag(t)+this.tagEndChar}else{return this.indentate(s)+"<"+t+r+">"+a+"</"+t+this.tagEndChar}}};Builder.prototype.replaceEntitiesValue=function(e){if(e&&e.length>0&&this.options.processEntities){for(let t=0;t<this.options.entities.length;t++){const r=this.options.entities[t];e=e.replace(r.regex,r.val)}}return e};function indentate(e){return this.options.indentBy.repeat(e)}function isAttribute(e){if(e.startsWith(this.options.attributeNamePrefix)&&e!==this.options.textNodeName){return e.substr(this.attrPrefixLen)}else{return false}}const ic={preserveOrder:false,attributeNamePrefix:"@_",attributesGroupName:false,textNodeName:"#text",ignoreAttributes:true,removeNSPrefix:false,allowBooleanAttributes:false,parseTagValue:true,parseAttributeValue:false,trimValues:true,cdataPropName:false,numberParseOptions:{hex:true,leadingZeros:true,eNotation:true},tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},stopNodes:[],alwaysCreateTextNode:false,isArray:()=>false,commentPropName:false,unpairedTags:[],processEntities:true,htmlEntities:false,ignoreDeclaration:false,ignorePiTags:false,transformTagName:false,transformAttributeName:false,updateTag:function(e,t,r){return e},captureMetaData:false};function normalizeProcessEntities(e){if(typeof e==="boolean"){return{enabled:e,maxEntitySize:1e4,maxExpansionDepth:10,maxTotalExpansions:1e3,maxExpandedLength:1e5,allowedTags:null,tagFilter:null}}if(typeof e==="object"&&e!==null){return{enabled:e.enabled!==false,maxEntitySize:e.maxEntitySize??1e4,maxExpansionDepth:e.maxExpansionDepth??10,maxTotalExpansions:e.maxTotalExpansions??1e3,maxExpandedLength:e.maxExpandedLength??1e5,allowedTags:e.allowedTags??null,tagFilter:e.tagFilter??null}}return normalizeProcessEntities(true)}const buildOptions=function(e){const t=Object.assign({},ic,e);t.processEntities=normalizeProcessEntities(t.processEntities);return t};const rc=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD";const sc=rc+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040";const ac="["+rc+"]["+sc+"]*";const oc=new RegExp("^"+ac+"$");function getAllMatches(e,t){const r=[];let s=t.exec(e);while(s){const a=[];a.startIndex=t.lastIndex-s[0].length;const u=s.length;for(let e=0;e<u;e++){a.push(s[e])}r.push(a);s=t.exec(e)}return r}const isName=function(e){const t=oc.exec(e);return!(t===null||typeof t==="undefined")};function isExist(e){return typeof e!=="undefined"}function isEmptyObject(e){return Object.keys(e).length===0}function merge(e,t,r){if(t){const s=Object.keys(t);const a=s.length;for(let u=0;u<a;u++){if(r==="strict"){e[s[u]]=[t[s[u]]]}else{e[s[u]]=t[s[u]]}}}}function util_getValue(e){if(exports.isExist(e)){return e}else{return""}}let uc;if(typeof Symbol!=="function"){uc="@@xmlMetadata"}else{uc=Symbol("XML Node Metadata")}class XmlNode{constructor(e){this.tagname=e;this.child=[];this[":@"]={}}add(e,t){if(e==="__proto__")e="#__proto__";this.child.push({[e]:t})}addChild(e,t){if(e.tagname==="__proto__")e.tagname="#__proto__";if(e[":@"]&&Object.keys(e[":@"]).length>0){this.child.push({[e.tagname]:e.child,[":@"]:e[":@"]})}else{this.child.push({[e.tagname]:e.child})}if(t!==undefined){this.child[this.child.length-1][uc]={startIndex:t}}}static getMetaDataSymbol(){return uc}}class DocTypeReader{constructor(e){this.suppressValidationErr=!e;this.options=e}readDocType(e,t){const r={};if(e[t+3]==="O"&&e[t+4]==="C"&&e[t+5]==="T"&&e[t+6]==="Y"&&e[t+7]==="P"&&e[t+8]==="E"){t=t+9;let s=1;let a=false,u=false;let l="";for(;t<e.length;t++){if(e[t]==="<"&&!u){if(a&&hasSeq(e,"!ENTITY",t)){t+=7;let s,a;[s,a,t]=this.readEntityExp(e,t+1,this.suppressValidationErr);if(a.indexOf("&")===-1){const e=s.replace(/[.\-+*:]/g,"\\.");r[s]={regx:RegExp(`&${e};`,"g"),val:a}}}else if(a&&hasSeq(e,"!ELEMENT",t)){t+=8;const{index:r}=this.readElementExp(e,t+1);t=r}else if(a&&hasSeq(e,"!ATTLIST",t)){t+=8}else if(a&&hasSeq(e,"!NOTATION",t)){t+=9;const{index:r}=this.readNotationExp(e,t+1,this.suppressValidationErr);t=r}else if(hasSeq(e,"!--",t))u=true;else throw new Error(`Invalid DOCTYPE`);s++;l=""}else if(e[t]===">"){if(u){if(e[t-1]==="-"&&e[t-2]==="-"){u=false;s--}}else{s--}if(s===0){break}}else if(e[t]==="["){a=true}else{l+=e[t]}}if(s!==0){throw new Error(`Unclosed DOCTYPE`)}}else{throw new Error(`Invalid Tag instead of DOCTYPE`)}return{entities:r,i:t}}readEntityExp(e,t){t=skipWhitespace(e,t);let r="";while(t<e.length&&!/\s/.test(e[t])&&e[t]!=='"'&&e[t]!=="'"){r+=e[t];t++}validateEntityName(r);t=skipWhitespace(e,t);if(!this.suppressValidationErr){if(e.substring(t,t+6).toUpperCase()==="SYSTEM"){throw new Error("External entities are not supported")}else if(e[t]==="%"){throw new Error("Parameter entities are not supported")}}let s="";[t,s]=this.readIdentifierVal(e,t,"entity");if(this.options.enabled!==false&&this.options.maxEntitySize&&s.length>this.options.maxEntitySize){throw new Error(`Entity "${r}" size (${s.length}) exceeds maximum allowed size (${this.options.maxEntitySize})`)}t--;return[r,s,t]}readNotationExp(e,t){t=skipWhitespace(e,t);let r="";while(t<e.length&&!/\s/.test(e[t])){r+=e[t];t++}!this.suppressValidationErr&&validateEntityName(r);t=skipWhitespace(e,t);const s=e.substring(t,t+6).toUpperCase();if(!this.suppressValidationErr&&s!=="SYSTEM"&&s!=="PUBLIC"){throw new Error(`Expected SYSTEM or PUBLIC, found "${s}"`)}t+=s.length;t=skipWhitespace(e,t);let a=null;let u=null;if(s==="PUBLIC"){[t,a]=this.readIdentifierVal(e,t,"publicIdentifier");t=skipWhitespace(e,t);if(e[t]==='"'||e[t]==="'"){[t,u]=this.readIdentifierVal(e,t,"systemIdentifier")}}else if(s==="SYSTEM"){[t,u]=this.readIdentifierVal(e,t,"systemIdentifier");if(!this.suppressValidationErr&&!u){throw new Error("Missing mandatory system identifier for SYSTEM notation")}}return{notationName:r,publicIdentifier:a,systemIdentifier:u,index:--t}}readIdentifierVal(e,t,r){let s="";const a=e[t];if(a!=='"'&&a!=="'"){throw new Error(`Expected quoted string, found "${a}"`)}t++;while(t<e.length&&e[t]!==a){s+=e[t];t++}if(e[t]!==a){throw new Error(`Unterminated ${r} value`)}t++;return[t,s]}readElementExp(e,t){t=skipWhitespace(e,t);let r="";while(t<e.length&&!/\s/.test(e[t])){r+=e[t];t++}if(!this.suppressValidationErr&&!isName(r)){throw new Error(`Invalid element name: "${r}"`)}t=skipWhitespace(e,t);let s="";if(e[t]==="E"&&hasSeq(e,"MPTY",t))t+=4;else if(e[t]==="A"&&hasSeq(e,"NY",t))t+=2;else if(e[t]==="("){t++;while(t<e.length&&e[t]!==")"){s+=e[t];t++}if(e[t]!==")"){throw new Error("Unterminated content model")}}else if(!this.suppressValidationErr){throw new Error(`Invalid Element Expression, found "${e[t]}"`)}return{elementName:r,contentModel:s.trim(),index:t}}readAttlistExp(e,t){t=skipWhitespace(e,t);let r="";while(t<e.length&&!/\s/.test(e[t])){r+=e[t];t++}validateEntityName(r);t=skipWhitespace(e,t);let s="";while(t<e.length&&!/\s/.test(e[t])){s+=e[t];t++}if(!validateEntityName(s)){throw new Error(`Invalid attribute name: "${s}"`)}t=skipWhitespace(e,t);let a="";if(e.substring(t,t+8).toUpperCase()==="NOTATION"){a="NOTATION";t+=8;t=skipWhitespace(e,t);if(e[t]!=="("){throw new Error(`Expected '(', found "${e[t]}"`)}t++;let r=[];while(t<e.length&&e[t]!==")"){let s="";while(t<e.length&&e[t]!=="|"&&e[t]!==")"){s+=e[t];t++}s=s.trim();if(!validateEntityName(s)){throw new Error(`Invalid notation name: "${s}"`)}r.push(s);if(e[t]==="|"){t++;t=skipWhitespace(e,t)}}if(e[t]!==")"){throw new Error("Unterminated list of notations")}t++;a+=" ("+r.join("|")+")"}else{while(t<e.length&&!/\s/.test(e[t])){a+=e[t];t++}const r=["CDATA","ID","IDREF","IDREFS","ENTITY","ENTITIES","NMTOKEN","NMTOKENS"];if(!this.suppressValidationErr&&!r.includes(a.toUpperCase())){throw new Error(`Invalid attribute type: "${a}"`)}}t=skipWhitespace(e,t);let u="";if(e.substring(t,t+8).toUpperCase()==="#REQUIRED"){u="#REQUIRED";t+=8}else if(e.substring(t,t+7).toUpperCase()==="#IMPLIED"){u="#IMPLIED";t+=7}else{[t,u]=this.readIdentifierVal(e,t,"ATTLIST")}return{elementName:r,attributeName:s,attributeType:a,defaultValue:u,index:t}}}const skipWhitespace=(e,t)=>{while(t<e.length&&/\s/.test(e[t])){t++}return t};function hasSeq(e,t,r){for(let s=0;s<t.length;s++){if(t[s]!==e[r+s+1])return false}return true}function validateEntityName(e){if(isName(e))return e;else throw new Error(`Invalid entity name ${e}`)}const lc=/^[-+]?0x[a-fA-F0-9]+$/;const hc=/^([\-\+])?(0*)([0-9]*(\.[0-9]*)?)$/;const fc={hex:true,leadingZeros:true,decimalPoint:".",eNotation:true};function strnum_toNumber(e,t={}){t=Object.assign({},fc,t);if(!e||typeof e!=="string")return e;let r=e.trim();if(t.skipLike!==undefined&&t.skipLike.test(r))return e;else if(e==="0")return 0;else if(t.hex&&lc.test(r)){return parse_int(r,16)}else if(r.includes("e")||r.includes("E")){return resolveEnotation(e,r,t)}else{const s=hc.exec(r);if(s){const a=s[1]||"";const u=s[2];let l=trimZeros(s[3]);const h=a?e[u.length+1]===".":e[u.length]===".";if(!t.leadingZeros&&(u.length>1||u.length===1&&!h)){return e}else{const s=Number(r);const h=String(s);if(s===0)return s;if(h.search(/[eE]/)!==-1){if(t.eNotation)return s;else return e}else if(r.indexOf(".")!==-1){if(h==="0")return s;else if(h===l)return s;else if(h===`${a}${l}`)return s;else return e}let f=u?l:r;if(u){return f===h||a+f===h?s:e}else{return f===h||f===a+h?s:e}}}else{return e}}}const pc=/^([-+])?(0*)(\d*(\.\d*)?[eE][-\+]?\d+)$/;function resolveEnotation(e,t,r){if(!r.eNotation)return e;const s=t.match(pc);if(s){let a=s[1]||"";const u=s[3].indexOf("e")===-1?"E":"e";const l=s[2];const h=a?e[l.length+1]===u:e[l.length]===u;if(l.length>1&&h)return e;else if(l.length===1&&(s[3].startsWith(`.${u}`)||s[3][0]===u)){return Number(t)}else if(r.leadingZeros&&!h){t=(s[1]||"")+s[3];return Number(t)}else return e}else{return e}}function trimZeros(e){if(e&&e.indexOf(".")!==-1){e=e.replace(/0+$/,"");if(e===".")e="0";else if(e[0]===".")e="0"+e;else if(e[e.length-1]===".")e=e.substring(0,e.length-1);return e}return e}function parse_int(e,t){if(parseInt)return parseInt(e,t);else if(Number.parseInt)return Number.parseInt(e,t);else if(window&&window.parseInt)return window.parseInt(e,t);else throw new Error("parseInt, Number.parseInt, window.parseInt are not supported")}class OrderedObjParser{constructor(e){this.options=e;this.currentNode=null;this.tagsNodeStack=[];this.docTypeEntities={};this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}};this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"};this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:""},pound:{regex:/&(pound|#163);/g,val:""},yen:{regex:/&(yen|#165);/g,val:""},euro:{regex:/&(euro|#8364);/g,val:""},copyright:{regex:/&(copy|#169);/g,val:""},reg:{regex:/&(reg|#174);/g,val:""},inr:{regex:/&(inr|#8377);/g,val:""},num_dec:{regex:/&#([0-9]{1,7});/g,val:(e,t)=>fromCodePoint(t,10,"&#")},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(e,t)=>fromCodePoint(t,16,"&#x")}};this.addExternalEntities=addExternalEntities;this.parseXml=parseXml;this.parseTextData=parseTextData;this.resolveNameSpace=resolveNameSpace;this.buildAttributesMap=buildAttributesMap;this.isItStopNode=isItStopNode;this.replaceEntitiesValue=OrderedObjParser_replaceEntitiesValue;this.readStopNodeData=readStopNodeData;this.saveTextToParentTag=saveTextToParentTag;this.addChild=addChild;this.ignoreAttributesFn=getIgnoreAttributesFn(this.options.ignoreAttributes);this.entityExpansionCount=0;this.currentExpandedLength=0;if(this.options.stopNodes&&this.options.stopNodes.length>0){this.stopNodesExact=new Set;this.stopNodesWildcard=new Set;for(let e=0;e<this.options.stopNodes.length;e++){const t=this.options.stopNodes[e];if(typeof t!=="string")continue;if(t.startsWith("*.")){this.stopNodesWildcard.add(t.substring(2))}else{this.stopNodesExact.add(t)}}}}}function addExternalEntities(e){const t=Object.keys(e);for(let r=0;r<t.length;r++){const s=t[r];const a=s.replace(/[.\-+*:]/g,"\\.");this.lastEntities[s]={regex:new RegExp("&"+a+";","g"),val:e[s]}}}function parseTextData(e,t,r,s,a,u,l){if(e!==undefined){if(this.options.trimValues&&!s){e=e.trim()}if(e.length>0){if(!l)e=this.replaceEntitiesValue(e,t,r);const s=this.options.tagValueProcessor(t,e,r,a,u);if(s===null||s===undefined){return e}else if(typeof s!==typeof e||s!==e){return s}else if(this.options.trimValues){return parseValue(e,this.options.parseTagValue,this.options.numberParseOptions)}else{const t=e.trim();if(t===e){return parseValue(e,this.options.parseTagValue,this.options.numberParseOptions)}else{return e}}}}}function resolveNameSpace(e){if(this.options.removeNSPrefix){const t=e.split(":");const r=e.charAt(0)==="/"?"/":"";if(t[0]==="xmlns"){return""}if(t.length===2){e=r+t[1]}}return e}const dc=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm");function buildAttributesMap(e,t,r){if(this.options.ignoreAttributes!==true&&typeof e==="string"){const s=getAllMatches(e,dc);const a=s.length;const u={};for(let e=0;e<a;e++){const a=this.resolveNameSpace(s[e][1]);if(this.ignoreAttributesFn(a,t)){continue}let l=s[e][4];let h=this.options.attributeNamePrefix+a;if(a.length){if(this.options.transformAttributeName){h=this.options.transformAttributeName(h)}if(h==="__proto__")h="#__proto__";if(l!==undefined){if(this.options.trimValues){l=l.trim()}l=this.replaceEntitiesValue(l,r,t);const e=this.options.attributeValueProcessor(a,l,t);if(e===null||e===undefined){u[h]=l}else if(typeof e!==typeof l||e!==l){u[h]=e}else{u[h]=parseValue(l,this.options.parseAttributeValue,this.options.numberParseOptions)}}else if(this.options.allowBooleanAttributes){u[h]=true}}}if(!Object.keys(u).length){return}if(this.options.attributesGroupName){const e={};e[this.options.attributesGroupName]=u;return e}return u}}const parseXml=function(e){e=e.replace(/\r\n?/g,"\n");const t=new XmlNode("!xml");let r=t;let s="";let a="";this.entityExpansionCount=0;this.currentExpandedLength=0;const u=new DocTypeReader(this.options.processEntities);for(let l=0;l<e.length;l++){const h=e[l];if(h==="<"){if(e[l+1]==="/"){const t=findClosingIndex(e,">",l,"Closing Tag is not closed.");let u=e.substring(l+2,t).trim();if(this.options.removeNSPrefix){const e=u.indexOf(":");if(e!==-1){u=u.substr(e+1)}}if(this.options.transformTagName){u=this.options.transformTagName(u)}if(r){s=this.saveTextToParentTag(s,r,a)}const h=a.substring(a.lastIndexOf(".")+1);if(u&&this.options.unpairedTags.indexOf(u)!==-1){throw new Error(`Unpaired tag can not be used as closing tag: </${u}>`)}let f=0;if(h&&this.options.unpairedTags.indexOf(h)!==-1){f=a.lastIndexOf(".",a.lastIndexOf(".")-1);this.tagsNodeStack.pop()}else{f=a.lastIndexOf(".")}a=a.substring(0,f);r=this.tagsNodeStack.pop();s="";l=t}else if(e[l+1]==="?"){let t=readTagExp(e,l,false,"?>");if(!t)throw new Error("Pi Tag is not closed.");s=this.saveTextToParentTag(s,r,a);if(this.options.ignoreDeclaration&&t.tagName==="?xml"||this.options.ignorePiTags){}else{const e=new XmlNode(t.tagName);e.add(this.options.textNodeName,"");if(t.tagName!==t.tagExp&&t.attrExpPresent){e[":@"]=this.buildAttributesMap(t.tagExp,a,t.tagName)}this.addChild(r,e,a,l)}l=t.closeIndex+1}else if(e.substr(l+1,3)==="!--"){const t=findClosingIndex(e,"--\x3e",l+4,"Comment is not closed.");if(this.options.commentPropName){const u=e.substring(l+4,t-2);s=this.saveTextToParentTag(s,r,a);r.add(this.options.commentPropName,[{[this.options.textNodeName]:u}])}l=t}else if(e.substr(l+1,2)==="!D"){const t=u.readDocType(e,l);this.docTypeEntities=t.entities;l=t.i}else if(e.substr(l+1,2)==="!["){const t=findClosingIndex(e,"]]>",l,"CDATA is not closed.")-2;const u=e.substring(l+9,t);s=this.saveTextToParentTag(s,r,a);let h=this.parseTextData(u,r.tagname,a,true,false,true,true);if(h==undefined)h="";if(this.options.cdataPropName){r.add(this.options.cdataPropName,[{[this.options.textNodeName]:u}])}else{r.add(this.options.textNodeName,h)}l=t+2}else{let u=readTagExp(e,l,this.options.removeNSPrefix);let h=u.tagName;const f=u.rawTagName;let d=u.tagExp;let _=u.attrExpPresent;let m=u.closeIndex;if(this.options.transformTagName){const e=this.options.transformTagName(h);if(d===h){d=e}h=e}if(r&&s){if(r.tagname!=="!xml"){s=this.saveTextToParentTag(s,r,a,false)}}const g=r;if(g&&this.options.unpairedTags.indexOf(g.tagname)!==-1){r=this.tagsNodeStack.pop();a=a.substring(0,a.lastIndexOf("."))}if(h!==t.tagname){a+=a?"."+h:h}const y=l;if(this.isItStopNode(this.stopNodesExact,this.stopNodesWildcard,a,h)){let t="";if(d.length>0&&d.lastIndexOf("/")===d.length-1){if(h[h.length-1]==="/"){h=h.substr(0,h.length-1);a=a.substr(0,a.length-1);d=h}else{d=d.substr(0,d.length-1)}l=u.closeIndex}else if(this.options.unpairedTags.indexOf(h)!==-1){l=u.closeIndex}else{const r=this.readStopNodeData(e,f,m+1);if(!r)throw new Error(`Unexpected end of ${f}`);l=r.i;t=r.tagContent}const s=new XmlNode(h);if(h!==d&&_){s[":@"]=this.buildAttributesMap(d,a,h)}if(t){t=this.parseTextData(t,h,a,true,_,true,true)}a=a.substr(0,a.lastIndexOf("."));s.add(this.options.textNodeName,t);this.addChild(r,s,a,y)}else{if(d.length>0&&d.lastIndexOf("/")===d.length-1){if(h[h.length-1]==="/"){h=h.substr(0,h.length-1);a=a.substr(0,a.length-1);d=h}else{d=d.substr(0,d.length-1)}if(this.options.transformTagName){const e=this.options.transformTagName(h);if(d===h){d=e}h=e}const e=new XmlNode(h);if(h!==d&&_){e[":@"]=this.buildAttributesMap(d,a,h)}this.addChild(r,e,a,y);a=a.substr(0,a.lastIndexOf("."))}else{const e=new XmlNode(h);this.tagsNodeStack.push(r);if(h!==d&&_){e[":@"]=this.buildAttributesMap(d,a,h)}this.addChild(r,e,a,y);r=e}s="";l=m}}}else{s+=e[l]}}return t.child};function addChild(e,t,r,s){if(!this.options.captureMetaData)s=undefined;const a=this.options.updateTag(t.tagname,r,t[":@"]);if(a===false){}else if(typeof a==="string"){t.tagname=a;e.addChild(t,s)}else{e.addChild(t,s)}}const OrderedObjParser_replaceEntitiesValue=function(e,t,r){if(e.indexOf("&")===-1){return e}const s=this.options.processEntities;if(!s.enabled){return e}if(s.allowedTags){if(!s.allowedTags.includes(t)){return e}}if(s.tagFilter){if(!s.tagFilter(t,r)){return e}}for(let t in this.docTypeEntities){const r=this.docTypeEntities[t];const a=e.match(r.regx);if(a){this.entityExpansionCount+=a.length;if(s.maxTotalExpansions&&this.entityExpansionCount>s.maxTotalExpansions){throw new Error(`Entity expansion limit exceeded: ${this.entityExpansionCount} > ${s.maxTotalExpansions}`)}const t=e.length;e=e.replace(r.regx,r.val);if(s.maxExpandedLength){this.currentExpandedLength+=e.length-t;if(this.currentExpandedLength>s.maxExpandedLength){throw new Error(`Total expanded content size exceeded: ${this.currentExpandedLength} > ${s.maxExpandedLength}`)}}}}if(e.indexOf("&")===-1)return e;for(let t in this.lastEntities){const r=this.lastEntities[t];e=e.replace(r.regex,r.val)}if(e.indexOf("&")===-1)return e;if(this.options.htmlEntities){for(let t in this.htmlEntities){const r=this.htmlEntities[t];e=e.replace(r.regex,r.val)}}e=e.replace(this.ampEntity.regex,this.ampEntity.val);return e};function saveTextToParentTag(e,t,r,s){if(e){if(s===undefined)s=t.child.length===0;e=this.parseTextData(e,t.tagname,r,false,t[":@"]?Object.keys(t[":@"]).length!==0:false,s);if(e!==undefined&&e!=="")t.add(this.options.textNodeName,e);e=""}return e}function isItStopNode(e,t,r,s){if(t&&t.has(s))return true;if(e&&e.has(r))return true;return false}function tagExpWithClosingIndex(e,t,r=">"){let s;let a="";for(let u=t;u<e.length;u++){let t=e[u];if(s){if(t===s)s=""}else if(t==='"'||t==="'"){s=t}else if(t===r[0]){if(r[1]){if(e[u+1]===r[1]){return{data:a,index:u}}}else{return{data:a,index:u}}}else if(t==="\t"){t=" "}a+=t}}function findClosingIndex(e,t,r,s){const a=e.indexOf(t,r);if(a===-1){throw new Error(s)}else{return a+t.length-1}}function readTagExp(e,t,r,s=">"){const a=tagExpWithClosingIndex(e,t+1,s);if(!a)return;let u=a.data;const l=a.index;const h=u.search(/\s/);let f=u;let d=true;if(h!==-1){f=u.substring(0,h);u=u.substring(h+1).trimStart()}const _=f;if(r){const e=f.indexOf(":");if(e!==-1){f=f.substr(e+1);d=f!==a.data.substr(e+1)}}return{tagName:f,tagExp:u,closeIndex:l,attrExpPresent:d,rawTagName:_}}function readStopNodeData(e,t,r){const s=r;let a=1;for(;r<e.length;r++){if(e[r]==="<"){if(e[r+1]==="/"){const u=findClosingIndex(e,">",r,`${t} is not closed`);let l=e.substring(r+2,u).trim();if(l===t){a--;if(a===0){return{tagContent:e.substring(s,r),i:u}}}r=u}else if(e[r+1]==="?"){const t=findClosingIndex(e,"?>",r+1,"StopNode is not closed.");r=t}else if(e.substr(r+1,3)==="!--"){const t=findClosingIndex(e,"--\x3e",r+3,"StopNode is not closed.");r=t}else if(e.substr(r+1,2)==="!["){const t=findClosingIndex(e,"]]>",r,"StopNode is not closed.")-2;r=t}else{const s=readTagExp(e,r,">");if(s){const e=s&&s.tagName;if(e===t&&s.tagExp[s.tagExp.length-1]!=="/"){a++}r=s.closeIndex}}}}}function parseValue(e,t,r){if(t&&typeof e==="string"){const t=e.trim();if(t==="true")return true;else if(t==="false")return false;else return strnum_toNumber(e,r)}else{if(isExist(e)){return e}else{return""}}}function fromCodePoint(e,t,r){const s=Number.parseInt(e,t);if(s>=0&&s<=1114111){return String.fromCodePoint(s)}else{return r+e+";"}}const _c=XmlNode.getMetaDataSymbol();function prettify(e,t){return compress(e,t)}function compress(e,t,r){let s;const a={};for(let u=0;u<e.length;u++){const l=e[u];const h=node2json_propName(l);let f="";if(r===undefined)f=h;else f=r+"."+h;if(h===t.textNodeName){if(s===undefined)s=l[h];else s+=""+l[h]}else if(h===undefined){continue}else if(l[h]){let e=compress(l[h],t,f);const r=isLeafTag(e,t);if(l[_c]!==undefined){e[_c]=l[_c]}if(l[":@"]){assignAttributes(e,l[":@"],f,t)}else if(Object.keys(e).length===1&&e[t.textNodeName]!==undefined&&!t.alwaysCreateTextNode){e=e[t.textNodeName]}else if(Object.keys(e).length===0){if(t.alwaysCreateTextNode)e[t.textNodeName]="";else e=""}if(a[h]!==undefined&&a.hasOwnProperty(h)){if(!Array.isArray(a[h])){a[h]=[a[h]]}a[h].push(e)}else{if(t.isArray(h,f,r)){a[h]=[e]}else{a[h]=e}}}}if(typeof s==="string"){if(s.length>0)a[t.textNodeName]=s}else if(s!==undefined)a[t.textNodeName]=s;return a}function node2json_propName(e){const t=Object.keys(e);for(let e=0;e<t.length;e++){const r=t[e];if(r!==":@")return r}}function assignAttributes(e,t,r,s){if(t){const a=Object.keys(t);const u=a.length;for(let l=0;l<u;l++){const u=a[l];if(s.isArray(u,r+"."+u,true,true)){e[u]=[t[u]]}else{e[u]=t[u]}}}}function isLeafTag(e,t){const{textNodeName:r}=t;const s=Object.keys(e).length;if(s===0){return true}if(s===1&&(e[r]||typeof e[r]==="boolean"||e[r]===0)){return true}return false}const mc={allowBooleanAttributes:false,unpairedTags:[]};function validate(e,t){t=Object.assign({},mc,t);const r=[];let s=false;let a=false;if(e[0]==="\ufeff"){e=e.substr(1)}for(let u=0;u<e.length;u++){if(e[u]==="<"&&e[u+1]==="?"){u+=2;u=readPI(e,u);if(u.err)return u}else if(e[u]==="<"){let l=u;u++;if(e[u]==="!"){u=readCommentAndCDATA(e,u);continue}else{let h=false;if(e[u]==="/"){h=true;u++}let f="";for(;u<e.length&&e[u]!==">"&&e[u]!==" "&&e[u]!=="\t"&&e[u]!=="\n"&&e[u]!=="\r";u++){f+=e[u]}f=f.trim();if(f[f.length-1]==="/"){f=f.substring(0,f.length-1);u--}if(!validateTagName(f)){let t;if(f.trim().length===0){t="Invalid space after '<'."}else{t="Tag '"+f+"' is an invalid name."}return getErrorObject("InvalidTag",t,getLineNumberForPosition(e,u))}const d=readAttributeStr(e,u);if(d===false){return getErrorObject("InvalidAttr","Attributes for '"+f+"' have open quote.",getLineNumberForPosition(e,u))}let _=d.value;u=d.index;if(_[_.length-1]==="/"){const r=u-_.length;_=_.substring(0,_.length-1);const a=validateAttributeString(_,t);if(a===true){s=true}else{return getErrorObject(a.err.code,a.err.msg,getLineNumberForPosition(e,r+a.err.line))}}else if(h){if(!d.tagClosed){return getErrorObject("InvalidTag","Closing tag '"+f+"' doesn't have proper closing.",getLineNumberForPosition(e,u))}else if(_.trim().length>0){return getErrorObject("InvalidTag","Closing tag '"+f+"' can't have attributes or invalid starting.",getLineNumberForPosition(e,l))}else if(r.length===0){return getErrorObject("InvalidTag","Closing tag '"+f+"' has not been opened.",getLineNumberForPosition(e,l))}else{const t=r.pop();if(f!==t.tagName){let r=getLineNumberForPosition(e,t.tagStartPos);return getErrorObject("InvalidTag","Expected closing tag '"+t.tagName+"' (opened in line "+r.line+", col "+r.col+") instead of closing tag '"+f+"'.",getLineNumberForPosition(e,l))}if(r.length==0){a=true}}}else{const h=validateAttributeString(_,t);if(h!==true){return getErrorObject(h.err.code,h.err.msg,getLineNumberForPosition(e,u-_.length+h.err.line))}if(a===true){return getErrorObject("InvalidXml","Multiple possible root nodes found.",getLineNumberForPosition(e,u))}else if(t.unpairedTags.indexOf(f)!==-1){}else{r.push({tagName:f,tagStartPos:l})}s=true}for(u++;u<e.length;u++){if(e[u]==="<"){if(e[u+1]==="!"){u++;u=readCommentAndCDATA(e,u);continue}else if(e[u+1]==="?"){u=readPI(e,++u);if(u.err)return u}else{break}}else if(e[u]==="&"){const t=validateAmpersand(e,u);if(t==-1)return getErrorObject("InvalidChar","char '&' is not expected.",getLineNumberForPosition(e,u));u=t}else{if(a===true&&!isWhiteSpace(e[u])){return getErrorObject("InvalidXml","Extra text at the end",getLineNumberForPosition(e,u))}}}if(e[u]==="<"){u--}}}else{if(isWhiteSpace(e[u])){continue}return getErrorObject("InvalidChar","char '"+e[u]+"' is not expected.",getLineNumberForPosition(e,u))}}if(!s){return getErrorObject("InvalidXml","Start tag expected.",1)}else if(r.length==1){return getErrorObject("InvalidTag","Unclosed tag '"+r[0].tagName+"'.",getLineNumberForPosition(e,r[0].tagStartPos))}else if(r.length>0){return getErrorObject("InvalidXml","Invalid '"+JSON.stringify(r.map((e=>e.tagName)),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1})}return true}function isWhiteSpace(e){return e===" "||e==="\t"||e==="\n"||e==="\r"}function readPI(e,t){const r=t;for(;t<e.length;t++){if(e[t]=="?"||e[t]==" "){const s=e.substr(r,t-r);if(t>5&&s==="xml"){return getErrorObject("InvalidXml","XML declaration allowed only at the start of the document.",getLineNumberForPosition(e,t))}else if(e[t]=="?"&&e[t+1]==">"){t++;break}else{continue}}}return t}function readCommentAndCDATA(e,t){if(e.length>t+5&&e[t+1]==="-"&&e[t+2]==="-"){for(t+=3;t<e.length;t++){if(e[t]==="-"&&e[t+1]==="-"&&e[t+2]===">"){t+=2;break}}}else if(e.length>t+8&&e[t+1]==="D"&&e[t+2]==="O"&&e[t+3]==="C"&&e[t+4]==="T"&&e[t+5]==="Y"&&e[t+6]==="P"&&e[t+7]==="E"){let r=1;for(t+=8;t<e.length;t++){if(e[t]==="<"){r++}else if(e[t]===">"){r--;if(r===0){break}}}}else if(e.length>t+9&&e[t+1]==="["&&e[t+2]==="C"&&e[t+3]==="D"&&e[t+4]==="A"&&e[t+5]==="T"&&e[t+6]==="A"&&e[t+7]==="["){for(t+=8;t<e.length;t++){if(e[t]==="]"&&e[t+1]==="]"&&e[t+2]===">"){t+=2;break}}}return t}const gc='"';const yc="'";function readAttributeStr(e,t){let r="";let s="";let a=false;for(;t<e.length;t++){if(e[t]===gc||e[t]===yc){if(s===""){s=e[t]}else if(s!==e[t]){}else{s=""}}else if(e[t]===">"){if(s===""){a=true;break}}r+=e[t]}if(s!==""){return false}return{value:r,index:t,tagClosed:a}}const bc=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function validateAttributeString(e,t){const r=getAllMatches(e,bc);const s={};for(let e=0;e<r.length;e++){if(r[e][1].length===0){return getErrorObject("InvalidAttr","Attribute '"+r[e][2]+"' has no space in starting.",getPositionFromMatch(r[e]))}else if(r[e][3]!==undefined&&r[e][4]===undefined){return getErrorObject("InvalidAttr","Attribute '"+r[e][2]+"' is without value.",getPositionFromMatch(r[e]))}else if(r[e][3]===undefined&&!t.allowBooleanAttributes){return getErrorObject("InvalidAttr","boolean attribute '"+r[e][2]+"' is not allowed.",getPositionFromMatch(r[e]))}const a=r[e][2];if(!validateAttrName(a)){return getErrorObject("InvalidAttr","Attribute '"+a+"' is an invalid name.",getPositionFromMatch(r[e]))}if(!s.hasOwnProperty(a)){s[a]=1}else{return getErrorObject("InvalidAttr","Attribute '"+a+"' is repeated.",getPositionFromMatch(r[e]))}}return true}function validateNumberAmpersand(e,t){let r=/\d/;if(e[t]==="x"){t++;r=/[\da-fA-F]/}for(;t<e.length;t++){if(e[t]===";")return t;if(!e[t].match(r))break}return-1}function validateAmpersand(e,t){t++;if(e[t]===";")return-1;if(e[t]==="#"){t++;return validateNumberAmpersand(e,t)}let r=0;for(;t<e.length;t++,r++){if(e[t].match(/\w/)&&r<20)continue;if(e[t]===";")break;return-1}return t}function getErrorObject(e,t,r){return{err:{code:e,msg:t,line:r.line||r,col:r.col}}}function validateAttrName(e){return isName(e)}function validateTagName(e){return isName(e)}function getLineNumberForPosition(e,t){const r=e.substring(0,t).split(/\r?\n/);return{line:r.length,col:r[r.length-1].length+1}}function getPositionFromMatch(e){return e.startIndex+e[1].length}class XMLParser{constructor(e){this.externalEntities={};this.options=buildOptions(e)}parse(e,t){if(typeof e!=="string"&&e.toString){e=e.toString()}else if(typeof e!=="string"){throw new Error("XML data is accepted in String or Bytes[] form.")}if(t){if(t===true)t={};const r=validate(e,t);if(r!==true){throw Error(`${r.err.msg}:${r.err.line}:${r.err.col}`)}}const r=new OrderedObjParser(this.options);r.addExternalEntities(this.externalEntities);const s=r.parseXml(e);if(this.options.preserveOrder||s===undefined)return s;else return prettify(s,this.options)}addEntity(e,t){if(t.indexOf("&")!==-1){throw new Error("Entity value can't have '&'")}else if(e.indexOf("&")!==-1||e.indexOf(";")!==-1){throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'")}else if(t==="&"){throw new Error("An entity with value '&' is not permitted")}else{this.externalEntities[e]=t}}static getMetaDataSymbol(){return XmlNode.getMetaDataSymbol()}}var vc=__nccwpck_require__(299);var Ec=__nccwpck_require__(54);var Tc=createToken({name:"WhiteSpace",pattern:/\s+/,group:Lexer.SKIPPED}),kc=createToken({name:"LineComment",pattern:/\/\/[^\n\r]*/,group:Lexer.SKIPPED}),xc=createToken({name:"BlockComment",pattern:/\/\*[\s\S]*?\*\//,group:Lexer.SKIPPED}),Oc=createToken({name:"Identifier",pattern:/[a-zA-Z_$][a-zA-Z0-9_.[\]]*/}),Ac=createToken({name:"QuotedIdentifier",pattern:/`([^`\\]|\\.)*`/}),wc=createToken({name:"From",pattern:/from/i,longer_alt:Oc}),Sc=createToken({name:"To",pattern:/to/i,longer_alt:Oc}),Nc=createToken({name:"Transform",pattern:/transform/i,longer_alt:Oc}),Rc=createToken({name:"Set",pattern:/set/i,longer_alt:Oc}),Cc=createToken({name:"Section",pattern:/section/i,longer_alt:Oc}),Ic=createToken({name:"Multiple",pattern:/multiple/i,longer_alt:Oc}),Lc=createToken({name:"Clone",pattern:/clone/i,longer_alt:Oc}),Pc=createToken({name:"Delete",pattern:/delete/i,longer_alt:Oc}),Mc=createToken({name:"Define",pattern:/define/i,longer_alt:Oc}),Fc=createToken({name:"Modify",pattern:/modify/i,longer_alt:Oc}),Dc=createToken({name:"If",pattern:/if/i,longer_alt:Oc}),Uc=createToken({name:"Else",pattern:/else/i,longer_alt:Oc}),$c=createToken({name:"True",pattern:/true/i,longer_alt:Oc}),jc=createToken({name:"False",pattern:/false/i,longer_alt:Oc}),Bc=createToken({name:"Null",pattern:/null/i,longer_alt:Oc}),Wc=createToken({name:"Return",pattern:/return/i,longer_alt:Oc}),Vc=createToken({name:"Unsafe",pattern:/unsafe/i,longer_alt:Oc}),zc=createToken({name:"Where",pattern:/where/i,longer_alt:Oc}),Gc=createToken({name:"EqualsEquals",pattern:/==/}),Hc=createToken({name:"EqualsEqualsEquals",pattern:/===/}),Kc=createToken({name:"NotEquals",pattern:/!=/}),qc=createToken({name:"NotEqualsEquals",pattern:/!==/}),Xc=createToken({name:"LessThanOrEqual",pattern:/<=/}),Yc=createToken({name:"GreaterThanOrEqual",pattern:/>=/}),Qc=createToken({name:"LessThan",pattern:/</}),Jc=createToken({name:"GreaterThan",pattern:/>/}),Zc=createToken({name:"And",pattern:/&&/}),eh=createToken({name:"Or",pattern:/\|\|/}),th=createToken({name:"Not",pattern:/!/}),nh=createToken({name:"Equals",pattern:/=/}),ih=createToken({name:"Plus",pattern:/\+/}),rh=createToken({name:"Minus",pattern:/-/}),sh=createToken({name:"Times",pattern:/\*/}),ah=createToken({name:"Divide",pattern:/\//}),oh=createToken({name:"Modulo",pattern:/%/}),uh=createToken({name:"LParen",pattern:/\(/}),lh=createToken({name:"RParen",pattern:/\)/}),ch=createToken({name:"Comma",pattern:/,/}),hh=createToken({name:"StringLiteral",pattern:/"(?:[^"\\]|\\.)*"|'(?:[^'\\]|\\.)*'/}),fh=createToken({name:"NumericLiteral",pattern:/-?\d+(?:\.\d+)?(?:[eE][+-]?\d+)?/}),ph=[Tc,kc,xc,wc,Sc,Nc,Rc,Cc,Ic,Lc,Pc,Mc,Fc,Dc,Uc,$c,jc,Bc,Wc,Vc,zc,Hc,Gc,qc,Kc,Xc,Yc,Zc,eh,nh,Qc,Jc,th,ih,rh,sh,ah,oh,uh,lh,ch,hh,fh,Ac,Oc],dh=new Lexer(ph);var _h=class extends CstParser{constructor(){super(ph),this.performSelfAnalysis()}query=this.RULE("query",(()=>{this.CONSUME(wc),this.SUBRULE(this.typeFormat,{LABEL:"sourceType"}),this.CONSUME(Sc),this.SUBRULE1(this.typeFormat,{LABEL:"targetType"}),this.OPTION((()=>{this.CONSUME(Nc),this.OPTION1((()=>{this.CONSUME(Vc)})),this.MANY((()=>{this.SUBRULE(this.action)}))}))}));typeFormat=this.RULE("typeFormat",(()=>{this.SUBRULE(this.anyIdentifier,{LABEL:"name"}),this.OPTION((()=>{this.CONSUME(uh),this.MANY_SEP({SEP:ch,DEF:()=>{this.SUBRULE(this.typeFormatParameter,{LABEL:"params"})}}),this.CONSUME(lh)}))}));typeFormatParameter=this.RULE("typeFormatParameter",(()=>{this.OR([{GATE:()=>this.LA(2).tokenType===nh,ALT:()=>this.SUBRULE(this.namedParameter)},{ALT:()=>this.SUBRULE(this.literal)}])}));namedParameter=this.RULE("namedParameter",(()=>{this.SUBRULE(this.anyIdentifier,{LABEL:"key"}),this.CONSUME(nh),this.SUBRULE(this.literal,{LABEL:"value"})}));anyIdentifier=this.RULE("anyIdentifier",(()=>{this.OR([{ALT:()=>this.CONSUME(Oc)},{ALT:()=>this.CONSUME(Ac)}])}));literal=this.RULE("literal",(()=>{this.OR([{ALT:()=>this.CONSUME(hh)},{ALT:()=>this.CONSUME(fh)},{ALT:()=>this.CONSUME($c)},{ALT:()=>this.CONSUME(jc)},{ALT:()=>this.CONSUME(Bc)}])}));action=this.RULE("action",(()=>{this.OR([{ALT:()=>this.SUBRULE(this.setRule)},{ALT:()=>this.SUBRULE(this.modifyRule)},{ALT:()=>this.SUBRULE(this.sectionRule)},{ALT:()=>this.SUBRULE(this.cloneRule)},{ALT:()=>this.SUBRULE(this.deleteRule)},{ALT:()=>this.SUBRULE(this.ifAction)},{ALT:()=>this.SUBRULE(this.defineRule)},{ALT:()=>this.SUBRULE(this.returnRule)}])}));returnRule=this.RULE("returnRule",(()=>{this.CONSUME(Wc),this.SUBRULE(this.expression,{LABEL:"expr"})}));deleteRule=this.RULE("deleteRule",(()=>{this.CONSUME(Pc),this.SUBRULE(this.anyIdentifier,{LABEL:"field"})}));ifAction=this.RULE("ifAction",(()=>{this.CONSUME(Dc),this.CONSUME(uh),this.SUBRULE(this.expression,{LABEL:"condition"}),this.CONSUME(lh),this.CONSUME2(uh),this.MANY((()=>{this.SUBRULE(this.action,{LABEL:"thenActions"})})),this.CONSUME2(lh),this.OPTION((()=>{this.CONSUME(Uc),this.CONSUME3(uh),this.MANY2((()=>{this.SUBRULE2(this.action,{LABEL:"elseActions"})})),this.CONSUME3(lh)}))}));cloneRule=this.RULE("cloneRule",(()=>{this.CONSUME(Lc),this.OPTION((()=>{this.CONSUME(uh),this.MANY_SEP({SEP:ch,DEF:()=>{this.SUBRULE(this.anyIdentifier,{LABEL:"fields"})}}),this.CONSUME(lh)}))}));setRule=this.RULE("setRule",(()=>{this.CONSUME(Rc),this.SUBRULE(this.anyIdentifier,{LABEL:"left"}),this.CONSUME(nh),this.SUBRULE(this.expression,{LABEL:"right"})}));modifyRule=this.RULE("modifyRule",(()=>{this.CONSUME(Fc),this.SUBRULE(this.anyIdentifier,{LABEL:"left"}),this.CONSUME(nh),this.SUBRULE(this.expression,{LABEL:"right"})}));expression=this.RULE("expression",(()=>{this.SUBRULE(this.logicalOr)}));logicalOr=this.RULE("logicalOr",(()=>{this.SUBRULE(this.logicalAnd,{LABEL:"lhs"}),this.MANY((()=>{this.CONSUME(eh),this.SUBRULE1(this.logicalAnd,{LABEL:"rhs"})}))}));logicalAnd=this.RULE("logicalAnd",(()=>{this.SUBRULE(this.comparison,{LABEL:"lhs"}),this.MANY((()=>{this.CONSUME(Zc),this.SUBRULE1(this.comparison,{LABEL:"rhs"})}))}));comparison=this.RULE("comparison",(()=>{this.SUBRULE(this.addition,{LABEL:"lhs"}),this.OPTION((()=>{this.OR([{ALT:()=>this.CONSUME(Gc,{LABEL:"ops"})},{ALT:()=>this.CONSUME(Hc,{LABEL:"ops"})},{ALT:()=>this.CONSUME(Kc,{LABEL:"ops"})},{ALT:()=>this.CONSUME(qc,{LABEL:"ops"})},{ALT:()=>this.CONSUME(Xc,{LABEL:"ops"})},{ALT:()=>this.CONSUME(Yc,{LABEL:"ops"})},{ALT:()=>this.CONSUME(Qc,{LABEL:"ops"})},{ALT:()=>this.CONSUME(Jc,{LABEL:"ops"})}]),this.SUBRULE1(this.addition,{LABEL:"rhs"})}))}));addition=this.RULE("addition",(()=>{this.SUBRULE(this.multiplication,{LABEL:"lhs"}),this.MANY((()=>{this.OR([{ALT:()=>this.CONSUME(ih,{LABEL:"ops"})},{ALT:()=>this.CONSUME(rh,{LABEL:"ops"})}]),this.SUBRULE1(this.multiplication,{LABEL:"rhs"})}))}));multiplication=this.RULE("multiplication",(()=>{this.SUBRULE(this.unaryExpression,{LABEL:"lhs"}),this.MANY((()=>{this.OR([{ALT:()=>this.CONSUME(sh,{LABEL:"ops"})},{ALT:()=>this.CONSUME(ah,{LABEL:"ops"})},{ALT:()=>this.CONSUME(oh,{LABEL:"ops"})}]),this.SUBRULE1(this.unaryExpression,{LABEL:"rhs"})}))}));unaryExpression=this.RULE("unaryExpression",(()=>{this.OPTION((()=>{this.OR([{ALT:()=>this.CONSUME(rh,{LABEL:"sign"})},{ALT:()=>this.CONSUME(th,{LABEL:"sign"})}])})),this.SUBRULE(this.atomic)}));atomic=this.RULE("atomic",(()=>{this.OR([{ALT:()=>this.SUBRULE(this.literal)},{GATE:()=>this.LA(2).tokenType===uh,ALT:()=>this.SUBRULE(this.functionCall)},{ALT:()=>this.SUBRULE(this.anyIdentifier)},{ALT:()=>{this.CONSUME(uh),this.SUBRULE(this.expression),this.CONSUME(lh)}}])}));functionCall=this.RULE("functionCall",(()=>{this.OR([{ALT:()=>this.CONSUME(Oc,{LABEL:"name"})},{ALT:()=>this.CONSUME(Dc,{LABEL:"name"})}]),this.CONSUME(uh),this.MANY_SEP({SEP:ch,DEF:()=>{this.SUBRULE(this.expression,{LABEL:"args"})}}),this.CONSUME(lh)}));sectionRule=this.RULE("sectionRule",(()=>{this.CONSUME(Cc),this.OPTION((()=>{this.CONSUME(Ic)})),this.SUBRULE(this.anyIdentifier,{LABEL:"sectionName"}),this.CONSUME(uh),this.OPTION1((()=>{this.CONSUME(wc,{LABEL:"subqueryFrom"}),this.SUBRULE(this.typeFormat,{LABEL:"subquerySourceType"}),this.CONSUME(Sc,{LABEL:"subqueryTo"}),this.SUBRULE1(this.typeFormat,{LABEL:"subqueryTargetType"}),this.OPTION2((()=>{this.CONSUME(Nc,{LABEL:"subqueryTransform"})}))})),this.MANY((()=>{this.SUBRULE(this.action)})),this.CONSUME(lh),this.OPTION3((()=>{this.CONSUME1(wc,{LABEL:"followFrom"}),this.SUBRULE(this.expression,{LABEL:"followExpr"})})),this.OPTION4((()=>{this.CONSUME(zc,{LABEL:"whereClause"}),this.SUBRULE1(this.expression,{LABEL:"whereExpr"})}))}));defineRule=this.RULE("defineRule",(()=>{this.CONSUME(Mc),this.SUBRULE(this.anyIdentifier,{LABEL:"left"}),this.CONSUME(nh),this.SUBRULE(this.expression,{LABEL:"right"})}))},mh=new _h;var gh={substring:(e,t)=>{if(e.length<2)throw new Error("substring() requires at least 2 arguments (string, start, [length])");let[r,s,a]=e;return a!==void 0?`String(${r}).slice(${s}, (${s}) + (${a}))`:`String(${r}).slice(${s})`},if:(e,t)=>{if(e.length!==3)throw new Error("if() requires exactly 3 arguments (condition, trueValue, falseValue)");let[r,s,a]=e;return`((${r}) ? (${s}) : (${a}))`},text:(e,t)=>{if(e.length!==1)throw new Error("text() requires exactly 1 argument (string or number)");let[r]=e;return`String(${r})`},replace:(e,t)=>{if(e.length!==3)throw new Error("replace() requires exactly 3 arguments (string, search, replacement)");let[r,s,a]=e;return`String(${r}).replace(${s}, ${a})`},number:(e,t)=>{if(e.length!==1)throw new Error("number() requires exactly 1 argument (string)");let[r]=e;return`Number(${r})`},extractnumber:(e,t)=>{if(e.length!==1)throw new Error("extractNumber() requires exactly 1 argument (string)");let[r]=e;return`(() => { const match = String(${r}).match(/\\d+(\\.\\d+)?/); return match ? Number(match[0]) : null; })()`},uppercase:(e,t)=>{if(e.length!==1)throw new Error("uppercase() requires exactly 1 argument (string)");let[r]=e;return`String(${r}).toUpperCase()`},lowercase:(e,t)=>{if(e.length!==1)throw new Error("lowercase() requires exactly 1 argument (string)");let[r]=e;return`String(${r}).toLowerCase()`},xmlnode:(e,t)=>{if(e.length<1)throw new Error("xmlnode() requires at least 1 argument (string)");let[r,...s]=e,a=s.join(", ");return`env.functions.xmlnode(${r}${a?", "+a:""})`},split:(e,t)=>{if(e.length<1)throw new Error("split() requires at least 1 argument (string)");let[r,s,a]=e,u=s!==void 0?s:'""',l=a!==void 0?`, ${a}`:"";return`String(${r}).split(${u}${l})`},to_base64:(e,t)=>{if(e.length!==1)throw new Error("to_base64() requires exactly 1 argument (string)");let[r]=e;return`env.functions.to_base64(${r})`},from_base64:(e,t)=>{if(e.length!==1)throw new Error("from_base64() requires exactly 1 argument (string)");let[r]=e;return`env.functions.from_base64(${r})`},aslist:(e,t)=>{if(e.length!==1)throw new Error("aslist() requires exactly 1 argument");let[r]=e;return`env.functions.aslist(${r})`},spreadsheet:(e,t)=>{if(e.length!==1)throw new Error("spreadsheet() requires exactly 1 argument");let[r]=e;return`env.functions.spreadsheet(${r})`},unpack:(e,t)=>{if(e.length<2)throw new Error("unpack() requires at least 2 arguments (string, fieldSpec1, [fieldSpec2, ...])");let[r,...s]=e;s.forEach((e=>{let t=e.replace(/^["']|["']$/g,""),r=t.split(":");if(r.length<3)throw new Error(`Invalid field spec for unpack(): ${t}. Expected "name:start:length[:modifier]"`);let[s,a,u]=r;if(!/^[a-zA-Z_$][a-zA-Z0-9_$]*$/.test(s))throw new Error(`Invalid field name in unpack() spec: "${s}". Must be a valid JavaScript identifier.`);let l=parseInt(a,10),h=parseInt(u,10);if(isNaN(l)||isNaN(h))throw new Error(`Invalid character positions in unpack() spec: ${t}`)}));let a=s.join(", ");return`env.functions.unpack(${r}, ${a})`},pack:(e,t)=>{if(e.length<2)throw new Error("pack() requires at least 2 arguments (object, fieldSpec1, [fieldSpec2, ...])");let[r,...s]=e;s.forEach((e=>{let t=e.replace(/^["']|["']$/g,""),r=t.split(":");if(r.length<3)throw new Error(`Invalid field spec for pack(): ${t}. Expected "name:start:length[:modifier]"`);let[s,a,u]=r;if(!/^[a-zA-Z_$][a-zA-Z0-9_$]*$/.test(s))throw new Error(`Invalid field name in pack() spec: "${s}". Must be a valid JavaScript identifier.`);let l=parseInt(a,10),h=parseInt(u,10);if(isNaN(l)||isNaN(h))throw new Error(`Invalid character positions in pack() spec: ${t}`)}));let a=s.join(", ");return`env.functions.pack(${r}, ${a})`},concat:(e,t)=>`env.functions.concat(${e.join(", ")})`,avg:(e,t)=>{if(e.length!==2)throw new Error("avg() requires exactly 2 arguments (array, valueExpression)");let[r,s]=e,a=`(item) => { const source = _safeSource(item); return ${s}; }`;return`env.functions.avg(${r}, ${a})`},minof:(e,t)=>{if(e.length!==2)throw new Error("minof() requires exactly 2 arguments (array, valueExpression)");let[r,s]=e,a=`(item) => { const source = _safeSource(item); return ${s}; }`;return`env.functions.minof(${r}, ${a})`},maxof:(e,t)=>{if(e.length!==2)throw new Error("maxof() requires exactly 2 arguments (array, valueExpression)");let[r,s]=e,a=`(item) => { const source = _safeSource(item); return ${s}; }`;return`env.functions.maxof(${r}, ${a})`},every:(e,t)=>{if(e.length!==2)throw new Error("every() requires exactly 2 arguments (array, conditionExpression)");let[r,s]=e,a=`(item) => { const source = _safeSource(item); return ${s}; }`;return`env.functions.every(${r}, ${a})`},some:(e,t)=>{if(e.length!==2)throw new Error("some() requires exactly 2 arguments (array, conditionExpression)");let[r,s]=e,a=`(item) => { const source = _safeSource(item); return ${s}; }`;return`env.functions.some(${r}, ${a})`},distinct:(e,t)=>{if(e.length!==2)throw new Error("distinct() requires exactly 2 arguments (array, valueExpression)");let[r,s]=e,a=`(item) => { const source = _safeSource(item); return ${s}; }`;return`env.functions.distinct(${r}, ${a})`},sum:(e,t)=>{if(e.length!==2)throw new Error("sum() requires exactly 2 arguments (array, valueExpression)");let[r,s]=e,a=`(item) => { const source = _safeSource(item); return ${s}; }`;return`env.functions.sum(${r}, ${a})`},groupby:(e,t)=>{if(e.length!==2)throw new Error("groupby() requires exactly 2 arguments (array, keyExpression)");let[r,s]=e,a=`(item) => { const source = _safeSource(item); return ${s}; }`;return`env.functions.groupby(${r}, ${a})`},transpose:(e,t)=>{if(e.length<2)throw new Error("transpose() requires at least 2 arguments (source, key1, [key2, ...])");return`env.functions.transpose(${e.join(", ")})`},list:(e,t)=>`[${e.join(", ")}]`,array:(e,t)=>`[${e.join(", ")}]`,extract:(e,t)=>{if(e.length<2)throw new Error("extract() requires at least 2 arguments (source, key1, [key2, ...])");let[r,...s]=e;return`env.functions.extract(${r}, ${t.safeMode}, ${s.join(", ")})`},floor:(e,t)=>{if(e.length!==1)throw new Error("floor() requires exactly 1 argument");return`Math.floor(${e[0]})`},ceil:(e,t)=>{if(e.length!==1)throw new Error("ceil() requires exactly 1 argument");return`Math.ceil(${e[0]})`},round:(e,t)=>{if(e.length<1||e.length>2)throw new Error("round() requires 1 or 2 arguments (value, [mode])");return`env.functions.round(${e.join(", ")})`},abs:(e,t)=>{if(e.length!==1)throw new Error("abs() requires exactly 1 argument");return`Math.abs(${e[0]})`},fixed:(e,t)=>{if(e.length<1||e.length>3)throw new Error("fixed() requires 1 to 3 arguments (value, [decimals], [mode])");return`env.functions.fixed(${e.join(", ")})`},min:(e,t)=>{if(e.length<2)throw new Error("min() requires at least 2 arguments");return`Math.min(${e.join(", ")})`},max:(e,t)=>{if(e.length<2)throw new Error("max() requires at least 2 arguments");return`Math.max(${e.join(", ")})`},trim:(e,t)=>{if(e.length!==1)throw new Error("trim() requires exactly 1 argument");return`String(${e[0]}).trim()`},padstart:(e,t)=>{if(e.length<2)throw new Error("padstart() requires at least 2 arguments (str, length, [char])");let[r,s,a]=e;return a!==void 0?`String(${r}).padStart(${s}, ${a})`:`String(${r}).padStart(${s})`},padend:(e,t)=>{if(e.length<2)throw new Error("padend() requires at least 2 arguments (str, length, [char])");let[r,s,a]=e;return a!==void 0?`String(${r}).padEnd(${s}, ${a})`:`String(${r}).padEnd(${s})`},indexof:(e,t)=>{if(e.length!==2)throw new Error("indexof() requires exactly 2 arguments (str, search)");return`String(${e[0]}).indexOf(${e[1]})`},startswith:(e,t)=>{if(e.length!==2)throw new Error("startswith() requires exactly 2 arguments (str, prefix)");return`String(${e[0]}).startsWith(${e[1]})`},endswith:(e,t)=>{if(e.length!==2)throw new Error("endswith() requires exactly 2 arguments (str, suffix)");return`String(${e[0]}).endsWith(${e[1]})`}};var yh=class{sourceRoot={type:"object",properties:{}};targetRoot={type:"object",properties:{}};sourceStack=[this.sourceRoot];targetStack=[this.targetRoot];getCurrentSource(){return this.sourceStack[this.sourceStack.length-1]}getCurrentTarget(){return this.targetStack[this.targetStack.length-1]}recordAccess(e,t="any",r=false){let s=r?this.getCurrentTarget():this.getCurrentSource();this.setInNode(s,e,t)}recordAssignment(e,t="any"){this.setInNode(this.getCurrentTarget(),e,t)}recordClone(e){let t=this.getCurrentTarget();e?e.forEach((e=>{this.setInNode(this.getCurrentSource(),e,"any"),this.setInNode(t,e,"any")})):t.isOpen=true}recordDelete(e){let t=this.getCurrentTarget();this.deleteInNode(t,e)}pushSection(e,t,r){t!=="parent"&&this.setInNode(this.getCurrentSource(),t,r?"array":"object");let s={type:r?"array":"object"};r?s.items={type:"object",properties:{}}:s.properties={};let a={type:"object",properties:{}};this.setInNodeExplicit(this.getCurrentTarget(),e,s),this.targetStack.push(r?s.items:s),this.sourceStack.push(a)}popSection(e,t){let r=this.sourceStack.pop();this.targetStack.pop();let s=this.getCurrentSource();if(e!=="parent"){let a=this.getOrSetNode(s,e,t?"array":"object"),u=t?a.items:a;u&&(u.properties||(u.properties={}),Object.assign(u.properties,r.properties||{}))}else s.properties||(s.properties={}),Object.assign(s.properties,r.properties||{})}parsePath(e){if(!e)return[];let t=[],r=e.split(".");for(let e of r){let r=e.match(/^([^[\]]*)((?:\[\d+\])*)$/);if(r){r[1]&&t.push(r[1]);let e=r[2].match(/\[\d+\]/g);if(e)for(let r of e)t.push("[]")}else t.push(e)}return t}setInNode(e,t,r){let s=this.parsePath(t),a=e;for(let e=0;e<s.length;e++){let t=s[e],u=e===s.length-1;if(t==="[]"){a.type="array",a.items||(a.items={type:u?r:"object",properties:{}}),a=a.items;continue}a.properties||(a.properties={}),u?(!a.properties[t]||a.properties[t].type==="any")&&(a.properties[t]={type:r},r==="object"?a.properties[t].properties={}:r==="array"&&(a.properties[t].items={type:"object",properties:{}})):(a.properties[t]||(a.properties[t]={type:"object",properties:{}}),a=a.properties[t])}}setInNodeExplicit(e,t,r){let s=this.parsePath(t),a=e;for(let e=0;e<s.length;e++){let t=s[e],u=e===s.length-1;if(t==="[]"){a.type="array",a.items||(a.items={type:u?r.type:"object",properties:{}}),u?a.items=r:a=a.items;continue}a.properties||(a.properties={}),u?a.properties[t]=r:(a.properties[t]||(a.properties[t]={type:"object",properties:{}}),a=a.properties[t])}}deleteInNode(e,t){let r=this.parsePath(t),s=e;for(let e=0;e<r.length;e++){let t=r[e],a=e===r.length-1;if(t==="[]"){if(!s.items)return;a?(delete s.items,s.type="any"):s=s.items;continue}if(!s.properties)return;if(a)delete s.properties[t];else if(s=s.properties[t],!s)return}}getOrSetNode(e,t,r){let s=this.parsePath(t),a=e;for(let e=0;e<s.length;e++){let t=s[e],u=e===s.length-1;if(t==="[]"){if(a.type="array",!a.items){let e=u?r:"object";a.items={type:e},e==="object"?a.items.properties={}:e==="array"&&(a.items.items={type:"object",properties:{}})}a=a.items;continue}let l=u?r:"object";a.properties||(a.properties={}),a.properties[t]||(a.properties[t]={type:l},l==="object"?a.properties[t].properties={}:l==="array"&&(a.properties[t].items={type:"object",properties:{}})),a=a.properties[t]}return a}getResult(){return{source:this.sourceRoot,target:this.targetRoot}}};var bh=mh.getBaseCstVisitorConstructor(),vh=class extends bh{readFrom="source";scopeStack=[];safeMode=true;isAnalyzing=false;tracker=new yh;lastInferredType="any";constructor(){super(),this.validateVisitor()}reset(){this.readFrom="source",this.scopeStack=[],this.tracker=new yh,this.lastInferredType="any"}visitWithContext(e,t){let r=this.readFrom;this.readFrom=t.readFrom;try{return this.visit(e)}finally{this.readFrom=r}}query(e){this.reset(),this.isAnalyzing&&(this.tracker=new yh);let t=this.visit(e.sourceType),r=this.visit(e.targetType),s=!!e.Unsafe;this.safeMode=!s,this.scopeStack.push({format:r.name,options:r.options,isSerializationScope:true});try{let s=e.action?e.action.map((e=>this.visit(e))):[];e.Transform||s.push("Object.assign(target, source);");let a=t.name,u=r.name,l=JSON.stringify(t.options),h=JSON.stringify(r.options),f=s.some((e=>typeof e=="string"&&e.trim().startsWith("return ")));return{code:`\n      return function(input, env) {\n        // 1. Parse Input\n        const _safeSource = (v) => (typeof v === 'object' && v !== null) ? (Array.isArray(v) ? [...v] : { ...v }) : (v || {});\n        const _parsedSource = env.parse('${a}', input, ${l});\n        const source = _safeSource(_parsedSource);\n        const _rootSource = source;\n        \n        // 2. Transform\n        const target = {};\n        const _rootTarget = target;\n        ${s.join(`\n        `)}\n\n        // 3. Serialize Output\n        ${f?"":`return env.serialize('${u}', target, ${h});`}\n      }\n    `,sourceType:t,targetType:r,analysis:this.isAnalyzing?this.tracker.getResult():void 0}}finally{this.scopeStack.pop()}}typeFormat(e){let t=this.visit(e.name),r={params:[]};return e.params&&e.params.forEach((e=>{let t=this.visit(e);typeof t=="object"&&"key"in t?r[t.key]=this.parseLiteral(t.value):r.params.push(this.parseLiteral(t))})),{name:t.name,options:r}}typeFormatParameter(e){if(e.namedParameter)return this.visit(e.namedParameter);if(e.literal)return this.visit(e.literal)}namedParameter(e){let t=this.visit(e.key).name,r=this.visit(e.value);return{key:t,value:r}}parseLiteral(e){if(e==="true")return true;if(e==="false")return false;if(e==="null")return null;if(e.startsWith('"')&&e.endsWith('"')||e.startsWith("'")&&e.endsWith("'"))return e.slice(1,-1);let t=Number(e);return isNaN(t)?e:t}isSimplePath(e){return e?!/[()+*/-]/.test(e)&&!e.includes(" "):false}safify(e){return this.safeMode?e.replace(/\.(?!\?)/g,"?.").replace(/\[/g,"?.["):e}genAccess(e,t,r=false){if(!this.safeMode||r)return t.quoted||t.name.includes("-")&&!t.name.includes(".")&&!t.name.includes("[")?`${e}["${t.name}"]`:`${e}.${t.name}`;if(t.quoted)return`${e}?.[${JSON.stringify(t.name)}]`;let s=this.safify(t.name);return`${e}?.${s}`}anyIdentifier(e){if(e.Identifier)return{name:e.Identifier[0].image,quoted:false};if(e.QuotedIdentifier)return{name:e.QuotedIdentifier[0].image.slice(1,-1).replace(/\\(.)/g,"$1"),quoted:true}}literal(e){if(e.StringLiteral)return this.lastInferredType="string",e.StringLiteral[0].image;if(e.NumericLiteral)return this.lastInferredType="number",e.NumericLiteral[0].image;if(e.True)return this.lastInferredType="boolean","true";if(e.False)return this.lastInferredType="boolean","false";if(e.Null)return this.lastInferredType="null","null"}action(e){if(e.setRule)return this.visit(e.setRule);if(e.modifyRule)return this.visit(e.modifyRule);if(e.sectionRule)return this.visit(e.sectionRule);if(e.cloneRule)return this.visit(e.cloneRule);if(e.ifAction)return this.visit(e.ifAction);if(e.deleteRule)return this.visit(e.deleteRule);if(e.defineRule)return this.visit(e.defineRule);if(e.returnRule)return this.visit(e.returnRule)}deleteRule(e){let t=this.visit(e.field);return this.isAnalyzing&&this.tracker.recordDelete(t.name),`delete ${this.genAccess("target",t,true)};`}ifAction(e){let t=this.visit(e.condition),r=e.thenActions?e.thenActions.map((e=>this.visit(e))).join(`\n`):"",s=e.elseActions?`else { ${e.elseActions.map((e=>this.visit(e))).join(`\n`)} }`:"";return`if (${t}) {\n       ${r}\n     } ${s}`}cloneRule(e){if(e.fields){let t=e.fields.map((e=>this.visit(e)));return this.isAnalyzing&&this.tracker.recordClone(t.map((e=>e.name))),t.map((e=>`${this.genAccess("target",e,true)} = ${this.genAccess("source",e)};`)).join(`\n        `)}return this.isAnalyzing&&this.tracker.recordClone(),"Object.assign(target, source);"}setRule(e){let t=this.visit(e.left);this.lastInferredType="any";let r=this.visit(e.right);return this.isAnalyzing&&this.tracker.recordAssignment(t.name,this.lastInferredType),`${this.genAccess("target",t,true)} = ${r};`}modifyRule(e){let t=this.visit(e.left);this.lastInferredType="any";let r=this.visitWithContext(e.right,{readFrom:"target"});return this.isAnalyzing&&this.tracker.recordAssignment(t.name,this.lastInferredType),`${this.genAccess("target",t,true)} = ${r};`}defineRule(e){let t=this.visit(e.left);this.lastInferredType="any";let r=this.visit(e.right);return this.isAnalyzing&&this.tracker.recordAssignment(t.name,this.lastInferredType),`${this.genAccess("source",t,true)} = ${r};`}returnRule(e){let t=this.visitWithContext(e.expr,{readFrom:"target"}),r=this.scopeStack[this.scopeStack.length-1];if(r&&r.isSerializationScope){let e=JSON.stringify(r.options);return`return env.serialize('${r.format}', ${t}, ${e});`}return`return ${t};`}expression(e){return this.visit(e.logicalOr)}logicalOr(e){let t=this.visit(e.lhs);if(e.rhs&&e.rhs.length>0){this.lastInferredType="boolean";for(let r=0;r<e.rhs.length;r++){let s=this.visit(e.rhs[r]);t=`${t} || ${s}`}}return t}logicalAnd(e){let t=this.visit(e.lhs);if(e.rhs&&e.rhs.length>0){this.lastInferredType="boolean";for(let r=0;r<e.rhs.length;r++){let s=this.visit(e.rhs[r]);t=`${t} && ${s}`}}return t}comparison(e){let t=this.visit(e.lhs);if(e.rhs){this.lastInferredType="boolean";let r=e.ops[0].image,s=this.visit(e.rhs[0]);t=`${t} ${r} ${s}`}return t}addition(e){let t=this.visit(e.lhs),r=this.lastInferredType,s=t;if(e.rhs&&e.rhs.length>0){let t=r==="string",a=r==="number";for(let r=0;r<e.rhs.length;r++){let u=e.ops[r].image,l=this.visit(e.rhs[r]);this.lastInferredType==="string"&&(t=true),this.lastInferredType!=="number"&&(a=false),s=`${s} ${u} ${l}`}t?this.lastInferredType="string":a?this.lastInferredType="number":this.lastInferredType="any"}else this.lastInferredType=r;return s}multiplication(e){let t=this.visit(e.lhs);if(e.rhs&&e.rhs.length>0){this.lastInferredType="number";for(let r=0;r<e.rhs.length;r++){let s=e.ops[r].image,a=this.visit(e.rhs[r]);t=`${t} ${s} ${a}`}}return t}unaryExpression(e){let t=this.visit(e.atomic);if(e.sign){let r=e.sign[0].image;return r==="!"&&(this.lastInferredType="boolean"),r==="-"&&(this.lastInferredType="number"),`${r}${t}`}return t}atomic(e){if(e.literal)return this.visit(e.literal);if(e.functionCall)return this.visit(e.functionCall);if(e.anyIdentifier){this.lastInferredType="any";let t=this.visit(e.anyIdentifier);if(["true","false","null"].includes(t.name)&&!t.quoted)return t.name;if(t.name==="_key"&&!t.quoted)return"_key";if(!t.quoted){if(t.name.startsWith("source.")||t.name.startsWith("source[")){let e=t.name.startsWith("source.")?t.name.substring(7):t.name.substring(6);return this.isAnalyzing&&e&&this.tracker.recordAccess(e,"any",false),this.safeMode?this.safify(t.name):t.name}if(t.name.startsWith("target.")||t.name.startsWith("target[")){let e=t.name.startsWith("target.")?t.name.substring(7):t.name.substring(6);return this.isAnalyzing&&e&&this.tracker.recordAccess(e,"any",true),this.safeMode?this.safify(t.name):t.name}if(t.name==="target")return"target";if(t.name==="source")return"source";if(t.name==="_source"||t.name.startsWith("_source.")||t.name.startsWith("_source[")){let e=t.name.substring(7);if(this.isAnalyzing){let t=e.startsWith(".")?e.substring(1):e;t&&this.tracker.recordAccess(t,"any",false)}return`_rootSource${this.safeMode?this.safify(e):e}`}if(t.name==="_target"||t.name.startsWith("_target.")||t.name.startsWith("_target[")){let e=t.name.substring(7);if(this.isAnalyzing){let t=e.startsWith(".")?e.substring(1):e;t&&this.tracker.recordAccess(t,"any",true)}return`_rootTarget${this.safeMode?this.safify(e):e}`}}return this.isAnalyzing&&this.tracker.recordAccess(t.name,"any",this.readFrom==="target"),this.genAccess(this.readFrom,t)}if(e.expression)return`(${this.visit(e.expression)})`}functionCall(e){let t=e.name[0].image,r=(t.startsWith("`")?t.slice(1,-1):t).toLowerCase(),s=e.args?e.args.map((e=>this.visit(e))):[],a=gh[r];if(a)return["substring","text","replace","uppercase","lowercase","to_base64","from_base64","trim","padstart","padend","fixed"].includes(r)?this.lastInferredType="string":["number","extractnumber","floor","ceil","round","abs","min","max","indexof"].includes(r)?this.lastInferredType="number":["startswith","endswith"].includes(r)?this.lastInferredType="boolean":["aslist","transpose","list","array"].includes(r)?this.lastInferredType="array":r==="asobject"&&(this.lastInferredType="object"),a(s,this);throw new Error(`Unknown function: ${t}`)}sectionRule(e){let t=this.visit(e.sectionName),r=t.name,s=this.genAccess("target",t,true),a,u;if(e.followExpr){let t=this.visit(e.followExpr),r=t.replace(/\?\./g,".");r==="source.parent"||r==="this.source.parent"||r===`${this.readFrom.replace(/\?\./g,".")}.parent`?(a="source",u="parent"):(a=t,u=a)}else a=this.genAccess("source",t),u=t.name;let l=!!e.Multiple,h=!!e.whereExpr,f="";if(h&&(f=this.visit(e.whereExpr)),!!e.subqueryFrom){let t=this.visit(e.subquerySourceType),r=this.visit(e.subqueryTargetType);this.scopeStack.push({format:r.name,options:r.options,isSerializationScope:true});try{let u=!!e.subqueryTransform,d=e.action?e.action.map((e=>this.visit(e))):[];u||d.push("Object.assign(target, source);");let _=JSON.stringify(t.options),m=JSON.stringify(r.options),g=a.includes("(")||a.includes("[")||a.includes(" ")?"_sectionSource":a,y=g==="_sectionSource"?`const _sectionSource = ${a};\n`:"";if(l){let e=h?`.filter((item, index) => { const source = item; const _key = index; return ${f}; })`:"";return`\n        {\n          ${y}if (${g} && Array.isArray(${g})) {\n            ${s} = ${g}${e}.map((item, index) => {\n              const subSource = env.parse('${t.name}', item, ${_});\n              const source = _safeSource(subSource);\n              const _key = index;\n              const target = {};\n              ${d.join(`\n              `)}\n              return env.serialize('${r.name}', target, ${m});\n            });\n          }\n        }\n        `}else return h?`\n        {\n          ${y}if (${g} && Array.isArray(${g})) {\n            const _filtered = ${g}.find((item, index) => { const source = item; const _key = index; return ${f}; });\n            if (_filtered) {\n              ${s} = (function(innerSource, innerIndex) {\n                const subSource = env.parse('${t.name}', innerSource, ${_});\n                const source = _safeSource(subSource);\n                const _key = innerIndex;\n                const target = {};\n                ${d.join(`\n                `)}\n                return env.serialize('${r.name}', target, ${m});\n              })(_filtered, ${g}.indexOf(_filtered));\n            }\n          }\n        }\n        `:`\n        {\n          ${y}if (${g}) {\n            ${s} = (function(innerSource) {\n              const subSource = env.parse('${t.name}', innerSource, ${_});\n              const source = _safeSource(subSource);\n              const _key = 0; // Single section without where, index is effectively 0 if we consider it an "iteration"\n              const target = {};\n              ${d.join(`\n              `)}\n              return env.serialize('${r.name}', target, ${m});\n            })(${g});\n          }\n        }\n        `}finally{this.scopeStack.pop()}}this.scopeStack.push({format:"object",options:{},isSerializationScope:false});try{let t=u;t!=="parent"&&(t=t.replace(/^source\??\./,"").replace(/^this\.source\??\./,"").replace(/\?\./g,".")),this.isAnalyzing&&(t==="parent"||this.isSimplePath(t)?this.tracker.pushSection(r,t,l):this.tracker.pushSection(r,"parent",l));try{let t=e.action?e.action.map((e=>this.visit(e))):[],r=a.includes("(")||a.includes("[")||a.includes(" ")?"_sectionSource":a,u=r==="_sectionSource"?`const _sectionSource = ${a};\n`:"";if(l){let e=h?`.filter((item, index) => { const source = _safeSource(item); const _key = index; return ${f}; })`:"";return`\n      {\n        ${u}if (${r} && Array.isArray(${r})) {\n          ${s} = ${r}${e}.map((item, index) => {\n            const source = _safeSource(item);\n            const _key = index;\n            const target = {};\n            ${t.join(`\n            `)}\n            return target;\n          });\n        }\n      }\n      `}else return h?`\n      {\n        ${u}if (${r} && Array.isArray(${r})) {\n          const _filtered = ${r}.find((item, index) => { const source = _safeSource(item); const _key = index; return ${f}; });\n          if (_filtered) {\n            ${s} = (function(innerSource, innerIndex) {\n              const source = _safeSource(innerSource);\n              const _key = innerIndex;\n              const target = {};\n              ${t.join(`\n              `)}\n              return target;\n            })(_filtered, ${r}.indexOf(_filtered));\n          }\n        }\n      }\n      `:`\n      {\n        ${u}if (${r}) {\n          ${s} = (function(innerSource) {\n            const source = _safeSource(innerSource);\n            const _key = 0;\n            const target = {};\n            ${t.join(`\n            `)}\n            return target;\n          })(${r});\n        }\n      }\n      `}finally{if(this.isAnalyzing){let e=t==="parent"||this.isSimplePath(t)?t:"parent";this.tracker.popSection(e,l)}}}finally{this.scopeStack.pop()}}},Eh=new vh;var Th={};function N(e,t){Th[e.toLowerCase()]=t}function de(e){let t=Th[e.toLowerCase()];if(!t)throw new Error(`No adapter found for format: ${e}`);return t}function Me(e){let t="";for(;e>=0;)t=String.fromCharCode(e%26+65)+t,e=Math.floor(e/26)-1;return t}N("json",{parse:e=>typeof e!="string"?e:JSON.parse(e),serialize:e=>JSON.stringify(e,null,2)});var kh=new Builder({ignoreAttributes:false,attributeNamePrefix:"$",textNodeName:"_",format:true});N("xml",{parse:(e,t)=>typeof e!="string"?e:new XMLParser({ignoreAttributes:false,removeNSPrefix:true,...t}).parse(e),serialize:(e,t)=>{let r=t?.rootGenerated??t?.params?.[0]??"root";return(t?new Builder({ignoreAttributes:false,attributeNamePrefix:"$",textNodeName:"_",format:true,...t}):kh).build({[r]:e})}});N("csv",{parse:(e,t)=>{if(typeof e!="string")return e;let r=t?.delimiter??t?.params?.[0]??",";return{rows:vc.parse(e,{delimiter:r,skipEmptyLines:true,...t}).data.map((e=>{let t={};return Array.isArray(e)&&e.forEach(((e,r)=>{t[Me(r)]=e})),t}))}},serialize:(e,t)=>{if(!e||!Array.isArray(e.rows))return"";let r=t?.delimiter??t?.params?.[0]??",",s=e.rows.map((e=>Object.keys(e).filter((e=>/^[A-Z]+$/.test(e))).sort(((e,t)=>e.length!==t.length?e.length-t.length:e.localeCompare(t))).map((t=>e[t]))));return vc.unparse(s,{delimiter:r,...t})}});N("edifact",{parse:(e,t)=>{if(typeof e!="string")return e;let r="'",s="+",a=":",u="?",l=e.trim();if(l.startsWith("UNA")){let e=l.substring(3,9);a=e[0],s=e[1],u=e[3],r=e[5],l=l.substring(9).trim()}t&&(t.segmentTerminator&&(r=t.segmentTerminator),t.elementSeparator&&(s=t.elementSeparator),t.componentSeparator&&(a=t.componentSeparator),t.releaseChar&&(u=t.releaseChar));let h={},c=(e,t,r)=>{let s=[],a="";for(let u=0;u<e.length;u++){let l=e[u];l===r&&u+1<e.length?a+=r+e[++u]:l===t?(s.push(a),a=""):a+=l}return s.push(a),s},p=(e,t)=>{let r="";for(let s=0;s<e.length;s++)e[s]===t&&s+1<e.length?r+=e[++s]:r+=e[s];return r},f=c(l,r,u).map((e=>e.trim())).filter((e=>e.length>0));for(let e of f){let t=c(e,s,u),r=p(t[0],u),l=t.slice(1).map((e=>{let t=c(e,a,u).map((e=>p(e,u)));return t.length>1?t:t[0]}));h[r]||(h[r]=[]),h[r].push(l)}return h},serialize:(e,t)=>{if(!e||typeof e!="object")return"";let r=t?.segmentTerminator??"'",s=t?.elementSeparator??"+",a=t?.componentSeparator??":",u=t?.releaseChar??"?",o=e=>{if(e==null)return"";let t=String(e),l="";for(let e of t)(e===r||e===s||e===a||e===u)&&(l+=u),l+=e;return l},l="";t?.includeUNA&&(l+=`UNA${a}${s}.${u} ${r}`);for(let t in e){let u=Array.isArray(e[t])?e[t]:[e[t]];for(let e of u){if(l+=t,Array.isArray(e))for(let t of e)l+=s,Array.isArray(t)?l+=t.map(o).join(a):l+=o(t);l+=r}}return l}});N("object",{parse:e=>{if(typeof e=="string"&&(e.trim().startsWith("{")||e.trim().startsWith("[")))try{return JSON.parse(e)}catch{return e}return e},serialize:e=>e});N("plaintext",{parse:(e,t)=>{if(typeof e!="string")return e;let r=t?.separator??t?.params?.[0]??/\r?\n/;return{rows:e.split(r).filter((e=>e.length>0))}},serialize:(e,t)=>{if(!e||!Array.isArray(e.rows))return"";let r=t?.separator??t?.params?.[0]??`\n`;return e.rows.join(r)}});var xh={spreadsheet:e=>{let t=Array.isArray(e)?e:e==null?[]:[e];if(!Array.isArray(e)&&e&&typeof e=="object"&&Array.isArray(e.rows)&&(t=e.rows),t.length===0)return[];let r=[],s=[],a=[];for(let e=0;e<t.length;e++){let u=t[e];if(!(!u||typeof u!="object"))if(e===0){a=Object.keys(u);for(let e of a)s.push(String(u[e]))}else{let e={};for(let t=0;t<a.length;t++){let r=a[t],l=s[t];e[l]=u[r]}r.push(e)}}return r},aslist:e=>Array.isArray(e)?e:e==null?[]:[e],to_base64:e=>{let t=String(e);return typeof btoa=="function"?btoa(unescape(encodeURIComponent(t))):Buffer.from(t,"utf-8").toString("base64")},from_base64:e=>{let t=String(e);return typeof atob=="function"?decodeURIComponent(escape(atob(t))):Buffer.from(t,"base64").toString("utf-8")},xmlnode:(e,...t)=>{if(t.length>0){let r=[];for(let e=0;e<t.length;e+=2)r.push([t[e],t[e+1]]);let s=r.map((([e,t])=>[`$${e}`,t])),a=Object.fromEntries(s);return{_:e,...a}}return e},unpack:(e,...t)=>{let r=String(e||""),s={};for(let e of t){let t=e.split(":");if(t.length<3)continue;let[a,u,l,h]=t,f=parseInt(u,10),d=parseInt(l,10);if(isNaN(f)||isNaN(d))continue;let _=r.substring(f,f+d);h!=="raw"&&(_=_.trim()),s[a]=_}return s},pack:(e,...t)=>{let r=e||{},s=t.map((e=>{let t=e.split(":");if(t.length<3)return null;let[r,s,a,u]=t;return{name:r,start:parseInt(s,10),length:parseInt(a,10),left:u==="left"}})).filter((e=>e!==null)),a=s.reduce(((e,t)=>Math.max(e,t.start+t.length)),0),u=" ".repeat(a);for(let e of s){let t=String(r[e.name]??""),s=(e.left?t.padStart(e.length):t.padEnd(e.length)).substring(0,e.length);u=u.substring(0,e.start)+s+u.substring(e.start+e.length)}return u},sum:(e,t)=>Array.isArray(e)?e.reduce(((e,r)=>{let s=Number(t(r));return e+(isNaN(s)?0:s)}),0):0,avg:(e,t)=>{if(!Array.isArray(e)||e.length===0)return 0;let r=0,s=0;for(let a of e){let e=t(a);if(e==null)continue;let u=Number(e);isNaN(u)||(r+=u,s++)}return s===0?0:r/s},minof:(e,t)=>{if(!Array.isArray(e))return null;let r=null;for(let s of e){let e=t(s);if(e==null)continue;let a=Number(e);!isNaN(a)&&(r===null||a<r)&&(r=a)}return r},maxof:(e,t)=>{if(!Array.isArray(e))return null;let r=null;for(let s of e){let e=t(s);if(e==null)continue;let a=Number(e);!isNaN(a)&&(r===null||a>r)&&(r=a)}return r},every:(e,t)=>Array.isArray(e)?e.every((e=>!!t(e))):true,some:(e,t)=>Array.isArray(e)?e.some((e=>!!t(e))):false,distinct:(e,t)=>{if(!Array.isArray(e))return[];let r=new Set,s=[];for(let a of e){let e=t(a),u=String(e);r.has(u)||(r.add(u),s.push(e))}return s},groupby:(e,t)=>{if(!Array.isArray(e))return[];let r=new Map;for(let s of e){let e=t(s),a=String(e);r.has(a)||r.set(a,{key:e,items:[]}),r.get(a).items.push(s)}return Array.from(r.values())},concat:(...e)=>e.reduce(((e,t)=>e.concat(Array.isArray(t)?t:t==null?[]:[t])),[]),transpose:(e,...t)=>{if(!e||typeof e!="object"||t.length===0)return[];let r=0;for(let s of t){let t=e[s];Array.isArray(t)?r=Math.max(r,t.length):t!=null&&(r=Math.max(r,1))}let s=[];for(let a=0;a<r;a++){let r={};for(let s of t){let t=e[s];Array.isArray(t)?r[s]=t[a]:r[s]=a===0?t:void 0}s.push(r)}return s},extract:(e,t,...r)=>{if(!e||typeof e!="object")return{};let n=(e,t,r)=>{if(!t)return e;let s=t.split("."),a=e;for(let e of s)if(r){if(a==null)return;a=a[e]}else a=a[e];return a},s={};for(let a of r){let r=a.indexOf(":"),u,l;r!==-1?(u=a.substring(0,r),l=a.substring(r+1)):(u=a,l=a),s[u]=n(e,l,t)}return s},round:(e,t="half-up")=>{let r=Number(e);if(t==="half-even"){let e=Math.floor(r);return r-e===.5?e%2===0?e:e+1:Math.round(r)}return Math.round(r)},fixed:(e,t=2,r="half-up")=>{let s=Number(e),a=Math.max(0,Math.floor(Number(t))),u=Math.pow(10,a),l;if(r==="half-even"){let e=Math.abs(s)*u,t=Math.floor(e);l=(e-t===.5?t%2===0?t:t+1:Math.round(e))/u*Math.sign(s||1)}else l=Math.round(Math.abs(s)*u)/u*Math.sign(s||1);return l.toFixed(a)}};async function ot(e,t){if(t?.cache){let r=await t.cache.retrieve(e);if(r)return Ne(r)}let r=dh.tokenize(e);if(r.errors.length>0)throw new Error(`Lexing errors: ${r.errors[0].message}`);mh.input=r.tokens;let s=mh.query();if(mh.errors.length>0)throw new Error(`Parsing errors: ${mh.errors[0].message}`);Eh.isAnalyzing=!!t?.analyze;let{code:a,analysis:u,sourceType:l,targetType:h}=Eh.visit(s),f=Ec.js(a,{indent_size:2,space_in_empty_paren:true,end_with_newline:true});t?.cache&&await t.cache.save(e,f);let d=Ne(f);return u&&(u.sourceFormat=l.name,u.targetFormat=h.name,d.analysis=u),d}function Ne(e){let t=new Function(e)(),r={parse:(e,t,r)=>de(e).parse(t,r),serialize:(e,t,r)=>de(e).serialize(t,r),functions:xh},i=e=>t(e,r);return i.code=e,i}function at(e,...t){return e.reduce(((e,r,s)=>e+r+(t[s]??"")),"")}function ct(e){return`Hello, ${e}! The Morph engine is ready.`}const Oh=e(import.meta.url)("fs");const Ah=e(import.meta.url)("path");const wh=e(import.meta.url)("crypto");var Sh=__nccwpck_require__(534);const{DM:Nh,gu:Rh,er:Ch,Ww:Ih,b7:Lh,Di:Ph,a2:Mh,uB:Fh,ef:Dh,c$:Uh,_V:$h}=Sh;const jh=e(import.meta.url)("fs/promises");var Bh=class{cacheDir;constructor(e=".compiled"){this.cacheDir=Ah.resolve(process.cwd(),e)}async retrieve(e){try{const t=this.getHash(e);const r=Ah.join(this.cacheDir,`morph_${t}.js`);if(Oh.existsSync(r)){return Oh.promises.readFile(r,"utf8")}}catch(e){}return null}async save(e,t){try{if(!Oh.existsSync(this.cacheDir)){Oh.mkdirSync(this.cacheDir,{recursive:true})}const r=this.getHash(e);const s=Ah.join(this.cacheDir,`morph_${r}.js`);const a=`/* \nQuery:\n${e}\n*/\n\n${t}`;await Oh.promises.writeFile(s,a,"utf8")}catch(e){}}getHash(e){return(0,wh.createHash)("sha256").update(e).digest("hex").substring(0,12)}};function createLogger(e="text"){const getTimestamp=()=>{const e=new Date;return e.toISOString().split("T")[1].split(".")[0]};const write=(t,r,s)=>{if(e==="json"){const e={ts:(new Date).toISOString(),level:t,msg:r,...s};process.stderr.write(JSON.stringify(e)+"\n")}else{const e=getTimestamp();let a="";if(s){if(s.input&&s.output){a=` ${s.input}  ${s.output}`;if(s.duration!==void 0)a+=` (${s.duration}ms)`}else if(s.processed!==void 0){a=`: ${s.processed} files processed, ${s.errors||0} errors`;if(s.duration!==void 0)a+=` in ${s.duration}ms`}}process.stderr.write(`[${e}] ${t.toUpperCase()}: ${r}${a}\n`)}};return{info(e,t){write("info",e,t)},error(e,t){write("error",e,t)},summary(e){write("info","Summary",e)}}}function resolveQuery(e,t){if(e)return e;if(t){if(!(0,Oh.existsSync)(t)){throw new Error(`Query file not found: ${t}`)}return(0,Oh.readFileSync)(t,"utf8").trim()}throw new Error("Either --query (-q) or --query-file (-Q) must be provided.")}function formatToExtension(e){const t=e.toLowerCase();switch(t){case"json":case"object":return".json";case"xml":return".xml";case"csv":return".csv";case"edifact":return".edi";case"plaintext":return".txt";default:return".json"}}function extractTargetFormat(e){const t=e.match(/to\s+(\w+)/i);return t?t[1]:"json"}function resolveOutputPath(e,t,r,s){const a=Ah.relative(t,e);const u=formatToExtension(s);const l=Ah.parse(a);return Ah.join(r,Ah.join(l.dir,l.name+u))}function matchesPattern(e,t){if(e.startsWith(".")&&!t.startsWith(".")){return false}if(t==="*")return true;const r=t.replace(/[.+^${}()|[\]\\]/g,"\\$&");const s=new RegExp(`^${r.replace(/\*/g,".*").replace(/\?/g,".")}$`);return s.test(e)}async function processFile(e){const t=Date.now();const{inputPath:r,outputPath:s,engine:a,doneDir:u,errorDir:l}=e;try{const l=await jh.readFile(r,"utf8");const h=await a(l);const f=Ah.dirname(s);if(!(0,Oh.existsSync)(f)){await jh.mkdir(f,{recursive:true})}await jh.writeFile(s,h,"utf8");if(u){if(!(0,Oh.existsSync)(u))await jh.mkdir(u,{recursive:true});const e=Ah.join(u,Ah.basename(r));await jh.rename(r,e)}else if(e.deleteSource){await jh.unlink(r)}return{success:true,inputPath:r,outputPath:s,duration:Date.now()-t}}catch(e){if(l){try{if(!(0,Oh.existsSync)(l))await jh.mkdir(l,{recursive:true});const e=Ah.join(l,Ah.basename(r));await jh.rename(r,e)}catch{}}return{success:false,inputPath:r,error:e.message}}}async function batchAction(e){const t=createLogger(e.logFormat);const r=Date.now();try{const{in:s,out:a,pattern:u,cacheDir:l,doneDir:h,errorDir:f}=e;if(!(0,Oh.existsSync)(s)){t.error(`Input directory does not exist: ${s}`);process.exit(1)}const d=Ah.resolve(process.cwd(),s);const _=Ah.resolve(process.cwd(),a);const m=h?Ah.resolve(process.cwd(),h):void 0;const g=f?Ah.resolve(process.cwd(),f):void 0;if(!(0,Oh.existsSync)(_))await jh.mkdir(_,{recursive:true});const y=resolveQuery(e.query,e.queryFile);const b=new Bh(l);const v=await ot(y,{cache:b});const E=extractTargetFormat(y);const T=await jh.readdir(d);const k=T.filter((e=>matchesPattern(e,u)));if(k.length===0){t.info("No files found matching pattern",{pattern:u,in:s});return}t.info(`Starting batch processing of ${k.length} files...`);let x=0;let O=0;for(const r of k){const s=Ah.join(d,r);const a=resolveOutputPath(s,d,_,E);const u=await processFile({engine:v,inputPath:s,outputPath:a,doneDir:m,errorDir:g,deleteSource:e.delete});if(u.success){x++;t.info("Transformed",{input:Ah.basename(s),output:Ah.basename(u.outputPath),duration:u.duration})}else{O++;t.error(u.error||"Unknown error",{input:Ah.basename(s)})}}t.summary({processed:x,errors:O,duration:Date.now()-r});if(O>0){process.exit(1)}}catch(e){t.error(`Batch execution failed: ${e.message}`);process.exit(1)}}async function watchAction(e){const t=createLogger(e.logFormat);try{const{in:r,out:s,pattern:a,cacheDir:u,doneDir:l,errorDir:h,pidFile:f}=e;if(!(0,Oh.existsSync)(r)){t.error(`Input directory does not exist: ${r}`);process.exit(1)}const d=Ah.resolve(process.cwd(),r);const _=Ah.resolve(process.cwd(),s);const m=l?Ah.resolve(process.cwd(),l):void 0;const g=h?Ah.resolve(process.cwd(),h):void 0;if(!(0,Oh.existsSync)(_))await jh.mkdir(_,{recursive:true});const y=resolveQuery(e.query,e.queryFile);const b=new Bh(u);const v=await ot(y,{cache:b});const E=extractTargetFormat(y);t.info("Starting initial sweep...");const T=await jh.readdir(d);for(const t of T){if(matchesPattern(t,a)){const r=Ah.join(d,t);const s=resolveOutputPath(r,d,_,E);await processFile({engine:v,inputPath:r,outputPath:s,doneDir:m,errorDir:g,deleteSource:e.delete})}}if(f){(0,Oh.writeFileSync)(f,process.pid.toString());t.info(`PID ${process.pid} written to ${f}`)}const cleanup=()=>{if(f&&(0,Oh.existsSync)(f)){(0,Oh.unlinkSync)(f)}t.info("Shutting down watch mode...");process.exit(0)};process.on("SIGINT",cleanup);process.on("SIGTERM",cleanup);t.info(`Watching directory: ${d} [Pattern: ${a}]`);const k=new Map;(0,Oh.watch)(d,{recursive:false},(async(r,s)=>{if(!s||!matchesPattern(s,a))return;const u=Ah.join(d,s);const l=k.get(s);if(l)clearTimeout(l);k.set(s,setTimeout((async()=>{k.delete(s);if(!(0,Oh.existsSync)(u))return;const r=await jh.stat(u);if(r.isDirectory())return;const a=resolveOutputPath(u,d,_,E);const l=await processFile({engine:v,inputPath:u,outputPath:a,doneDir:m,errorDir:g,deleteSource:e.delete});if(l.success){t.info("Transformed",{input:s,output:Ah.basename(l.outputPath),duration:l.duration})}else{t.error(l.error||"Unknown error",{input:s})}}),100))}))}catch(e){t.error(`Watch execution failed: ${e.message}`);process.exit(1)}}async function readStdin(){const e=[];for await(const t of process.stdin){e.push(t)}return Buffer.concat(e).toString("utf8")}var Wh=new Fh;Wh.name("morphql").description("CLI tool for morphql - transform structural data from the command line.").version("0.1.30");Wh.command("batch").description("Transform all files in a directory").option("-q, --query <string>","MorphQL query string").option("-Q, --query-file <path>","Path to a file containing the MorphQL query").requiredOption("--in <path>","Input directory").requiredOption("--out <path>","Output directory").option("--pattern <glob>","Include pattern for source files","*").option("--done-dir <path>","Move processed files here").option("--error-dir <path>","Move failed files here").option("--delete","Delete source files after successful processing (if --done-dir is missing)").option("--cache-dir <path>","Directory for compiled cache",".compiled").option("--log-format <format>","Log output format: text or json","text").action(batchAction);Wh.command("watch").description("Watch a directory and transform new files").option("-q, --query <string>","MorphQL query string").option("-Q, --query-file <path>","Path to a file containing the MorphQL query").requiredOption("--in <path>","Input directory").requiredOption("--out <path>","Output directory").option("--pattern <glob>","Include pattern for source files","*").option("--done-dir <path>","Move processed files here").option("--error-dir <path>","Move failed files here").option("--delete","Delete source files after successful processing (if --done-dir is missing)").option("--cache-dir <path>","Directory for compiled cache",".compiled").option("--pid-file <path>","Write PID to file for process management").option("--log-format <format>","Log output format: text or json","text").action(watchAction);Wh.option("-f, --from <path>","Path to the source file").option("-i, --input <string>","Raw source content as string").option("-t, --to <path>","Path to the destination file (if omitted, result is printed to stdout)").option("-q, --query <string>","MorphQL query string").option("-Q, --query-file <path>","Path to a file containing the MorphQL query").option("--cache-dir <path>","Directory for compiled cache",".compiled").option("--log-format <format>","Log output format: text or json","text").action((async e=>{if(!e.query&&!e.queryFile){Wh.help();return}const t=createLogger(e.logFormat);try{const{from:r,input:s,to:a,cacheDir:u}=e;const l=resolveQuery(e.query,e.queryFile);let h;if(s){h=s}else if(r){if(!(0,Oh.existsSync)(r)){t.error(`Source file not found: ${r}`);process.exit(1)}h=await jh.readFile(r,"utf8")}else if(!process.stdin.isTTY){h=await readStdin()}else{t.error("Either --from <path>, --input <string>, or pipe data via stdin must be provided.");process.exit(1)}const f=new Bh(u);const d=await ot(l,{cache:f});const _=await d(h);if(a){const e=Ah.dirname(a);if(!(0,Oh.existsSync)(e)){await jh.mkdir(e,{recursive:true})}await jh.writeFile(a,_,"utf8");t.info(`Successfully transformed to ${a}`)}else{process.stdout.write(_+"\n")}}catch(e){t.error(`Error during transformation: ${e.message}`);process.exit(1)}}));Wh.parse();